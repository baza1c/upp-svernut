
&НаКлиенте
Процедура ПоказатьВыгрузку(Команда)
	Запрос = ПолучитьЗапрос ();
	Результат = Запрос.Выполнить();
    ТабДокумент = Новый ТабличныйДокумент;
	Построитель = Новый ПостроительОтчета;
	Построитель.ИсточникДанных=Новый ОписаниеИсточникаДанных(Результат);       
	Построитель.Вывести(ТабДокумент);
    ТабДокумент.Показать();
КонецПроцедуры

&НаКлиенте
Функция ПолучитьЗапрос ()
	Запрос = Новый Запрос;
	//Запрос.Текст = 
	//{Лео Катанович 
	//БЫЛО
		//"ВЫБРАТЬ
		//|	Номенклатура.Ссылка КАК Номенклатура,
		//|	Номенклатура.Код,
		//|	Номенклатура.Артикул,
		//|	Номенклатура.НаименованиеПолное,
		//|	Номенклатура.Наименование,
		//|	Номенклатура.абс_СтатусНоменклатуры
		//|ПОМЕСТИТЬ ВТ_Номенклатура
		//|ИЗ
		//|	Справочник.Номенклатура КАК Номенклатура
		//|ГДЕ
		//|	Номенклатура.Артикул <> """"
		//|	И Номенклатура.ПометкаУдаления = ЛОЖЬ
		//|;
		//|
		//|////////////////////////////////////////////////////////////////////////////////
		//|ВЫБРАТЬ
		//|	ЗначенияСвойствОбъектов.Объект,
		//|	ЗначенияСвойствОбъектов.Свойство,
		//|	ЗначенияСвойствОбъектов.Значение
		//|ПОМЕСТИТЬ ВТ_Свойства
		//|ИЗ
		//|	ВТ_Номенклатура КАК ВТ_Номенклатура
		//|		ВНУТРЕННЕЕ СОЕДИНЕНИЕ РегистрСведений.ЗначенияСвойствОбъектов КАК ЗначенияСвойствОбъектов
		//|		ПО ВТ_Номенклатура.Номенклатура = ЗначенияСвойствОбъектов.Объект
		//|;
		//|
		//|////////////////////////////////////////////////////////////////////////////////
		//|ВЫБРАТЬ
		//|	ВТ_Номенклатура.Код,
		//|	ВТ_Номенклатура.Артикул,
		//|	МАКСИМУМ(СвойстваНоменклатуры.Тип) КАК Тип,
		//|	МАКСИМУМ(СвойстваНоменклатуры.Категория) КАК Категория,
		//|	МАКСИМУМ(СвойстваНоменклатуры.Подкатегория1) КАК Подкатегория1,
		//|	МАКСИМУМ(СвойстваНоменклатуры.Подкатегория2) КАК Подкатегория2,
		//|	МАКСИМУМ(СвойстваНоменклатуры.ТорговаяМарка) КАК ТорговаяМарка,
		//|	МАКСИМУМ(СвойстваНоменклатуры.Название) КАК Название,
		//|	ВТ_Номенклатура.Наименование,
		//|	ВЫРАЗИТЬ(ВТ_Номенклатура.НаименованиеПолное КАК СТРОКА(500)) КАК НаименованиеПолное,
		//|	ВТ_Номенклатура.абс_СтатусНоменклатуры,
		//|	ЕСТЬNULL(ВложенныйЗапрос.Коэффициент, 1) * ВТ_Номенклатура.Номенклатура.ЕдиницаХраненияОстатков.ВесНетто КАК Вес,
		//|	"""" КАК Прейскурант,
		//|	МАКСИМУМ(СвойстваНоменклатуры.ФокусныйАссортимент) КАК ФокусныйАссортимент,
		//|	МАКСИМУМ(ЕСТЬNULL(ВложенныйЗапрос.Коэффициент, 1)) КАК КолВложений,
		//|	МАКСИМУМ(ВТ_Номенклатура.Номенклатура.ЕдиницаХраненияОстатков.ВесНетто) КАК ВесВложения,
		//|	МАКСИМУМ(СвойстваНоменклатуры.Одиночные) КАК Одиночные,
		//|	МАКСИМУМ(СвойстваНоменклатуры.ФорматУпаковки) КАК ФорматУпаковки,
		//|	МАКСИМУМ(СвойстваНоменклатуры.СводноеНаименование) КАК СводноеНаименование,
		//|	МАКСИМУМ(СвойстваНоменклатуры.СводнаяТорговаяМарка) КАК СводнаяТорговаяМарка,
		//|	МАКСИМУМ(СвойстваНоменклатуры.Consumer_product) КАК Consumer_product,
		//|	МАКСИМУМ(СвойстваНоменклатуры.Потребление) КАК Потребление,
		//|	МАКСИМУМ(СвойстваНоменклатуры.Новинка) КАК Новинка,
		//|	МАКСИМУМ(СвойстваНоменклатуры.КоличествоВложенийМаркетинг) КАК КоличествоВложенийМаркетинг,
		//|	МАКСИМУМ(СвойстваНоменклатуры.ВесВложенияМаркетинг) КАК ВесВложенияМаркетинг,
		//|	МАКСИМУМ(СвойстваНоменклатуры.ВесМаркетинг) КАК ВесМаркетинг
		//|ИЗ
		//|	ВТ_Номенклатура КАК ВТ_Номенклатура
		//|		ЛЕВОЕ СОЕДИНЕНИЕ (ВЫБРАТЬ
		//|			ВТ_Свойства.Объект КАК Объект,
		//|			ВТ_Свойства.Значение КАК Тип,
		//|			"""" КАК Категория,
		//|			"""" КАК Подкатегория1,
		//|			"""" КАК Подкатегория2,
		//|			"""" КАК ТорговаяМарка,
		//|			"""" КАК ФокусныйАссортимент,
		//|			"""" КАК ФорматУпаковки,
		//|			"""" КАК СводноеНаименование,
		//|			"""" КАК Consumer_product,
		//|			"""" КАК Потребление,
		//|			"""" КАК Название,
		//|			"""" КАК ВесВложения,
		//|			"""" КАК Одиночные,
		//|			"""" КАК Новинка,
		//|			"""" КАК КоличествоВложенийМаркетинг,
		//|			"""" КАК ВесВложенияМаркетинг,
		//|			"""" КАК ВесМаркетинг,
		//|			"""" КАК СводнаяТорговаяМарка
		//|		ИЗ
		//|			ВТ_Свойства КАК ВТ_Свойства
		//|		ГДЕ
		//|			ВТ_Свойства.Свойство = &Тип
		//|		
		//|		ОБЪЕДИНИТЬ ВСЕ
		//|		
		//|		ВЫБРАТЬ
		//|			ВТ_Свойства.Объект,
		//|			"""",
		//|			ВТ_Свойства.Значение,
		//|			"""",
		//|			"""",
		//|			"""",
		//|			"""",
		//|			"""",
		//|			"""",
		//|			"""",
		//|			"""",
		//|			"""",
		//|			"""",
		//|			"""",
		//|			"""",
		//|			"""",
		//|			"""",
		//|			"""",
		//|			""""
		//|		ИЗ
		//|			ВТ_Свойства КАК ВТ_Свойства
		//|		ГДЕ
		//|			ВТ_Свойства.Свойство = &Категория
		//|		
		//|		ОБЪЕДИНИТЬ ВСЕ
		//|		
		//|		ВЫБРАТЬ
		//|			ВТ_Свойства.Объект,
		//|			"""",
		//|			"""",
		//|			ВТ_Свойства.Значение,
		//|			"""",
		//|			"""",
		//|			"""",
		//|			"""",
		//|			"""",
		//|			"""",
		//|			"""",
		//|			"""",
		//|			"""",
		//|			"""",
		//|			"""",
		//|			"""",
		//|			"""",
		//|			"""",
		//|			""""
		//|		ИЗ
		//|			ВТ_Свойства КАК ВТ_Свойства
		//|		ГДЕ
		//|			ВТ_Свойства.Свойство = &Подкатегория1
		//|		
		//|		ОБЪЕДИНИТЬ ВСЕ
		//|		
		//|		ВЫБРАТЬ
		//|			ВТ_Свойства.Объект,
		//|			"""",
		//|			"""",
		//|			"""",
		//|			ВТ_Свойства.Значение,
		//|			"""",
		//|			"""",
		//|			"""",
		//|			"""",
		//|			"""",
		//|			"""",
		//|			"""",
		//|			"""",
		//|			"""",
		//|			"""",
		//|			"""",
		//|			"""",
		//|			"""",
		//|			""""
		//|		ИЗ
		//|			ВТ_Свойства КАК ВТ_Свойства
		//|		ГДЕ
		//|			ВТ_Свойства.Свойство = &Подкатегория2
		//|		
		//|		ОБЪЕДИНИТЬ ВСЕ
		//|		
		//|		ВЫБРАТЬ
		//|			ВТ_Свойства.Объект,
		//|			"""",
		//|			"""",
		//|			"""",
		//|			"""",
		//|			ВТ_Свойства.Значение,
		//|			"""",
		//|			"""",
		//|			"""",
		//|			"""",
		//|			"""",
		//|			"""",
		//|			"""",
		//|			"""",
		//|			"""",
		//|			"""",
		//|			"""",
		//|			"""",
		//|			""""
		//|		ИЗ
		//|			ВТ_Свойства КАК ВТ_Свойства
		//|		ГДЕ
		//|			ВТ_Свойства.Свойство = &ТорговаяМарка
		//|		
		//|		ОБЪЕДИНИТЬ ВСЕ
		//|		
		//|		ВЫБРАТЬ
		//|			ВТ_Свойства.Объект,
		//|			"""",
		//|			"""",
		//|			"""",
		//|			"""",
		//|			"""",
		//|			ВТ_Свойства.Значение,
		//|			"""",
		//|			"""",
		//|			"""",
		//|			"""",
		//|			"""",
		//|			"""",
		//|			"""",
		//|			"""",
		//|			"""",
		//|			"""",
		//|			"""",
		//|			""""
		//|		ИЗ
		//|			ВТ_Свойства КАК ВТ_Свойства
		//|		ГДЕ
		//|			ВТ_Свойства.Свойство = &ФокусныйАссортимент
		//|		
		//|		ОБЪЕДИНИТЬ ВСЕ
		//|		
		//|		ВЫБРАТЬ
		//|			ВТ_Свойства.Объект,
		//|			"""",
		//|			"""",
		//|			"""",
		//|			"""",
		//|			"""",
		//|			"""",
		//|			ВТ_Свойства.Значение,
		//|			"""",
		//|			"""",
		//|			"""",
		//|			"""",
		//|			"""",
		//|			"""",
		//|			"""",
		//|			"""",
		//|			"""",
		//|			"""",
		//|			""""
		//|		ИЗ
		//|			ВТ_Свойства КАК ВТ_Свойства
		//|		ГДЕ
		//|			ВТ_Свойства.Свойство = &ФорматУпаковки
		//|		
		//|		ОБЪЕДИНИТЬ ВСЕ
		//|		
		//|		ВЫБРАТЬ
		//|			ВТ_Свойства.Объект,
		//|			"""",
		//|			"""",
		//|			"""",
		//|			"""",
		//|			"""",
		//|			"""",
		//|			"""",
		//|			ВТ_Свойства.Значение,
		//|			"""",
		//|			"""",
		//|			"""",
		//|			"""",
		//|			"""",
		//|			"""",
		//|			"""",
		//|			"""",
		//|			"""",
		//|			""""
		//|		ИЗ
		//|			ВТ_Свойства КАК ВТ_Свойства
		//|		ГДЕ
		//|			ВТ_Свойства.Свойство = &СводноеНаименование
		//|		
		//|		ОБЪЕДИНИТЬ ВСЕ
		//|		
		//|		ВЫБРАТЬ
		//|			ВТ_Свойства.Объект,
		//|			"""",
		//|			"""",
		//|			"""",
		//|			"""",
		//|			"""",
		//|			"""",
		//|			"""",
		//|			"""",
		//|			ВТ_Свойства.Значение,
		//|			"""",
		//|			"""",
		//|			"""",
		//|			"""",
		//|			"""",
		//|			"""",
		//|			"""",
		//|			"""",
		//|			""""
		//|		ИЗ
		//|			ВТ_Свойства КАК ВТ_Свойства
		//|		ГДЕ
		//|			ВТ_Свойства.Свойство = &Consumer_product
		//|		
		//|		ОБЪЕДИНИТЬ ВСЕ
		//|		
		//|		ВЫБРАТЬ
		//|			ВТ_Свойства.Объект,
		//|			"""",
		//|			"""",
		//|			"""",
		//|			"""",
		//|			"""",
		//|			"""",
		//|			"""",
		//|			"""",
		//|			"""",
		//|			ВТ_Свойства.Значение,
		//|			"""",
		//|			"""",
		//|			"""",
		//|			"""",
		//|			"""",
		//|			"""",
		//|			"""",
		//|			""""
		//|		ИЗ
		//|			ВТ_Свойства КАК ВТ_Свойства
		//|		ГДЕ
		//|			ВТ_Свойства.Свойство = &Потребление
		//|		
		//|		ОБЪЕДИНИТЬ ВСЕ
		//|		
		//|		ВЫБРАТЬ
		//|			ВТ_Свойства.Объект,
		//|			"""",
		//|			"""",
		//|			"""",
		//|			"""",
		//|			"""",
		//|			"""",
		//|			"""",
		//|			"""",
		//|			"""",
		//|			"""",
		//|			ВТ_Свойства.Значение,
		//|			"""",
		//|			"""",
		//|			"""",
		//|			"""",
		//|			"""",
		//|			"""",
		//|			""""
		//|		ИЗ
		//|			ВТ_Свойства КАК ВТ_Свойства
		//|		ГДЕ
		//|			ВТ_Свойства.Свойство = &Название
		//|		
		//|		ОБЪЕДИНИТЬ ВСЕ
		//|		
		//|		ВЫБРАТЬ
		//|			ВТ_Свойства.Объект,
		//|			"""",
		//|			"""",
		//|			"""",
		//|			"""",
		//|			"""",
		//|			"""",
		//|			"""",
		//|			"""",
		//|			"""",
		//|			"""",
		//|			"""",
		//|			ВТ_Свойства.Значение,
		//|			"""",
		//|			"""",
		//|			"""",
		//|			"""",
		//|			"""",
		//|			""""
		//|		ИЗ
		//|			ВТ_Свойства КАК ВТ_Свойства
		//|		ГДЕ
		//|			ВТ_Свойства.Свойство = &ВесВложения
		//|		
		//|		ОБЪЕДИНИТЬ ВСЕ
		//|		
		//|		ВЫБРАТЬ
		//|			ВТ_Свойства.Объект,
		//|			"""",
		//|			"""",
		//|			"""",
		//|			"""",
		//|			"""",
		//|			"""",
		//|			"""",
		//|			"""",
		//|			"""",
		//|			"""",
		//|			"""",
		//|			"""",
		//|			ВТ_Свойства.Значение,
		//|			"""",
		//|			"""",
		//|			"""",
		//|			"""",
		//|			""""
		//|		ИЗ
		//|			ВТ_Свойства КАК ВТ_Свойства
		//|		ГДЕ
		//|			ВТ_Свойства.Свойство = &Одиночные
		//|		
		//|		ОБЪЕДИНИТЬ ВСЕ
		//|		
		//|		ВЫБРАТЬ
		//|			ВТ_Свойства.Объект,
		//|			"""",
		//|			"""",
		//|			"""",
		//|			"""",
		//|			"""",
		//|			"""",
		//|			"""",
		//|			"""",
		//|			"""",
		//|			"""",
		//|			"""",
		//|			"""",
		//|			"""",
		//|			ВТ_Свойства.Значение,
		//|			"""",
		//|			"""",
		//|			"""",
		//|			""""
		//|		ИЗ
		//|			ВТ_Свойства КАК ВТ_Свойства
		//|		ГДЕ
		//|			ВТ_Свойства.Свойство = &Новинка
		//|		
		//|		ОБЪЕДИНИТЬ ВСЕ
		//|		
		//|		ВЫБРАТЬ
		//|			ВТ_Свойства.Объект,
		//|			"""",
		//|			"""",
		//|			"""",
		//|			"""",
		//|			"""",
		//|			"""",
		//|			"""",
		//|			"""",
		//|			"""",
		//|			"""",
		//|			"""",
		//|			"""",
		//|			"""",
		//|			"""",
		//|			ВТ_Свойства.Значение,
		//|			"""",
		//|			"""",
		//|			""""
		//|		ИЗ
		//|			ВТ_Свойства КАК ВТ_Свойства
		//|		ГДЕ
		//|			ВТ_Свойства.Свойство = &КоличествоВложенийМаркетинг
		//|		
		//|		ОБЪЕДИНИТЬ ВСЕ
		//|		
		//|		ВЫБРАТЬ
		//|			ВТ_Свойства.Объект,
		//|			"""",
		//|			"""",
		//|			"""",
		//|			"""",
		//|			"""",
		//|			"""",
		//|			"""",
		//|			"""",
		//|			"""",
		//|			"""",
		//|			"""",
		//|			"""",
		//|			"""",
		//|			"""",
		//|			"""",
		//|			ВТ_Свойства.Значение,
		//|			"""",
		//|			""""
		//|		ИЗ
		//|			ВТ_Свойства КАК ВТ_Свойства
		//|		ГДЕ
		//|			ВТ_Свойства.Свойство = &ВесВложенияМаркетинг
		//|		
		//|		ОБЪЕДИНИТЬ ВСЕ
		//|		
		//|		ВЫБРАТЬ
		//|			ВТ_Свойства.Объект,
		//|			"""",
		//|			"""",
		//|			"""",
		//|			"""",
		//|			"""",
		//|			"""",
		//|			"""",
		//|			"""",
		//|			"""",
		//|			"""",
		//|			"""",
		//|			"""",
		//|			"""",
		//|			"""",
		//|			"""",
		//|			"""",
		//|			ВТ_Свойства.Значение,
		//|			""""
		//|		ИЗ
		//|			ВТ_Свойства КАК ВТ_Свойства
		//|		ГДЕ
		//|			ВТ_Свойства.Свойство = &ВесМаркетинг
		//
		//|		ОБЪЕДИНИТЬ ВСЕ
		//|		
		//|		ВЫБРАТЬ
		//|			ВТ_Свойства.Объект,
		//|			"""",
		//|			"""",
		//|			"""",
		//|			"""",
		//|			"""",
		//|			"""",
		//|			"""",
		//|			"""",
		//|			"""",
		//|			"""",
		//|			"""",
		//|			"""",
		//|			"""",
		//|			"""",
		//|			"""",
		//|			"""",
		//|			"""",
		//|			ВТ_Свойства.Значение
		//|		ИЗ
		//|			ВТ_Свойства КАК ВТ_Свойства
		//|		ГДЕ
		//|			ВТ_Свойства.Свойство = &СводнаяТорговаямарка) КАК СвойстваНоменклатуры
		//
		//|		ПО ВТ_Номенклатура.Номенклатура = СвойстваНоменклатуры.Объект
		//|		ЛЕВОЕ СОЕДИНЕНИЕ (ВЫБРАТЬ
		//|			ЕдиницыИзмерения.Ссылка КАК Ссылка,
		//|			ЕдиницыИзмерения.Владелец КАК Владелец,
		//|			ЕдиницыИзмерения.Коэффициент КАК Коэффициент
		//|		ИЗ
		//|			Справочник.ЕдиницыИзмерения КАК ЕдиницыИзмерения
		//|		ГДЕ
		//|			ЕдиницыИзмерения.Наименование = ""Блок""
		//|			И ЕдиницыИзмерения.ПометкаУдаления = ЛОЖЬ) КАК ВложенныйЗапрос
		//|		ПО ВТ_Номенклатура.Номенклатура = ВложенныйЗапрос.Владелец
		//|
		//|СГРУППИРОВАТЬ ПО
		//|	ВТ_Номенклатура.Код,
		//|	ВТ_Номенклатура.Наименование,
		//|	ВЫРАЗИТЬ(ВТ_Номенклатура.НаименованиеПолное КАК СТРОКА(500)),
		//|	ВТ_Номенклатура.абс_СтатусНоменклатуры,
		//|	ВТ_Номенклатура.Артикул,
		//|	ЕСТЬNULL(ВложенныйЗапрос.Коэффициент, 1) * ВТ_Номенклатура.Номенклатура.ЕдиницаХраненияОстатков.ВесНетто";
    Запрос.Текст = 
	    "ВЫБРАТЬ
	    |	Номенклатура.Ссылка КАК Номенклатура,
	    |	Номенклатура.Ссылка.Артикул КАК Артикул
	    |ПОМЕСТИТЬ ВТ_Номенклатура
	    |ИЗ
	    |	Справочник.Номенклатура КАК Номенклатура
	    |ГДЕ
	    |	Номенклатура.Артикул <> """"
	    |	И Номенклатура.ПометкаУдаления = ЛОЖЬ
	    |;
	    |
	    |////////////////////////////////////////////////////////////////////////////////
	    |ВЫБРАТЬ
	    |	ВТ_Номенклатура.Номенклатура.Код КАК Код,
	    |	ВТ_Номенклатура.Номенклатура.Артикул КАК Артикул,
		
		|	ВТ_Номенклатура.Номенклатура.Наименование КАК Наименование,
		|	ВТ_Номенклатура.Номенклатура.НаименованиеПолное КАК НаименованиеПолное,
		|	ВТ_Номенклатура.Номенклатура.абс_СтатусНоменклатуры КАК СтатусНоменклатуры,
        |   ЕСТЬNULL(ВложенныйЗапрос.Коэффициент, 1) * ВТ_Номенклатура.Номенклатура.ЕдиницаХраненияОстатков.ВесНетто КАК Вес,
		|	ВТ_Номенклатура.Номенклатура.ЕдиницаХраненияОстатков.ВесНетто КАК ВесВложения,
		|	"""" КАК Прейскурант,
		|	ТипСвойство.Значение КАК Тип,
	    |	Категория.Значение КАК Категория,
	    |	ПодКатегория1.Значение КАК ПодКатегория1,
	    |	ПодКатегория2.Значение КАК ПодКатегория2,
	    |	ТорговаяМарка.Значение КАК ТорговаяМарка,
	    |	СводнаяТорговаяМарка.Значение КАК СводнаяТорговаяМарка,
	    |	ФокусныйАссортимент.Значение КАК ФокусныйАссортимент,
	    |	СводноеНаименование.Значение КАК СводноеНаименование,
	    |	Название.Значение КАК Название,
	    |	Consumer_Product.Значение КАК Consumer_Product,
	    |	Потребление.Значение КАК Потребление,
	    |	Одиночные.Значение КАК Одиночные,
	    |	Новинка.Значение КАК Новинка,
	    |	ФорматУпаковки.Значение КАК ФорматУпаковки,
		|	ЕСТЬNULL(ВложенныйЗапрос.Коэффициент, 1) КАК КолВложений,
	    |	КоличествоВложенийМаркетинг.Значение КАК КоличествоВложенийМаркетинг,
	    //|	ВесВложения.Значение КАК ВесВложения,
	    |	ВесВложенияМаркетинг.Значение КАК ВесВложенияМаркетинг,
	    |	ВесМаркетинг.Значение КАК ВесМаркетинг
	    |ИЗ
	    |	ВТ_Номенклатура КАК ВТ_Номенклатура
	    |		ЛЕВОЕ СОЕДИНЕНИЕ (ВЫБРАТЬ
	    |			ЗначенияСвойствОбъектов.Объект КАК Объект,
	    |			ЗначенияСвойствОбъектов.Свойство КАК Свойство,
	    |			ЗначенияСвойствОбъектов.Значение КАК Значение
	    |		ИЗ
	    |			РегистрСведений.ЗначенияСвойствОбъектов КАК ЗначенияСвойствОбъектов
	    |		ГДЕ
	    |			ЗначенияСвойствОбъектов.Свойство = &ВесВложенияМаркетинг) КАК ВесВложенияМаркетинг
	    |		ПО ВТ_Номенклатура.Номенклатура = ВесВложенияМаркетинг.Объект
	    |		ЛЕВОЕ СОЕДИНЕНИЕ (ВЫБРАТЬ
	    |			ЗначенияСвойствОбъектов.Объект КАК Объект,
	    |			ЗначенияСвойствОбъектов.Свойство КАК Свойство,
	    |			ЗначенияСвойствОбъектов.Значение КАК Значение
	    |		ИЗ
	    |			РегистрСведений.ЗначенияСвойствОбъектов КАК ЗначенияСвойствОбъектов
	    |		ГДЕ
	    |			ЗначенияСвойствОбъектов.Свойство = &Тип) КАК ТипСвойство
	    |		ПО ВТ_Номенклатура.Номенклатура = ТипСвойство.Объект
	    |		ЛЕВОЕ СОЕДИНЕНИЕ (ВЫБРАТЬ
	    |			ЗначенияСвойствОбъектов.Объект КАК Объект,
	    |			ЗначенияСвойствОбъектов.Свойство КАК Свойство,
	    |			ЗначенияСвойствОбъектов.Значение КАК Значение
	    |		ИЗ
	    |			РегистрСведений.ЗначенияСвойствОбъектов КАК ЗначенияСвойствОбъектов
	    |		ГДЕ
	    |			ЗначенияСвойствОбъектов.Свойство = &Категория) КАК Категория
	    |		ПО ВТ_Номенклатура.Номенклатура = Категория.Объект
	    |		ЛЕВОЕ СОЕДИНЕНИЕ (ВЫБРАТЬ
	    |			ЗначенияСвойствОбъектов.Объект КАК Объект,
	    |			ЗначенияСвойствОбъектов.Свойство КАК Свойство,
	    |			ЗначенияСвойствОбъектов.Значение КАК Значение
	    |		ИЗ
	    |			РегистрСведений.ЗначенияСвойствОбъектов КАК ЗначенияСвойствОбъектов
	    |		ГДЕ
	    |			ЗначенияСвойствОбъектов.Свойство = &ПодКатегория1) КАК ПодКатегория1
	    |		ПО ВТ_Номенклатура.Номенклатура = ПодКатегория1.Объект
	    |		ЛЕВОЕ СОЕДИНЕНИЕ (ВЫБРАТЬ
	    |			ЗначенияСвойствОбъектов.Объект КАК Объект,
	    |			ЗначенияСвойствОбъектов.Свойство КАК Свойство,
	    |			ЗначенияСвойствОбъектов.Значение КАК Значение
	    |		ИЗ
	    |			РегистрСведений.ЗначенияСвойствОбъектов КАК ЗначенияСвойствОбъектов
	    |		ГДЕ
	    |			ЗначенияСвойствОбъектов.Свойство = &ПодКатегория2) КАК ПодКатегория2
	    |		ПО ВТ_Номенклатура.Номенклатура = ПодКатегория2.Объект
	    |		ЛЕВОЕ СОЕДИНЕНИЕ (ВЫБРАТЬ
	    |			ЗначенияСвойствОбъектов.Объект КАК Объект,
	    |			ЗначенияСвойствОбъектов.Свойство КАК Свойство,
	    |			ЗначенияСвойствОбъектов.Значение КАК Значение
	    |		ИЗ
	    |			РегистрСведений.ЗначенияСвойствОбъектов КАК ЗначенияСвойствОбъектов
	    |		ГДЕ
	    |			ЗначенияСвойствОбъектов.Свойство = &ТорговаяМарка) КАК ТорговаяМарка
	    |		ПО ВТ_Номенклатура.Номенклатура = ТорговаяМарка.Объект
	    |		ЛЕВОЕ СОЕДИНЕНИЕ (ВЫБРАТЬ
	    |			ЗначенияСвойствОбъектов.Объект КАК Объект,
	    |			ЗначенияСвойствОбъектов.Свойство КАК Свойство,
	    |			ЗначенияСвойствОбъектов.Значение КАК Значение
	    |		ИЗ
	    |			РегистрСведений.ЗначенияСвойствОбъектов КАК ЗначенияСвойствОбъектов
	    |		ГДЕ
	    |			ЗначенияСвойствОбъектов.Свойство = &СводнаяТорговаяМарка) КАК СводнаяТорговаяМарка
	    |		ПО ВТ_Номенклатура.Номенклатура = СводнаяТорговаяМарка.Объект
	    |		ЛЕВОЕ СОЕДИНЕНИЕ (ВЫБРАТЬ
	    |			ЗначенияСвойствОбъектов.Объект КАК Объект,
	    |			ЗначенияСвойствОбъектов.Свойство КАК Свойство,
	    |			ЗначенияСвойствОбъектов.Значение КАК Значение
	    |		ИЗ
	    |			РегистрСведений.ЗначенияСвойствОбъектов КАК ЗначенияСвойствОбъектов
	    |		ГДЕ
	    |			ЗначенияСвойствОбъектов.Свойство = &ФокусныйАссортимент) КАК ФокусныйАссортимент
	    |		ПО ВТ_Номенклатура.Номенклатура = ФокусныйАссортимент.Объект
	    |		ЛЕВОЕ СОЕДИНЕНИЕ (ВЫБРАТЬ
	    |			ЗначенияСвойствОбъектов.Объект КАК Объект,
	    |			ЗначенияСвойствОбъектов.Свойство КАК Свойство,
	    |			ЗначенияСвойствОбъектов.Значение КАК Значение
	    |		ИЗ
	    |			РегистрСведений.ЗначенияСвойствОбъектов КАК ЗначенияСвойствОбъектов
	    |		ГДЕ
	    |			ЗначенияСвойствОбъектов.Свойство = &ФорматУпаковки) КАК ФорматУпаковки
	    |		ПО ВТ_Номенклатура.Номенклатура = ФорматУпаковки.Объект
	    |		ЛЕВОЕ СОЕДИНЕНИЕ (ВЫБРАТЬ
	    |			ЗначенияСвойствОбъектов.Объект КАК Объект,
	    |			ЗначенияСвойствОбъектов.Свойство КАК Свойство,
	    |			ЗначенияСвойствОбъектов.Значение КАК Значение
	    |		ИЗ
	    |			РегистрСведений.ЗначенияСвойствОбъектов КАК ЗначенияСвойствОбъектов
	    |		ГДЕ
	    |			ЗначенияСвойствОбъектов.Свойство = &СводноеНаименование) КАК СводноеНаименование
	    |		ПО ВТ_Номенклатура.Номенклатура = СводноеНаименование.Объект
	    |		ЛЕВОЕ СОЕДИНЕНИЕ (ВЫБРАТЬ
	    |			ЗначенияСвойствОбъектов.Объект КАК Объект,
	    |			ЗначенияСвойствОбъектов.Свойство КАК Свойство,
	    |			ЗначенияСвойствОбъектов.Значение КАК Значение
	    |		ИЗ
	    |			РегистрСведений.ЗначенияСвойствОбъектов КАК ЗначенияСвойствОбъектов
	    |		ГДЕ
	    |			ЗначенияСвойствОбъектов.Свойство = &Consumer_Product) КАК Consumer_Product
	    |		ПО ВТ_Номенклатура.Номенклатура = Consumer_Product.Объект
	    |		ЛЕВОЕ СОЕДИНЕНИЕ (ВЫБРАТЬ
	    |			ЗначенияСвойствОбъектов.Объект КАК Объект,
	    |			ЗначенияСвойствОбъектов.Свойство КАК Свойство,
	    |			ЗначенияСвойствОбъектов.Значение КАК Значение
	    |		ИЗ
	    |			РегистрСведений.ЗначенияСвойствОбъектов КАК ЗначенияСвойствОбъектов
	    |		ГДЕ
	    |			ЗначенияСвойствОбъектов.Свойство = &Потребление) КАК Потребление
	    |		ПО ВТ_Номенклатура.Номенклатура = Потребление.Объект
	    |		ЛЕВОЕ СОЕДИНЕНИЕ (ВЫБРАТЬ
	    |			ЗначенияСвойствОбъектов.Объект КАК Объект,
	    |			ЗначенияСвойствОбъектов.Свойство КАК Свойство,
	    |			ЗначенияСвойствОбъектов.Значение КАК Значение
	    |		ИЗ
	    |			РегистрСведений.ЗначенияСвойствОбъектов КАК ЗначенияСвойствОбъектов
	    |		ГДЕ
	    |			ЗначенияСвойствОбъектов.Свойство = &Название) КАК Название
	    |		ПО ВТ_Номенклатура.Номенклатура = Название.Объект
	    |		ЛЕВОЕ СОЕДИНЕНИЕ (ВЫБРАТЬ
	    |			ЗначенияСвойствОбъектов.Объект КАК Объект,
	    |			ЗначенияСвойствОбъектов.Свойство КАК Свойство,
	    |			ЗначенияСвойствОбъектов.Значение КАК Значение
	    |		ИЗ
	    |			РегистрСведений.ЗначенияСвойствОбъектов КАК ЗначенияСвойствОбъектов
	    |		ГДЕ
	    |			ЗначенияСвойствОбъектов.Свойство = &ВесВложения) КАК ВесВложения
	    |		ПО ВТ_Номенклатура.Номенклатура = ВесВложения.Объект
	    |		ЛЕВОЕ СОЕДИНЕНИЕ (ВЫБРАТЬ
	    |			ЗначенияСвойствОбъектов.Объект КАК Объект,
	    |			ЗначенияСвойствОбъектов.Свойство КАК Свойство,
	    |			ЗначенияСвойствОбъектов.Значение КАК Значение
	    |		ИЗ
	    |			РегистрСведений.ЗначенияСвойствОбъектов КАК ЗначенияСвойствОбъектов
	    |		ГДЕ
	    |			ЗначенияСвойствОбъектов.Свойство = &Одиночные) КАК Одиночные
	    |		ПО ВТ_Номенклатура.Номенклатура = Одиночные.Объект
	    |		ЛЕВОЕ СОЕДИНЕНИЕ (ВЫБРАТЬ
	    |			ЗначенияСвойствОбъектов.Объект КАК Объект,
	    |			ЗначенияСвойствОбъектов.Свойство КАК Свойство,
	    |			ЗначенияСвойствОбъектов.Значение КАК Значение
	    |		ИЗ
	    |			РегистрСведений.ЗначенияСвойствОбъектов КАК ЗначенияСвойствОбъектов
	    |		ГДЕ
	    |			ЗначенияСвойствОбъектов.Свойство = &Новинка) КАК Новинка
	    |		ПО ВТ_Номенклатура.Номенклатура = Новинка.Объект
	    |		ЛЕВОЕ СОЕДИНЕНИЕ (ВЫБРАТЬ
	    |			ЗначенияСвойствОбъектов.Объект КАК Объект,
	    |			ЗначенияСвойствОбъектов.Свойство КАК Свойство,
	    |			ЗначенияСвойствОбъектов.Значение КАК Значение
	    |		ИЗ
	    |			РегистрСведений.ЗначенияСвойствОбъектов КАК ЗначенияСвойствОбъектов
	    |		ГДЕ
	    |			ЗначенияСвойствОбъектов.Свойство = &КоличествоВложенийМаркетинг) КАК КоличествоВложенийМаркетинг
	    |		ПО ВТ_Номенклатура.Номенклатура = КоличествоВложенийМаркетинг.Объект
	    |		ЛЕВОЕ СОЕДИНЕНИЕ (ВЫБРАТЬ
	    |			ЗначенияСвойствОбъектов.Объект КАК Объект,
	    |			ЗначенияСвойствОбъектов.Свойство КАК Свойство,
	    |			ЗначенияСвойствОбъектов.Значение КАК Значение
	    |		ИЗ
	    |			РегистрСведений.ЗначенияСвойствОбъектов КАК ЗначенияСвойствОбъектов
	    |		ГДЕ
	    |			ЗначенияСвойствОбъектов.Свойство = &ВесМаркетинг) КАК ВесМаркетинг
	    |		ПО ВТ_Номенклатура.Номенклатура = ВесМаркетинг.Объект
		|       ЛЕВОЕ СОЕДИНЕНИЕ (ВЫБРАТЬ
		|			ЕдиницыИзмерения.Ссылка КАК Ссылка,
		|			ЕдиницыИзмерения.Владелец КАК Владелец,
		|			ЕдиницыИзмерения.Коэффициент КАК Коэффициент
		|		ИЗ
		|			Справочник.ЕдиницыИзмерения КАК ЕдиницыИзмерения
		|		ГДЕ
		|			ЕдиницыИзмерения.Наименование = ""Блок""
		|			И ЕдиницыИзмерения.ПометкаУдаления = ЛОЖЬ) КАК ВложенныйЗапрос
		|		ПО ВТ_Номенклатура.Номенклатура = ВложенныйЗапрос.Владелец

	    |
	    |УПОРЯДОЧИТЬ ПО
	    |	Код"    ;
 //Лео Катанович}	
	Запрос.УстановитьПараметр("Тип", ПланыВидовХарактеристик.СвойстваОбъектов.абс_ТипНоменклатуры);
	Запрос.УстановитьПараметр("Категория", ПланыВидовХарактеристик.СвойстваОбъектов.абс_КатегорияНоменклатуры);
    Запрос.УстановитьПараметр("Подкатегория1", ПланыВидовХарактеристик.СвойстваОбъектов.абс_Подкатегория1);
    Запрос.УстановитьПараметр("Подкатегория2", ПланыВидовХарактеристик.СвойстваОбъектов.абс_Подкатегория2);
    Запрос.УстановитьПараметр("ТорговаяМарка", ПланыВидовХарактеристик.СвойстваОбъектов.ТорговаяМарка);
    Запрос.УстановитьПараметр("ФокусныйАссортимент", ПланыВидовХарактеристик.СвойстваОбъектов.абс_ФокусныйАссортимент);
    Запрос.УстановитьПараметр("ФорматУпаковки", ПланыВидовХарактеристик.СвойстваОбъектов.абс_ФорматУпаковки);
    Запрос.УстановитьПараметр("СводноеНаименование", ПланыВидовХарактеристик.СвойстваОбъектов.абс_СводноеНаименование);
	Запрос.УстановитьПараметр("СводнаяТорговаяМарка", ПланыВидовХарактеристик.СвойстваОбъектов.НайтиПоКоду("00000000067"));
	Запрос.УстановитьПараметр("Consumer_product", ПланыВидовХарактеристик.СвойстваОбъектов.абс_ConsumerProduct);
    Запрос.УстановитьПараметр("Потребление", ПланыВидовХарактеристик.СвойстваОбъектов.абс_Потребление);
	Запрос.УстановитьПараметр("Название", ПланыВидовХарактеристик.СвойстваОбъектов.абс_НазваниеНоменклатуры);
	Запрос.УстановитьПараметр("ВесВложения", ПланыВидовХарактеристик.СвойстваОбъектов.абс_ВесВложения);
    Запрос.УстановитьПараметр("Одиночные", ПланыВидовХарактеристик.СвойстваОбъектов.абс_Одиночные);
	Запрос.УстановитьПараметр("Новинка", ПланыВидовХарактеристик.СвойстваОбъектов.НайтиПоКоду("00000000051"));
    Запрос.УстановитьПараметр("КоличествоВложенийМаркетинг", ПланыВидовХарактеристик.СвойстваОбъектов.НайтиПоКоду("00000000052"));
	Запрос.УстановитьПараметр("ВесВложенияМаркетинг", ПланыВидовХарактеристик.СвойстваОбъектов.НайтиПоКоду("00000000053"));
	Запрос.УстановитьПараметр("ВесМаркетинг", ПланыВидовХарактеристик.СвойстваОбъектов.НайтиПоКоду("00000000054"));
	//Запрос.УстановитьПараметр("КоличествоВложений", ПланыВидовХарактеристик.СвойстваОбъектов.НайтиПоКоду("00000000054"));

	
	Возврат Запрос;
КонецФункции

&НаКлиенте
Процедура ВыгрузитьФайл(Команда)
	Попытка 
		Запрос = ПолучитьЗапрос ();
		Результат = Запрос.Выполнить();
	    ТабДокумент = Новый ТабличныйДокумент;
		Построитель = Новый ПостроительОтчета;
		Построитель.ИсточникДанных=Новый ОписаниеИсточникаДанных(Результат);       
		Построитель.Вывести(ТабДокумент);

		
		ИмяДокумента = "Nomenklatura_" + Формат(ДобавитьМесяц(ТекущаяДата(),-2), "ДФ=yyyyMM")+ ".xls";
		ТабДокумент.Записать(Объект.ПутьКФайлу+ ИмяДокумента,ТипФайлаТабличногоДокумента.XLS);
		
		Сообщить("Файл " + ИмяДокумента + " сформирован." )
	Исключение
		Сообщить("Не удалось сформировать файл." )
	КонецПопытки;
КонецПроцедуры

&НаКлиенте
Процедура ПутьКФайлуНачалоВыбора(Элемент, ДанныеВыбора, СтандартнаяОбработка)
	Диалог = Новый ДиалогВыбораФайла(РежимДиалогаВыбораФайла.ВыборКаталога);
    Если Диалог.Выбрать() Тогда
        Объект.ПутьКФайлу = Диалог.Каталог + "\";
	КонецЕсли;

КонецПроцедуры

&НаКлиенте
Процедура ПриОткрытии(Отказ)
	Объект.ПутьКФайлу =  "\\air\Sales\Cube\1С\"  ;
КонецПроцедуры
