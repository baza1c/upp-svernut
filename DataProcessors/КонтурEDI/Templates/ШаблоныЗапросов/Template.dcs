<?xml version="1.0" encoding="UTF-8"?>
<DataCompositionSchema xmlns="http://v8.1c.ru/8.1/data-composition-system/schema" xmlns:dcscom="http://v8.1c.ru/8.1/data-composition-system/common" xmlns:dcscor="http://v8.1c.ru/8.1/data-composition-system/core" xmlns:dcsset="http://v8.1c.ru/8.1/data-composition-system/settings" xmlns:v8="http://v8.1c.ru/8.1/data/core" xmlns:v8ui="http://v8.1c.ru/8.1/data/ui" xmlns:xs="http://www.w3.org/2001/XMLSchema" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
	<dataSource>
		<name>ИсточникДанных1</name>
		<dataSourceType>Local</dataSourceType>
	</dataSource>
	<dataSet xsi:type="DataSetUnion">
		<name>Астор</name>
		<item xsi:type="DataSetUnion">
			<name>Поставщик</name>
			<item xsi:type="DataSetUnion">
				<name>ЗапросОсновнойЦепочки</name>
				<item xsi:type="DataSetQuery">
					<name>Резерв_РасходнаяНакладная_СчетФактура</name>
					<dataSource>ИсточникДанных1</dataSource>
					<query>ВЫБРАТЬ
	докРезерв.Ссылка КАК PORDERS,
	докРезерв.Ссылка КАК ORDERS,
	докРезерв.Ссылка КАК ORDRSP,
	докРасходнаяНакладная.Ссылка КАК DESADV,
	докРасходнаяНакладная.Ссылка КАК RECADV,
	докСчетФактураСостав.Ссылка КАК INVOIC
ИЗ
	(ВЫБРАТЬ
		1 КАК Поле1) КАК Заглушка
		{ПОЛНОЕ СОЕДИНЕНИЕ Документ.СчетФактура.Состав КАК докСчетФактураСостав
			{ПОЛНОЕ СОЕДИНЕНИЕ Документ.РасходнаяНакладная КАК докРасходнаяНакладная
				{ПОЛНОЕ СОЕДИНЕНИЕ Документ.Резерв КАК докРезерв
				ПО докРасходнаяНакладная.ДокОснование = докРезерв.Ссылка}
			ПО докСчетФактураСостав.Основание = докРасходнаяНакладная.Ссылка}
		ПО (ИСТИНА)}</query>
				</item>
			</item>
			<item xsi:type="DataSetUnion">
				<name>ЗапросПоТоварам</name>
				<item xsi:type="DataSetUnion">
					<name>_PORDERS_ORDRSP_</name>
					<item xsi:type="DataSetQuery">
						<name>Резерв</name>
						<dataSource>ИсточникДанных1</dataSource>
						<query> ВЫБРАТЬ
	РезервСостав.Номенклатура,
	РезервСостав.Характеристика как ХарактеристикаНоменклатуры,
	РезервСостав.ЕдиницаИзмерения КАК ЕдиницаИзмерения,
	РезервСостав.ЕдиницаИзмерения.ЕдиницаПоКлассификатору.Наименование КАК КодЕдиницыИзмерения,
	РезервСостав.Цена,
	РезервСостав.СтавкаНДС,
	РезервСостав.Количество КАК Количество,
	РезервСостав.Сумма КАК Сумма,
	РезервСостав.СуммаНДС КАК СуммаНДС,
	ВЫБОР
		КОГДА РезервСостав.Номенклатура.ВидТовара = ЗНАЧЕНИЕ(Перечисление.ВидыТоваров.Услуга)
			ТОГДА "Services"
		ИНАЧЕ ""
	КОНЕЦ КАК ТипЕдиницы
ИЗ
	Документ.Резерв.Состав КАК РезервСостав
ГДЕ
	РезервСостав.Ссылка в (&amp;Ссылка)
	И (НЕ РезервСостав.Номенклатура.ВидТовара = ЗНАЧЕНИЕ(Перечисление.ВидыТоваров.Услуга)
			ИЛИ &amp;РаботаСУслугами)
</query>
					</item>
				</item>
				<item xsi:type="DataSetUnion">
					<name>_DESADV_</name>
					<item xsi:type="DataSetQuery">
						<name>РасходнаяНакладная</name>
						<dataSource>ИсточникДанных1</dataSource>
						<query>ВЫБРАТЬ
	РасходнаяНакладнаяСостав.НомерСтроки,
	РасходнаяНакладнаяСостав.Номенклатура,
	РасходнаяНакладнаяСостав.ХарактеристикаПартия КАК ХарактеристикаНоменклатуры,
	РасходнаяНакладнаяСостав.ЕдиницаИзмерения КАК ЕдиницаИзмерения,
	РасходнаяНакладнаяСостав.ЕдиницаИзмерения.ЕдиницаПоКлассификатору.Наименование КАК КодЕдиницыИзмерения,
	ВЫРАЗИТЬ(РасходнаяНакладнаяСостав.Номенклатура.Наименование КАК СТРОКА(178)) КАК Наименование,
	ВЫРАЗИТЬ(РасходнаяНакладнаяСостав.Номенклатура.НаименованиеДляПечати КАК СТРОКА(500)) КАК НаименованиеПолное,
	РасходнаяНакладнаяСостав.Цена,
	РасходнаяНакладнаяСостав.СтавкаНДС,
	Неопределено КАК СерияНоменклатуры,
	РасходнаяНакладнаяСостав.Номенклатура.СтранаПроисхождения КАК Страна,
	Неопределено КАК НомерГТД,
	РасходнаяНакладнаяСостав.Количество КАК Количество,
	РасходнаяНакладнаяСостав.Сумма КАК Сумма,
	РасходнаяНакладнаяСостав.СуммаНДС,
	ВЫБОР
		КОГДА РасходнаяНакладнаяСостав.Номенклатура.ВидТовара = ЗНАЧЕНИЕ(Перечисление.ВидыТоваров.Услуга)
			ТОГДА "Services"
		ИНАЧЕ ""
	КОНЕЦ КАК ТипЕдиницы
ИЗ
	Документ.РасходнаяНакладная.Состав КАК РасходнаяНакладнаяСостав
ГДЕ
	РасходнаяНакладнаяСостав.Ссылка в (&amp;Ссылка)
	И (НЕ РасходнаяНакладнаяСостав.Номенклатура.ВидТовара = ЗНАЧЕНИЕ(Перечисление.ВидыТоваров.Услуга)
			ИЛИ &amp;РаботаСУслугами)

ОБЪЕДИНИТЬ ВСЕ

ВЫБРАТЬ
	0,
	ВозвратнаяНакладнаяСостав.Номенклатура,
	ВозвратнаяНакладнаяСостав.ХарактеристикаПартия,
	ВозвратнаяНакладнаяСостав.ЕдиницаИзмерения,
	ВозвратнаяНакладнаяСостав.ЕдиницаИзмерения.ЕдиницаПоКлассификатору.Наименование КАК КодЕдиницыИзмерения,
	ВЫРАЗИТЬ(ВозвратнаяНакладнаяСостав.Номенклатура.Наименование КАК СТРОКА(178)),
	ВЫРАЗИТЬ(ВозвратнаяНакладнаяСостав.Номенклатура.НаименованиеДляПечати КАК СТРОКА(500)),
	ВозвратнаяНакладнаяСостав.Цена,
	ВозвратнаяНакладнаяСостав.СтавкаНДС,
	Неопределено КАК СерияНоменклатуры, 
	ВозвратнаяНакладнаяСостав.Номенклатура.СтранаПроисхождения,
	Неопределено КАК НомерГТД,
	-ВозвратнаяНакладнаяСостав.Количество,
	-ВозвратнаяНакладнаяСостав.Сумма,
	-ВозвратнаяНакладнаяСостав.СуммаНДС,
	""
ИЗ
	Документ.ВозвратнаяНакладная.Состав КАК ВозвратнаяНакладнаяСостав
ГДЕ
	ВозвратнаяНакладнаяСостав.Ссылка В(&amp;Возвраты)</query>
					</item>
				</item>
				<item xsi:type="DataSetUnion">
					<name>_INVOIC_</name>
					<item xsi:type="DataSetQuery">
						<name>СчетФактура</name>
						<dataSource>ИсточникДанных1</dataSource>
						<query>ВЫБРАТЬ
	СчетФактураСостав.НомерСтроки,
	СчетФактураСостав.Номенклатура,
	СчетФактураСостав.Характеристика КАК ХарактеристикаНоменклатуры,
	СчетФактураСостав.ЕдиницаИзмерения КАК ЕдиницаИзмерения,
	СчетФактураСостав.ЕдиницаИзмерения.ЕдиницаПоКлассификатору.Наименование КАК КодЕдиницыИзмерения,
	ВЫРАЗИТЬ(СчетФактураСостав.Номенклатура.Наименование КАК СТРОКА(178)) КАК Наименование,
	ВЫРАЗИТЬ(СчетФактураСостав.Номенклатура.НаименованиеДляПечати КАК СТРОКА(500)) КАК НаименованиеПолное,
	СчетФактураСостав.Цена,
	СчетФактураСостав.СтавкаНДС,
	Неопределено КАК СерияНоменклатуры,
	СчетФактураСостав.Страна КАК Страна,
	СчетФактураСостав.НомерГТД КАК НомерГТД,
	СчетФактураСостав.Количество КАК Количество,
	СчетФактураСостав.Всего КАК Сумма,
	СчетФактураСостав.СуммаНДС,
	ВЫБОР
		КОГДА СчетФактураСостав.Номенклатура.ВидТовара = ЗНАЧЕНИЕ(Перечисление.ВидыТоваров.Услуга)
			ТОГДА "Services"
		ИНАЧЕ ""
	КОНЕЦ КАК ТипЕдиницы
ИЗ
	Документ.СчетФактура.Состав КАК СчетФактураСостав
ГДЕ
	СчетФактураСостав.Ссылка в (&amp;Ссылка)
	И (НЕ СчетФактураСостав.Номенклатура.ВидТовара = ЗНАЧЕНИЕ(Перечисление.ВидыТоваров.Услуга)
			ИЛИ &amp;РаботаСУслугами)
</query>
					</item>
				</item>
			</item>
		</item>
		<item xsi:type="DataSetUnion">
			<name>Покупатель</name>
			<item xsi:type="DataSetUnion">
				<name>ЗапросОсновнойЦепочки</name>
				<item xsi:type="DataSetQuery">
					<name>Заказ_ПриходнаяНакладная_РегистрацияСФ</name>
					<dataSource>ИсточникДанных1</dataSource>
					<query>ВЫБРАТЬ
	Заказ.Ссылка КАК PORDERS,
	Заказ.Ссылка КАК ORDERS,
	Заказ.Ссылка КАК ORDRSP,
	ПриходнаяНакладная.Ссылка КАК DESADV,
	ПриходнаяНакладная.Ссылка КАК RECADV,
	РегистрацияСчетаФактурыСоставНДС.Ссылка КАК INVOIC
ИЗ
	(ВЫБРАТЬ
		1 КАК Поле1) КАК Заглушка
		{ПОЛНОЕ СОЕДИНЕНИЕ Документ.РегистрацияСчетаФактуры.СоставНДС КАК РегистрацияСчетаФактурыСоставНДС
			{ПОЛНОЕ СОЕДИНЕНИЕ Документ.ПриходнаяНакладная КАК ПриходнаяНакладная
				{ПОЛНОЕ СОЕДИНЕНИЕ Документ.Заказ КАК Заказ
				ПО (Заказ.Ссылка В
						(ВЫБРАТЬ
							РегистрСведений.ЗакрытиеЗаказов.ПоДокументу
						ИЗ
							РегистрСведений.ЗакрытиеЗаказов
						ГДЕ
							РегистрСведений.ЗакрытиеЗаказов.ДокументЗакрытия = ПриходнаяНакладная.Ссылка))}
			ПО РегистрацияСчетаФактурыСоставНДС.Основание = ПриходнаяНакладная.Ссылка}
		ПО (ИСТИНА)}</query>
					<autoFillFields>false</autoFillFields>
				</item>
			</item>
			<item xsi:type="DataSetUnion">
				<name>ЗапросПоТоварам</name>
				<item xsi:type="DataSetUnion">
					<name>_ORDERS_</name>
					<item xsi:type="DataSetQuery">
						<name>Заказ</name>
						<dataSource>ИсточникДанных1</dataSource>
						<query>ВЫБРАТЬ
	Товары.Номенклатура
ПОМЕСТИТЬ Товары
ИЗ
	Документ.Заказ.Состав КАК Товары
ГДЕ
	Товары.Ссылка = &amp;Ссылка
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ
	ЗаказТовары.Номенклатура.Код КАК КодТовараПокупателя,
	ЗаказТовары.Номенклатура,
	ЗаказТовары.Характеристика КАК ХарактеристикаНоменклатуры,
	ЗаказТовары.ЕдиницаИзмерения КАК ЕдиницаИзмерения,
	ЗаказТовары.ЕдиницаИзмерения.ЕдиницаПоКлассификатору.Наименование КАК КодЕдиницыИзмерения,
	ВЫРАЗИТЬ(ЗаказТовары.Номенклатура.Наименование КАК СТРОКА(178)) КАК Наименование,
	ЗаказТовары.Цена,
	ЕСТЬNULL(СтавкаНДССрезПоследних.СтавкаНДС, ЗНАЧЕНИЕ(Справочник.СтавкиНДС.)) КАК СтавкаНДС,
	СУММА(ЗаказТовары.Количество) КАК Количество,
	СУММА(ЗаказТовары.Сумма) КАК Сумма,
	Неопределено КАК СуммаНДС
ИЗ
	Документ.Заказ.Состав КАК ЗаказТовары
		ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.СтавкаНДС.СрезПоследних(
				,
				Номенклатура В
					(ВЫБРАТЬ
						Товары.Номенклатура
					ИЗ
						Товары)) КАК СтавкаНДССрезПоследних
		ПО ЗаказТовары.Номенклатура = СтавкаНДССрезПоследних.Номенклатура
ГДЕ
	ЗаказТовары.Ссылка = &amp;Ссылка

СГРУППИРОВАТЬ ПО
	ЗаказТовары.Номенклатура,
	ЗаказТовары.Характеристика,
	ЗаказТовары.ЕдиницаИзмерения,
	ЗаказТовары.Цена,
	ВЫРАЗИТЬ(ЗаказТовары.Номенклатура.Наименование КАК СТРОКА(178)),
	ЗаказТовары.Номенклатура.Код,
	ЕСТЬNULL(СтавкаНДССрезПоследних.СтавкаНДС, ЗНАЧЕНИЕ(Справочник.СтавкиНДС.))</query>
						<autoFillFields>false</autoFillFields>
					</item>
				</item>
				<item xsi:type="DataSetUnion">
					<name>_RECADV_</name>
					<item xsi:type="DataSetQuery">
						<name>ПриходнаяНакладная</name>
						<dataSource>ИсточникДанных1</dataSource>
						<query>ВЫБРАТЬ
	ПриходнаяНакладнаяСостав.Номенклатура,
	ВЫРАЗИТЬ(ПриходнаяНакладнаяСостав.ХарактеристикаПартия КАК Справочник.ХарактеристикиНоменклатуры) КАК ХарактеристикаНоменклатуры,
	ПриходнаяНакладнаяСостав.ЕдиницаИзмерения КАК ЕдиницаИзмерения,
	ПриходнаяНакладнаяСостав.ЕдиницаИзмерения.ЕдиницаПоКлассификатору.Наименование КАК КодЕдиницыИзмерения,
	ВЫРАЗИТЬ(ПриходнаяНакладнаяСостав.Номенклатура.Наименование КАК СТРОКА(178)) КАК Наименование,
	ПриходнаяНакладнаяСостав.Количество КАК Количество,
	ПриходнаяНакладнаяСостав.Цена,
	ПриходнаяНакладнаяСостав.СтавкаНДС,
	ПриходнаяНакладнаяСостав.Сумма,
	ПриходнаяНакладнаяСостав.СуммаНДС
ИЗ
	Документ.ПриходнаяНакладная.Состав КАК ПриходнаяНакладнаяСостав
ГДЕ
	ПриходнаяНакладнаяСостав.Ссылка = &amp;Ссылка</query>
						<autoFillFields>false</autoFillFields>
					</item>
				</item>
			</item>
			<item xsi:type="DataSetQuery">
				<name>КонвертироватьТоварыEDIВ1С</name>
				<dataSource>ИсточникДанных1</dataSource>
				<query>ВЫБРАТЬ
	ТабТоваров.GTIN КАК GTIN,
	ТабТоваров.КодТовараСторонний КАК КодТовараСторонний,
	ТабТоваров.КодТовараСвой КАК КодТовараСвой,
	ТабСоответствий_КонтурEDI.Номенклатура КАК Номенклатура,
	ТабСоответствий_КонтурEDI.ХарактеристикаНоменклатуры КАК ХарактеристикаНоменклатуры,
	ТабСоответствий_КонтурEDI.ЕдиницаИзмерения КАК ЕдиницаИзмерения,
	ТабСоответствий_КонтурEDI.ТипЕдиницы КАК ТипЕдиницы,
	4 КАК Приоритет
ПОМЕСТИТЬ ВТ_НайденныеСоответствия
ИЗ
	ТабТоваров КАК ТабТоваров
		ВНУТРЕННЕЕ СОЕДИНЕНИЕ ТабСоответствий_КонтурEDI КАК ТабСоответствий_КонтурEDI
		ПО ТабТоваров.GTIN = ТабСоответствий_КонтурEDI.GTIN
			И ТабТоваров.КодТовараСторонний = ТабСоответствий_КонтурEDI.КодТовараСторонний
			И ТабТоваров.КодТовараСвой = ТабСоответствий_КонтурEDI.КодТовараСвой

ОБЪЕДИНИТЬ ВСЕ

ВЫБРАТЬ
	ТабТоваров.GTIN,
	ТабТоваров.КодТовараСторонний,
	ТабТоваров.КодТовараСвой,
	Штрихкоды.Номенклатура,
	Штрихкоды.ХарактеристикаПартия,
	Штрихкоды.ЕдиницаИзмерения,
	ВЫРАЗИТЬ("" КАК СТРОКА(20)),
	3
ИЗ
	ТабТоваров КАК ТабТоваров
		ВНУТРЕННЕЕ СОЕДИНЕНИЕ РегистрСведений.ШтриховыеКоды КАК Штрихкоды
		ПО (ТабТоваров.GTIN = Штрихкоды.Штрихкод)
ГДЕ
	(НЕ ТабТоваров.GTIN = "")

ОБЪЕДИНИТЬ ВСЕ

ВЫБРАТЬ
	ТабТоваров.GTIN,
	ТабТоваров.КодТовараСторонний,
	ТабТоваров.КодТовараСвой,
	Штрихкоды.Номенклатура,
	Штрихкоды.ХарактеристикаПартия,
	Штрихкоды.ЕдиницаИзмерения,
	ВЫРАЗИТЬ("" КАК СТРОКА(20)),
	2
ИЗ
	ТабТоваров КАК ТабТоваров
		ВНУТРЕННЕЕ СОЕДИНЕНИЕ РегистрСведений.ШтриховыеКоды КАК Штрихкоды
		ПО (ПОДСТРОКА(ТабТоваров.GTIN, 2, 13) = Штрихкоды.Штрихкод)
ГДЕ
	(НЕ ТабТоваров.GTIN = "")
	
ОБЪЕДИНИТЬ ВСЕ

ВЫБРАТЬ
	ТабТоваров.GTIN,
	ТабТоваров.КодТовараСторонний,
	ТабТоваров.КодТовараСвой,
	СправочникНоменклатура.Ссылка,
	НЕОПРЕДЕЛЕНО,
	СправочникЕдиницыИзмерения.Ссылка,
	ВЫРАЗИТЬ("" КАК СТРОКА(20)),
	1
ИЗ
	ТабТоваров КАК ТабТоваров
		ВНУТРЕННЕЕ СОЕДИНЕНИЕ Справочник.Номенклатура КАК СправочникНоменклатура
		ПО ТабТоваров.КодТовараСвой = СправочникНоменклатура.Код
		ВНУТРЕННЕЕ СОЕДИНЕНИЕ Справочник.ЕдиницыИзмерения КАК СправочникЕдиницыИзмерения
		ПО СправочникНоменклатура.Ссылка = СправочникЕдиницыИзмерения.Владелец
		И СправочникНоменклатура.БазоваяЕдиницаИзмерения = СправочникЕдиницыИзмерения.ЕдиницаПоКлассификатору 
ГДЕ
	(НЕ ТабТоваров.КодТовараСвой = "")
</query>
				<autoFillFields>false</autoFillFields>
			</item>
			<item xsi:type="DataSetQuery">
				<name>КонвертироватьТовары1СВEDIВ_GTIN</name>
				<dataSource>ИсточникДанных1</dataSource>
				<query>ВЫБРАТЬ РАЗЛИЧНЫЕ
	ТабТоваров.Номенклатура,
	ТабТоваров.ХарактеристикаНоменклатуры,
	ТабТоваров.ЕдиницаИзмерения,
	ТабТоваров.Номенклатура.Код КАК КодТовараСвой,
	ВЫРАЗИТЬ(Штрихкоды.Штрихкод КАК СТРОКА(14)) КАК GTIN
ПОМЕСТИТЬ ВТШтрихкодыТоваров
ИЗ
	ТабТоваров КАК ТабТоваров
		ВНУТРЕННЕЕ СОЕДИНЕНИЕ РегистрСведений.ШтриховыеКоды КАК Штрихкоды
		ПО ТабТоваров.Номенклатура = Штрихкоды.Номенклатура
			И ТабТоваров.ЕдиницаИзмерения = Штрихкоды.ЕдиницаИзмерения
ГДЕ
	&amp;ИскатьТоварПоШК

ИНДЕКСИРОВАТЬ ПО
	ТабТоваров.Номенклатура,
	ТабТоваров.ЕдиницаИзмерения</query>
				<autoFillFields>false</autoFillFields>
			</item>
		</item>
	</dataSet>
	<dataSet xsi:type="DataSetUnion">
		<name>БП_16</name>
		<field xsi:type="DataSetFieldField">
			<dataPath>GTIN</dataPath>
			<field>GTIN</field>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>ЕдИзмСрокаГодности</dataPath>
			<field>ЕдИзмСрокаГодности</field>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>ЕдиницаИзмерения</dataPath>
			<field>ЕдиницаИзмерения</field>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>КвантПоставки</dataPath>
			<field>КвантПоставки</field>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>КодТовараПоставщика</dataPath>
			<field>КодТовараПоставщика</field>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>КоличествоВОдномМесте</dataPath>
			<field>КоличествоВОдномМесте</field>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>Наименование</dataPath>
			<field>Наименование</field>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>Номенклатура</dataPath>
			<field>Номенклатура</field>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>Родитель</dataPath>
			<field>Родитель</field>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>СрокГодности</dataPath>
			<field>СрокГодности</field>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>СтавкаНДС</dataPath>
			<field>СтавкаНДС</field>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>Страна</dataPath>
			<field>Страна</field>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>Цена</dataPath>
			<field>Цена</field>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>КоличествоОстаткаНаКонец</dataPath>
			<field>КоличествоОстаткаНаКонец</field>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>РекомендуемаяРозничнаяЦена</dataPath>
			<field>РекомендуемаяРозничнаяЦена</field>
		</field>
		<item xsi:type="DataSetUnion">
			<name>Поставщик</name>
			<field xsi:type="DataSetFieldField">
				<dataPath>GTIN</dataPath>
				<field>GTIN</field>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>ЕдИзмСрокаГодности</dataPath>
				<field>ЕдИзмСрокаГодности</field>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>ЕдиницаИзмерения</dataPath>
				<field>ЕдиницаИзмерения</field>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>КвантПоставки</dataPath>
				<field>КвантПоставки</field>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>КодТовараПоставщика</dataPath>
				<field>КодТовараПоставщика</field>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>КоличествоВОдномМесте</dataPath>
				<field>КоличествоВОдномМесте</field>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>Наименование</dataPath>
				<field>Наименование</field>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>Номенклатура</dataPath>
				<field>Номенклатура</field>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>Родитель</dataPath>
				<field>Родитель</field>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>СрокГодности</dataPath>
				<field>СрокГодности</field>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>СтавкаНДС</dataPath>
				<field>СтавкаНДС</field>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>Страна</dataPath>
				<field>Страна</field>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>Цена</dataPath>
				<field>Цена</field>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>КоличествоОстаткаНаКонец</dataPath>
				<field>КоличествоОстаткаНаКонец</field>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>РекомендуемаяРозничнаяЦена</dataPath>
				<field>РекомендуемаяРозничнаяЦена</field>
			</field>
			<item xsi:type="DataSetUnion">
				<name>ЗапросОсновнойЦепочки</name>
				<item xsi:type="DataSetQuery">
					<name>Реализация_СФ</name>
					<dataSource>ИсточникДанных1</dataSource>
					<query>ВЫБРАТЬ
	РеализацияТоваровУслуг.Ссылка КАК PORDERS,
	РеализацияТоваровУслуг.Ссылка КАК ORDERS,
	РеализацияТоваровУслуг.Ссылка КАК ORDRSP,
	РеализацияТоваровУслуг.Ссылка КАК DESADV,
	РеализацияТоваровУслуг.Ссылка КАК RECADV,
	СчетФактураВыданный.Ссылка КАК INVOIC
ИЗ
	(ВЫБРАТЬ
		1 КАК Поле1) КАК Заглушка
		{ПОЛНОЕ СОЕДИНЕНИЕ Документ.СчетФактураВыданный.ДокументыОснования КАК СчетФактураВыданный
			{ПОЛНОЕ СОЕДИНЕНИЕ Документ.РеализацияТоваровУслуг КАК РеализацияТоваровУслуг
			ПО (СчетФактураВыданный.ДокументОснование = РеализацияТоваровУслуг.Ссылка)}
		ПО (ИСТИНА)}</query>
					<autoFillFields>false</autoFillFields>
				</item>
				<item xsi:type="DataSetQuery">
					<name>Реализация</name>
					<dataSource>ИсточникДанных1</dataSource>
					<query>ВЫБРАТЬ
	РеализацияТоваровУслуг.Ссылка КАК PORDERS,
	РеализацияТоваровУслуг.Ссылка КАК ORDERS,
	РеализацияТоваровУслуг.Ссылка КАК ORDRSP,
	РеализацияТоваровУслуг.Ссылка КАК DESADV,
	РеализацияТоваровУслуг.Ссылка КАК RECADV,
	РеализацияТоваровУслуг.Ссылка КАК INVOIC
ИЗ
	(ВЫБРАТЬ
		1 КАК Поле1) КАК Заглушка
		{ПОЛНОЕ СОЕДИНЕНИЕ Документ.РеализацияТоваровУслуг КАК РеализацияТоваровУслуг
		ПО (ИСТИНА)}</query>
					<autoFillFields>false</autoFillFields>
				</item>
			</item>
			<item xsi:type="DataSetUnion">
				<name>ЗапросПоТоварам</name>
				<field xsi:type="DataSetFieldField">
					<dataPath>GTIN</dataPath>
					<field>GTIN</field>
				</field>
				<field xsi:type="DataSetFieldField">
					<dataPath>ЕдИзмСрокаГодности</dataPath>
					<field>ЕдИзмСрокаГодности</field>
				</field>
				<field xsi:type="DataSetFieldField">
					<dataPath>ЕдиницаИзмерения</dataPath>
					<field>ЕдиницаИзмерения</field>
				</field>
				<field xsi:type="DataSetFieldField">
					<dataPath>КвантПоставки</dataPath>
					<field>КвантПоставки</field>
				</field>
				<field xsi:type="DataSetFieldField">
					<dataPath>КодТовараПоставщика</dataPath>
					<field>КодТовараПоставщика</field>
				</field>
				<field xsi:type="DataSetFieldField">
					<dataPath>КоличествоВОдномМесте</dataPath>
					<field>КоличествоВОдномМесте</field>
				</field>
				<field xsi:type="DataSetFieldField">
					<dataPath>Наименование</dataPath>
					<field>Наименование</field>
				</field>
				<field xsi:type="DataSetFieldField">
					<dataPath>Номенклатура</dataPath>
					<field>Номенклатура</field>
				</field>
				<field xsi:type="DataSetFieldField">
					<dataPath>Родитель</dataPath>
					<field>Родитель</field>
				</field>
				<field xsi:type="DataSetFieldField">
					<dataPath>СрокГодности</dataPath>
					<field>СрокГодности</field>
				</field>
				<field xsi:type="DataSetFieldField">
					<dataPath>СтавкаНДС</dataPath>
					<field>СтавкаНДС</field>
				</field>
				<field xsi:type="DataSetFieldField">
					<dataPath>Страна</dataPath>
					<field>Страна</field>
				</field>
				<field xsi:type="DataSetFieldField">
					<dataPath>Цена</dataPath>
					<field>Цена</field>
				</field>
				<field xsi:type="DataSetFieldField">
					<dataPath>КоличествоОстаткаНаКонец</dataPath>
					<field>КоличествоОстаткаНаКонец</field>
				</field>
				<field xsi:type="DataSetFieldField">
					<dataPath>РекомендуемаяРозничнаяЦена</dataPath>
					<field>РекомендуемаяРозничнаяЦена</field>
				</field>
				<item xsi:type="DataSetUnion">
					<name>_PORDERS_ORDRSP_</name>
					<item xsi:type="DataSetQuery">
						<name>РеализацияТоваровУслуг</name>
						<dataSource>ИсточникДанных1</dataSource>
						<query>ВЫБРАТЬ
	РеализацияТоваровУслугТовары.НомерСтроки,
	РеализацияТоваровУслугТовары.Номенклатура,
	ВЫБОР
		КОГДА РеализацияТоваровУслугТовары.Номенклатура.Услуга
			ТОГДА РеализацияТоваровУслугТовары.Номенклатура.БазоваяЕдиницаИзмерения
		ИНАЧЕ РеализацияТоваровУслугТовары.ЕдиницаИзмерения
	КОНЕЦ КАК ЕдиницаИзмерения,
	ВЫБОР
		КОГДА РеализацияТоваровУслугТовары.Номенклатура.Услуга
			ТОГДА РеализацияТоваровУслугТовары.Номенклатура.БазоваяЕдиницаИзмерения.Наименование
		ИНАЧЕ РеализацияТоваровУслугТовары.ЕдиницаИзмерения.Наименование
	КОНЕЦ КАК КодЕдиницыИзмерения,
	ВЫРАЗИТЬ(РеализацияТоваровУслугТовары.Номенклатура.Наименование КАК СТРОКА(178)) КАК Наименование,
	ВЫРАЗИТЬ(РеализацияТоваровУслугТовары.Номенклатура.НаименованиеПолное КАК СТРОКА(500)) КАК НаименованиеПолное,
	Неопределено КАК ХарактеристикаНоменклатуры,
	Неопределено КАК СерияНоменклатуры,
	РеализацияТоваровУслугТовары.Цена,
	РеализацияТоваровУслугТовары.СтавкаНДС,
	РеализацияТоваровУслугТовары.СтранаПроисхождения КАК Страна,
	РеализацияТоваровУслугТовары.НомерГТД КАК НомерГТД,
	РеализацияТоваровУслугТовары.Количество КАК Количество,
	РеализацияТоваровУслугТовары.Сумма КАК Сумма,
	РеализацияТоваровУслугТовары.СуммаНДС КАК СуммаНДС,
	ВЫБОР
		КОГДА РеализацияТоваровУслугТовары.Номенклатура.Услуга
			ТОГДА "Services"
		ИНАЧЕ ""
	КОНЕЦ КАК ТипЕдиницы
ИЗ
	Документ.РеализацияТоваровУслуг.Товары КАК РеализацияТоваровУслугТовары
ГДЕ
	РеализацияТоваровУслугТовары.Ссылка В(&amp;Ссылка)
	И (НЕ РеализацияТоваровУслугТовары.Номенклатура.Услуга
			ИЛИ &amp;РаботаСУслугами)

ОБЪЕДИНИТЬ ВСЕ

ВЫБРАТЬ
	РеализацияТоваровУслугТовары.НомерСтроки,
	РеализацияТоваровУслугТовары.Номенклатура,
	РеализацияТоваровУслугТовары.Номенклатура.БазоваяЕдиницаИзмерения,
	РеализацияТоваровУслугТовары.Номенклатура.БазоваяЕдиницаИзмерения.Наименование,
	ВЫРАЗИТЬ(РеализацияТоваровУслугТовары.Номенклатура.Наименование КАК СТРОКА(178)),
	ВЫРАЗИТЬ(РеализацияТоваровУслугТовары.Номенклатура.НаименованиеПолное КАК СТРОКА(500)),
	Неопределено,
	Неопределено,
	РеализацияТоваровУслугТовары.Цена,
	РеализацияТоваровУслугТовары.СтавкаНДС,
	РеализацияТоваровУслугТовары.Номенклатура.СтранаПроисхождения,
	РеализацияТоваровУслугТовары.Номенклатура.НомерГТД,
	РеализацияТоваровУслугТовары.Количество,
	РеализацияТоваровУслугТовары.Сумма,
	РеализацияТоваровУслугТовары.СуммаНДС,
	"Services"
ИЗ
	Документ.РеализацияТоваровУслуг.Услуги КАК РеализацияТоваровУслугТовары
ГДЕ
	&amp;РаботаСУслугами
	И РеализацияТоваровУслугТовары.Ссылка В(&amp;Ссылка)

ОБЪЕДИНИТЬ ВСЕ

ВЫБРАТЬ
	РеализацияТоваровУслугВозвратнаяТара.НомерСтроки,
	РеализацияТоваровУслугВозвратнаяТара.Номенклатура,
	РеализацияТоваровУслугВозвратнаяТара.Номенклатура.БазоваяЕдиницаИзмерения,
	РеализацияТоваровУслугВозвратнаяТара.Номенклатура.БазоваяЕдиницаИзмерения.Наименование,
	ВЫРАЗИТЬ(РеализацияТоваровУслугВозвратнаяТара.Номенклатура.Наименование КАК СТРОКА(178)),
	ВЫРАЗИТЬ(РеализацияТоваровУслугВозвратнаяТара.Номенклатура.НаименованиеПолное КАК СТРОКА(500)),
	Неопределено,
	Неопределено,
	РеализацияТоваровУслугВозвратнаяТара.Цена,
	ЗНАЧЕНИЕ(Перечисление.СтавкиНДС.НДС0),
	РеализацияТоваровУслугВозвратнаяТара.Номенклатура.СтранаПроисхождения,
	РеализацияТоваровУслугВозвратнаяТара.Номенклатура.НомерГТД,
	РеализацияТоваровУслугВозвратнаяТара.Количество,
	РеализацияТоваровУслугВозвратнаяТара.Сумма,
	0,
	"RC"
ИЗ
	Документ.РеализацияТоваровУслуг.ВозвратнаяТара КАК РеализацияТоваровУслугВозвратнаяТара
ГДЕ
	&amp;ОтправлятьВозвратнуюТару
	И РеализацияТоваровУслугВозвратнаяТара.Ссылка В(&amp;Ссылка)</query>
						<autoFillFields>false</autoFillFields>
					</item>
				</item>
				<item xsi:type="DataSetUnion">
					<name>_DESADV_INVOIC_</name>
					<item xsi:type="DataSetQuery">
						<name>РеализацияТоваровУслуг</name>
						<dataSource>ИсточникДанных1</dataSource>
						<query>ВЫБРАТЬ
	РеализацияТоваровУслугТовары.НомерСтроки,
	РеализацияТоваровУслугТовары.Номенклатура,
	ВЫБОР
		КОГДА РеализацияТоваровУслугТовары.Номенклатура.Услуга
			ТОГДА РеализацияТоваровУслугТовары.Номенклатура.БазоваяЕдиницаИзмерения
		ИНАЧЕ РеализацияТоваровУслугТовары.ЕдиницаИзмерения
	КОНЕЦ КАК ЕдиницаИзмерения,
	ВЫБОР
		КОГДА РеализацияТоваровУслугТовары.Номенклатура.Услуга
			ТОГДА РеализацияТоваровУслугТовары.Номенклатура.БазоваяЕдиницаИзмерения.Наименование
		ИНАЧЕ РеализацияТоваровУслугТовары.ЕдиницаИзмерения.Наименование
	КОНЕЦ КАК КодЕдиницыИзмерения,
	ВЫРАЗИТЬ(РеализацияТоваровУслугТовары.Номенклатура.Наименование КАК СТРОКА(178))  КАК Наименование,
	ВЫРАЗИТЬ(РеализацияТоваровУслугТовары.Номенклатура.НаименованиеПолное КАК СТРОКА(500)) КАК НаименованиеПолное,
	Неопределено КАК ХарактеристикаНоменклатуры,
	Неопределено КАК СерияНоменклатуры,
	РеализацияТоваровУслугТовары.Цена,
	РеализацияТоваровУслугТовары.СтавкаНДС,
	РеализацияТоваровУслугТовары.СтранаПроисхождения КАК Страна,
	РеализацияТоваровУслугТовары.НомерГТД КАК НомерГТД,
	РеализацияТоваровУслугТовары.Количество КАК Количество,
	РеализацияТоваровУслугТовары.Сумма КАК Сумма,
	РеализацияТоваровУслугТовары.СуммаНДС КАК СуммаНДС,
	ВЫБОР
		КОГДА РеализацияТоваровУслугТовары.Номенклатура.Услуга
			ТОГДА "Services"
		ИНАЧЕ ""
	КОНЕЦ КАК ТипЕдиницы
ИЗ
	Документ.РеализацияТоваровУслуг.Товары КАК РеализацияТоваровУслугТовары
ГДЕ
	РеализацияТоваровУслугТовары.Ссылка В(&amp;Ссылка)
	И (НЕ РеализацияТоваровУслугТовары.Номенклатура.Услуга
			ИЛИ &amp;РаботаСУслугами)

ОБЪЕДИНИТЬ ВСЕ

ВЫБРАТЬ
	РеализацияТоваровУслугТовары.НомерСтроки,
	РеализацияТоваровУслугТовары.Номенклатура,
	РеализацияТоваровУслугТовары.Номенклатура.БазоваяЕдиницаИзмерения,
	РеализацияТоваровУслугТовары.Номенклатура.БазоваяЕдиницаИзмерения.Наименование,
	ВЫРАЗИТЬ(РеализацияТоваровУслугТовары.Номенклатура.Наименование КАК СТРОКА(178)),
	ВЫРАЗИТЬ(РеализацияТоваровУслугТовары.Номенклатура.НаименованиеПолное КАК СТРОКА(500)),
	Неопределено,
	Неопределено,
	РеализацияТоваровУслугТовары.Цена,
	РеализацияТоваровУслугТовары.СтавкаНДС,
	РеализацияТоваровУслугТовары.Номенклатура.СтранаПроисхождения,
	РеализацияТоваровУслугТовары.Номенклатура.НомерГТД,
	РеализацияТоваровУслугТовары.Количество,
	РеализацияТоваровУслугТовары.Сумма,
	РеализацияТоваровУслугТовары.СуммаНДС,
	"Services"
ИЗ
	Документ.РеализацияТоваровУслуг.Услуги КАК РеализацияТоваровУслугТовары
ГДЕ
	&amp;РаботаСУслугами
	И РеализацияТоваровУслугТовары.Ссылка В(&amp;Ссылка)

ОБЪЕДИНИТЬ ВСЕ

ВЫБРАТЬ
	0,
	ВозвратТоваровОтПокупателяТовары.Номенклатура,
	ВозвратТоваровОтПокупателяТовары.Номенклатура.БазоваяЕдиницаИзмерения,
	ВозвратТоваровОтПокупателяТовары.Номенклатура.БазоваяЕдиницаИзмерения.Наименование,
	ВЫРАЗИТЬ(ВозвратТоваровОтПокупателяТовары.Номенклатура.Наименование КАК СТРОКА(178)),
	ВЫРАЗИТЬ(ВозвратТоваровОтПокупателяТовары.Номенклатура.НаименованиеПолное КАК СТРОКА(500)),
	Неопределено,
	Неопределено,
	ВозвратТоваровОтПокупателяТовары.Цена,
	ВозвратТоваровОтПокупателяТовары.СтавкаНДС,
	ВозвратТоваровОтПокупателяТовары.СтранаПроисхождения,
	ВозвратТоваровОтПокупателяТовары.НомерГТД,
	-ВозвратТоваровОтПокупателяТовары.Количество,
	-ВозвратТоваровОтПокупателяТовары.Сумма,
	-ВозвратТоваровОтПокупателяТовары.СуммаНДС,
	""
ИЗ
	Документ.ВозвратТоваровОтПокупателя.Товары КАК ВозвратТоваровОтПокупателяТовары
ГДЕ
	ВозвратТоваровОтПокупателяТовары.Ссылка В(&amp;Возвраты)

ОБЪЕДИНИТЬ ВСЕ

ВЫБРАТЬ
	РеализацияТоваровУслугВозвратнаяТара.НомерСтроки,
	РеализацияТоваровУслугВозвратнаяТара.Номенклатура,
	РеализацияТоваровУслугВозвратнаяТара.Номенклатура.БазоваяЕдиницаИзмерения,
	РеализацияТоваровУслугВозвратнаяТара.Номенклатура.БазоваяЕдиницаИзмерения.Наименование,
	ВЫРАЗИТЬ(РеализацияТоваровУслугВозвратнаяТара.Номенклатура.Наименование КАК СТРОКА(178)),
	ВЫРАЗИТЬ(РеализацияТоваровУслугВозвратнаяТара.Номенклатура.НаименованиеПолное КАК СТРОКА(500)),
	Неопределено,
	Неопределено,
	РеализацияТоваровУслугВозвратнаяТара.Цена,
	ЗНАЧЕНИЕ(Перечисление.СтавкиНДС.БезНДС),
	РеализацияТоваровУслугВозвратнаяТара.Номенклатура.СтранаПроисхождения,
	РеализацияТоваровУслугВозвратнаяТара.Номенклатура.НомерГТД,
	РеализацияТоваровУслугВозвратнаяТара.Количество,
	РеализацияТоваровУслугВозвратнаяТара.Сумма,
	0,
	"RC"
ИЗ
	Документ.РеализацияТоваровУслуг.ВозвратнаяТара КАК РеализацияТоваровУслугВозвратнаяТара
ГДЕ
	&amp;ОтправлятьВозвратнуюТару
	И РеализацияТоваровУслугВозвратнаяТара.Ссылка В(&amp;Ссылка)

ОБЪЕДИНИТЬ ВСЕ

ВЫБРАТЬ
	0,
	ВозвратТоваровОтПокупателяВозвратнаяТара.Номенклатура,
	ВозвратТоваровОтПокупателяВозвратнаяТара.Номенклатура.БазоваяЕдиницаИзмерения,
	ВозвратТоваровОтПокупателяВозвратнаяТара.Номенклатура.БазоваяЕдиницаИзмерения.Наименование,
	ВЫРАЗИТЬ(ВозвратТоваровОтПокупателяВозвратнаяТара.Номенклатура.Наименование КАК СТРОКА(178)),
	ВЫРАЗИТЬ(ВозвратТоваровОтПокупателяВозвратнаяТара.Номенклатура.НаименованиеПолное КАК СТРОКА(500)),
	Неопределено,
	Неопределено,
	ВозвратТоваровОтПокупателяВозвратнаяТара.Цена,
	ЗНАЧЕНИЕ(Перечисление.СтавкиНДС.НДС0),
	ВозвратТоваровОтПокупателяВозвратнаяТара.Номенклатура.СтранаПроисхождения,
	ВозвратТоваровОтПокупателяВозвратнаяТара.Номенклатура.НомерГТД,
	-ВозвратТоваровОтПокупателяВозвратнаяТара.Количество,
	-ВозвратТоваровОтПокупателяВозвратнаяТара.Сумма,
	0,
	"RC"
ИЗ
	Документ.ВозвратТоваровОтПокупателя.ВозвратнаяТара КАК ВозвратТоваровОтПокупателяВозвратнаяТара
ГДЕ
	&amp;ОтправлятьВозвратнуюТару
	И ВозвратТоваровОтПокупателяВозвратнаяТара.Ссылка В(&amp;Возвраты)</query>
						<autoFillFields>false</autoFillFields>
					</item>
				</item>
				<item xsi:type="DataSetUnion">
					<name>_PRICELIST_</name>
					<field xsi:type="DataSetFieldField">
						<dataPath>GTIN</dataPath>
						<field>GTIN</field>
					</field>
					<field xsi:type="DataSetFieldField">
						<dataPath>ЕдИзмСрокаГодности</dataPath>
						<field>ЕдИзмСрокаГодности</field>
					</field>
					<field xsi:type="DataSetFieldField">
						<dataPath>ЕдиницаИзмерения</dataPath>
						<field>ЕдиницаИзмерения</field>
					</field>
					<field xsi:type="DataSetFieldField">
						<dataPath>КвантПоставки</dataPath>
						<field>КвантПоставки</field>
					</field>
					<field xsi:type="DataSetFieldField">
						<dataPath>КодТовараПоставщика</dataPath>
						<field>КодТовараПоставщика</field>
					</field>
					<field xsi:type="DataSetFieldField">
						<dataPath>КоличествоВОдномМесте</dataPath>
						<field>КоличествоВОдномМесте</field>
					</field>
					<field xsi:type="DataSetFieldField">
						<dataPath>Наименование</dataPath>
						<field>Наименование</field>
					</field>
					<field xsi:type="DataSetFieldField">
						<dataPath>Номенклатура</dataPath>
						<field>Номенклатура</field>
					</field>
					<field xsi:type="DataSetFieldField">
						<dataPath>Родитель</dataPath>
						<field>Родитель</field>
					</field>
					<field xsi:type="DataSetFieldField">
						<dataPath>СрокГодности</dataPath>
						<field>СрокГодности</field>
					</field>
					<field xsi:type="DataSetFieldField">
						<dataPath>СтавкаНДС</dataPath>
						<field>СтавкаНДС</field>
					</field>
					<field xsi:type="DataSetFieldField">
						<dataPath>Страна</dataPath>
						<field>Страна</field>
					</field>
					<field xsi:type="DataSetFieldField">
						<dataPath>Цена</dataPath>
						<field>Цена</field>
					</field>
					<field xsi:type="DataSetFieldField">
						<dataPath>КоличествоОстаткаНаКонец</dataPath>
						<field>КоличествоОстаткаНаКонец</field>
					</field>
					<field xsi:type="DataSetFieldField">
						<dataPath>РекомендуемаяРозничнаяЦена</dataPath>
						<field>РекомендуемаяРозничнаяЦена</field>
					</field>
					<item xsi:type="DataSetQuery">
						<name>Ценовой_лист_БезЦен</name>
						<field xsi:type="DataSetFieldField">
							<dataPath>GTIN</dataPath>
							<field>GTIN</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>ЕдИзмСрокаГодности</dataPath>
							<field>ЕдИзмСрокаГодности</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>ЕдиницаИзмерения</dataPath>
							<field>ЕдиницаИзмерения</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>КвантПоставки</dataPath>
							<field>КвантПоставки</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>КодТовараПоставщика</dataPath>
							<field>КодТовараПоставщика</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>КоличествоВОдномМесте</dataPath>
							<field>КоличествоВОдномМесте</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>Наименование</dataPath>
							<field>Наименование</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>Номенклатура</dataPath>
							<field>Номенклатура</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>Родитель</dataPath>
							<field>Родитель</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>СрокГодности</dataPath>
							<field>СрокГодности</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>СтавкаНДС</dataPath>
							<field>СтавкаНДС</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>Страна</dataPath>
							<field>Страна</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>Цена</dataPath>
							<field>Цена</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>РекомендуемаяРозничнаяЦена</dataPath>
							<field>РекомендуемаяРозничнаяЦена</field>
						</field>
						<dataSource>ИсточникДанных1</dataSource>
						<query>ВЫБРАТЬ
	СправочникНоменклатура.Родитель КАК Родитель,
	СправочникНоменклатура.Ссылка КАК Номенклатура,
	СправочникНоменклатура.БазоваяЕдиницаИзмерения КАК ЕдиницаИзмерения,
	СправочникНоменклатура.Код КАК КодТовараПоставщика,
	СправочникНоменклатура.НаименованиеПолное КАК Наименование,
	СправочникНоменклатура.СтавкаНДС КАК СтавкаНДС,
	0 КАК Цена,
	0 КАК РекомендуемаяРозничнаяЦена,
	NULL КАК GTIN,
	NULL КАК КоличествоВОдномМесте,
	СправочникНоменклатура.СтранаПроисхождения КАК Страна,
	NULL КАК КвантПоставки,
	NULL КАК ЕдИзмСрокаГодности,
	NULL КАК СрокГодности
ИЗ
	Справочник.Номенклатура КАК СправочникНоменклатура
ГДЕ
	НЕ СправочникНоменклатура.ЭтоГруппа
	И НЕ СправочникНоменклатура.ПометкаУдаления
	И НЕ СправочникНоменклатура.Услуга
	И &amp;УсловиеОтбораНоменклатуры</query>
					</item>
					<item xsi:type="DataSetQuery">
						<name>Ценовой_лист_СЦенами</name>
						<field xsi:type="DataSetFieldField">
							<dataPath>GTIN</dataPath>
							<field>GTIN</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>ЕдИзмСрокаГодности</dataPath>
							<field>ЕдИзмСрокаГодности</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>ЕдиницаИзмерения</dataPath>
							<field>ЕдиницаИзмерения</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>КвантПоставки</dataPath>
							<field>КвантПоставки</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>КодТовараПоставщика</dataPath>
							<field>КодТовараПоставщика</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>КоличествоВОдномМесте</dataPath>
							<field>КоличествоВОдномМесте</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>Наименование</dataPath>
							<field>Наименование</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>Номенклатура</dataPath>
							<field>Номенклатура</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>Родитель</dataPath>
							<field>Родитель</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>СрокГодности</dataPath>
							<field>СрокГодности</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>СтавкаНДС</dataPath>
							<field>СтавкаНДС</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>Страна</dataPath>
							<field>Страна</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>Цена</dataPath>
							<field>Цена</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>РекомендуемаяРозничнаяЦена</dataPath>
							<field>РекомендуемаяРозничнаяЦена</field>
						</field>
						<dataSource>ИсточникДанных1</dataSource>
						<query>ВЫБРАТЬ
	ЦеныНоменклатурыСрезПоследних.Номенклатура.Родитель КАК Родитель,
	ЦеныНоменклатурыСрезПоследних.Номенклатура.Ссылка КАК Номенклатура,
	ЦеныНоменклатурыСрезПоследних.Номенклатура.БазоваяЕдиницаИзмерения КАК ЕдиницаИзмерения,
	ЦеныНоменклатурыСрезПоследних.Номенклатура.Код КАК КодТовараПоставщика,
	ЦеныНоменклатурыСрезПоследних.Номенклатура.НаименованиеПолное КАК Наименование,
	ЦеныНоменклатурыСрезПоследних.Номенклатура.СтавкаНДС КАК СтавкаНДС,
	ЦеныНоменклатурыСрезПоследних.Цена,
	0 КАК РекомендуемаяРозничнаяЦена,
	NULL КАК GTIN,
	NULL КАК КоличествоВОдномМесте,
	ЦеныНоменклатурыСрезПоследних.Номенклатура.СтранаПроисхождения КАК Страна,
	NULL КАК КвантПоставки,
	NULL КАК ЕдИзмСрокаГодности,
	NULL КАК СрокГодности
ИЗ
	РегистрСведений.ЦеныНоменклатуры.СрезПоследних(
			,
			ТипЦен = &amp;ТипЦен
				И НЕ Номенклатура.ПометкаУдаления
				И НЕ Номенклатура.Услуга
				И &amp;УсловиеОтбораНоменклатуры) КАК ЦеныНоменклатурыСрезПоследних
ГДЕ
	ЦеныНоменклатурыСрезПоследних.Цена &gt; 0</query>
					</item>
					<item xsi:type="DataSetQuery">
						<name>Ценовой_лист_БезЦен_Остатки</name>
						<field xsi:type="DataSetFieldField">
							<dataPath>GTIN</dataPath>
							<field>GTIN</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>ЕдИзмСрокаГодности</dataPath>
							<field>ЕдИзмСрокаГодности</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>ЕдиницаИзмерения</dataPath>
							<field>ЕдиницаИзмерения</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>КвантПоставки</dataPath>
							<field>КвантПоставки</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>КодТовараПоставщика</dataPath>
							<field>КодТовараПоставщика</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>КоличествоВОдномМесте</dataPath>
							<field>КоличествоВОдномМесте</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>Наименование</dataPath>
							<field>Наименование</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>Номенклатура</dataPath>
							<field>Номенклатура</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>Родитель</dataPath>
							<field>Родитель</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>СрокГодности</dataPath>
							<field>СрокГодности</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>СтавкаНДС</dataPath>
							<field>СтавкаНДС</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>Страна</dataPath>
							<field>Страна</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>Цена</dataPath>
							<field>Цена</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>КоличествоОстаткаНаКонец</dataPath>
							<field>КоличествоОстаткаНаКонец</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>РекомендуемаяРозничнаяЦена</dataPath>
							<field>РекомендуемаяРозничнаяЦена</field>
						</field>
						<dataSource>ИсточникДанных1</dataSource>
						<query>ВЫБРАТЬ
	СправочникНоменклатура.Родитель КАК Родитель,
	СправочникНоменклатура.Ссылка КАК Номенклатура,
	СправочникНоменклатура.БазоваяЕдиницаИзмерения КАК ЕдиницаИзмерения,
	СправочникНоменклатура.Код КАК КодТовараПоставщика,
	СправочникНоменклатура.НаименованиеПолное КАК Наименование,
	СправочникНоменклатура.СтавкаНДС КАК СтавкаНДС,
	0 КАК Цена,
	0 КАК РекомендуемаяРозничнаяЦена,
	NULL КАК GTIN,
	NULL КАК КоличествоВОдномМесте,
	СправочникНоменклатура.СтранаПроисхождения КАК Страна,
	NULL КАК КвантПоставки,
	NULL КАК ЕдИзмСрокаГодности,
	NULL КАК СрокГодности,
	0 КАК КоличествоОстаткаНаКонец
ИЗ
	Справочник.Номенклатура КАК СправочникНоменклатура
ГДЕ
	НЕ СправочникНоменклатура.ЭтоГруппа
	И НЕ СправочникНоменклатура.ПометкаУдаления
	И НЕ СправочникНоменклатура.Услуга
	И &amp;УсловиеОтбораНоменклатуры</query>
					</item>
					<item xsi:type="DataSetQuery">
						<name>Ценовой_лист_СЦенами_Остатки</name>
						<field xsi:type="DataSetFieldField">
							<dataPath>GTIN</dataPath>
							<field>GTIN</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>ЕдИзмСрокаГодности</dataPath>
							<field>ЕдИзмСрокаГодности</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>ЕдиницаИзмерения</dataPath>
							<field>ЕдиницаИзмерения</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>КвантПоставки</dataPath>
							<field>КвантПоставки</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>КодТовараПоставщика</dataPath>
							<field>КодТовараПоставщика</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>КоличествоВОдномМесте</dataPath>
							<field>КоличествоВОдномМесте</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>Наименование</dataPath>
							<field>Наименование</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>Номенклатура</dataPath>
							<field>Номенклатура</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>Родитель</dataPath>
							<field>Родитель</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>СрокГодности</dataPath>
							<field>СрокГодности</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>СтавкаНДС</dataPath>
							<field>СтавкаНДС</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>Страна</dataPath>
							<field>Страна</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>Цена</dataPath>
							<field>Цена</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>КоличествоОстаткаНаКонец</dataPath>
							<field>КоличествоОстаткаНаКонец</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>РекомендуемаяРозничнаяЦена</dataPath>
							<field>РекомендуемаяРозничнаяЦена</field>
						</field>
						<dataSource>ИсточникДанных1</dataSource>
						<query>ВЫБРАТЬ
	ЦеныНоменклатурыСрезПоследних.Номенклатура.Родитель КАК Родитель,
	ЦеныНоменклатурыСрезПоследних.Номенклатура.Ссылка КАК Номенклатура,
	ЦеныНоменклатурыСрезПоследних.Номенклатура.БазоваяЕдиницаИзмерения КАК ЕдиницаИзмерения,
	ЦеныНоменклатурыСрезПоследних.Номенклатура.Код КАК КодТовараПоставщика,
	ЦеныНоменклатурыСрезПоследних.Номенклатура.НаименованиеПолное КАК Наименование,
	ЦеныНоменклатурыСрезПоследних.Номенклатура.СтавкаНДС КАК СтавкаНДС,
	ЦеныНоменклатурыСрезПоследних.Цена,
	0 КАК РекомендуемаяРозничнаяЦена,
	NULL КАК GTIN,
	NULL КАК КоличествоВОдномМесте,
	ЦеныНоменклатурыСрезПоследних.Номенклатура.СтранаПроисхождения КАК Страна,
	NULL КАК КвантПоставки,
	NULL КАК ЕдИзмСрокаГодности,
	NULL КАК СрокГодности,
	0 КАК КоличествоОстаткаНаКонец
ИЗ
	РегистрСведений.ЦеныНоменклатуры.СрезПоследних(
			,
			ТипЦен = &amp;ТипЦен
				И НЕ Номенклатура.ПометкаУдаления
				И НЕ Номенклатура.Услуга
				И &amp;УсловиеОтбораНоменклатуры) КАК ЦеныНоменклатурыСрезПоследних
ГДЕ
	ЦеныНоменклатурыСрезПоследних.Цена &gt; 0</query>
					</item>
				</item>
			</item>
		</item>
		<item xsi:type="DataSetUnion">
			<name>Покупатель</name>
			<item xsi:type="DataSetUnion">
				<name>ЗапросОсновнойЦепочки</name>
				<item xsi:type="DataSetQuery">
					<name>ПоступлениеТоваровУслуг_СФ</name>
					<dataSource>ИсточникДанных1</dataSource>
					<query>ВЫБРАТЬ
	ПоступлениеТоваровУслуг.Ссылка КАК PORDERS,
	ПоступлениеТоваровУслуг.Ссылка КАК ORDERS,
	ПоступлениеТоваровУслуг.Ссылка КАК ORDRSP,
	ПоступлениеТоваровУслуг.Ссылка КАК DESADV,
	ПоступлениеТоваровУслуг.Ссылка КАК RECADV,
	СчетФактураПолученный.Ссылка КАК INVOIC
ИЗ
	(ВЫБРАТЬ
		1 КАК Поле1) КАК Заглушка
		{ПОЛНОЕ СОЕДИНЕНИЕ Документ.СчетФактураПолученный КАК СчетФактураПолученный
			{ПОЛНОЕ СОЕДИНЕНИЕ Документ.ПоступлениеТоваровУслуг КАК ПоступлениеТоваровУслуг
			ПО СчетФактураПолученный.ДокументОснование = ПоступлениеТоваровУслуг.Ссылка}
		ПО (ИСТИНА)}</query>
					<autoFillFields>false</autoFillFields>
				</item>
			</item>
			<item xsi:type="DataSetUnion">
				<name>ЗапросПоТоварам</name>
				<item xsi:type="DataSetUnion">
					<name>_ORDERS_</name>
					<item xsi:type="DataSetQuery">
						<name>ПоступлениеТоваровУслуг</name>
						<dataSource>ИсточникДанных1</dataSource>
						<query>ВЫБРАТЬ
	ПоступлениеТоваровУслугТовары.Номенклатура,
	НЕОПРЕДЕЛЕНО КАК ХарактеристикаНоменклатуры,
	ПоступлениеТоваровУслугТовары.ЕдиницаИзмерения КАК ЕдиницаИзмерения,
	ПоступлениеТоваровУслугТовары.ЕдиницаИзмерения.Наименование КАК КодЕдиницыИзмерения,
	ВЫРАЗИТЬ(ПоступлениеТоваровУслугТовары.Номенклатура.Наименование КАК СТРОКА(178)) КАК Наименование,
	ПоступлениеТоваровУслугТовары.Количество КАК Количество,
	ПоступлениеТоваровУслугТовары.Цена,
	ПоступлениеТоваровУслугТовары.СтавкаНДС,
	ПоступлениеТоваровУслугТовары.Сумма,
	ПоступлениеТоваровУслугТовары.СуммаНДС
ИЗ
	Документ.ПоступлениеТоваровУслуг.Товары КАК ПоступлениеТоваровУслугТовары
ГДЕ
	ПоступлениеТоваровУслугТовары.Ссылка = &amp;Ссылка</query>
						<autoFillFields>false</autoFillFields>
					</item>
				</item>
				<item xsi:type="DataSetUnion">
					<name>_RECADV_</name>
					<item xsi:type="DataSetQuery">
						<name>ПоступлениеТоваровУслуг</name>
						<dataSource>ИсточникДанных1</dataSource>
						<query>ВЫБРАТЬ
	ПоступлениеТоваровУслугТовары.Номенклатура,
	НЕОПРЕДЕЛЕНО КАК ХарактеристикаНоменклатуры,
	ПоступлениеТоваровУслугТовары.ЕдиницаИзмерения КАК ЕдиницаИзмерения,
	ПоступлениеТоваровУслугТовары.ЕдиницаИзмерения.Наименование КАК КодЕдиницыИзмерения,
	ВЫРАЗИТЬ(ПоступлениеТоваровУслугТовары.Номенклатура.Наименование КАК СТРОКА(178)) КАК Наименование,
	ПоступлениеТоваровУслугТовары.Количество КАК Количество,
	ПоступлениеТоваровУслугТовары.Цена,
	ПоступлениеТоваровУслугТовары.СтавкаНДС,
	ПоступлениеТоваровУслугТовары.Сумма,
	ПоступлениеТоваровУслугТовары.СуммаНДС
ИЗ
	Документ.ПоступлениеТоваровУслуг.Товары КАК ПоступлениеТоваровУслугТовары
ГДЕ
	ПоступлениеТоваровУслугТовары.Ссылка = &amp;Ссылка</query>
						<autoFillFields>false</autoFillFields>
					</item>
				</item>
				<item xsi:type="DataSetQuery">
					<name>КонвертироватьТовары1СВEDIВ_GTIN</name>
					<dataSource>ИсточникДанных1</dataSource>
					<query>ВЫБРАТЬ
	ТабТоваров.Номенклатура,
	ТабТоваров.ХарактеристикаНоменклатуры,
	ТабТоваров.ЕдиницаИзмерения,
	ВЫРАЗИТЬ(ТабТоваров.Номенклатура.Код КАК СТРОКА) КАК КодТовараСвой,
	"" КАК GTIN
ПОМЕСТИТЬ ВТШтрихкодыТоваров
ИЗ
	ТабТоваров КАК ТабТоваров

ИНДЕКСИРОВАТЬ ПО
	ТабТоваров.Номенклатура,
	ТабТоваров.ХарактеристикаНоменклатуры,
	ТабТоваров.ЕдиницаИзмерения</query>
					<autoFillFields>false</autoFillFields>
				</item>
			</item>
			<item xsi:type="DataSetQuery">
				<name>КонвертироватьТоварыEDIВ1С</name>
				<dataSource>ИсточникДанных1</dataSource>
				<query>ВЫБРАТЬ
	ТабТоваров.GTIN КАК GTIN,
	ТабТоваров.КодТовараСторонний КАК КодТовараСторонний,
	ТабТоваров.КодТовараСвой КАК КодТовараСвой,
	ТабСоответствий_КонтурEDI.Номенклатура КАК Номенклатура,
	ТабСоответствий_КонтурEDI.ХарактеристикаНоменклатуры КАК ХарактеристикаНоменклатуры,
	ТабСоответствий_КонтурEDI.ЕдиницаИзмерения КАК ЕдиницаИзмерения,
	ТабСоответствий_КонтурEDI.ТипЕдиницы КАК ТипЕдиницы,
	3 КАК Приоритет
ПОМЕСТИТЬ ВТ_НайденныеСоответствия
ИЗ
	ТабТоваров КАК ТабТоваров
		ВНУТРЕННЕЕ СОЕДИНЕНИЕ ТабСоответствий_КонтурEDI КАК ТабСоответствий_КонтурEDI
		ПО ТабТоваров.GTIN = ТабСоответствий_КонтурEDI.GTIN
			И ТабТоваров.КодТовараСторонний = ТабСоответствий_КонтурEDI.КодТовараСторонний
			И ТабТоваров.КодТовараСвой = ТабСоответствий_КонтурEDI.КодТовараСвой

ОБЪЕДИНИТЬ ВСЕ

ВЫБРАТЬ
	ТабТоваров.GTIN,
	ТабТоваров.КодТовараСторонний,
	ТабТоваров.КодТовараСвой,
	СправочникНоменклатура.Ссылка,
	НЕОПРЕДЕЛЕНО,
	СправочникНоменклатура.БазоваяЕдиницаИзмерения,
	ВЫРАЗИТЬ(ВЫБОР
			КОГДА СправочникНоменклатура.Услуга = ИСТИНА
				ТОГДА "Services"
			ИНАЧЕ ""
		КОНЕЦ КАК СТРОКА(20)),
	2
ИЗ
	ТабТоваров КАК ТабТоваров
		ВНУТРЕННЕЕ СОЕДИНЕНИЕ Справочник.Номенклатура КАК СправочникНоменклатура
		ПО ТабТоваров.КодТовараСвой = СправочникНоменклатура.Код
ГДЕ
	НЕ ТабТоваров.КодТовараСвой = ""</query>
				<autoFillFields>false</autoFillFields>
			</item>
			<item xsi:type="DataSetQuery">
				<name>КонвертироватьТовары1СВEDIВ_GTIN</name>
				<dataSource>ИсточникДанных1</dataSource>
				<query>ВЫБРАТЬ
	ТабТоваров.Номенклатура,
	ТабТоваров.ХарактеристикаНоменклатуры,
	ТабТоваров.ЕдиницаИзмерения,
	ВЫРАЗИТЬ(ТабТоваров.Номенклатура.Код КАК СТРОКА) КАК КодТовараСвой,
	"" КАК GTIN
ПОМЕСТИТЬ ВТШтрихкодыТоваров
ИЗ
	ТабТоваров КАК ТабТоваров

ИНДЕКСИРОВАТЬ ПО
	ТабТоваров.Номенклатура,
	ТабТоваров.ХарактеристикаНоменклатуры,
	ТабТоваров.ЕдиницаИзмерения</query>
				<autoFillFields>false</autoFillFields>
			</item>
		</item>
	</dataSet>
	<dataSet xsi:type="DataSetUnion">
		<name>БП_20</name>
		<field xsi:type="DataSetFieldField">
			<dataPath>ЕдиницаИзмерения</dataPath>
			<field>ЕдиницаИзмерения</field>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>Количество</dataPath>
			<field>Количество</field>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>КоличествоДоКорректировки</dataPath>
			<field>КоличествоДоКорректировки</field>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>Номенклатура</dataPath>
			<field>Номенклатура</field>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>НомерГТД</dataPath>
			<field>НомерГТД</field>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>НомерСтроки</dataPath>
			<field>НомерСтроки</field>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>СерияНоменклатуры</dataPath>
			<field>СерияНоменклатуры</field>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>СтавкаНДС</dataPath>
			<field>СтавкаНДС</field>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>СтавкаНДСДоКорректировки</dataPath>
			<field>СтавкаНДСДоКорректировки</field>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>Страна</dataPath>
			<field>Страна</field>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>Сумма</dataPath>
			<field>Сумма</field>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>СуммаДоКорректировки</dataPath>
			<field>СуммаДоКорректировки</field>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>СуммаНДС</dataPath>
			<field>СуммаНДС</field>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>СуммаНДСДоКорректировки</dataPath>
			<field>СуммаНДСДоКорректировки</field>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>ТипЕдиницы</dataPath>
			<field>ТипЕдиницы</field>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>ХарактеристикаНоменклатуры</dataPath>
			<field>ХарактеристикаНоменклатуры</field>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>Цена</dataPath>
			<field>Цена</field>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>ЦенаДоКорректировки</dataPath>
			<field>ЦенаДоКорректировки</field>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>GTIN</dataPath>
			<field>GTIN</field>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>ЕдИзмСрокаГодности</dataPath>
			<field>ЕдИзмСрокаГодности</field>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>КвантПоставки</dataPath>
			<field>КвантПоставки</field>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>КодТовараПоставщика</dataPath>
			<field>КодТовараПоставщика</field>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>КоличествоВОдномМесте</dataPath>
			<field>КоличествоВОдномМесте</field>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>Наименование</dataPath>
			<field>Наименование</field>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>Родитель</dataPath>
			<field>Родитель</field>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>СрокГодности</dataPath>
			<field>СрокГодности</field>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>КоличествоОстаткаНаКонец</dataPath>
			<field>КоличествоОстаткаНаКонец</field>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>РекомендуемаяРозничнаяЦена</dataPath>
			<field>РекомендуемаяРозничнаяЦена</field>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>НаименованиеПолное</dataPath>
			<field>НаименованиеПолное</field>
			<title xsi:type="v8:LocalStringType">
				<v8:item>
					<v8:lang>ru</v8:lang>
					<v8:content>Наименование полное</v8:content>
				</v8:item>
			</title>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>КодЕдиницыИзмерения</dataPath>
			<field>КодЕдиницыИзмерения</field>
			<title xsi:type="v8:LocalStringType">
				<v8:item>
					<v8:lang>ru</v8:lang>
					<v8:content>Код единицы измерения</v8:content>
				</v8:item>
			</title>
		</field>
		<item xsi:type="DataSetUnion">
			<name>Поставщик</name>
			<field xsi:type="DataSetFieldField">
				<dataPath>ЕдиницаИзмерения</dataPath>
				<field>ЕдиницаИзмерения</field>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>Количество</dataPath>
				<field>Количество</field>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>КоличествоДоКорректировки</dataPath>
				<field>КоличествоДоКорректировки</field>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>Номенклатура</dataPath>
				<field>Номенклатура</field>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>НомерГТД</dataPath>
				<field>НомерГТД</field>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>НомерСтроки</dataPath>
				<field>НомерСтроки</field>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>СерияНоменклатуры</dataPath>
				<field>СерияНоменклатуры</field>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>СтавкаНДС</dataPath>
				<field>СтавкаНДС</field>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>СтавкаНДСДоКорректировки</dataPath>
				<field>СтавкаНДСДоКорректировки</field>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>Страна</dataPath>
				<field>Страна</field>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>Сумма</dataPath>
				<field>Сумма</field>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>СуммаДоКорректировки</dataPath>
				<field>СуммаДоКорректировки</field>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>СуммаНДС</dataPath>
				<field>СуммаНДС</field>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>СуммаНДСДоКорректировки</dataPath>
				<field>СуммаНДСДоКорректировки</field>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>ТипЕдиницы</dataPath>
				<field>ТипЕдиницы</field>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>ХарактеристикаНоменклатуры</dataPath>
				<field>ХарактеристикаНоменклатуры</field>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>Цена</dataPath>
				<field>Цена</field>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>ЦенаДоКорректировки</dataPath>
				<field>ЦенаДоКорректировки</field>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>GTIN</dataPath>
				<field>GTIN</field>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>ЕдИзмСрокаГодности</dataPath>
				<field>ЕдИзмСрокаГодности</field>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>КвантПоставки</dataPath>
				<field>КвантПоставки</field>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>КодТовараПоставщика</dataPath>
				<field>КодТовараПоставщика</field>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>КоличествоВОдномМесте</dataPath>
				<field>КоличествоВОдномМесте</field>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>Наименование</dataPath>
				<field>Наименование</field>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>Родитель</dataPath>
				<field>Родитель</field>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>СрокГодности</dataPath>
				<field>СрокГодности</field>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>КоличествоОстаткаНаКонец</dataPath>
				<field>КоличествоОстаткаНаКонец</field>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>РекомендуемаяРозничнаяЦена</dataPath>
				<field>РекомендуемаяРозничнаяЦена</field>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>НаименованиеПолное</dataPath>
				<field>НаименованиеПолное</field>
				<title xsi:type="v8:LocalStringType">
					<v8:item>
						<v8:lang>ru</v8:lang>
						<v8:content>Наименование полное</v8:content>
					</v8:item>
				</title>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>КодЕдиницыИзмерения</dataPath>
				<field>КодЕдиницыИзмерения</field>
				<title xsi:type="v8:LocalStringType">
					<v8:item>
						<v8:lang>ru</v8:lang>
						<v8:content>Код единицы измерения</v8:content>
					</v8:item>
				</title>
			</field>
			<item xsi:type="DataSetUnion">
				<name>ЗапросОсновнойЦепочки</name>
				<item xsi:type="DataSetQuery">
					<name>Реализация_СФ</name>
					<dataSource>ИсточникДанных1</dataSource>
					<query>ВЫБРАТЬ
	РеализацияТоваровУслуг.Ссылка КАК PORDERS,
	РеализацияТоваровУслуг.Ссылка КАК ORDERS,
	РеализацияТоваровУслуг.Ссылка КАК ORDRSP,
	РеализацияТоваровУслуг.Ссылка КАК DESADV,
	РеализацияТоваровУслуг.Ссылка КАК RECADV,
	СчетФактураВыданный.Ссылка КАК INVOIC
ИЗ
	(ВЫБРАТЬ
		1 КАК Поле1) КАК Заглушка
		{ПОЛНОЕ СОЕДИНЕНИЕ Документ.СчетФактураВыданный.ДокументыОснования КАК СчетФактураВыданный
			{ПОЛНОЕ СОЕДИНЕНИЕ Документ.РеализацияТоваровУслуг КАК РеализацияТоваровУслуг
			ПО (СчетФактураВыданный.ДокументОснование = РеализацияТоваровУслуг.Ссылка)}
		ПО (ИСТИНА)}</query>
					<autoFillFields>false</autoFillFields>
				</item>
				<item xsi:type="DataSetQuery">
					<name>Реализация</name>
					<dataSource>ИсточникДанных1</dataSource>
					<query>ВЫБРАТЬ
	РеализацияТоваровУслуг.Ссылка КАК PORDERS,
	РеализацияТоваровУслуг.Ссылка КАК ORDERS,
	РеализацияТоваровУслуг.Ссылка КАК ORDRSP,
	РеализацияТоваровУслуг.Ссылка КАК DESADV,
	РеализацияТоваровУслуг.Ссылка КАК RECADV,
	РеализацияТоваровУслуг.Ссылка КАК INVOIC
ИЗ
	(ВЫБРАТЬ
		1 КАК Поле1) КАК Заглушка
		{ПОЛНОЕ СОЕДИНЕНИЕ Документ.РеализацияТоваровУслуг КАК РеализацияТоваровУслуг
		ПО (ИСТИНА)}</query>
					<autoFillFields>false</autoFillFields>
				</item>
				<item xsi:type="DataSetQuery">
					<name>Счет_Реализация_СФ</name>
					<dataSource>ИсточникДанных1</dataSource>
					<query>ВЫБРАТЬ
	докСчетНаОплатуПокупателю.Ссылка КАК PORDERS,
	докСчетНаОплатуПокупателю.Ссылка КАК ORDERS,
	докСчетНаОплатуПокупателю.Ссылка КАК ORDRSP,
	докРеализацияТоваровУслуг.Ссылка КАК DESADV,
	докРеализацияТоваровУслуг.Ссылка КАК RECADV,
	СчетФактураВыданный.Ссылка КАК INVOIC
ИЗ
	(ВЫБРАТЬ
		1 КАК Поле1) КАК Заглушка
		{ПОЛНОЕ СОЕДИНЕНИЕ Документ.СчетФактураВыданный.ДокументыОснования КАК СчетФактураВыданный
			{ПОЛНОЕ СОЕДИНЕНИЕ Документ.РеализацияТоваровУслуг КАК докРеализацияТоваровУслуг
				{ПОЛНОЕ СОЕДИНЕНИЕ Документ.СчетНаОплатуПокупателю КАК докСчетНаОплатуПокупателю
				ПО докРеализацияТоваровУслуг.СчетНаОплатуПокупателю = докСчетНаОплатуПокупателю.Ссылка}
			ПО (СчетФактураВыданный.ДокументОснование = докРеализацияТоваровУслуг.Ссылка)}
		ПО (ИСТИНА)}</query>
					<autoFillFields>false</autoFillFields>
				</item>
				<item xsi:type="DataSetQuery">
					<name>Счет_Реализация</name>
					<dataSource>ИсточникДанных1</dataSource>
					<query>ВЫБРАТЬ
	докСчетНаОплатуПокупателю.Ссылка КАК PORDERS,
	докСчетНаОплатуПокупателю.Ссылка КАК ORDERS,
	докСчетНаОплатуПокупателю.Ссылка КАК ORDRSP,
	докРеализацияТоваровУслуг.Ссылка КАК DESADV,
	докРеализацияТоваровУслуг.Ссылка КАК RECADV,
	докРеализацияТоваровУслуг.Ссылка КАК INVOIC
ИЗ
	(ВЫБРАТЬ
		1 КАК Поле1) КАК Заглушка
		{ПОЛНОЕ СОЕДИНЕНИЕ Документ.РеализацияТоваровУслуг КАК докРеализацияТоваровУслуг
			{ПОЛНОЕ СОЕДИНЕНИЕ Документ.СчетНаОплатуПокупателю КАК докСчетНаОплатуПокупателю
			ПО докРеализацияТоваровУслуг.СчетНаОплатуПокупателю = докСчетНаОплатуПокупателю.Ссылка}
		ПО (ИСТИНА)}</query>
					<autoFillFields>false</autoFillFields>
				</item>
			</item>
			<item xsi:type="DataSetUnion">
				<name>ЗапросПоТоварам</name>
				<field xsi:type="DataSetFieldField">
					<dataPath>ЕдиницаИзмерения</dataPath>
					<field>ЕдиницаИзмерения</field>
				</field>
				<field xsi:type="DataSetFieldField">
					<dataPath>Количество</dataPath>
					<field>Количество</field>
				</field>
				<field xsi:type="DataSetFieldField">
					<dataPath>КоличествоДоКорректировки</dataPath>
					<field>КоличествоДоКорректировки</field>
				</field>
				<field xsi:type="DataSetFieldField">
					<dataPath>Номенклатура</dataPath>
					<field>Номенклатура</field>
				</field>
				<field xsi:type="DataSetFieldField">
					<dataPath>НомерГТД</dataPath>
					<field>НомерГТД</field>
				</field>
				<field xsi:type="DataSetFieldField">
					<dataPath>НомерСтроки</dataPath>
					<field>НомерСтроки</field>
				</field>
				<field xsi:type="DataSetFieldField">
					<dataPath>СерияНоменклатуры</dataPath>
					<field>СерияНоменклатуры</field>
				</field>
				<field xsi:type="DataSetFieldField">
					<dataPath>СтавкаНДС</dataPath>
					<field>СтавкаНДС</field>
				</field>
				<field xsi:type="DataSetFieldField">
					<dataPath>СтавкаНДСДоКорректировки</dataPath>
					<field>СтавкаНДСДоКорректировки</field>
				</field>
				<field xsi:type="DataSetFieldField">
					<dataPath>Страна</dataPath>
					<field>Страна</field>
				</field>
				<field xsi:type="DataSetFieldField">
					<dataPath>Сумма</dataPath>
					<field>Сумма</field>
				</field>
				<field xsi:type="DataSetFieldField">
					<dataPath>СуммаДоКорректировки</dataPath>
					<field>СуммаДоКорректировки</field>
				</field>
				<field xsi:type="DataSetFieldField">
					<dataPath>СуммаНДС</dataPath>
					<field>СуммаНДС</field>
				</field>
				<field xsi:type="DataSetFieldField">
					<dataPath>СуммаНДСДоКорректировки</dataPath>
					<field>СуммаНДСДоКорректировки</field>
				</field>
				<field xsi:type="DataSetFieldField">
					<dataPath>ТипЕдиницы</dataPath>
					<field>ТипЕдиницы</field>
				</field>
				<field xsi:type="DataSetFieldField">
					<dataPath>ХарактеристикаНоменклатуры</dataPath>
					<field>ХарактеристикаНоменклатуры</field>
				</field>
				<field xsi:type="DataSetFieldField">
					<dataPath>Цена</dataPath>
					<field>Цена</field>
				</field>
				<field xsi:type="DataSetFieldField">
					<dataPath>ЦенаДоКорректировки</dataPath>
					<field>ЦенаДоКорректировки</field>
				</field>
				<field xsi:type="DataSetFieldField">
					<dataPath>GTIN</dataPath>
					<field>GTIN</field>
				</field>
				<field xsi:type="DataSetFieldField">
					<dataPath>ЕдИзмСрокаГодности</dataPath>
					<field>ЕдИзмСрокаГодности</field>
				</field>
				<field xsi:type="DataSetFieldField">
					<dataPath>КвантПоставки</dataPath>
					<field>КвантПоставки</field>
				</field>
				<field xsi:type="DataSetFieldField">
					<dataPath>КодТовараПоставщика</dataPath>
					<field>КодТовараПоставщика</field>
				</field>
				<field xsi:type="DataSetFieldField">
					<dataPath>КоличествоВОдномМесте</dataPath>
					<field>КоличествоВОдномМесте</field>
				</field>
				<field xsi:type="DataSetFieldField">
					<dataPath>Наименование</dataPath>
					<field>Наименование</field>
				</field>
				<field xsi:type="DataSetFieldField">
					<dataPath>Родитель</dataPath>
					<field>Родитель</field>
				</field>
				<field xsi:type="DataSetFieldField">
					<dataPath>СрокГодности</dataPath>
					<field>СрокГодности</field>
				</field>
				<field xsi:type="DataSetFieldField">
					<dataPath>КоличествоОстаткаНаКонец</dataPath>
					<field>КоличествоОстаткаНаКонец</field>
				</field>
				<field xsi:type="DataSetFieldField">
					<dataPath>РекомендуемаяРозничнаяЦена</dataPath>
					<field>РекомендуемаяРозничнаяЦена</field>
				</field>
				<field xsi:type="DataSetFieldField">
					<dataPath>НаименованиеПолное</dataPath>
					<field>НаименованиеПолное</field>
					<title xsi:type="v8:LocalStringType">
						<v8:item>
							<v8:lang>ru</v8:lang>
							<v8:content>Наименование полное</v8:content>
						</v8:item>
					</title>
				</field>
				<field xsi:type="DataSetFieldField">
					<dataPath>КодЕдиницыИзмерения</dataPath>
					<field>КодЕдиницыИзмерения</field>
					<title xsi:type="v8:LocalStringType">
						<v8:item>
							<v8:lang>ru</v8:lang>
							<v8:content>Код единицы измерения</v8:content>
						</v8:item>
					</title>
				</field>
				<item xsi:type="DataSetUnion">
					<name>_PORDERS_ORDRSP_</name>
					<item xsi:type="DataSetQuery">
						<name>СчетНаОплатуПокупателю</name>
						<dataSource>ИсточникДанных1</dataSource>
						<query>ВЫБРАТЬ
	СчетНаОплатуПокупателю.Номенклатура,
	Неопределено КАК ХарактеристикаНоменклатуры,
	СчетНаОплатуПокупателю.Номенклатура.БазоваяЕдиницаИзмерения КАК ЕдиницаИзмерения,
	СчетНаОплатуПокупателю.Номенклатура.БазоваяЕдиницаИзмерения.Наименование КАК КодЕдиницыИзмерения,
	СчетНаОплатуПокупателю.Цена,
	СчетНаОплатуПокупателю.СтавкаНДС,
	СчетНаОплатуПокупателю.Количество КАК Количество,
	СчетНаОплатуПокупателю.Сумма КАК Сумма,
	СчетНаОплатуПокупателю.СуммаНДС КАК СуммаНДС,
	ВЫБОР
		КОГДА СчетНаОплатуПокупателю.Номенклатура.Услуга
			ТОГДА "Services"
		ИНАЧЕ ""
	КОНЕЦ КАК ТипЕдиницы
ИЗ
	Документ.СчетНаОплатуПокупателю.Товары КАК СчетНаОплатуПокупателю
ГДЕ
	СчетНаОплатуПокупателю.Ссылка В(&amp;Ссылка)
	И (НЕ СчетНаОплатуПокупателю.Номенклатура.Услуга
		ИЛИ &amp;РаботаСУслугами)
		
ОБЪЕДИНИТЬ ВСЕ

ВЫБРАТЬ
	СчетНаОплатуПокупателю.Номенклатура,
	Неопределено КАК ХарактеристикаНоменклатуры,
	СчетНаОплатуПокупателю.Номенклатура.БазоваяЕдиницаИзмерения КАК ЕдиницаИзмерения,
	СчетНаОплатуПокупателю.Номенклатура.БазоваяЕдиницаИзмерения.Наименование КАК КодЕдиницыИзмерения,
	СчетНаОплатуПокупателю.Цена,
	СчетНаОплатуПокупателю.СтавкаНДС,
	СчетНаОплатуПокупателю.Количество КАК Количество,
	СчетНаОплатуПокупателю.Сумма КАК Сумма,
	СчетНаОплатуПокупателю.СуммаНДС КАК СуммаНДС,
	"Services" КАК ТипЕдиницы
ИЗ
	Документ.СчетНаОплатуПокупателю.Услуги КАК СчетНаОплатуПокупателю
ГДЕ
	&amp;РаботаСУслугами
	И СчетНаОплатуПокупателю.Ссылка В(&amp;Ссылка)</query>
						<autoFillFields>false</autoFillFields>
					</item>
					<item xsi:type="DataSetQuery">
						<name>РеализацияТоваровУслуг</name>
						<dataSource>ИсточникДанных1</dataSource>
						<query>ВЫБРАТЬ
	РеализацияТоваровУслугТовары.НомерСтроки,
	РеализацияТоваровУслугТовары.Номенклатура,
	ВЫБОР
		КОГДА РеализацияТоваровУслугТовары.Номенклатура.Услуга
			ТОГДА РеализацияТоваровУслугТовары.Номенклатура.БазоваяЕдиницаИзмерения
		ИНАЧЕ РеализацияТоваровУслугТовары.ЕдиницаИзмерения
	КОНЕЦ КАК ЕдиницаИзмерения,
	ВЫБОР
		КОГДА РеализацияТоваровУслугТовары.Номенклатура.Услуга
			ТОГДА РеализацияТоваровУслугТовары.Номенклатура.БазоваяЕдиницаИзмерения.Наименование
		ИНАЧЕ РеализацияТоваровУслугТовары.ЕдиницаИзмерения.Наименование
	КОНЕЦ КАК КодЕдиницыИзмерения,
	ВЫРАЗИТЬ(РеализацияТоваровУслугТовары.Номенклатура.Наименование КАК СТРОКА(178)) КАК Наименование,
	ВЫРАЗИТЬ(РеализацияТоваровУслугТовары.Номенклатура.НаименованиеПолное КАК СТРОКА(500)) КАК НаименованиеПолное,
	Неопределено КАК ХарактеристикаНоменклатуры,
	Неопределено КАК СерияНоменклатуры,
	РеализацияТоваровУслугТовары.Цена,
	РеализацияТоваровУслугТовары.СтавкаНДС,
	РеализацияТоваровУслугТовары.СтранаПроисхождения КАК Страна,
	РеализацияТоваровУслугТовары.НомерГТД КАК НомерГТД,
	РеализацияТоваровУслугТовары.Количество КАК Количество,
	РеализацияТоваровУслугТовары.Сумма КАК Сумма,
	РеализацияТоваровУслугТовары.СуммаНДС КАК СуммаНДС,
	ВЫБОР
		КОГДА РеализацияТоваровУслугТовары.Номенклатура.Услуга
			ТОГДА "Services"
		ИНАЧЕ ""
	КОНЕЦ КАК ТипЕдиницы
ИЗ
	Документ.РеализацияТоваровУслуг.Товары КАК РеализацияТоваровУслугТовары
ГДЕ
	РеализацияТоваровУслугТовары.Ссылка В (&amp;Ссылка)
    И (НЕ РеализацияТоваровУслугТовары.Номенклатура.Услуга
			ИЛИ &amp;РаботаСУслугами)

ОБЪЕДИНИТЬ ВСЕ

ВЫБРАТЬ
	РеализацияТоваровУслугТовары.НомерСтроки,
	РеализацияТоваровУслугТовары.Номенклатура,
	РеализацияТоваровУслугТовары.Номенклатура.БазоваяЕдиницаИзмерения,
	РеализацияТоваровУслугТовары.Номенклатура.БазоваяЕдиницаИзмерения.Наименование,
	ВЫРАЗИТЬ(РеализацияТоваровУслугТовары.Номенклатура.Наименование КАК СТРОКА(178)),
	ВЫРАЗИТЬ(РеализацияТоваровУслугТовары.Номенклатура.НаименованиеПолное КАК СТРОКА(500)),
	Неопределено,
	Неопределено,
	РеализацияТоваровУслугТовары.Цена,
	РеализацияТоваровУслугТовары.СтавкаНДС,
	РеализацияТоваровУслугТовары.Номенклатура.СтранаПроисхождения,
	РеализацияТоваровУслугТовары.Номенклатура.НомерГТД,
	РеализацияТоваровУслугТовары.Количество,
	РеализацияТоваровУслугТовары.Сумма,
	РеализацияТоваровУслугТовары.СуммаНДС,
	"Services"
ИЗ
	Документ.РеализацияТоваровУслуг.Услуги КАК РеализацияТоваровУслугТовары
ГДЕ
	&amp;РаботаСУслугами
	И РеализацияТоваровУслугТовары.Ссылка В (&amp;Ссылка)

ОБЪЕДИНИТЬ ВСЕ

ВЫБРАТЬ
	РеализацияТоваровУслугВозвратнаяТара.НомерСтроки,
	РеализацияТоваровУслугВозвратнаяТара.Номенклатура,
	РеализацияТоваровУслугВозвратнаяТара.Номенклатура.БазоваяЕдиницаИзмерения,
	РеализацияТоваровУслугВозвратнаяТара.Номенклатура.БазоваяЕдиницаИзмерения.Наименование,
	ВЫРАЗИТЬ(РеализацияТоваровУслугВозвратнаяТара.Номенклатура.Наименование КАК СТРОКА(178)),
	ВЫРАЗИТЬ(РеализацияТоваровУслугВозвратнаяТара.Номенклатура.НаименованиеПолное КАК СТРОКА(500)),
	Неопределено,
	Неопределено КАК СерияНоменклатуры,
	РеализацияТоваровУслугВозвратнаяТара.Цена,
	ЗНАЧЕНИЕ(Перечисление.СтавкиНДС.БезНДС),
	РеализацияТоваровУслугВозвратнаяТара.Номенклатура.СтранаПроисхождения,
	РеализацияТоваровУслугВозвратнаяТара.Номенклатура.НомерГТД,
	РеализацияТоваровУслугВозвратнаяТара.Количество,
	РеализацияТоваровУслугВозвратнаяТара.Сумма,
	0,
	"RC"
ИЗ
	Документ.РеализацияТоваровУслуг.ВозвратнаяТара КАК РеализацияТоваровУслугВозвратнаяТара
ГДЕ
	&amp;ОтправлятьВозвратнуюТару
	И РеализацияТоваровУслугВозвратнаяТара.Ссылка В (&amp;Ссылка)

</query>
						<autoFillFields>false</autoFillFields>
					</item>
				</item>
				<item xsi:type="DataSetUnion">
					<name>_DESADV_INVOIC_</name>
					<item xsi:type="DataSetQuery">
						<name>РеализацияТоваровУслуг</name>
						<dataSource>ИсточникДанных1</dataSource>
						<query>ВЫБРАТЬ
	РеализацияТоваровУслугТовары.НомерСтроки,
	РеализацияТоваровУслугТовары.Номенклатура,
	ВЫБОР
		КОГДА РеализацияТоваровУслугТовары.Номенклатура.Услуга
			ТОГДА РеализацияТоваровУслугТовары.Номенклатура.БазоваяЕдиницаИзмерения
		ИНАЧЕ РеализацияТоваровУслугТовары.ЕдиницаИзмерения
	КОНЕЦ КАК ЕдиницаИзмерения,
	ВЫБОР
		КОГДА РеализацияТоваровУслугТовары.Номенклатура.Услуга
			ТОГДА РеализацияТоваровУслугТовары.Номенклатура.БазоваяЕдиницаИзмерения.Наименование
		ИНАЧЕ РеализацияТоваровУслугТовары.ЕдиницаИзмерения.Наименование
	КОНЕЦ КАК КодЕдиницыИзмерения,
	ВЫРАЗИТЬ(РеализацияТоваровУслугТовары.Номенклатура.Наименование КАК СТРОКА(178)) КАК Наименование,
	ВЫРАЗИТЬ(РеализацияТоваровУслугТовары.Номенклатура.НаименованиеПолное КАК СТРОКА(500)) КАК НаименованиеПолное,
	Неопределено КАК ХарактеристикаНоменклатуры,
	Неопределено КАК СерияНоменклатуры,
	РеализацияТоваровУслугТовары.Цена,
	РеализацияТоваровУслугТовары.СтавкаНДС,
	РеализацияТоваровУслугТовары.СтранаПроисхождения КАК Страна,
	РеализацияТоваровУслугТовары.НомерГТД КАК НомерГТД,
	РеализацияТоваровУслугТовары.Количество КАК Количество,
	РеализацияТоваровУслугТовары.Сумма КАК Сумма,
	РеализацияТоваровУслугТовары.СуммаНДС КАК СуммаНДС,
	ВЫБОР
		КОГДА РеализацияТоваровУслугТовары.Номенклатура.Услуга
			ТОГДА "Services"
		ИНАЧЕ ""
	КОНЕЦ КАК ТипЕдиницы
ИЗ
	Документ.РеализацияТоваровУслуг.Товары КАК РеализацияТоваровУслугТовары
ГДЕ
	РеализацияТоваровУслугТовары.Ссылка В (&amp;Ссылка)
    И (НЕ РеализацияТоваровУслугТовары.Номенклатура.Услуга
			ИЛИ &amp;РаботаСУслугами)

ОБЪЕДИНИТЬ ВСЕ

ВЫБРАТЬ
	РеализацияТоваровУслугТовары.НомерСтроки,
	РеализацияТоваровУслугТовары.Номенклатура,
	РеализацияТоваровУслугТовары.Номенклатура.БазоваяЕдиницаИзмерения,
	РеализацияТоваровУслугТовары.Номенклатура.БазоваяЕдиницаИзмерения.Наименование,
	ВЫРАЗИТЬ(РеализацияТоваровУслугТовары.Номенклатура.Наименование КАК СТРОКА(178)),
	ВЫРАЗИТЬ(РеализацияТоваровУслугТовары.Номенклатура.НаименованиеПолное КАК СТРОКА(500)),
	Неопределено,
	Неопределено,
	РеализацияТоваровУслугТовары.Цена,
	РеализацияТоваровУслугТовары.СтавкаНДС,
	РеализацияТоваровУслугТовары.Номенклатура.СтранаПроисхождения,
	РеализацияТоваровУслугТовары.Номенклатура.НомерГТД,
	РеализацияТоваровУслугТовары.Количество,
	РеализацияТоваровУслугТовары.Сумма,
	РеализацияТоваровУслугТовары.СуммаНДС,
	"Services"
ИЗ
	Документ.РеализацияТоваровУслуг.Услуги КАК РеализацияТоваровУслугТовары
ГДЕ
	&amp;РаботаСУслугами
	И РеализацияТоваровУслугТовары.Ссылка В (&amp;Ссылка)

ОБЪЕДИНИТЬ ВСЕ

ВЫБРАТЬ
	0,
	ВозвратТоваровОтПокупателяТовары.Номенклатура,
	ВозвратТоваровОтПокупателяТовары.Номенклатура.БазоваяЕдиницаИзмерения,
	ВозвратТоваровОтПокупателяТовары.Номенклатура.БазоваяЕдиницаИзмерения.Наименование,
	ВЫРАЗИТЬ(ВозвратТоваровОтПокупателяТовары.Номенклатура.Наименование КАК СТРОКА(178)),
	ВЫРАЗИТЬ(ВозвратТоваровОтПокупателяТовары.Номенклатура.НаименованиеПолное КАК СТРОКА(500)),
	Неопределено,
	Неопределено КАК СерияНоменклатуры,
	ВозвратТоваровОтПокупателяТовары.Цена,
	ВозвратТоваровОтПокупателяТовары.СтавкаНДС,
	ВозвратТоваровОтПокупателяТовары.СтранаПроисхождения,
	ВозвратТоваровОтПокупателяТовары.НомерГТД,
	-ВозвратТоваровОтПокупателяТовары.Количество,
	-ВозвратТоваровОтПокупателяТовары.Сумма,
	-ВозвратТоваровОтПокупателяТовары.СуммаНДС КАК СуммаНДС,
	""
ИЗ
	Документ.ВозвратТоваровОтПокупателя.Товары КАК ВозвратТоваровОтПокупателяТовары
ГДЕ
	ВозвратТоваровОтПокупателяТовары.Ссылка В(&amp;Возвраты)

ОБЪЕДИНИТЬ ВСЕ

ВЫБРАТЬ
	РеализацияТоваровУслугВозвратнаяТара.НомерСтроки,
	РеализацияТоваровУслугВозвратнаяТара.Номенклатура,
	РеализацияТоваровУслугВозвратнаяТара.Номенклатура.БазоваяЕдиницаИзмерения,
	РеализацияТоваровУслугВозвратнаяТара.Номенклатура.БазоваяЕдиницаИзмерения.Наименование,
	ВЫРАЗИТЬ(РеализацияТоваровУслугВозвратнаяТара.Номенклатура.Наименование КАК СТРОКА(178)),
	ВЫРАЗИТЬ(РеализацияТоваровУслугВозвратнаяТара.Номенклатура.НаименованиеПолное КАК СТРОКА(500)),
	Неопределено,
	Неопределено КАК СерияНоменклатуры,
	РеализацияТоваровУслугВозвратнаяТара.Цена,
	ЗНАЧЕНИЕ(Перечисление.СтавкиНДС.БезНДС),
	РеализацияТоваровУслугВозвратнаяТара.Номенклатура.СтранаПроисхождения,
	РеализацияТоваровУслугВозвратнаяТара.Номенклатура.НомерГТД,
	РеализацияТоваровУслугВозвратнаяТара.Количество,
	РеализацияТоваровУслугВозвратнаяТара.Сумма,
	0,
	"RC"
ИЗ
	Документ.РеализацияТоваровУслуг.ВозвратнаяТара КАК РеализацияТоваровУслугВозвратнаяТара
ГДЕ
	&amp;ОтправлятьВозвратнуюТару
	И РеализацияТоваровУслугВозвратнаяТара.Ссылка В (&amp;Ссылка)

ОБЪЕДИНИТЬ ВСЕ

ВЫБРАТЬ
	0,
	ВозвратТоваровОтПокупателяВозвратнаяТара.Номенклатура,
	ВозвратТоваровОтПокупателяВозвратнаяТара.Номенклатура.БазоваяЕдиницаИзмерения,
	ВозвратТоваровОтПокупателяВозвратнаяТара.Номенклатура.БазоваяЕдиницаИзмерения.Наименование,
	ВЫРАЗИТЬ(ВозвратТоваровОтПокупателяВозвратнаяТара.Номенклатура.Наименование КАК СТРОКА(178)),
	ВЫРАЗИТЬ(ВозвратТоваровОтПокупателяВозвратнаяТара.Номенклатура.НаименованиеПолное КАК СТРОКА(500)),
	Неопределено,
	Неопределено КАК СерияНоменклатуры,
	ВозвратТоваровОтПокупателяВозвратнаяТара.Цена,
	ЗНАЧЕНИЕ(Перечисление.СтавкиНДС.НДС0),
	ВозвратТоваровОтПокупателяВозвратнаяТара.Номенклатура.СтранаПроисхождения,
	ВозвратТоваровОтПокупателяВозвратнаяТара.Номенклатура.НомерГТД,
	-ВозвратТоваровОтПокупателяВозвратнаяТара.Количество,
	-ВозвратТоваровОтПокупателяВозвратнаяТара.Сумма,
	0,
	"RC"
ИЗ
	Документ.ВозвратТоваровОтПокупателя.ВозвратнаяТара КАК ВозвратТоваровОтПокупателяВозвратнаяТара
ГДЕ
	&amp;ОтправлятьВозвратнуюТару
	И ВозвратТоваровОтПокупателяВозвратнаяТара.Ссылка В(&amp;Возвраты)
</query>
						<autoFillFields>false</autoFillFields>
					</item>
				</item>
				<item xsi:type="DataSetUnion">
					<name>_RETINS_RETREC_</name>
					<field xsi:type="DataSetFieldField">
						<dataPath>СтавкаНДС</dataPath>
						<field>СтавкаНДС</field>
					</field>
					<field xsi:type="DataSetFieldField">
						<dataPath>НомерСтроки</dataPath>
						<field>НомерСтроки</field>
					</field>
					<field xsi:type="DataSetFieldField">
						<dataPath>Номенклатура</dataPath>
						<field>Номенклатура</field>
					</field>
					<field xsi:type="DataSetFieldField">
						<dataPath>ЕдиницаИзмерения</dataPath>
						<field>ЕдиницаИзмерения</field>
						<title xsi:type="v8:LocalStringType">
							<v8:item>
								<v8:lang>ru</v8:lang>
								<v8:content>Единица измерения</v8:content>
							</v8:item>
						</title>
					</field>
					<field xsi:type="DataSetFieldField">
						<dataPath>Наименование</dataPath>
						<field>Наименование</field>
						<title xsi:type="v8:LocalStringType">
							<v8:item>
								<v8:lang>ru</v8:lang>
								<v8:content>Наименование</v8:content>
							</v8:item>
						</title>
					</field>
					<field xsi:type="DataSetFieldField">
						<dataPath>НаименованиеПолное</dataPath>
						<field>НаименованиеПолное</field>
						<title xsi:type="v8:LocalStringType">
							<v8:item>
								<v8:lang>ru</v8:lang>
								<v8:content>Наименование полное</v8:content>
							</v8:item>
						</title>
					</field>
					<field xsi:type="DataSetFieldField">
						<dataPath>ХарактеристикаНоменклатуры</dataPath>
						<field>ХарактеристикаНоменклатуры</field>
						<title xsi:type="v8:LocalStringType">
							<v8:item>
								<v8:lang>ru</v8:lang>
								<v8:content>Характеристика номенклатуры</v8:content>
							</v8:item>
						</title>
					</field>
					<field xsi:type="DataSetFieldField">
						<dataPath>ТипЕдиницы</dataPath>
						<field>ТипЕдиницы</field>
						<title xsi:type="v8:LocalStringType">
							<v8:item>
								<v8:lang>ru</v8:lang>
								<v8:content>Тип единицы</v8:content>
							</v8:item>
						</title>
					</field>
					<field xsi:type="DataSetFieldField">
						<dataPath>КодЕдиницыИзмерения</dataPath>
						<field>КодЕдиницыИзмерения</field>
						<title xsi:type="v8:LocalStringType">
							<v8:item>
								<v8:lang>ru</v8:lang>
								<v8:content>Код единицы измерения</v8:content>
							</v8:item>
						</title>
					</field>
					<field xsi:type="DataSetFieldField">
						<dataPath>Цена</dataPath>
						<field>Цена</field>
					</field>
					<field xsi:type="DataSetFieldField">
						<dataPath>СерияНоменклатуры</dataPath>
						<field>СерияНоменклатуры</field>
						<title xsi:type="v8:LocalStringType">
							<v8:item>
								<v8:lang>ru</v8:lang>
								<v8:content>Серия номенклатуры</v8:content>
							</v8:item>
						</title>
					</field>
					<field xsi:type="DataSetFieldField">
						<dataPath>Страна</dataPath>
						<field>Страна</field>
						<title xsi:type="v8:LocalStringType">
							<v8:item>
								<v8:lang>ru</v8:lang>
								<v8:content>Страна</v8:content>
							</v8:item>
						</title>
					</field>
					<field xsi:type="DataSetFieldField">
						<dataPath>НомерГТД</dataPath>
						<field>НомерГТД</field>
						<title xsi:type="v8:LocalStringType">
							<v8:item>
								<v8:lang>ru</v8:lang>
								<v8:content>Номер ГТД</v8:content>
							</v8:item>
						</title>
					</field>
					<field xsi:type="DataSetFieldField">
						<dataPath>Количество</dataPath>
						<field>Количество</field>
					</field>
					<field xsi:type="DataSetFieldField">
						<dataPath>Сумма</dataPath>
						<field>Сумма</field>
					</field>
					<field xsi:type="DataSetFieldField">
						<dataPath>СуммаНДС</dataPath>
						<field>СуммаНДС</field>
					</field>
					<item xsi:type="DataSetQuery">
						<name>ВозвратТоваровОтПокупателя</name>
						<field xsi:type="DataSetFieldField">
							<dataPath>СтавкаНДС</dataPath>
							<field>СтавкаНДС</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>НомерСтроки</dataPath>
							<field>НомерСтроки</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>Номенклатура</dataPath>
							<field>Номенклатура</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>ЕдиницаИзмерения</dataPath>
							<field>ЕдиницаИзмерения</field>
							<title xsi:type="v8:LocalStringType">
								<v8:item>
									<v8:lang>ru</v8:lang>
									<v8:content>Единица измерения</v8:content>
								</v8:item>
							</title>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>Наименование</dataPath>
							<field>Наименование</field>
							<title xsi:type="v8:LocalStringType">
								<v8:item>
									<v8:lang>ru</v8:lang>
									<v8:content>Наименование</v8:content>
								</v8:item>
							</title>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>НаименованиеПолное</dataPath>
							<field>НаименованиеПолное</field>
							<title xsi:type="v8:LocalStringType">
								<v8:item>
									<v8:lang>ru</v8:lang>
									<v8:content>Наименование полное</v8:content>
								</v8:item>
							</title>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>ХарактеристикаНоменклатуры</dataPath>
							<field>ХарактеристикаНоменклатуры</field>
							<title xsi:type="v8:LocalStringType">
								<v8:item>
									<v8:lang>ru</v8:lang>
									<v8:content>Характеристика номенклатуры</v8:content>
								</v8:item>
							</title>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>ТипЕдиницы</dataPath>
							<field>ТипЕдиницы</field>
							<title xsi:type="v8:LocalStringType">
								<v8:item>
									<v8:lang>ru</v8:lang>
									<v8:content>Тип единицы</v8:content>
								</v8:item>
							</title>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>КодЕдиницыИзмерения</dataPath>
							<field>КодЕдиницыИзмерения</field>
							<title xsi:type="v8:LocalStringType">
								<v8:item>
									<v8:lang>ru</v8:lang>
									<v8:content>Код единицы измерения</v8:content>
								</v8:item>
							</title>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>Цена</dataPath>
							<field>Цена</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>СерияНоменклатуры</dataPath>
							<field>СерияНоменклатуры</field>
							<title xsi:type="v8:LocalStringType">
								<v8:item>
									<v8:lang>ru</v8:lang>
									<v8:content>Серия номенклатуры</v8:content>
								</v8:item>
							</title>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>Страна</dataPath>
							<field>Страна</field>
							<title xsi:type="v8:LocalStringType">
								<v8:item>
									<v8:lang>ru</v8:lang>
									<v8:content>Страна</v8:content>
								</v8:item>
							</title>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>НомерГТД</dataPath>
							<field>НомерГТД</field>
							<title xsi:type="v8:LocalStringType">
								<v8:item>
									<v8:lang>ru</v8:lang>
									<v8:content>Номер ГТД</v8:content>
								</v8:item>
							</title>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>Количество</dataPath>
							<field>Количество</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>Сумма</dataPath>
							<field>Сумма</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>СуммаНДС</dataPath>
							<field>СуммаНДС</field>
						</field>
						<dataSource>ИсточникДанных1</dataSource>
						<query>ВЫБРАТЬ
	ВозвратТоваровОтПокупателяТовары.НомерСтроки,
	ВозвратТоваровОтПокупателяТовары.Номенклатура,
	Неопределено КАК ХарактеристикаНоменклатуры,
	ВозвратТоваровОтПокупателяТовары.Номенклатура.БазоваяЕдиницаИзмерения КАК ЕдиницаИзмерения,
	ВозвратТоваровОтПокупателяТовары.Номенклатура.БазоваяЕдиницаИзмерения.Код КАК КодЕдиницыИзмерения,
	ВЫРАЗИТЬ(ВозвратТоваровОтПокупателяТовары.Номенклатура.Наименование КАК СТРОКА(178)) КАК Наименование,
	ВЫРАЗИТЬ(ВозвратТоваровОтПокупателяТовары.Номенклатура.НаименованиеПолное КАК СТРОКА(500)) КАК НаименованиеПолное,
	ВозвратТоваровОтПокупателяТовары.Цена,
	ВозвратТоваровОтПокупателяТовары.СтавкаНДС,
	Неопределено КАК СерияНоменклатуры,
	ВЫБОР
		КОГДА ВозвратТоваровОтПокупателяТовары.СтранаПроисхождения = ЗНАЧЕНИЕ(Справочник.КлассификаторСтранМира.ПустаяСсылка)
			ТОГДА ВозвратТоваровОтПокупателяТовары.Номенклатура.СтранаПроисхождения
		ИНАЧЕ ВозвратТоваровОтПокупателяТовары.СтранаПроисхождения
	КОНЕЦ КАК Страна,
	ЕСТЬNULL(ВозвратТоваровОтПокупателяТовары.НомерГТД.Код, ЕСТЬNULL(ВозвратТоваровОтПокупателяТовары.Номенклатура.НомерГТД.Код, "")) КАК НомерГТД,
	ВозвратТоваровОтПокупателяТовары.Количество,
	ВозвратТоваровОтПокупателяТовары.Сумма,
	ВозвратТоваровОтПокупателяТовары.СуммаНДС,
	"" КАК ТипЕдиницы
ИЗ
	Документ.ВозвратТоваровОтПокупателя.Товары КАК ВозвратТоваровОтПокупателяТовары
ГДЕ
	ВозвратТоваровОтПокупателяТовары.Ссылка В(&amp;Ссылка)</query>
					</item>
					<item xsi:type="DataSetQuery">
						<name>ПоступлениеТоваровУслуг</name>
						<field xsi:type="DataSetFieldField">
							<dataPath>СтавкаНДС</dataPath>
							<field>СтавкаНДС</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>НомерСтроки</dataPath>
							<field>НомерСтроки</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>Номенклатура</dataPath>
							<field>Номенклатура</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>ЕдиницаИзмерения</dataPath>
							<field>ЕдиницаИзмерения</field>
							<title xsi:type="v8:LocalStringType">
								<v8:item>
									<v8:lang>ru</v8:lang>
									<v8:content>Единица измерения</v8:content>
								</v8:item>
							</title>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>Наименование</dataPath>
							<field>Наименование</field>
							<title xsi:type="v8:LocalStringType">
								<v8:item>
									<v8:lang>ru</v8:lang>
									<v8:content>Наименование</v8:content>
								</v8:item>
							</title>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>НаименованиеПолное</dataPath>
							<field>НаименованиеПолное</field>
							<title xsi:type="v8:LocalStringType">
								<v8:item>
									<v8:lang>ru</v8:lang>
									<v8:content>Наименование полное</v8:content>
								</v8:item>
							</title>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>ХарактеристикаНоменклатуры</dataPath>
							<field>ХарактеристикаНоменклатуры</field>
							<title xsi:type="v8:LocalStringType">
								<v8:item>
									<v8:lang>ru</v8:lang>
									<v8:content>Характеристика номенклатуры</v8:content>
								</v8:item>
							</title>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>ТипЕдиницы</dataPath>
							<field>ТипЕдиницы</field>
							<title xsi:type="v8:LocalStringType">
								<v8:item>
									<v8:lang>ru</v8:lang>
									<v8:content>Тип единицы</v8:content>
								</v8:item>
							</title>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>КодЕдиницыИзмерения</dataPath>
							<field>КодЕдиницыИзмерения</field>
							<title xsi:type="v8:LocalStringType">
								<v8:item>
									<v8:lang>ru</v8:lang>
									<v8:content>Код единицы измерения</v8:content>
								</v8:item>
							</title>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>Цена</dataPath>
							<field>Цена</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>СерияНоменклатуры</dataPath>
							<field>СерияНоменклатуры</field>
							<title xsi:type="v8:LocalStringType">
								<v8:item>
									<v8:lang>ru</v8:lang>
									<v8:content>Серия номенклатуры</v8:content>
								</v8:item>
							</title>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>Страна</dataPath>
							<field>Страна</field>
							<title xsi:type="v8:LocalStringType">
								<v8:item>
									<v8:lang>ru</v8:lang>
									<v8:content>Страна</v8:content>
								</v8:item>
							</title>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>НомерГТД</dataPath>
							<field>НомерГТД</field>
							<title xsi:type="v8:LocalStringType">
								<v8:item>
									<v8:lang>ru</v8:lang>
									<v8:content>Номер ГТД</v8:content>
								</v8:item>
							</title>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>Количество</dataPath>
							<field>Количество</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>Сумма</dataPath>
							<field>Сумма</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>СуммаНДС</dataPath>
							<field>СуммаНДС</field>
						</field>
						<dataSource>ИсточникДанных1</dataSource>
						<query>ВЫБРАТЬ
	ПоступлениеТоваровУслугТовары.НомерСтроки,
	ПоступлениеТоваровУслугТовары.Номенклатура,
	Неопределено КАК ХарактеристикаНоменклатуры,
	ПоступлениеТоваровУслугТовары.Номенклатура.БазоваяЕдиницаИзмерения КАК ЕдиницаИзмерения,
	ПоступлениеТоваровУслугТовары.Номенклатура.БазоваяЕдиницаИзмерения.Код КАК КодЕдиницыИзмерения,
	ВЫРАЗИТЬ(ПоступлениеТоваровУслугТовары.Номенклатура.Наименование КАК СТРОКА(178)) КАК Наименование,
	ВЫРАЗИТЬ(ПоступлениеТоваровУслугТовары.Номенклатура.НаименованиеПолное КАК СТРОКА(500)) КАК НаименованиеПолное,
	ПоступлениеТоваровУслугТовары.Цена,
	ПоступлениеТоваровУслугТовары.СтавкаНДС,
	Неопределено КАК СерияНоменклатуры,
	ВЫБОР
		КОГДА ПоступлениеТоваровУслугТовары.СтранаПроисхождения = ЗНАЧЕНИЕ(Справочник.КлассификаторСтранМира.ПустаяСсылка)
			ТОГДА ПоступлениеТоваровУслугТовары.Номенклатура.СтранаПроисхождения
		ИНАЧЕ ПоступлениеТоваровУслугТовары.СтранаПроисхождения
	КОНЕЦ КАК Страна,
	ЕСТЬNULL(ПоступлениеТоваровУслугТовары.НомерГТД.Код, ЕСТЬNULL(ПоступлениеТоваровУслугТовары.Номенклатура.НомерГТД.Код, "")) КАК НомерГТД,
	ПоступлениеТоваровУслугТовары.Количество,
	ПоступлениеТоваровУслугТовары.Сумма,
	ПоступлениеТоваровУслугТовары.СуммаНДС,
	"" КАК ТипЕдиницы
ИЗ
	Документ.ПоступлениеТоваровУслуг.Товары КАК ПоступлениеТоваровУслугТовары
ГДЕ
	ПоступлениеТоваровУслугТовары.Ссылка В(&amp;Ссылка)</query>
					</item>
				</item>
				<item xsi:type="DataSetUnion">
					<name>_COINVOIC_IINVOIC_</name>
					<field xsi:type="DataSetFieldField">
						<dataPath>ЕдиницаИзмерения</dataPath>
						<field>ЕдиницаИзмерения</field>
					</field>
					<field xsi:type="DataSetFieldField">
						<dataPath>Количество</dataPath>
						<field>Количество</field>
					</field>
					<field xsi:type="DataSetFieldField">
						<dataPath>КоличествоДоКорректировки</dataPath>
						<field>КоличествоДоКорректировки</field>
					</field>
					<field xsi:type="DataSetFieldField">
						<dataPath>Номенклатура</dataPath>
						<field>Номенклатура</field>
					</field>
					<field xsi:type="DataSetFieldField">
						<dataPath>НомерГТД</dataPath>
						<field>НомерГТД</field>
					</field>
					<field xsi:type="DataSetFieldField">
						<dataPath>СерияНоменклатуры</dataPath>
						<field>СерияНоменклатуры</field>
					</field>
					<field xsi:type="DataSetFieldField">
						<dataPath>СтавкаНДС</dataPath>
						<field>СтавкаНДС</field>
					</field>
					<field xsi:type="DataSetFieldField">
						<dataPath>СтавкаНДСДоКорректировки</dataPath>
						<field>СтавкаНДСДоКорректировки</field>
					</field>
					<field xsi:type="DataSetFieldField">
						<dataPath>Страна</dataPath>
						<field>Страна</field>
					</field>
					<field xsi:type="DataSetFieldField">
						<dataPath>Сумма</dataPath>
						<field>Сумма</field>
					</field>
					<field xsi:type="DataSetFieldField">
						<dataPath>СуммаДоКорректировки</dataPath>
						<field>СуммаДоКорректировки</field>
					</field>
					<field xsi:type="DataSetFieldField">
						<dataPath>СуммаНДС</dataPath>
						<field>СуммаНДС</field>
					</field>
					<field xsi:type="DataSetFieldField">
						<dataPath>СуммаНДСДоКорректировки</dataPath>
						<field>СуммаНДСДоКорректировки</field>
					</field>
					<field xsi:type="DataSetFieldField">
						<dataPath>ТипЕдиницы</dataPath>
						<field>ТипЕдиницы</field>
					</field>
					<field xsi:type="DataSetFieldField">
						<dataPath>ХарактеристикаНоменклатуры</dataPath>
						<field>ХарактеристикаНоменклатуры</field>
					</field>
					<field xsi:type="DataSetFieldField">
						<dataPath>Цена</dataPath>
						<field>Цена</field>
					</field>
					<field xsi:type="DataSetFieldField">
						<dataPath>ЦенаДоКорректировки</dataPath>
						<field>ЦенаДоКорректировки</field>
					</field>
					<field xsi:type="DataSetFieldField">
						<dataPath>Наименование</dataPath>
						<field>Наименование</field>
						<title xsi:type="v8:LocalStringType">
							<v8:item>
								<v8:lang>ru</v8:lang>
								<v8:content>Наименование</v8:content>
							</v8:item>
						</title>
					</field>
					<field xsi:type="DataSetFieldField">
						<dataPath>НаименованиеПолное</dataPath>
						<field>НаименованиеПолное</field>
						<title xsi:type="v8:LocalStringType">
							<v8:item>
								<v8:lang>ru</v8:lang>
								<v8:content>Наименование полное</v8:content>
							</v8:item>
						</title>
					</field>
					<item xsi:type="DataSetQuery">
						<name>КорректировкаРеализации</name>
						<field xsi:type="DataSetFieldField">
							<dataPath>ЕдиницаИзмерения</dataPath>
							<field>ЕдиницаИзмерения</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>Количество</dataPath>
							<field>Количество</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>КоличествоДоКорректировки</dataPath>
							<field>КоличествоДоКорректировки</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>Номенклатура</dataPath>
							<field>Номенклатура</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>НомерГТД</dataPath>
							<field>НомерГТД</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>СерияНоменклатуры</dataPath>
							<field>СерияНоменклатуры</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>СтавкаНДС</dataPath>
							<field>СтавкаНДС</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>СтавкаНДСДоКорректировки</dataPath>
							<field>СтавкаНДСДоКорректировки</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>Страна</dataPath>
							<field>Страна</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>Сумма</dataPath>
							<field>Сумма</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>СуммаДоКорректировки</dataPath>
							<field>СуммаДоКорректировки</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>СуммаНДС</dataPath>
							<field>СуммаНДС</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>СуммаНДСДоКорректировки</dataPath>
							<field>СуммаНДСДоКорректировки</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>ТипЕдиницы</dataPath>
							<field>ТипЕдиницы</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>ХарактеристикаНоменклатуры</dataPath>
							<field>ХарактеристикаНоменклатуры</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>Цена</dataPath>
							<field>Цена</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>ЦенаДоКорректировки</dataPath>
							<field>ЦенаДоКорректировки</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>Наименование</dataPath>
							<field>Наименование</field>
							<title xsi:type="v8:LocalStringType">
								<v8:item>
									<v8:lang>ru</v8:lang>
									<v8:content>Наименование</v8:content>
								</v8:item>
							</title>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>НаименованиеПолное</dataPath>
							<field>НаименованиеПолное</field>
							<title xsi:type="v8:LocalStringType">
								<v8:item>
									<v8:lang>ru</v8:lang>
									<v8:content>Наименование полное</v8:content>
								</v8:item>
							</title>
						</field>
						<dataSource>ИсточникДанных1</dataSource>
						<query>ВЫБРАТЬ
	КорректировкаРеализацииТовары.Номенклатура,
	НЕОПРЕДЕЛЕНО КАК ХарактеристикаНоменклатуры,
	КорректировкаРеализацииТовары.Номенклатура.БазоваяЕдиницаИзмерения КАК ЕдиницаИзмерения,
	ВЫРАЗИТЬ(КорректировкаРеализацииТовары.Номенклатура.Наименование КАК СТРОКА(178)) КАК НоменклатураНаименование,
	ПОДСТРОКА(КорректировкаРеализацииТовары.Номенклатура.НаименованиеПолное, 0, 500) КАК НоменклатураНаименованиеПолное,
	МАКСИМУМ(КорректировкаРеализацииТовары.Цена) КАК Цена,
	КорректировкаРеализацииТовары.ЦенаДоКорректировки КАК ЦенаДоКорректировки,
	КорректировкаРеализацииТовары.СтавкаНДС,
	КорректировкаРеализацииТовары.СтавкаНДСДоИзменения КАК СтавкаНДСДоКорректировки,
	НЕОПРЕДЕЛЕНО КАК СерияНоменклатуры,
	ВЫБОР
		КОГДА &amp;ТипСообщения = "INVOIC"
			ТОГДА КорректировкаРеализацииТовары.СтранаПроисхождения
		ИНАЧЕ Значение(Справочник.КлассификаторСтранМира.ПустаяСсылка)
	КОНЕЦ КАК Страна,
	ВЫБОР
		КОГДА &amp;ТипСообщения = "INVOIC"
			ТОГДА КорректировкаРеализацииТовары.НомерГТД
		ИНАЧЕ Значение(Справочник.НомераГТД.ПустаяСсылка)
	КОНЕЦ КАК НомерГТД,
	СУММА(КорректировкаРеализацииТовары.Количество) КАК Количество,
	СУММА(КорректировкаРеализацииТовары.КоличествоДоКорректировки) КАК КоличествоДоКорректировки,
	СУММА(КорректировкаРеализацииТовары.Сумма) КАК Сумма,
	СУММА(КорректировкаРеализацииТовары.СуммаДоКорректировки) КАК СуммаДоКорректировки,
	СУММА(КорректировкаРеализацииТовары.СуммаНДС) КАК СуммаНДС,
	СУММА(КорректировкаРеализацииТовары.СуммаНДСДоКорректировки) КАК СуммаНДСДоКорректировки,
	ВЫБОР
		КОГДА КорректировкаРеализацииТовары.Номенклатура.Услуга
			ТОГДА "Services"
		ИНАЧЕ ""
	КОНЕЦ КАК ТипЕдиницы
ПОМЕСТИТЬ табКорректировки
ИЗ
	Документ.КорректировкаРеализации.Товары КАК КорректировкаРеализацииТовары
ГДЕ
	КорректировкаРеализацииТовары.Ссылка = &amp;Ссылка

СГРУППИРОВАТЬ ПО
	КорректировкаРеализацииТовары.Номенклатура,
	КорректировкаРеализацииТовары.Номенклатура.БазоваяЕдиницаИзмерения,
	ВЫРАЗИТЬ(КорректировкаРеализацииТовары.Номенклатура.Наименование КАК СТРОКА(178)),
	ПОДСТРОКА(КорректировкаРеализацииТовары.Номенклатура.НаименованиеПолное, 0, 500),
	КорректировкаРеализацииТовары.СтавкаНДС,
	КорректировкаРеализацииТовары.СтавкаНДСДоИзменения,
	ВЫБОР
		КОГДА КорректировкаРеализацииТовары.Номенклатура.Услуга
			ТОГДА "Services"
		ИНАЧЕ ""
	КОНЕЦ,
	ВЫБОР
		КОГДА &amp;ТипСообщения = "INVOIC"
			ТОГДА КорректировкаРеализацииТовары.СтранаПроисхождения
		ИНАЧЕ Значение(Справочник.КлассификаторСтранМира.ПустаяСсылка)
	КОНЕЦ,
	ВЫБОР
		КОГДА &amp;ТипСообщения = "INVOIC"
			ТОГДА КорректировкаРеализацииТовары.НомерГТД
		ИНАЧЕ Значение(Справочник.НомераГТД.ПустаяСсылка)
	КОНЕЦ,
	КорректировкаРеализацииТовары.ЦенаДоКорректировки

ОБЪЕДИНИТЬ ВСЕ

ВЫБРАТЬ
	КорректировкаРеализацииУслуги.Номенклатура,
	НЕОПРЕДЕЛЕНО,
	КорректировкаРеализацииУслуги.Номенклатура.БазоваяЕдиницаИзмерения,
	ВЫРАЗИТЬ(КорректировкаРеализацииУслуги.Номенклатура.Наименование КАК СТРОКА(178)),
	ПОДСТРОКА(КорректировкаРеализацииУслуги.Номенклатура.НаименованиеПолное, 0, 500),
	МАКСИМУМ(КорректировкаРеализацииУслуги.Цена),
	КорректировкаРеализацииУслуги.ЦенаДоКорректировки,
	КорректировкаРеализацииУслуги.СтавкаНДС,
	КорректировкаРеализацииУслуги.СтавкаНДСДоИзменения,
	НЕОПРЕДЕЛЕНО,
	NULL,
	NULL,
	СУММА(КорректировкаРеализацииУслуги.Количество),
	СУММА(КорректировкаРеализацииУслуги.КоличествоДоКорректировки),
	СУММА(КорректировкаРеализацииУслуги.Сумма),
	СУММА(КорректировкаРеализацииУслуги.СуммаДоКорректировки),
	СУММА(КорректировкаРеализацииУслуги.СуммаНДС),
	СУММА(КорректировкаРеализацииУслуги.СуммаНДСДоКорректировки),
	"Services"
ИЗ
	Документ.КорректировкаРеализации.Услуги КАК КорректировкаРеализацииУслуги
ГДЕ
	КорректировкаРеализацииУслуги.Ссылка = &amp;Ссылка

СГРУППИРОВАТЬ ПО
	КорректировкаРеализацииУслуги.Номенклатура,
	КорректировкаРеализацииУслуги.Номенклатура.БазоваяЕдиницаИзмерения,
	ВЫРАЗИТЬ(КорректировкаРеализацииУслуги.Номенклатура.Наименование КАК СТРОКА(178)),
	ПОДСТРОКА(КорректировкаРеализацииУслуги.Номенклатура.НаименованиеПолное, 0, 500),
	КорректировкаРеализацииУслуги.СтавкаНДС,
	КорректировкаРеализацииУслуги.СтавкаНДСДоИзменения,
	КорректировкаРеализацииУслуги.ЦенаДоКорректировки
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ
	табКорректировки.Номенклатура,
	табКорректировки.ХарактеристикаНоменклатуры,
	табКорректировки.ЕдиницаИзмерения,
	табКорректировки.НоменклатураНаименование КАК Наименование,
	табКорректировки.НоменклатураНаименованиеПолное КАК НаименованиеПолное,
	табКорректировки.СтавкаНДС,
	табКорректировки.СтавкаНДСДоКорректировки,
	табКорректировки.СерияНоменклатуры,
	табКорректировки.Страна,
	табКорректировки.НомерГТД,
	табКорректировки.Количество,
	табКорректировки.КоличествоДоКорректировки,
	табКорректировки.Сумма,
	табКорректировки.СуммаДоКорректировки,
	табКорректировки.СуммаНДС,
	табКорректировки.СуммаНДСДоКорректировки,
	табКорректировки.ТипЕдиницы,
	ВЫБОР
		КОГДА НЕ ЕСТЬNULL(табКорректировки.Цена, 0) = 0
			ТОГДА табКорректировки.Цена
		КОГДА НЕ табКорректировки.Количество = 0
			ТОГДА табКорректировки.Сумма / табКорректировки.Количество
		ИНАЧЕ 0 
	КОНЕЦ КАК Цена,
	табКорректировки.ЦенаДоКорректировки КАК ЦенаДоКорректировки
ИЗ
	табКорректировки КАК табКорректировки</query>
					</item>
				</item>
				<item xsi:type="DataSetUnion">
					<name>_PRICELIST_</name>
					<field xsi:type="DataSetFieldField">
						<dataPath>GTIN</dataPath>
						<field>GTIN</field>
					</field>
					<field xsi:type="DataSetFieldField">
						<dataPath>ЕдИзмСрокаГодности</dataPath>
						<field>ЕдИзмСрокаГодности</field>
					</field>
					<field xsi:type="DataSetFieldField">
						<dataPath>ЕдиницаИзмерения</dataPath>
						<field>ЕдиницаИзмерения</field>
					</field>
					<field xsi:type="DataSetFieldField">
						<dataPath>КвантПоставки</dataPath>
						<field>КвантПоставки</field>
					</field>
					<field xsi:type="DataSetFieldField">
						<dataPath>КодТовараПоставщика</dataPath>
						<field>КодТовараПоставщика</field>
					</field>
					<field xsi:type="DataSetFieldField">
						<dataPath>КоличествоВОдномМесте</dataPath>
						<field>КоличествоВОдномМесте</field>
					</field>
					<field xsi:type="DataSetFieldField">
						<dataPath>Наименование</dataPath>
						<field>Наименование</field>
					</field>
					<field xsi:type="DataSetFieldField">
						<dataPath>Номенклатура</dataPath>
						<field>Номенклатура</field>
					</field>
					<field xsi:type="DataSetFieldField">
						<dataPath>Родитель</dataPath>
						<field>Родитель</field>
					</field>
					<field xsi:type="DataSetFieldField">
						<dataPath>СрокГодности</dataPath>
						<field>СрокГодности</field>
					</field>
					<field xsi:type="DataSetFieldField">
						<dataPath>СтавкаНДС</dataPath>
						<field>СтавкаНДС</field>
					</field>
					<field xsi:type="DataSetFieldField">
						<dataPath>Страна</dataPath>
						<field>Страна</field>
					</field>
					<field xsi:type="DataSetFieldField">
						<dataPath>Цена</dataPath>
						<field>Цена</field>
					</field>
					<field xsi:type="DataSetFieldField">
						<dataPath>КоличествоОстаткаНаКонец</dataPath>
						<field>КоличествоОстаткаНаКонец</field>
					</field>
					<field xsi:type="DataSetFieldField">
						<dataPath>РекомендуемаяРозничнаяЦена</dataPath>
						<field>РекомендуемаяРозничнаяЦена</field>
					</field>
					<item xsi:type="DataSetQuery">
						<name>Ценовой_лист_БезЦен</name>
						<field xsi:type="DataSetFieldField">
							<dataPath>GTIN</dataPath>
							<field>GTIN</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>ЕдИзмСрокаГодности</dataPath>
							<field>ЕдИзмСрокаГодности</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>ЕдиницаИзмерения</dataPath>
							<field>ЕдиницаИзмерения</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>КвантПоставки</dataPath>
							<field>КвантПоставки</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>КодТовараПоставщика</dataPath>
							<field>КодТовараПоставщика</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>КоличествоВОдномМесте</dataPath>
							<field>КоличествоВОдномМесте</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>Наименование</dataPath>
							<field>Наименование</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>Номенклатура</dataPath>
							<field>Номенклатура</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>Родитель</dataPath>
							<field>Родитель</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>СрокГодности</dataPath>
							<field>СрокГодности</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>СтавкаНДС</dataPath>
							<field>СтавкаНДС</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>Страна</dataPath>
							<field>Страна</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>Цена</dataPath>
							<field>Цена</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>РекомендуемаяРозничнаяЦена</dataPath>
							<field>РекомендуемаяРозничнаяЦена</field>
						</field>
						<dataSource>ИсточникДанных1</dataSource>
						<query>ВЫБРАТЬ
	СправочникНоменклатура.Родитель КАК Родитель,
	СправочникНоменклатура.Ссылка КАК Номенклатура,
	СправочникНоменклатура.БазоваяЕдиницаИзмерения КАК ЕдиницаИзмерения,
	СправочникНоменклатура.Код КАК КодТовараПоставщика,
	СправочникНоменклатура.НаименованиеПолное КАК Наименование,
	СправочникНоменклатура.СтавкаНДС КАК СтавкаНДС,
	0 КАК Цена,
	0 КАК РекомендуемаяРозничнаяЦена,
	NULL КАК GTIN,
	NULL КАК КоличествоВОдномМесте,
	СправочникНоменклатура.СтранаПроисхождения КАК Страна,
	NULL КАК КвантПоставки,
	NULL КАК ЕдИзмСрокаГодности,
	NULL КАК СрокГодности
ИЗ
	Справочник.Номенклатура КАК СправочникНоменклатура
ГДЕ
	НЕ СправочникНоменклатура.ЭтоГруппа
	И НЕ СправочникНоменклатура.ПометкаУдаления
	И НЕ СправочникНоменклатура.Услуга
	И &amp;УсловиеОтбораНоменклатуры</query>
					</item>
					<item xsi:type="DataSetQuery">
						<name>Ценовой_лист_СЦенами</name>
						<field xsi:type="DataSetFieldField">
							<dataPath>GTIN</dataPath>
							<field>GTIN</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>ЕдИзмСрокаГодности</dataPath>
							<field>ЕдИзмСрокаГодности</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>ЕдиницаИзмерения</dataPath>
							<field>ЕдиницаИзмерения</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>КвантПоставки</dataPath>
							<field>КвантПоставки</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>КодТовараПоставщика</dataPath>
							<field>КодТовараПоставщика</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>КоличествоВОдномМесте</dataPath>
							<field>КоличествоВОдномМесте</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>Наименование</dataPath>
							<field>Наименование</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>Номенклатура</dataPath>
							<field>Номенклатура</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>Родитель</dataPath>
							<field>Родитель</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>СрокГодности</dataPath>
							<field>СрокГодности</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>СтавкаНДС</dataPath>
							<field>СтавкаНДС</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>Страна</dataPath>
							<field>Страна</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>Цена</dataPath>
							<field>Цена</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>РекомендуемаяРозничнаяЦена</dataPath>
							<field>РекомендуемаяРозничнаяЦена</field>
						</field>
						<dataSource>ИсточникДанных1</dataSource>
						<query>ВЫБРАТЬ
	ЦеныНоменклатурыСрезПоследних.Номенклатура.Родитель КАК Родитель,
	ЦеныНоменклатурыСрезПоследних.Номенклатура.Ссылка КАК Номенклатура,
	ЦеныНоменклатурыСрезПоследних.Номенклатура.БазоваяЕдиницаИзмерения КАК ЕдиницаИзмерения,
	ЦеныНоменклатурыСрезПоследних.Номенклатура.Код КАК КодТовараПоставщика,
	ЦеныНоменклатурыСрезПоследних.Номенклатура.НаименованиеПолное КАК Наименование,
	ЦеныНоменклатурыСрезПоследних.Номенклатура.СтавкаНДС КАК СтавкаНДС,
	ЦеныНоменклатурыСрезПоследних.Цена,
	0 КАК РекомендуемаяРозничнаяЦена,
	NULL КАК GTIN,
	NULL КАК КоличествоВОдномМесте,
	ЦеныНоменклатурыСрезПоследних.Номенклатура.СтранаПроисхождения КАК Страна,
	NULL КАК КвантПоставки,
	NULL КАК ЕдИзмСрокаГодности,
	NULL КАК СрокГодности
ИЗ
	РегистрСведений.ЦеныНоменклатуры.СрезПоследних(
			,
			ТипЦен = &amp;ТипЦен
				И НЕ Номенклатура.ПометкаУдаления
				И НЕ Номенклатура.Услуга
				И &amp;УсловиеОтбораНоменклатуры) КАК ЦеныНоменклатурыСрезПоследних
ГДЕ
	ЦеныНоменклатурыСрезПоследних.Цена &gt; 0</query>
					</item>
					<item xsi:type="DataSetQuery">
						<name>Ценовой_лист_БезЦен_Остатки</name>
						<field xsi:type="DataSetFieldField">
							<dataPath>GTIN</dataPath>
							<field>GTIN</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>ЕдИзмСрокаГодности</dataPath>
							<field>ЕдИзмСрокаГодности</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>ЕдиницаИзмерения</dataPath>
							<field>ЕдиницаИзмерения</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>КвантПоставки</dataPath>
							<field>КвантПоставки</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>КодТовараПоставщика</dataPath>
							<field>КодТовараПоставщика</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>КоличествоВОдномМесте</dataPath>
							<field>КоличествоВОдномМесте</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>Наименование</dataPath>
							<field>Наименование</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>Номенклатура</dataPath>
							<field>Номенклатура</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>Родитель</dataPath>
							<field>Родитель</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>СрокГодности</dataPath>
							<field>СрокГодности</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>СтавкаНДС</dataPath>
							<field>СтавкаНДС</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>Страна</dataPath>
							<field>Страна</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>Цена</dataPath>
							<field>Цена</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>КоличествоОстаткаНаКонец</dataPath>
							<field>КоличествоОстаткаНаКонец</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>РекомендуемаяРозничнаяЦена</dataPath>
							<field>РекомендуемаяРозничнаяЦена</field>
						</field>
						<dataSource>ИсточникДанных1</dataSource>
						<query>ВЫБРАТЬ
	СправочникНоменклатура.Родитель КАК Родитель,
	СправочникНоменклатура.Ссылка КАК Номенклатура,
	СправочникНоменклатура.БазоваяЕдиницаИзмерения КАК ЕдиницаИзмерения,
	СправочникНоменклатура.Код КАК КодТовараПоставщика,
	СправочникНоменклатура.НаименованиеПолное КАК Наименование,
	СправочникНоменклатура.СтавкаНДС КАК СтавкаНДС,
	0 КАК Цена,
	0 КАК РекомендуемаяРозничнаяЦена,
	NULL КАК GTIN,
	NULL КАК КоличествоВОдномМесте,
	СправочникНоменклатура.СтранаПроисхождения КАК Страна,
	NULL КАК КвантПоставки,
	NULL КАК ЕдИзмСрокаГодности,
	NULL КАК СрокГодности,
	0 КАК КоличествоОстаткаНаКонец
ИЗ
	Справочник.Номенклатура КАК СправочникНоменклатура
ГДЕ
	НЕ СправочникНоменклатура.ЭтоГруппа
	И НЕ СправочникНоменклатура.ПометкаУдаления
	И НЕ СправочникНоменклатура.Услуга
	И &amp;УсловиеОтбораНоменклатуры</query>
					</item>
					<item xsi:type="DataSetQuery">
						<name>Ценовой_лист_СЦенами_Остатки</name>
						<field xsi:type="DataSetFieldField">
							<dataPath>GTIN</dataPath>
							<field>GTIN</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>ЕдИзмСрокаГодности</dataPath>
							<field>ЕдИзмСрокаГодности</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>ЕдиницаИзмерения</dataPath>
							<field>ЕдиницаИзмерения</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>КвантПоставки</dataPath>
							<field>КвантПоставки</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>КодТовараПоставщика</dataPath>
							<field>КодТовараПоставщика</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>КоличествоВОдномМесте</dataPath>
							<field>КоличествоВОдномМесте</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>Наименование</dataPath>
							<field>Наименование</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>Номенклатура</dataPath>
							<field>Номенклатура</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>Родитель</dataPath>
							<field>Родитель</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>СрокГодности</dataPath>
							<field>СрокГодности</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>СтавкаНДС</dataPath>
							<field>СтавкаНДС</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>Страна</dataPath>
							<field>Страна</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>Цена</dataPath>
							<field>Цена</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>КоличествоОстаткаНаКонец</dataPath>
							<field>КоличествоОстаткаНаКонец</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>РекомендуемаяРозничнаяЦена</dataPath>
							<field>РекомендуемаяРозничнаяЦена</field>
						</field>
						<dataSource>ИсточникДанных1</dataSource>
						<query>ВЫБРАТЬ
	ЦеныНоменклатурыСрезПоследних.Номенклатура.Родитель КАК Родитель,
	ЦеныНоменклатурыСрезПоследних.Номенклатура.Ссылка КАК Номенклатура,
	ЦеныНоменклатурыСрезПоследних.Номенклатура.БазоваяЕдиницаИзмерения КАК ЕдиницаИзмерения,
	ЦеныНоменклатурыСрезПоследних.Номенклатура.Код КАК КодТовараПоставщика,
	ЦеныНоменклатурыСрезПоследних.Номенклатура.НаименованиеПолное КАК Наименование,
	ЦеныНоменклатурыСрезПоследних.Номенклатура.СтавкаНДС КАК СтавкаНДС,
	ЦеныНоменклатурыСрезПоследних.Цена,
	0 КАК РекомендуемаяРозничнаяЦена,
	NULL КАК GTIN,
	NULL КАК КоличествоВОдномМесте,
	ЦеныНоменклатурыСрезПоследних.Номенклатура.СтранаПроисхождения КАК Страна,
	NULL КАК КвантПоставки,
	NULL КАК ЕдИзмСрокаГодности,
	NULL КАК СрокГодности,
	0 КАК КоличествоОстаткаНаКонец
ИЗ
	РегистрСведений.ЦеныНоменклатуры.СрезПоследних(
			,
			ТипЦен = &amp;ТипЦен
				И НЕ Номенклатура.ПометкаУдаления
				И НЕ Номенклатура.Услуга
				И &amp;УсловиеОтбораНоменклатуры) КАК ЦеныНоменклатурыСрезПоследних
ГДЕ
	ЦеныНоменклатурыСрезПоследних.Цена &gt; 0</query>
					</item>
				</item>
			</item>
			<item xsi:type="DataSetUnion">
				<name>ЗапросПоCOINVOIC</name>
				<item xsi:type="DataSetQuery">
					<name>Реализация_СФ</name>
					<dataSource>ИсточникДанных1</dataSource>
					<query>ВЫБРАТЬ РАЗРЕШЕННЫЕ
	докКорректировка.Ссылка КАК Корректировка,
	ВЫБОР
		КОГДА НЕ докКорректировка.Проведен
			ТОГДА докКорректировка.Ссылка
		ИНАЧЕ ЕСТЬNULL(докСчетФактура.Ссылка, докКорректировка.Ссылка)
	КОНЕЦ КАК Документ,
	ВЫБОР
		КОГДА НЕ докКорректировка.Проведен
			ТОГДА "Провести Корректировка реализации"
		КОГДА докСчетФактура.Ссылка ЕСТЬ NULL 
			ТОГДА "Создать Счет-фактура по корректировке"
		КОГДА НЕ докСчетФактура.Ссылка.Проведен И &amp;ТребуетсяПроведениеCOINVOIC
			ТОГДА "Провести Счет-фактура по корректировке"
		КОГДА докСчетФактура.Ссылка.ВидСчетаФактуры &lt;&gt; ЗНАЧЕНИЕ(Перечисление.ВидСчетаФактурыВыставленного.Корректировочный)
			ТОГДА "Отправить счет-фактуру"
		ИНАЧЕ "Отправить корректировочный счет-фактуру"
	КОНЕЦ КАК ТребуемоеДействие,
	ВЫБОР
		КОГДА докСчетФактура.Ссылка.ВидСчетаФактуры &lt;&gt; ЗНАЧЕНИЕ(Перечисление.ВидСчетаФактурыВыставленного.Корректировочный)
			ТОГДА "INVOIC"
		ИНАЧЕ "COINVOIC"
	КОНЕЦ КАК ТипСообщения,
	докКорректировка.ДокументРеализации,
	ТаблицаКэшПартнеровКонтрагентов.Партнер
ПОМЕСТИТЬ табКорректировки
ИЗ
	ТаблицаКэшПартнеровКонтрагентов КАК ТаблицаКэшПартнеровКонтрагентов
		ВНУТРЕННЕЕ СОЕДИНЕНИЕ Документ.КорректировкаРеализации КАК докКорректировка
			ЛЕВОЕ СОЕДИНЕНИЕ Документ.СчетФактураВыданный.ДокументыОснования КАК докСчетФактура
				ЛЕВОЕ СОЕДИНЕНИЕ Справочник.КонтурEDI_Сообщения КАК КонтурEDI_Сообщения
				ПО (КонтурEDI_Сообщения.Документ = докСчетФактура.Ссылка)
					И (КонтурEDI_Сообщения.ТипСообщения = "COINVOIC"
						ИЛИ КонтурEDI_Сообщения.ТипСообщения = "INVOIC")
			ПО докКорректировка.Ссылка = докСчетФактура.ДокументОснование
				И (докСчетФактура.Ссылка.ПометкаУдаления = ЛОЖЬ)
		ПО ТаблицаКэшПартнеровКонтрагентов.Контрагент = докКорректировка.Контрагент
			И (ТаблицаКэшПартнеровКонтрагентов.COINVOIC = ИСТИНА)
ГДЕ
	НЕ докКорректировка.ПометкаУдаления
	И докКорректировка.Дата МЕЖДУ &amp;НачалоПериода И &amp;КонецПериода
	И (докКорректировка.ДокументРеализации ССЫЛКА Документ.РеализацияТоваровУслуг
			ИЛИ докКорректировка.ДокументРеализации ССЫЛКА Документ.КорректировкаРеализации)
	И ВЫБОР
			КОГДА &amp;ТолькоТребуемые
				ТОГДА КонтурEDI_Сообщения.Ссылка ЕСТЬ NULL 
			ИНАЧЕ ИСТИНА
		КОНЕЦ
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ РАЗРЕШЕННЫЕ
	табКорректировки.Корректировка,
	ЕСТЬNULL(СчетФактураВыданныйДокументыОснования.Ссылка, табКорректировки.ДокументРеализации) КАК ПредыдущийДокумент
ПОМЕСТИТЬ табПредыдущихДокументов
ИЗ
	табКорректировки КАК табКорректировки
		ВНУТРЕННЕЕ СОЕДИНЕНИЕ Документ.СчетФактураВыданный.ДокументыОснования КАК СчетФактураВыданныйДокументыОснования
		ПО табКорректировки.ДокументРеализации = СчетФактураВыданныйДокументыОснования.ДокументОснование
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ РАЗРЕШЕННЫЕ
	КонтурEDI_Сообщения.Ссылка КАК Сообщение,
	табПредыдущихДокументов.Корректировка,
	табПредыдущихДокументов.ПредыдущийДокумент
ПОМЕСТИТЬ табРазрешенийНаОтправку
ИЗ
	табПредыдущихДокументов КАК табПредыдущихДокументов
		ЛЕВОЕ СОЕДИНЕНИЕ Справочник.КонтурEDI_Сообщения КАК КонтурEDI_Сообщения
		ПО табПредыдущихДокументов.ПредыдущийДокумент = КонтурEDI_Сообщения.Документ
			И (НЕ КонтурEDI_Сообщения.Статус В (&amp;БлокирующиеСтатусыПервичногоINVOIC))
			И (КонтурEDI_Сообщения.ТипСообщения = "COINVOIC"
				ИЛИ КонтурEDI_Сообщения.ТипСообщения = "INVOIC")
ГДЕ
	ВЫБОР
			КОГДА &amp;ТолькоТребуемые
				ТОГДА КонтурEDI_Сообщения.Ссылка ЕСТЬ НЕ NULL 
			ИНАЧЕ ИСТИНА
		КОНЕЦ
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ РАЗРЕШЕННЫЕ
	табКорректировки.Корректировка,
	табКорректировки.Документ,
	табКорректировки.ТребуемоеДействие,
	табКорректировки.ТипСообщения,
	табРазрешенийНаОтправку.Сообщение,
	табКорректировки.Партнер,
	табРазрешенийНаОтправку.ПредыдущийДокумент
ПОМЕСТИТЬ ВТ_КоррИспрСФ
ИЗ
	табКорректировки КАК табКорректировки
		ЛЕВОЕ СОЕДИНЕНИЕ табРазрешенийНаОтправку КАК табРазрешенийНаОтправку
		ПО табКорректировки.Корректировка = табРазрешенийНаОтправку.Корректировка
ГДЕ
	ВЫБОР
			КОГДА &amp;ТолькоТребуемые
				ТОГДА табРазрешенийНаОтправку.Корректировка ЕСТЬ НЕ NULL 
			ИНАЧЕ ИСТИНА
		КОНЕЦ
;

////////////////////////////////////////////////////////////////////////////////
УНИЧТОЖИТЬ табКорректировки
;

////////////////////////////////////////////////////////////////////////////////
УНИЧТОЖИТЬ табПредыдущихДокументов
;

////////////////////////////////////////////////////////////////////////////////
УНИЧТОЖИТЬ табРазрешенийНаОтправку</query>
				</item>
				<item xsi:type="DataSetQuery">
					<name>Реализация</name>
					<dataSource>ИсточникДанных1</dataSource>
					<query>ВЫБРАТЬ РАЗРЕШЕННЫЕ
	докКорректировка.Ссылка КАК Корректировка,
	ВЫБОР
		КОГДА НЕ докКорректировка.Проведен
			ТОГДА докКорректировка.Ссылка
		КОГДА докКорректировка.ВидОперации &lt;&gt; ЗНАЧЕНИЕ(Перечисление.ВидыОперацийИсправленияПоступленияРеализации.СогласованноеИзменение)
			ТОГДА ЕСТЬNULL(докСчетФактура.Ссылка, докКорректировка.Ссылка)
		ИНАЧЕ докКорректировка.Ссылка
	КОНЕЦ КАК Документ,
	ВЫБОР
		КОГДА НЕ докКорректировка.Проведен
			ТОГДА "Провести Корректировка реализации"
		КОГДА докКорректировка.ВидОперации &lt;&gt; ЗНАЧЕНИЕ(Перечисление.ВидыОперацийИсправленияПоступленияРеализации.СогласованноеИзменение)
			ТОГДА ВЫБОР
					КОГДА докСчетФактура.Ссылка ЕСТЬ NULL 
						ТОГДА "Создать Счет-фактура по корректировке"
					КОГДА НЕ докСчетФактура.Ссылка.Проведен И &amp;ТребуетсяПроведениеCOINVOIC
						ТОГДА "Провести Счет-фактура по корректировке"
					ИНАЧЕ "Отправить счет-фактуру"
				КОНЕЦ
		ИНАЧЕ "Отправить корректировочный счет-фактуру"
	КОНЕЦ КАК ТребуемоеДействие,
	ВЫБОР
		КОГДА докКорректировка.ВидОперации = ЗНАЧЕНИЕ(Перечисление.ВидыОперацийИсправленияПоступленияРеализации.СогласованноеИзменение)
			ТОГДА "COINVOIC"
		КОГДА докСчетФактура.Ссылка.ВидСчетаФактуры &lt;&gt; ЗНАЧЕНИЕ(Перечисление.ВидСчетаФактурыВыставленного.Корректировочный)
			ТОГДА "INVOIC"
		ИНАЧЕ "COINVOIC"
	КОНЕЦ КАК ТипСообщения,
	докКорректировка.ДокументРеализации,
	ТаблицаКэшПартнеровКонтрагентов.Партнер
ПОМЕСТИТЬ табКорректировки
ИЗ
	ТаблицаКэшПартнеровКонтрагентов КАК ТаблицаКэшПартнеровКонтрагентов
		ВНУТРЕННЕЕ СОЕДИНЕНИЕ Документ.КорректировкаРеализации КАК докКорректировка
			ЛЕВОЕ СОЕДИНЕНИЕ Документ.СчетФактураВыданный.ДокументыОснования КАК докСчетФактура
			ПО докКорректировка.Ссылка = докСчетФактура.ДокументОснование
				И (докСчетФактура.Ссылка.ПометкаУдаления = ЛОЖЬ)
		ПО ТаблицаКэшПартнеровКонтрагентов.Контрагент = докКорректировка.Контрагент
			И (ТаблицаКэшПартнеровКонтрагентов.COINVOIC = ИСТИНА)
ГДЕ
	НЕ докКорректировка.ПометкаУдаления
	И докКорректировка.Дата МЕЖДУ &amp;НачалоПериода И &amp;КонецПериода
	И (докКорректировка.ДокументРеализации ССЫЛКА Документ.РеализацияТоваровУслуг
			ИЛИ докКорректировка.ДокументРеализации ССЫЛКА Документ.КорректировкаРеализации)
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ РАЗРЕШЕННЫЕ
	табКорректировки.Корректировка,
	табКорректировки.Документ,
	табКорректировки.ТребуемоеДействие,
	табКорректировки.ТипСообщения,
	табКорректировки.ДокументРеализации,
	табКорректировки.Партнер
ПОМЕСТИТЬ табКорректировкиИСообщения
ИЗ
	табКорректировки КАК табКорректировки
		ЛЕВОЕ СОЕДИНЕНИЕ Справочник.КонтурEDI_Сообщения КАК КонтурEDI_Сообщения
		ПО табКорректировки.Документ = КонтурEDI_Сообщения.Документ
			И (КонтурEDI_Сообщения.ТипСообщения = "COINVOIC"
				ИЛИ КонтурEDI_Сообщения.ТипСообщения = "INVOIC")
ГДЕ
	ВЫБОР
			КОГДА &amp;ТолькоТребуемые
				ТОГДА КонтурEDI_Сообщения.Ссылка ЕСТЬ NULL 
			ИНАЧЕ ИСТИНА
		КОНЕЦ
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ РАЗРЕШЕННЫЕ
	табКорректировкиИСообщения.Корректировка,
	ЕСТЬNULL(СчетФактураВыданныйДокументыОснования.Ссылка, табКорректировкиИСообщения.ДокументРеализации) КАК ПредыдущийДокумент
ПОМЕСТИТЬ табПредыдущихДокументов
ИЗ
	табКорректировкиИСообщения КАК табКорректировкиИСообщения
		ЛЕВОЕ СОЕДИНЕНИЕ Документ.СчетФактураВыданный.ДокументыОснования КАК СчетФактураВыданныйДокументыОснования
		ПО табКорректировкиИСообщения.ДокументРеализации = СчетФактураВыданныйДокументыОснования.ДокументОснование
			И (НЕ табКорректировкиИСообщения.ДокументРеализации ССЫЛКА Документ.РеализацияТоваровУслуг)
			И (НЕ табКорректировкиИСообщения.ДокументРеализации.ВидОперации = ЗНАЧЕНИЕ(Перечисление.ВидыОперацийИсправленияПоступленияРеализации.СогласованноеИзменение))
ГДЕ
	(табКорректировкиИСообщения.ДокументРеализации ССЫЛКА Документ.РеализацияТоваровУслуг
			ИЛИ табКорректировкиИСообщения.ДокументРеализации.ВидОперации = ЗНАЧЕНИЕ(Перечисление.ВидыОперацийИсправленияПоступленияРеализации.СогласованноеИзменение)
			ИЛИ СчетФактураВыданныйДокументыОснования.Ссылка ЕСТЬ НЕ NULL )
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ РАЗРЕШЕННЫЕ
	КонтурEDI_Сообщения.Ссылка КАК Сообщение,
	табПредыдущихДокументов.Корректировка,
	табПредыдущихДокументов.ПредыдущийДокумент
ПОМЕСТИТЬ табРазрешенийНаОтправку
ИЗ
	табПредыдущихДокументов КАК табПредыдущихДокументов
		ЛЕВОЕ СОЕДИНЕНИЕ Справочник.КонтурEDI_Сообщения КАК КонтурEDI_Сообщения
		ПО табПредыдущихДокументов.ПредыдущийДокумент = КонтурEDI_Сообщения.Документ
			И (НЕ КонтурEDI_Сообщения.Статус В (&amp;БлокирующиеСтатусыПервичногоINVOIC))
			И (КонтурEDI_Сообщения.ТипСообщения = "COINVOIC"
				ИЛИ КонтурEDI_Сообщения.ТипСообщения = "INVOIC")
ГДЕ
	ВЫБОР
			КОГДА &amp;ТолькоТребуемые
				ТОГДА КонтурEDI_Сообщения.Ссылка ЕСТЬ НЕ NULL 
			ИНАЧЕ ИСТИНА
		КОНЕЦ
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ РАЗРЕШЕННЫЕ
	табКорректировкиИСообщения.Корректировка,
	табКорректировкиИСообщения.Документ,
	табКорректировкиИСообщения.ТребуемоеДействие,
	табКорректировкиИСообщения.ТипСообщения,
	табРазрешенийНаОтправку.Сообщение,
	табКорректировкиИСообщения.Партнер,
	табРазрешенийНаОтправку.ПредыдущийДокумент
ПОМЕСТИТЬ ВТ_КоррИспрСФ
ИЗ
	табКорректировкиИСообщения КАК табКорректировкиИСообщения
		ЛЕВОЕ СОЕДИНЕНИЕ табРазрешенийНаОтправку КАК табРазрешенийНаОтправку
		ПО табКорректировкиИСообщения.Корректировка = табРазрешенийНаОтправку.Корректировка
ГДЕ
	ВЫБОР
			КОГДА &amp;ТолькоТребуемые
				ТОГДА табРазрешенийНаОтправку.Корректировка ЕСТЬ НЕ NULL 
			ИНАЧЕ ИСТИНА
		КОНЕЦ
;

////////////////////////////////////////////////////////////////////////////////
УНИЧТОЖИТЬ табКорректировки
;

////////////////////////////////////////////////////////////////////////////////
УНИЧТОЖИТЬ табПредыдущихДокументов
;

////////////////////////////////////////////////////////////////////////////////
УНИЧТОЖИТЬ табРазрешенийНаОтправку
;

////////////////////////////////////////////////////////////////////////////////
УНИЧТОЖИТЬ табКорректировкиИСообщения</query>
				</item>
				<item xsi:type="DataSetQuery">
					<name>Счет_Реализация_СФ</name>
					<dataSource>ИсточникДанных1</dataSource>
					<query>ВЫБРАТЬ РАЗРЕШЕННЫЕ
	докКорректировка.Ссылка КАК Корректировка,
	ВЫБОР
		КОГДА НЕ докКорректировка.Проведен
			ТОГДА докКорректировка.Ссылка
		ИНАЧЕ ЕСТЬNULL(докСчетФактура.Ссылка, докКорректировка.Ссылка)
	КОНЕЦ КАК Документ,
	ВЫБОР
		КОГДА НЕ докКорректировка.Проведен
			ТОГДА "Провести Корректировка реализации"
		КОГДА докСчетФактура.Ссылка ЕСТЬ NULL 
			ТОГДА "Создать Счет-фактура по корректировке"
		КОГДА НЕ докСчетФактура.Ссылка.Проведен И &amp;ТребуетсяПроведениеCOINVOIC
			ТОГДА "Провести Счет-фактура по корректировке" 
		КОГДА докСчетФактура.Ссылка.ВидСчетаФактуры &lt;&gt; ЗНАЧЕНИЕ(Перечисление.ВидСчетаФактурыВыставленного.Корректировочный)
			ТОГДА "Отправить счет-фактуру"
		ИНАЧЕ "Отправить корректировочный счет-фактуру"
	КОНЕЦ КАК ТребуемоеДействие,
	ВЫБОР
		КОГДА докСчетФактура.Ссылка.ВидСчетаФактуры &lt;&gt; ЗНАЧЕНИЕ(Перечисление.ВидСчетаФактурыВыставленного.Корректировочный)
			ТОГДА "INVOIC"
		ИНАЧЕ "COINVOIC"
	КОНЕЦ КАК ТипСообщения,
	докКорректировка.ДокументРеализации,
	ТаблицаКэшПартнеровКонтрагентов.Партнер
ПОМЕСТИТЬ табКорректировки
ИЗ
	ТаблицаКэшПартнеровКонтрагентов КАК ТаблицаКэшПартнеровКонтрагентов
		ВНУТРЕННЕЕ СОЕДИНЕНИЕ Документ.КорректировкаРеализации КАК докКорректировка
			ЛЕВОЕ СОЕДИНЕНИЕ Документ.СчетФактураВыданный.ДокументыОснования КАК докСчетФактура
				ЛЕВОЕ СОЕДИНЕНИЕ Справочник.КонтурEDI_Сообщения КАК КонтурEDI_Сообщения
				ПО (КонтурEDI_Сообщения.Документ = докСчетФактура.Ссылка)
					И (КонтурEDI_Сообщения.ТипСообщения = "COINVOIC"
						ИЛИ КонтурEDI_Сообщения.ТипСообщения = "INVOIC")
			ПО докКорректировка.Ссылка = докСчетФактура.ДокументОснование
				И (докСчетФактура.Ссылка.ПометкаУдаления = ЛОЖЬ)
		ПО ТаблицаКэшПартнеровКонтрагентов.Контрагент = докКорректировка.Контрагент
			И (ТаблицаКэшПартнеровКонтрагентов.COINVOIC = ИСТИНА)
ГДЕ
	НЕ докКорректировка.ПометкаУдаления
	И докКорректировка.Дата МЕЖДУ &amp;НачалоПериода И &amp;КонецПериода
	И (докКорректировка.ДокументРеализации ССЫЛКА Документ.РеализацияТоваровУслуг
			ИЛИ докКорректировка.ДокументРеализации ССЫЛКА Документ.КорректировкаРеализации)
	И ВЫБОР
			КОГДА &amp;ТолькоТребуемые
				ТОГДА КонтурEDI_Сообщения.Ссылка ЕСТЬ NULL 
			ИНАЧЕ ИСТИНА
		КОНЕЦ
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ РАЗРЕШЕННЫЕ
	табКорректировки.Корректировка,
	ЕСТЬNULL(СчетФактураВыданныйДокументыОснования.Ссылка, табКорректировки.ДокументРеализации) КАК ПредыдущийДокумент
ПОМЕСТИТЬ табПредыдущихДокументов
ИЗ
	табКорректировки КАК табКорректировки
		ВНУТРЕННЕЕ СОЕДИНЕНИЕ Документ.СчетФактураВыданный.ДокументыОснования КАК СчетФактураВыданныйДокументыОснования
		ПО табКорректировки.ДокументРеализации = СчетФактураВыданныйДокументыОснования.ДокументОснование
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ РАЗРЕШЕННЫЕ
	КонтурEDI_Сообщения.Ссылка КАК Сообщение,
	табПредыдущихДокументов.Корректировка,
	табПредыдущихДокументов.ПредыдущийДокумент
ПОМЕСТИТЬ табРазрешенийНаОтправку
ИЗ
	табПредыдущихДокументов КАК табПредыдущихДокументов
		ЛЕВОЕ СОЕДИНЕНИЕ Справочник.КонтурEDI_Сообщения КАК КонтурEDI_Сообщения
		ПО табПредыдущихДокументов.ПредыдущийДокумент = КонтурEDI_Сообщения.Документ
			И (НЕ КонтурEDI_Сообщения.Статус В (&amp;БлокирующиеСтатусыПервичногоINVOIC))
			И (КонтурEDI_Сообщения.ТипСообщения = "COINVOIC"
				ИЛИ КонтурEDI_Сообщения.ТипСообщения = "INVOIC")
ГДЕ
	ВЫБОР
			КОГДА &amp;ТолькоТребуемые
				ТОГДА КонтурEDI_Сообщения.Ссылка ЕСТЬ НЕ NULL 
			ИНАЧЕ ИСТИНА
		КОНЕЦ
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ РАЗРЕШЕННЫЕ
	табКорректировки.Корректировка,
	табКорректировки.Документ,
	табКорректировки.ТребуемоеДействие,
	табКорректировки.ТипСообщения,
	табРазрешенийНаОтправку.Сообщение,
	табКорректировки.Партнер,
	табРазрешенийНаОтправку.ПредыдущийДокумент
ПОМЕСТИТЬ ВТ_КоррИспрСФ
ИЗ
	табКорректировки КАК табКорректировки
		ЛЕВОЕ СОЕДИНЕНИЕ табРазрешенийНаОтправку КАК табРазрешенийНаОтправку
		ПО табКорректировки.Корректировка = табРазрешенийНаОтправку.Корректировка
ГДЕ
	ВЫБОР
			КОГДА &amp;ТолькоТребуемые
				ТОГДА табРазрешенийНаОтправку.Корректировка ЕСТЬ НЕ NULL 
			ИНАЧЕ ИСТИНА
		КОНЕЦ
;

////////////////////////////////////////////////////////////////////////////////
УНИЧТОЖИТЬ табКорректировки
;

////////////////////////////////////////////////////////////////////////////////
УНИЧТОЖИТЬ табПредыдущихДокументов
;

////////////////////////////////////////////////////////////////////////////////
УНИЧТОЖИТЬ табРазрешенийНаОтправку</query>
				</item>
				<item xsi:type="DataSetQuery">
					<name>Счет_Реализация</name>
					<dataSource>ИсточникДанных1</dataSource>
					<query>ВЫБРАТЬ РАЗРЕШЕННЫЕ
	докКорректировка.Ссылка КАК Корректировка,
	ВЫБОР
		КОГДА НЕ докКорректировка.Проведен
			ТОГДА докКорректировка.Ссылка
		КОГДА докКорректировка.ВидОперации &lt;&gt; ЗНАЧЕНИЕ(Перечисление.ВидыОперацийИсправленияПоступленияРеализации.СогласованноеИзменение)
			ТОГДА ЕСТЬNULL(докСчетФактура.Ссылка, докКорректировка.Ссылка)
		ИНАЧЕ докКорректировка.Ссылка
	КОНЕЦ КАК Документ,
	ВЫБОР
		КОГДА НЕ докКорректировка.Проведен
			ТОГДА "Провести Корректировка реализации"
		КОГДА докКорректировка.ВидОперации &lt;&gt; ЗНАЧЕНИЕ(Перечисление.ВидыОперацийИсправленияПоступленияРеализации.СогласованноеИзменение)
			ТОГДА ВЫБОР
					КОГДА докСчетФактура.Ссылка ЕСТЬ NULL 
						ТОГДА "Создать Счет-фактура по корректировке"
					КОГДА НЕ докСчетФактура.Ссылка.Проведен И &amp;ТребуетсяПроведениеCOINVOIC
						ТОГДА "Провести Счет-фактура по корректировке"
					ИНАЧЕ "Отправить счет-фактуру"
				КОНЕЦ
		ИНАЧЕ "Отправить корректировочный счет-фактуру"
	КОНЕЦ КАК ТребуемоеДействие,
	ВЫБОР
		КОГДА докКорректировка.ВидОперации = ЗНАЧЕНИЕ(Перечисление.ВидыОперацийИсправленияПоступленияРеализации.СогласованноеИзменение)
			ТОГДА "COINVOIC"
		КОГДА докСчетФактура.Ссылка.ВидСчетаФактуры &lt;&gt; ЗНАЧЕНИЕ(Перечисление.ВидСчетаФактурыВыставленного.Корректировочный)
			ТОГДА "INVOIC"
		ИНАЧЕ "COINVOIC"
	КОНЕЦ КАК ТипСообщения,
	докКорректировка.ДокументРеализации,
	ТаблицаКэшПартнеровКонтрагентов.Партнер
ПОМЕСТИТЬ табКорректировки
ИЗ
	ТаблицаКэшПартнеровКонтрагентов КАК ТаблицаКэшПартнеровКонтрагентов
		ВНУТРЕННЕЕ СОЕДИНЕНИЕ Документ.КорректировкаРеализации КАК докКорректировка
			ЛЕВОЕ СОЕДИНЕНИЕ Документ.СчетФактураВыданный.ДокументыОснования КАК докСчетФактура
			ПО докКорректировка.Ссылка = докСчетФактура.ДокументОснование
				И (докСчетФактура.Ссылка.ПометкаУдаления = ЛОЖЬ)
		ПО ТаблицаКэшПартнеровКонтрагентов.Контрагент = докКорректировка.Контрагент
			И (ТаблицаКэшПартнеровКонтрагентов.COINVOIC = ИСТИНА)
ГДЕ
	НЕ докКорректировка.ПометкаУдаления
	И докКорректировка.Дата МЕЖДУ &amp;НачалоПериода И &amp;КонецПериода
	И (докКорректировка.ДокументРеализации ССЫЛКА Документ.РеализацияТоваровУслуг
			ИЛИ докКорректировка.ДокументРеализации ССЫЛКА Документ.КорректировкаРеализации)
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ РАЗРЕШЕННЫЕ
	табКорректировки.Корректировка,
	табКорректировки.Документ,
	табКорректировки.ТребуемоеДействие,
	табКорректировки.ТипСообщения,
	табКорректировки.ДокументРеализации,
	табКорректировки.Партнер
ПОМЕСТИТЬ табКорректировкиИСообщения
ИЗ
	табКорректировки КАК табКорректировки
		ЛЕВОЕ СОЕДИНЕНИЕ Справочник.КонтурEDI_Сообщения КАК КонтурEDI_Сообщения
		ПО табКорректировки.Документ = КонтурEDI_Сообщения.Документ
			И (КонтурEDI_Сообщения.ТипСообщения = "COINVOIC"
				ИЛИ КонтурEDI_Сообщения.ТипСообщения = "INVOIC")
ГДЕ
	ВЫБОР
			КОГДА &amp;ТолькоТребуемые
				ТОГДА КонтурEDI_Сообщения.Ссылка ЕСТЬ NULL 
			ИНАЧЕ ИСТИНА
		КОНЕЦ
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ РАЗРЕШЕННЫЕ
	табКорректировкиИСообщения.Корректировка,
	ЕСТЬNULL(СчетФактураВыданныйДокументыОснования.Ссылка, табКорректировкиИСообщения.ДокументРеализации) КАК ПредыдущийДокумент
ПОМЕСТИТЬ табПредыдущихДокументов
ИЗ
	табКорректировкиИСообщения КАК табКорректировкиИСообщения
		ЛЕВОЕ СОЕДИНЕНИЕ Документ.СчетФактураВыданный.ДокументыОснования КАК СчетФактураВыданныйДокументыОснования
		ПО табКорректировкиИСообщения.ДокументРеализации = СчетФактураВыданныйДокументыОснования.ДокументОснование
			И (НЕ табКорректировкиИСообщения.ДокументРеализации ССЫЛКА Документ.РеализацияТоваровУслуг)
			И (НЕ табКорректировкиИСообщения.ДокументРеализации.ВидОперации = ЗНАЧЕНИЕ(Перечисление.ВидыОперацийИсправленияПоступленияРеализации.СогласованноеИзменение))
ГДЕ
	(табКорректировкиИСообщения.ДокументРеализации ССЫЛКА Документ.РеализацияТоваровУслуг
			ИЛИ табКорректировкиИСообщения.ДокументРеализации.ВидОперации = ЗНАЧЕНИЕ(Перечисление.ВидыОперацийИсправленияПоступленияРеализации.СогласованноеИзменение)
			ИЛИ СчетФактураВыданныйДокументыОснования.Ссылка ЕСТЬ НЕ NULL )
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ РАЗРЕШЕННЫЕ
	КонтурEDI_Сообщения.Ссылка КАК Сообщение,
	табПредыдущихДокументов.Корректировка,
	табПредыдущихДокументов.ПредыдущийДокумент
ПОМЕСТИТЬ табРазрешенийНаОтправку
ИЗ
	табПредыдущихДокументов КАК табПредыдущихДокументов
		ЛЕВОЕ СОЕДИНЕНИЕ Справочник.КонтурEDI_Сообщения КАК КонтурEDI_Сообщения
		ПО табПредыдущихДокументов.ПредыдущийДокумент = КонтурEDI_Сообщения.Документ
			И (НЕ КонтурEDI_Сообщения.Статус В (&amp;БлокирующиеСтатусыПервичногоINVOIC))
			И (КонтурEDI_Сообщения.ТипСообщения = "COINVOIC"
				ИЛИ КонтурEDI_Сообщения.ТипСообщения = "INVOIC")
ГДЕ
	ВЫБОР
			КОГДА &amp;ТолькоТребуемые
				ТОГДА КонтурEDI_Сообщения.Ссылка ЕСТЬ НЕ NULL 
			ИНАЧЕ ИСТИНА
		КОНЕЦ
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ РАЗРЕШЕННЫЕ
	табКорректировкиИСообщения.Корректировка,
	табКорректировкиИСообщения.Документ,
	табКорректировкиИСообщения.ТребуемоеДействие,
	табКорректировкиИСообщения.ТипСообщения,
	табРазрешенийНаОтправку.Сообщение,
	табКорректировкиИСообщения.Партнер,
	табРазрешенийНаОтправку.ПредыдущийДокумент
ПОМЕСТИТЬ ВТ_КоррИспрСФ
ИЗ
	табКорректировкиИСообщения КАК табКорректировкиИСообщения
		ЛЕВОЕ СОЕДИНЕНИЕ табРазрешенийНаОтправку КАК табРазрешенийНаОтправку
		ПО табКорректировкиИСообщения.Корректировка = табРазрешенийНаОтправку.Корректировка
ГДЕ
	ВЫБОР
			КОГДА &amp;ТолькоТребуемые
				ТОГДА табРазрешенийНаОтправку.Корректировка ЕСТЬ НЕ NULL 
			ИНАЧЕ ИСТИНА
		КОНЕЦ
;

////////////////////////////////////////////////////////////////////////////////
УНИЧТОЖИТЬ табКорректировки
;

////////////////////////////////////////////////////////////////////////////////
УНИЧТОЖИТЬ табПредыдущихДокументов
;

////////////////////////////////////////////////////////////////////////////////
УНИЧТОЖИТЬ табРазрешенийНаОтправку
;

////////////////////////////////////////////////////////////////////////////////
УНИЧТОЖИТЬ табКорректировкиИСообщения</query>
				</item>
			</item>
		</item>
		<item xsi:type="DataSetUnion">
			<name>Покупатель</name>
			<item xsi:type="DataSetUnion">
				<name>ЗапросОсновнойЦепочки</name>
				<item xsi:type="DataSetQuery">
					<name>ПоступлениеТоваровУслуг_СФ</name>
					<dataSource>ИсточникДанных1</dataSource>
					<query>ВЫБРАТЬ
	ПоступлениеТоваровУслуг.Ссылка КАК PORDERS,
	ПоступлениеТоваровУслуг.Ссылка КАК ORDERS,
	ПоступлениеТоваровУслуг.Ссылка КАК ORDRSP,
	ПоступлениеТоваровУслуг.Ссылка КАК DESADV,
	ПоступлениеТоваровУслуг.Ссылка КАК RECADV,
	СчетФактураПолученный.Ссылка КАК INVOIC
ИЗ
	(ВЫБРАТЬ
		1 КАК Поле1) КАК Заглушка
		{ПОЛНОЕ СОЕДИНЕНИЕ Документ.СчетФактураПолученный КАК СчетФактураПолученный
			{ПОЛНОЕ СОЕДИНЕНИЕ Документ.ПоступлениеТоваровУслуг КАК ПоступлениеТоваровУслуг
			ПО СчетФактураПолученный.ДокументОснование = ПоступлениеТоваровУслуг.Ссылка}
		ПО (ИСТИНА)}</query>
					<autoFillFields>false</autoFillFields>
				</item>
			</item>
			<item xsi:type="DataSetUnion">
				<name>ЗапросПоТоварам</name>
				<item xsi:type="DataSetUnion">
					<name>_ORDERS_</name>
					<item xsi:type="DataSetQuery">
						<name>ПоступлениеТоваровУслуг</name>
						<dataSource>ИсточникДанных1</dataSource>
						<query>ВЫБРАТЬ
	ПоступлениеТоваровУслугТовары.Номенклатура,
	НЕОПРЕДЕЛЕНО КАК ХарактеристикаНоменклатуры,
	ПоступлениеТоваровУслугТовары.ЕдиницаИзмерения КАК ЕдиницаИзмерения,
	ПоступлениеТоваровУслугТовары.ЕдиницаИзмерения.Наименование КАК КодЕдиницыИзмерения,
	ВЫРАЗИТЬ(ПоступлениеТоваровУслугТовары.Номенклатура.Наименование КАК СТРОКА(178)) КАК Наименование,
	ПоступлениеТоваровУслугТовары.Количество КАК Количество,
	ПоступлениеТоваровУслугТовары.Цена,
	ПоступлениеТоваровУслугТовары.СтавкаНДС,
	ПоступлениеТоваровУслугТовары.Сумма,
	ПоступлениеТоваровУслугТовары.СуммаНДС
ИЗ
	Документ.ПоступлениеТоваровУслуг.Товары КАК ПоступлениеТоваровУслугТовары
ГДЕ
	ПоступлениеТоваровУслугТовары.Ссылка = &amp;Ссылка</query>
						<autoFillFields>false</autoFillFields>
					</item>
				</item>
				<item xsi:type="DataSetUnion">
					<name>_RECADV_</name>
					<item xsi:type="DataSetQuery">
						<name>ПоступлениеТоваровУслуг</name>
						<dataSource>ИсточникДанных1</dataSource>
						<query>ВЫБРАТЬ
	ПоступлениеТоваровУслугТовары.Номенклатура,
	НЕОПРЕДЕЛЕНО КАК ХарактеристикаНоменклатуры,
	ПоступлениеТоваровУслугТовары.ЕдиницаИзмерения КАК ЕдиницаИзмерения,
	ПоступлениеТоваровУслугТовары.ЕдиницаИзмерения.Наименование КАК КодЕдиницыИзмерения,
	ВЫРАЗИТЬ(ПоступлениеТоваровУслугТовары.Номенклатура.Наименование КАК СТРОКА(178)) КАК Наименование,
	ПоступлениеТоваровУслугТовары.Количество КАК Количество,
	ПоступлениеТоваровУслугТовары.Цена,
	ПоступлениеТоваровУслугТовары.СтавкаНДС,
	ПоступлениеТоваровУслугТовары.Сумма,
	ПоступлениеТоваровУслугТовары.СуммаНДС
ИЗ
	Документ.ПоступлениеТоваровУслуг.Товары КАК ПоступлениеТоваровУслугТовары
ГДЕ
	ПоступлениеТоваровУслугТовары.Ссылка = &amp;Ссылка</query>
						<autoFillFields>false</autoFillFields>
					</item>
				</item>
			</item>
			<item xsi:type="DataSetQuery">
				<name>КонвертироватьТоварыEDIВ1С</name>
				<dataSource>ИсточникДанных1</dataSource>
				<query>ВЫБРАТЬ
	ТабТоваров.GTIN КАК GTIN,
	ТабТоваров.КодТовараСторонний КАК КодТовараСторонний,
	ТабТоваров.КодТовараСвой КАК КодТовараСвой,
	ТабСоответствий_КонтурEDI.Номенклатура КАК Номенклатура,
	ТабСоответствий_КонтурEDI.ХарактеристикаНоменклатуры КАК ХарактеристикаНоменклатуры,
	ТабСоответствий_КонтурEDI.ЕдиницаИзмерения КАК ЕдиницаИзмерения,
	ТабСоответствий_КонтурEDI.ТипЕдиницы КАК ТипЕдиницы,
	3 КАК Приоритет
ПОМЕСТИТЬ ВТ_НайденныеСоответствия
ИЗ
	ТабТоваров КАК ТабТоваров
		ВНУТРЕННЕЕ СОЕДИНЕНИЕ ТабСоответствий_КонтурEDI КАК ТабСоответствий_КонтурEDI
		ПО ТабТоваров.GTIN = ТабСоответствий_КонтурEDI.GTIN
			И ТабТоваров.КодТовараСторонний = ТабСоответствий_КонтурEDI.КодТовараСторонний
			И ТабТоваров.КодТовараСвой = ТабСоответствий_КонтурEDI.КодТовараСвой

ОБЪЕДИНИТЬ ВСЕ

ВЫБРАТЬ
	ТабТоваров.GTIN,
	ТабТоваров.КодТовараСторонний,
	ТабТоваров.КодТовараСвой,
	СправочникНоменклатура.Ссылка,
	НЕОПРЕДЕЛЕНО,
	СправочникНоменклатура.БазоваяЕдиницаИзмерения,
	ВЫРАЗИТЬ(ВЫБОР
			КОГДА СправочникНоменклатура.Услуга = ИСТИНА
				ТОГДА "Services"
			ИНАЧЕ ""
		КОНЕЦ КАК СТРОКА(20)),
	2
ИЗ
	ТабТоваров КАК ТабТоваров
		ВНУТРЕННЕЕ СОЕДИНЕНИЕ Справочник.Номенклатура КАК СправочникНоменклатура
		ПО ТабТоваров.КодТовараСвой = СправочникНоменклатура.Код
ГДЕ
	НЕ ТабТоваров.КодТовараСвой = ""</query>
				<autoFillFields>false</autoFillFields>
			</item>
			<item xsi:type="DataSetQuery">
				<name>КонвертироватьТовары1СВEDIВ_GTIN</name>
				<dataSource>ИсточникДанных1</dataSource>
				<query>ВЫБРАТЬ
	ТабТоваров.Номенклатура,
	ТабТоваров.ХарактеристикаНоменклатуры,
	ТабТоваров.ЕдиницаИзмерения,
	ВЫРАЗИТЬ(ТабТоваров.Номенклатура.Код КАК СТРОКА) КАК КодТовараСвой,
	"" КАК GTIN
ПОМЕСТИТЬ ВТШтрихкодыТоваров
ИЗ
	ТабТоваров КАК ТабТоваров

ИНДЕКСИРОВАТЬ ПО
	ТабТоваров.Номенклатура,
	ТабТоваров.ХарактеристикаНоменклатуры,
	ТабТоваров.ЕдиницаИзмерения</query>
				<autoFillFields>false</autoFillFields>
			</item>
		</item>
	</dataSet>
	<dataSet xsi:type="DataSetUnion">
		<name>БСХП_20</name>
		<item xsi:type="DataSetUnion">
			<name>Поставщик</name>
			<item xsi:type="DataSetUnion">
				<name>ЗапросОсновнойЦепочки</name>
				<item xsi:type="DataSetQuery">
					<name>Реализация_СФ</name>
					<dataSource>ИсточникДанных1</dataSource>
					<query>ВЫБРАТЬ
	РеализацияТоваровУслуг.Ссылка КАК PORDERS,
	РеализацияТоваровУслуг.Ссылка КАК ORDERS,
	РеализацияТоваровУслуг.Ссылка КАК ORDRSP,
	РеализацияТоваровУслуг.Ссылка КАК DESADV,
	РеализацияТоваровУслуг.Ссылка КАК RECADV,
	СчетФактураВыданный.Ссылка КАК INVOIC
ИЗ
	(ВЫБРАТЬ
		1 КАК Поле1) КАК Заглушка
		{ПОЛНОЕ СОЕДИНЕНИЕ Документ.СчетФактураВыданный.ДокументыОснования КАК СчетФактураВыданный
			{ПОЛНОЕ СОЕДИНЕНИЕ Документ.РеализацияТоваровУслуг КАК РеализацияТоваровУслуг
			ПО (СчетФактураВыданный.ДокументОснование = РеализацияТоваровУслуг.Ссылка)}
		ПО (ИСТИНА)}</query>
					<autoFillFields>false</autoFillFields>
				</item>
				<item xsi:type="DataSetQuery">
					<name>Реализация</name>
					<dataSource>ИсточникДанных1</dataSource>
					<query>ВЫБРАТЬ
	РеализацияТоваровУслуг.Ссылка КАК PORDERS,
	РеализацияТоваровУслуг.Ссылка КАК ORDERS,
	РеализацияТоваровУслуг.Ссылка КАК ORDRSP,
	РеализацияТоваровУслуг.Ссылка КАК DESADV,
	РеализацияТоваровУслуг.Ссылка КАК RECADV,
	РеализацияТоваровУслуг.Ссылка КАК INVOIC
ИЗ
	(ВЫБРАТЬ
		1 КАК Поле1) КАК Заглушка
		{ПОЛНОЕ СОЕДИНЕНИЕ Документ.РеализацияТоваровУслуг КАК РеализацияТоваровУслуг
		ПО (ИСТИНА)}</query>
					<autoFillFields>false</autoFillFields>
				</item>
				<item xsi:type="DataSetQuery">
					<name>Счет_Реализация_СФ</name>
					<dataSource>ИсточникДанных1</dataSource>
					<query>ВЫБРАТЬ
	докСчетНаОплатуПокупателю.Ссылка КАК PORDERS,
	докСчетНаОплатуПокупателю.Ссылка КАК ORDERS,
	докСчетНаОплатуПокупателю.Ссылка КАК ORDRSP,
	докРеализацияТоваровУслуг.Ссылка КАК DESADV,
	докРеализацияТоваровУслуг.Ссылка КАК RECADV,
	СчетФактураВыданный.Ссылка КАК INVOIC
ИЗ
	(ВЫБРАТЬ
		1 КАК Поле1) КАК Заглушка
		{ПОЛНОЕ СОЕДИНЕНИЕ Документ.СчетФактураВыданный.ДокументыОснования КАК СчетФактураВыданный
			{ПОЛНОЕ СОЕДИНЕНИЕ Документ.РеализацияТоваровУслуг КАК докРеализацияТоваровУслуг
				{ПОЛНОЕ СОЕДИНЕНИЕ Документ.СчетНаОплатуПокупателю КАК докСчетНаОплатуПокупателю
				ПО докРеализацияТоваровУслуг.СчетНаОплатуПокупателю = докСчетНаОплатуПокупателю.Ссылка}
			ПО (СчетФактураВыданный.ДокументОснование = докРеализацияТоваровУслуг.Ссылка)}
		ПО (ИСТИНА)}</query>
					<autoFillFields>false</autoFillFields>
				</item>
				<item xsi:type="DataSetQuery">
					<name>Счет_Реализация</name>
					<dataSource>ИсточникДанных1</dataSource>
					<query>ВЫБРАТЬ
	докСчетНаОплатуПокупателю.Ссылка КАК PORDERS,
	докСчетНаОплатуПокупателю.Ссылка КАК ORDERS,
	докСчетНаОплатуПокупателю.Ссылка КАК ORDRSP,
	докРеализацияТоваровУслуг.Ссылка КАК DESADV,
	докРеализацияТоваровУслуг.Ссылка КАК RECADV,
	докРеализацияТоваровУслуг.Ссылка КАК INVOIC
ИЗ
	(ВЫБРАТЬ
		1 КАК Поле1) КАК Заглушка
		{ПОЛНОЕ СОЕДИНЕНИЕ Документ.РеализацияТоваровУслуг КАК докРеализацияТоваровУслуг
			{ПОЛНОЕ СОЕДИНЕНИЕ Документ.СчетНаОплатуПокупателю КАК докСчетНаОплатуПокупателю
			ПО докРеализацияТоваровУслуг.СчетНаОплатуПокупателю = докСчетНаОплатуПокупателю.Ссылка}
		ПО (ИСТИНА)}</query>
					<autoFillFields>false</autoFillFields>
				</item>
			</item>
			<item xsi:type="DataSetUnion">
				<name>ЗапросПоТоварам</name>
				<item xsi:type="DataSetUnion">
					<name>_PORDERS_ORDRSP_</name>
					<item xsi:type="DataSetQuery">
						<name>РеализацияТоваровУслуг</name>
						<dataSource>ИсточникДанных1</dataSource>
						<query>ВЫБРАТЬ
	РеализацияТоваровУслугТовары.НомерСтроки,
	РеализацияТоваровУслугТовары.Номенклатура,
	ВЫБОР
		КОГДА РеализацияТоваровУслугТовары.Номенклатура.Услуга
			ТОГДА РеализацияТоваровУслугТовары.Номенклатура.БазоваяЕдиницаИзмерения
		ИНАЧЕ РеализацияТоваровУслугТовары.ЕдиницаИзмерения
	КОНЕЦ КАК ЕдиницаИзмерения,
	ВЫБОР
		КОГДА РеализацияТоваровУслугТовары.Номенклатура.Услуга
			ТОГДА РеализацияТоваровУслугТовары.Номенклатура.БазоваяЕдиницаИзмерения.Наименование
		ИНАЧЕ РеализацияТоваровУслугТовары.ЕдиницаИзмерения.Наименование
	КОНЕЦ КАК КодЕдиницыИзмерения,
	ВЫРАЗИТЬ(РеализацияТоваровУслугТовары.Номенклатура.Наименование КАК СТРОКА(178)) КАК Наименование,
	ВЫРАЗИТЬ(РеализацияТоваровУслугТовары.Номенклатура.НаименованиеПолное КАК СТРОКА(500)) КАК НаименованиеПолное,
	Неопределено КАК ХарактеристикаНоменклатуры,
	Неопределено КАК СерияНоменклатуры,
	РеализацияТоваровУслугТовары.Цена,
	РеализацияТоваровУслугТовары.СтавкаНДС,
	РеализацияТоваровУслугТовары.СтранаПроисхождения КАК Страна,
	РеализацияТоваровУслугТовары.НомерГТД КАК НомерГТД,
	РеализацияТоваровУслугТовары.Количество КАК Количество,
	РеализацияТоваровУслугТовары.Сумма КАК Сумма,
	РеализацияТоваровУслугТовары.СуммаНДС КАК СуммаНДС,
	ВЫБОР
		КОГДА РеализацияТоваровУслугТовары.Номенклатура.Услуга
			ТОГДА "Services"
		ИНАЧЕ ""
	КОНЕЦ КАК ТипЕдиницы
ИЗ
	Документ.РеализацияТоваровУслуг.Товары КАК РеализацияТоваровУслугТовары
ГДЕ
	РеализацияТоваровУслугТовары.Ссылка В(&amp;Ссылка)
    И (НЕ РеализацияТоваровУслугТовары.Номенклатура.Услуга
			ИЛИ &amp;РаботаСУслугами)

ОБЪЕДИНИТЬ ВСЕ

ВЫБРАТЬ
	РеализацияТоваровУслугТовары.НомерСтроки,
	РеализацияТоваровУслугТовары.Номенклатура,
	РеализацияТоваровУслугТовары.Номенклатура.БазоваяЕдиницаИзмерения,
	РеализацияТоваровУслугТовары.Номенклатура.БазоваяЕдиницаИзмерения.Наименование,
	ВЫРАЗИТЬ(РеализацияТоваровУслугТовары.Номенклатура.Наименование КАК СТРОКА(178)),
	ВЫРАЗИТЬ(РеализацияТоваровУслугТовары.Номенклатура.НаименованиеПолное КАК СТРОКА(500)),
	Неопределено,
	Неопределено,
	РеализацияТоваровУслугТовары.Цена,
	РеализацияТоваровУслугТовары.СтавкаНДС,
	РеализацияТоваровУслугТовары.Номенклатура.СтранаПроисхождения,
	РеализацияТоваровУслугТовары.Номенклатура.НомерГТД,
	РеализацияТоваровУслугТовары.Количество,
	РеализацияТоваровУслугТовары.Сумма,
	РеализацияТоваровУслугТовары.СуммаНДС,
	"Services"
ИЗ
	Документ.РеализацияТоваровУслуг.Услуги КАК РеализацияТоваровУслугТовары
ГДЕ
	&amp;РаботаСУслугами
	И РеализацияТоваровУслугТовары.Ссылка В (&amp;Ссылка)

ОБЪЕДИНИТЬ ВСЕ

ВЫБРАТЬ
	0,
	ВозвратТоваровОтПокупателяТовары.Номенклатура,
	ВозвратТоваровОтПокупателяТовары.Номенклатура.БазоваяЕдиницаИзмерения,
	ВозвратТоваровОтПокупателяТовары.Номенклатура.БазоваяЕдиницаИзмерения.Наименование,
	ВЫРАЗИТЬ(ВозвратТоваровОтПокупателяТовары.Номенклатура.Наименование КАК СТРОКА(178)),
	ВЫРАЗИТЬ(ВозвратТоваровОтПокупателяТовары.Номенклатура.НаименованиеПолное КАК СТРОКА(500)),
	Неопределено,
	Неопределено,
	ВозвратТоваровОтПокупателяТовары.Цена,
	ВозвратТоваровОтПокупателяТовары.СтавкаНДС,
	ВозвратТоваровОтПокупателяТовары.СтранаПроисхождения,
	ВозвратТоваровОтПокупателяТовары.НомерГТД,
	-ВозвратТоваровОтПокупателяТовары.Количество,
	-ВозвратТоваровОтПокупателяТовары.Сумма,
	-ВозвратТоваровОтПокупателяТовары.СуммаНДС,
	""
ИЗ
	Документ.ВозвратТоваровОтПокупателя.Товары КАК ВозвратТоваровОтПокупателяТовары
ГДЕ
	ВозвратТоваровОтПокупателяТовары.Ссылка В(&amp;Возвраты)

ОБЪЕДИНИТЬ ВСЕ

ВЫБРАТЬ
	0,
	ВозвратТоваровОтПокупателяВозвратнаяТара.Номенклатура,
	ВозвратТоваровОтПокупателяВозвратнаяТара.Номенклатура.БазоваяЕдиницаИзмерения,
	ВозвратТоваровОтПокупателяВозвратнаяТара.Номенклатура.БазоваяЕдиницаИзмерения.Наименование,
	ВЫРАЗИТЬ(ВозвратТоваровОтПокупателяВозвратнаяТара.Номенклатура.Наименование КАК СТРОКА(178)),
	ВЫРАЗИТЬ(ВозвратТоваровОтПокупателяВозвратнаяТара.Номенклатура.НаименованиеПолное КАК СТРОКА(500)),
	Неопределено,
	Неопределено,
	ВозвратТоваровОтПокупателяВозвратнаяТара.Цена,
	ЗНАЧЕНИЕ(Перечисление.СтавкиНДС.БезНДС),
	ВозвратТоваровОтПокупателяВозвратнаяТара.Номенклатура.СтранаПроисхождения,
	ВозвратТоваровОтПокупателяВозвратнаяТара.Номенклатура.НомерГТД,
	-ВозвратТоваровОтПокупателяВозвратнаяТара.Количество,
	-ВозвратТоваровОтПокупателяВозвратнаяТара.Сумма,
	0,
	"RC"
ИЗ
	Документ.ВозвратТоваровОтПокупателя.ВозвратнаяТара КАК ВозвратТоваровОтПокупателяВозвратнаяТара
ГДЕ
	&amp;ОтправлятьВозвратнуюТару
	И ВозвратТоваровОтПокупателяВозвратнаяТара.Ссылка В(&amp;Возвраты)</query>
						<autoFillFields>false</autoFillFields>
					</item>
				</item>
				<item xsi:type="DataSetUnion">
					<name>_DESADV_INVOIC_</name>
					<item xsi:type="DataSetQuery">
						<name>РеализацияТоваровУслуг</name>
						<dataSource>ИсточникДанных1</dataSource>
						<query>ВЫБРАТЬ
	РеализацияТоваровУслугТовары.НомерСтроки,
	РеализацияТоваровУслугТовары.Номенклатура,
	ВЫБОР
		КОГДА РеализацияТоваровУслугТовары.Номенклатура.Услуга
			ТОГДА РеализацияТоваровУслугТовары.Номенклатура.БазоваяЕдиницаИзмерения
		ИНАЧЕ РеализацияТоваровУслугТовары.ЕдиницаИзмерения
	КОНЕЦ КАК ЕдиницаИзмерения,
	ВЫБОР
		КОГДА РеализацияТоваровУслугТовары.Номенклатура.Услуга
			ТОГДА РеализацияТоваровУслугТовары.Номенклатура.БазоваяЕдиницаИзмерения.Наименование
		ИНАЧЕ РеализацияТоваровУслугТовары.ЕдиницаИзмерения.Наименование
	КОНЕЦ КАК КодЕдиницыИзмерения,
	ВЫРАЗИТЬ(РеализацияТоваровУслугТовары.Номенклатура.Наименование КАК СТРОКА(178)) КАК Наименование,
	ВЫРАЗИТЬ(РеализацияТоваровУслугТовары.Номенклатура.НаименованиеПолное КАК СТРОКА(500)) КАК НаименованиеПолное,
	Неопределено КАК ХарактеристикаНоменклатуры,
	Неопределено КАК СерияНоменклатуры,
	РеализацияТоваровУслугТовары.Цена,
	РеализацияТоваровУслугТовары.СтавкаНДС,
	РеализацияТоваровУслугТовары.СтранаПроисхождения КАК Страна,
	РеализацияТоваровУслугТовары.НомерГТД КАК НомерГТД,
	РеализацияТоваровУслугТовары.Количество КАК Количество,
	РеализацияТоваровУслугТовары.Сумма КАК Сумма,
	РеализацияТоваровУслугТовары.СуммаНДС КАК СуммаНДС,
	ВЫБОР
		КОГДА РеализацияТоваровУслугТовары.Номенклатура.Услуга
			ТОГДА "Services"
		ИНАЧЕ ""
	КОНЕЦ КАК ТипЕдиницы
ИЗ
	Документ.РеализацияТоваровУслуг.Товары КАК РеализацияТоваровУслугТовары
ГДЕ
	РеализацияТоваровУслугТовары.Ссылка В(&amp;Ссылка)
    И (НЕ РеализацияТоваровУслугТовары.Номенклатура.Услуга
			ИЛИ &amp;РаботаСУслугами)

ОБЪЕДИНИТЬ ВСЕ

ВЫБРАТЬ
	РеализацияТоваровУслугТовары.НомерСтроки,
	РеализацияТоваровУслугТовары.Номенклатура,
	РеализацияТоваровУслугТовары.Номенклатура.БазоваяЕдиницаИзмерения,
	РеализацияТоваровУслугТовары.Номенклатура.БазоваяЕдиницаИзмерения.Наименование,
	ВЫРАЗИТЬ(РеализацияТоваровУслугТовары.Номенклатура.Наименование КАК СТРОКА(178)),
	ВЫРАЗИТЬ(РеализацияТоваровУслугТовары.Номенклатура.НаименованиеПолное КАК СТРОКА(500)),
	Неопределено,
	Неопределено,
	РеализацияТоваровУслугТовары.Цена,
	РеализацияТоваровУслугТовары.СтавкаНДС,
	РеализацияТоваровУслугТовары.Номенклатура.СтранаПроисхождения,
	РеализацияТоваровУслугТовары.Номенклатура.НомерГТД,
	РеализацияТоваровУслугТовары.Количество,
	РеализацияТоваровУслугТовары.Сумма,
	РеализацияТоваровУслугТовары.СуммаНДС,
	"Services"
ИЗ
	Документ.РеализацияТоваровУслуг.Услуги КАК РеализацияТоваровУслугТовары
ГДЕ
	&amp;РаботаСУслугами
	И РеализацияТоваровУслугТовары.Ссылка В (&amp;Ссылка)

ОБЪЕДИНИТЬ ВСЕ

ВЫБРАТЬ
	0,
	ВозвратТоваровОтПокупателяТовары.Номенклатура,
	ВозвратТоваровОтПокупателяТовары.Номенклатура.БазоваяЕдиницаИзмерения,
	ВозвратТоваровОтПокупателяТовары.Номенклатура.БазоваяЕдиницаИзмерения.Наименование,
	ВЫРАЗИТЬ(ВозвратТоваровОтПокупателяТовары.Номенклатура.Наименование КАК СТРОКА(178)),
	ВЫРАЗИТЬ(ВозвратТоваровОтПокупателяТовары.Номенклатура.НаименованиеПолное КАК СТРОКА(500)),
	Неопределено,
	Неопределено,
	ВозвратТоваровОтПокупателяТовары.Цена,
	ВозвратТоваровОтПокупателяТовары.СтавкаНДС,
	ВозвратТоваровОтПокупателяТовары.СтранаПроисхождения,
	ВозвратТоваровОтПокупателяТовары.НомерГТД,
	-ВозвратТоваровОтПокупателяТовары.Количество,
	-ВозвратТоваровОтПокупателяТовары.Сумма,
	-ВозвратТоваровОтПокупателяТовары.СуммаНДС,
	""
ИЗ
	Документ.ВозвратТоваровОтПокупателя.Товары КАК ВозвратТоваровОтПокупателяТовары
ГДЕ
	ВозвратТоваровОтПокупателяТовары.Ссылка В(&amp;Возвраты)

ОБЪЕДИНИТЬ ВСЕ

ВЫБРАТЬ
	0,
	ВозвратТоваровОтПокупателяВозвратнаяТара.Номенклатура,
	ВозвратТоваровОтПокупателяВозвратнаяТара.Номенклатура.БазоваяЕдиницаИзмерения,
	ВозвратТоваровОтПокупателяВозвратнаяТара.Номенклатура.БазоваяЕдиницаИзмерения.Наименование,
	ВЫРАЗИТЬ(ВозвратТоваровОтПокупателяВозвратнаяТара.Номенклатура.Наименование КАК СТРОКА(178)),
	ВЫРАЗИТЬ(ВозвратТоваровОтПокупателяВозвратнаяТара.Номенклатура.НаименованиеПолное КАК СТРОКА(500)),
	Неопределено,
	Неопределено,
	ВозвратТоваровОтПокупателяВозвратнаяТара.Цена,
	ЗНАЧЕНИЕ(Перечисление.СтавкиНДС.НДС0),
	ВозвратТоваровОтПокупателяВозвратнаяТара.Номенклатура.СтранаПроисхождения,
	ВозвратТоваровОтПокупателяВозвратнаяТара.Номенклатура.НомерГТД,
	-ВозвратТоваровОтПокупателяВозвратнаяТара.Количество,
	-ВозвратТоваровОтПокупателяВозвратнаяТара.Сумма,
	0,
	"RC"
ИЗ
	Документ.ВозвратТоваровОтПокупателя.ВозвратнаяТара КАК ВозвратТоваровОтПокупателяВозвратнаяТара
ГДЕ
	&amp;ОтправлятьВозвратнуюТару
	И ВозвратТоваровОтПокупателяВозвратнаяТара.Ссылка В(&amp;Возвраты)</query>
						<autoFillFields>false</autoFillFields>
					</item>
				</item>
			</item>
		</item>
		<item xsi:type="DataSetUnion">
			<name>Покупатель</name>
			<item xsi:type="DataSetUnion">
				<name>ЗапросОсновнойЦепочки</name>
			</item>
		</item>
	</dataSet>
	<dataSet xsi:type="DataSetUnion">
		<name>ТКПТ</name>
		<item xsi:type="DataSetUnion">
			<name>Поставщик</name>
			<item xsi:type="DataSetUnion">
				<name>ЗапросОсновнойЦепочки</name>
				<item xsi:type="DataSetQuery">
					<name>Заказ_Реализация_СчетФактура</name>
					<dataSource>ИсточникДанных1</dataSource>
					<query>ВЫБРАТЬ
	ЗаказПокупателя.Ссылка КАК PORDERS,
	ЗаказПокупателя.Ссылка КАК ORDERS,
	ЗаказПокупателя.Ссылка КАК ORDRSP,
	РеализацияТоваров.Ссылка КАК RECADV,
	РеализацияТоваров.Ссылка КАК DESADV,
	СчетФактураВыданный.Ссылка КАК INVOIC
ИЗ
	(ВЫБРАТЬ
		1 КАК Поле1) КАК Заглушка
		{ПОЛНОЕ СОЕДИНЕНИЕ Документ.СчетФактураВыданный КАК СчетФактураВыданный
			{ПОЛНОЕ СОЕДИНЕНИЕ Документ.РеализацияТоваров КАК РеализацияТоваров
				{ПОЛНОЕ СОЕДИНЕНИЕ Документ.ЗаказПокупателя КАК ЗаказПокупателя
				ПО РеализацияТоваров.ДокументОснование = ЗаказПокупателя.Ссылка}
			ПО СчетФактураВыданный.ДокументОснование = РеализацияТоваров.Ссылка}
		ПО (ИСТИНА)}</query>
					<autoFillFields>false</autoFillFields>
				</item>
			</item>
			<item xsi:type="DataSetUnion">
				<name>ЗапросПоТоварам</name>
				<item xsi:type="DataSetUnion">
					<name>_PORDERS_ORDRSP_</name>
					<item xsi:type="DataSetQuery">
						<name>ЗаказПокупателя</name>
						<dataSource>ИсточникДанных1</dataSource>
						<query>ВЫБРАТЬ
	ЗаказПокупателяТовары.Номенклатура,
	ЗаказПокупателяТовары.ХарактеристикаНоменклатуры КАК ХарактеристикаНоменклатуры,
	ЗаказПокупателяТовары.ЕдиницаИзмерения КАК ЕдиницаИзмерения,
	ЗаказПокупателяТовары.ЕдиницаИзмерения.ЕдиницаПоКлассификатору.Наименование КАК КодЕдиницыИзмерения,
	ЗаказПокупателяТовары.Цена,
	ЗаказПокупателяТовары.СтавкаНДС,
	ЗаказПокупателяТовары.Количество КАК Количество,
	ЗаказПокупателяТовары.Сумма КАК Сумма,
	ЗаказПокупателяТовары.СуммаНДС КАК СуммаНДС,
	ВЫБОР
		КОГДА ЗаказПокупателяТовары.Номенклатура.ВидНоменклатуры = ЗНАЧЕНИЕ(Перечисление.ВидыНоменклатуры.Услуга)
			ТОГДА "Services"
		ИНАЧЕ ""
	КОНЕЦ КАК ТипЕдиницы

ИЗ
	Документ.ЗаказПокупателя.Товары КАК ЗаказПокупателяТовары
ГДЕ
	ЗаказПокупателяТовары.Ссылка В(&amp;Ссылка)
	И (НЕ ЗаказПокупателяТовары.Номенклатура.ВидНоменклатуры = ЗНАЧЕНИЕ(Перечисление.ВидыНоменклатуры.Услуга)
			ИЛИ &amp;РаботаСУслугами)
</query>
						<autoFillFields>false</autoFillFields>
					</item>
				</item>
				<item xsi:type="DataSetUnion">
					<name>_DESADV_INVOIC_</name>
					<item xsi:type="DataSetQuery">
						<name>РеализацияТоваров</name>
						<dataSource>ИсточникДанных1</dataSource>
						<query>ВЫБРАТЬ
	РеализацияТоваровТовары.НомерСтроки,
	РеализацияТоваровТовары.Номенклатура,
	РеализацияТоваровТовары.ХарактеристикаНоменклатуры,
	РеализацияТоваровТовары.ЕдиницаИзмерения КАК ЕдиницаИзмерения,
	РеализацияТоваровТовары.ЕдиницаИзмерения.ЕдиницаПоКлассификатору.Наименование КАК КодЕдиницыИзмерения,
	ВЫРАЗИТЬ(РеализацияТоваровТовары.Номенклатура.Наименование КАК СТРОКА(178)) КАК Наименование,
	ВЫРАЗИТЬ(РеализацияТоваровТовары.Номенклатура.НаименованиеПолное КАК СТРОКА(500)) КАК НаименованиеПолное,
	РеализацияТоваровТовары.Цена,
	РеализацияТоваровТовары.СтавкаНДС,
	Неопределено КАК СерияНоменклатуры,
	РеализацияТоваровТовары.Номенклатура.СтранаПроисхождения КАК Страна,
	РеализацияТоваровТовары.Номенклатура.ГТД.Код КАК НомерГТД,
	РеализацияТоваровТовары.Количество КАК Количество,
	РеализацияТоваровТовары.Сумма КАК Сумма,
	РеализацияТоваровТовары.СуммаНДС КАК СуммаНДС,
	ВЫБОР
		КОГДА РеализацияТоваровТовары.Номенклатура.ВидНоменклатуры = ЗНАЧЕНИЕ(Перечисление.ВидыНоменклатуры.Услуга)
			ТОГДА "Services"
		ИНАЧЕ ""
	КОНЕЦ КАК ТипЕдиницы
ИЗ
	Документ.РеализацияТоваров.Товары КАК РеализацияТоваровТовары
ГДЕ
	РеализацияТоваровТовары.Ссылка В(&amp;Ссылка)
	И (НЕ РеализацияТоваровТовары.Номенклатура.ВидНоменклатуры = ЗНАЧЕНИЕ(Перечисление.ВидыНоменклатуры.Услуга)
			ИЛИ &amp;РаботаСУслугами)

ОБЪЕДИНИТЬ ВСЕ

ВЫБРАТЬ
	0,
	ВозвратТоваровОтПокупателяТовары.Номенклатура,
	ВозвратТоваровОтПокупателяТовары.ХарактеристикаНоменклатуры,
	ВозвратТоваровОтПокупателяТовары.ЕдиницаИзмерения,
	ВозвратТоваровОтПокупателяТовары.ЕдиницаИзмерения.ЕдиницаПоКлассификатору.Наименование,
	ВЫРАЗИТЬ(ВозвратТоваровОтПокупателяТовары.Номенклатура.Наименование КАК СТРОКА(178)),
	ВЫРАЗИТЬ(ВозвратТоваровОтПокупателяТовары.Номенклатура.НаименованиеПолное КАК СТРОКА(500)),
	ВозвратТоваровОтПокупателяТовары.Цена,
	ВозвратТоваровОтПокупателяТовары.СтавкаНДС,
	Неопределено,
	ВозвратТоваровОтПокупателяТовары.Номенклатура.СтранаПроисхождения,
	ВозвратТоваровОтПокупателяТовары.Номенклатура.ГТД.Код,
	-ВозвратТоваровОтПокупателяТовары.Количество,
	-ВозвратТоваровОтПокупателяТовары.Сумма,
	-ВозвратТоваровОтПокупателяТовары.СуммаНДС,
	""
ИЗ
	Документ.ВозвратОтПокупателя.Товары КАК ВозвратТоваровОтПокупателяТовары
ГДЕ
	ВозвратТоваровОтПокупателяТовары.Ссылка В(&amp;Возвраты)</query>
						<autoFillFields>false</autoFillFields>
					</item>
				</item>
			</item>
		</item>
		<item xsi:type="DataSetUnion">
			<name>Покупатель</name>
			<item xsi:type="DataSetUnion">
				<name>ЗапросОсновнойЦепочки</name>
				<item xsi:type="DataSetQuery">
					<name>Заказ_ПредварительноеПоступление_Поступление_СчетФактура</name>
					<dataSource>ИсточникДанных1</dataSource>
					<query>ВЫБРАТЬ
	ЗаказПоставщику.Ссылка КАК PORDERS,
	ЗаказПоставщику.Ссылка КАК ORDERS,
	ЗаказПоставщику.Ссылка КАК ORDRSP,
	ПоступлениеТоваров.Ссылка КАК RECADV,
	ПредварительноеПоступлениеТоваров.Ссылка КАК DESADV,
	СчетФактураПолученный.Ссылка КАК INVOIC
ИЗ
	(ВЫБРАТЬ
		1 КАК Поле1) КАК Заглушка
		{ПОЛНОЕ СОЕДИНЕНИЕ Документ.СчетФактураПолученный КАК СчетФактураПолученный
			{ПОЛНОЕ СОЕДИНЕНИЕ Документ.ПоступлениеТоваров КАК ПоступлениеТоваров
				{ПОЛНОЕ СОЕДИНЕНИЕ Документ.ПредварительноеПоступлениеТоваров КАК ПредварительноеПоступлениеТоваров
					{ПОЛНОЕ СОЕДИНЕНИЕ Документ.ЗаказПоставщику КАК ЗаказПоставщику
					ПО ПредварительноеПоступлениеТоваров.ДокументОснование = ЗаказПоставщику.Ссылка}
				ПО ПоступлениеТоваров.ДокументОснование = ПредварительноеПоступлениеТоваров.Ссылка}
			ПО СчетФактураПолученный.ДокументОснование = ПоступлениеТоваров.Ссылка}
		ПО (ИСТИНА)}</query>
					<autoFillFields>false</autoFillFields>
				</item>
				<item xsi:type="DataSetQuery">
					<name>Заказ_Поступление_СчетФактура</name>
					<dataSource>ИсточникДанных1</dataSource>
					<query>ВЫБРАТЬ
	ЗаказПоставщику.Ссылка КАК PORDERS,
	ЗаказПоставщику.Ссылка КАК ORDERS,
	ЗаказПоставщику.Ссылка КАК ORDRSP,
	ПоступлениеТоваров.Ссылка КАК RECADV,
	ПоступлениеТоваров.Ссылка КАК DESADV,
	СчетФактураПолученный.Ссылка КАК INVOIC
ИЗ
	(ВЫБРАТЬ
		1 КАК Поле1) КАК Заглушка
		{ПОЛНОЕ СОЕДИНЕНИЕ Документ.СчетФактураПолученный КАК СчетФактураПолученный
			{ПОЛНОЕ СОЕДИНЕНИЕ Документ.ПоступлениеТоваров КАК ПоступлениеТоваров
				{ПОЛНОЕ СОЕДИНЕНИЕ Документ.ЗаказПоставщику КАК ЗаказПоставщику
				ПО ПоступлениеТоваров.ДокументОснование = ЗаказПоставщику.Ссылка}
			ПО СчетФактураПолученный.ДокументОснование = ПоступлениеТоваров.Ссылка}
		ПО (ИСТИНА)}</query>
					<autoFillFields>false</autoFillFields>
				</item>
			</item>
			<item xsi:type="DataSetUnion">
				<name>ЗапросПоТоварам</name>
				<item xsi:type="DataSetUnion">
					<name>_ORDERS_</name>
					<item xsi:type="DataSetQuery">
						<name>ЗаказПоставщику</name>
						<dataSource>ИсточникДанных1</dataSource>
						<query>ВЫБРАТЬ
	ЗаказПоставщикуТовары.Номенклатура.Код КАК КодТовараПокупателя,
	ЗаказПоставщикуТовары.Номенклатура,
	ЗаказПоставщикуТовары.ХарактеристикаНоменклатуры,
	ЗаказПоставщикуТовары.ЕдиницаИзмерения КАК ЕдиницаИзмерения,
	ЗаказПоставщикуТовары.ЕдиницаИзмерения.ЕдиницаПоКлассификатору.Наименование КАК КодЕдиницыИзмерения,
	ВЫРАЗИТЬ(ЗаказПоставщикуТовары.Номенклатура.Наименование КАК СТРОКА(178)) КАК Наименование,
	ЗаказПоставщикуТовары.Цена,
	ЗаказПоставщикуТовары.СтавкаНДС,
	СУММА(ЗаказПоставщикуТовары.Количество) КАК Количество,
	СУММА(ЗаказПоставщикуТовары.Сумма) КАК Сумма,
	СУММА(ЗаказПоставщикуТовары.СуммаНДС) КАК СуммаНДС
ИЗ
	Документ.ЗаказПоставщику.Товары КАК ЗаказПоставщикуТовары
ГДЕ
	ЗаказПоставщикуТовары.Ссылка = &amp;Ссылка

СГРУППИРОВАТЬ ПО
	ЗаказПоставщикуТовары.Номенклатура,
	ЗаказПоставщикуТовары.ХарактеристикаНоменклатуры,
	ЗаказПоставщикуТовары.ЕдиницаИзмерения,
	ЗаказПоставщикуТовары.Цена,
	ЗаказПоставщикуТовары.СтавкаНДС,
	ЗаказПоставщикуТовары.Номенклатура.Код,
	ВЫРАЗИТЬ(ЗаказПоставщикуТовары.Номенклатура.Наименование КАК СТРОКА(178))</query>
						<autoFillFields>false</autoFillFields>
					</item>
				</item>
				<item xsi:type="DataSetUnion">
					<name>_RECADV_</name>
					<item xsi:type="DataSetQuery">
						<name>ПоступлениеТоваров</name>
						<dataSource>ИсточникДанных1</dataSource>
						<query>ВЫБРАТЬ
	ПоступлениеТоваров.Номенклатура,
	ПоступлениеТоваров.ХарактеристикаНоменклатуры,
	ПоступлениеТоваров.ЕдиницаИзмерения КАК ЕдиницаИзмерения,
	ПоступлениеТоваров.ЕдиницаИзмерения.ЕдиницаПоКлассификатору.Наименование КАК КодЕдиницыИзмерения,
	ВЫРАЗИТЬ(ПоступлениеТоваров.Номенклатура.Наименование КАК СТРОКА(178)) КАК Наименование,
	ПоступлениеТоваров.Количество КАК Количество,
	ПоступлениеТоваров.Цена,
	ПоступлениеТоваров.СтавкаНДС,
	ПоступлениеТоваров.Сумма,
	ПоступлениеТоваров.СуммаНДС
ИЗ
	Документ.ПоступлениеТоваров.Товары КАК ПоступлениеТоваров
ГДЕ
	ПоступлениеТоваров.Ссылка = &amp;Ссылка</query>
						<autoFillFields>false</autoFillFields>
					</item>
				</item>
			</item>
			<item xsi:type="DataSetQuery">
				<name>КонвертироватьТоварыEDIВ1С</name>
				<dataSource>ИсточникДанных1</dataSource>
				<query>ВЫБРАТЬ
	ТабТоваров.GTIN КАК GTIN,
	ТабТоваров.КодТовараСторонний КАК КодТовараСторонний,
	ТабТоваров.КодТовараСвой КАК КодТовараСвой,
	ТабСоответствий_КонтурEDI.Номенклатура КАК Номенклатура,
	ТабСоответствий_КонтурEDI.ХарактеристикаНоменклатуры КАК ХарактеристикаНоменклатуры,
	ТабСоответствий_КонтурEDI.ЕдиницаИзмерения КАК ЕдиницаИзмерения,
	ТабСоответствий_КонтурEDI.ТипЕдиницы КАК ТипЕдиницы,
	4 КАК Приоритет
ПОМЕСТИТЬ ВТ_НайденныеСоответствия
ИЗ
	ТабТоваров КАК ТабТоваров
		ВНУТРЕННЕЕ СОЕДИНЕНИЕ ТабСоответствий_КонтурEDI КАК ТабСоответствий_КонтурEDI
		ПО ТабТоваров.GTIN = ТабСоответствий_КонтурEDI.GTIN
			И ТабТоваров.КодТовараСторонний = ТабСоответствий_КонтурEDI.КодТовараСторонний
			И ТабТоваров.КодТовараСвой = ТабСоответствий_КонтурEDI.КодТовараСвой

ОБЪЕДИНИТЬ ВСЕ

ВЫБРАТЬ
	ТабТоваров.GTIN,
	ТабТоваров.КодТовараСторонний,
	ТабТоваров.КодТовараСвой,
	Штрихкоды.Объект,
	Штрихкоды.ХарактеристикаНоменклатуры,
	Штрихкоды.ЕдиницаИзмерения,
	ВЫРАЗИТЬ("" КАК СТРОКА(20)),
	3
ИЗ
	ТабТоваров КАК ТабТоваров
		ВНУТРЕННЕЕ СОЕДИНЕНИЕ РегистрСведений.ШтрихКоды КАК Штрихкоды
		ПО (ТабТоваров.GTIN = Штрихкоды.ШтрихКод)
ГДЕ
	НЕ ТабТоваров.GTIN = ""
    
ОБЪЕДИНИТЬ ВСЕ

ВЫБРАТЬ
	ТабТоваров.GTIN,
	ТабТоваров.КодТовараСторонний,
	ТабТоваров.КодТовараСвой,
	Штрихкоды.Объект,
	Штрихкоды.ХарактеристикаНоменклатуры,
	Штрихкоды.ЕдиницаИзмерения,
	ВЫРАЗИТЬ("" КАК СТРОКА(20)),
	2
ИЗ
	ТабТоваров КАК ТабТоваров
		ВНУТРЕННЕЕ СОЕДИНЕНИЕ РегистрСведений.ШтрихКоды КАК Штрихкоды
		ПО (ПОДСТРОКА(ТабТоваров.GTIN, 2, 13) = Штрихкоды.ШтрихКод)
ГДЕ
	НЕ ТабТоваров.GTIN = ""

ОБЪЕДИНИТЬ ВСЕ

ВЫБРАТЬ
	ТабТоваров.GTIN,
	ТабТоваров.КодТовараСторонний,
	ТабТоваров.КодТовараСвой,
	СправочникНоменклатура.Ссылка,
	НЕОПРЕДЕЛЕНО,
	СправочникНоменклатура.ОсновнаяЕдиницаИзмерения,
	ВЫРАЗИТЬ("" КАК СТРОКА(20)),
	1
ИЗ
	ТабТоваров КАК ТабТоваров
		ВНУТРЕННЕЕ СОЕДИНЕНИЕ Справочник.Номенклатура КАК СправочникНоменклатура
		ПО ТабТоваров.КодТовараСвой = СправочникНоменклатура.Код
ГДЕ
	НЕ ТабТоваров.КодТовараСвой = ""
</query>
				<autoFillFields>false</autoFillFields>
			</item>
			<item xsi:type="DataSetQuery">
				<name>КонвертироватьТовары1СВEDIВ_GTIN</name>
				<dataSource>ИсточникДанных1</dataSource>
				<query>ВЫБРАТЬ РАЗЛИЧНЫЕ
	ТабТоваров.Номенклатура,
	ТабТоваров.ХарактеристикаНоменклатуры,
	ТабТоваров.ЕдиницаИзмерения,
	ТабТоваров.Номенклатура.Код КАК КодТовараСвой,
	ВЫРАЗИТЬ(Штрихкоды.Штрихкод КАК СТРОКА(14)) КАК GTIN
ПОМЕСТИТЬ ВТШтрихкодыТоваров
ИЗ
	ТабТоваров КАК ТабТоваров
		ВНУТРЕННЕЕ СОЕДИНЕНИЕ РегистрСведений.Штрихкоды КАК Штрихкоды
		ПО ТабТоваров.Номенклатура = Штрихкоды.Объект
			И (Штрихкоды.ОсновнойШтрихкод = ИСТИНА)
ГДЕ
	&amp;ИскатьТоварПоШК

ИНДЕКСИРОВАТЬ ПО
	ТабТоваров.Номенклатура,
	ТабТоваров.ХарактеристикаНоменклатуры,
	ТабТоваров.ЕдиницаИзмерения</query>
				<autoFillFields>false</autoFillFields>
			</item>
		</item>
	</dataSet>
	<dataSet xsi:type="DataSetUnion">
		<name>УТ_10_2</name>
		<field xsi:type="DataSetFieldField">
			<dataPath>НомерСтроки</dataPath>
			<field>НомерСтроки</field>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>ЕдиницаИзмерения</dataPath>
			<field>ЕдиницаИзмерения</field>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>КодЕдиницыИзмерения</dataPath>
			<field>КодЕдиницыИзмерения</field>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>Количество</dataPath>
			<field>Количество</field>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>Наименование</dataPath>
			<field>Наименование</field>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>НаименованиеПолное</dataPath>
			<field>НаименованиеПолное</field>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>Номенклатура</dataPath>
			<field>Номенклатура</field>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>НомерГТД</dataPath>
			<field>НомерГТД</field>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>СерияНоменклатуры</dataPath>
			<field>СерияНоменклатуры</field>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>СтавкаНДС</dataPath>
			<field>СтавкаНДС</field>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>Страна</dataPath>
			<field>Страна</field>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>Сумма</dataPath>
			<field>Сумма</field>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>СуммаНДС</dataPath>
			<field>СуммаНДС</field>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>ТипЕдиницы</dataPath>
			<field>ТипЕдиницы</field>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>ХарактеристикаНоменклатуры</dataPath>
			<field>ХарактеристикаНоменклатуры</field>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>Цена</dataPath>
			<field>Цена</field>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>GTIN</dataPath>
			<field>GTIN</field>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>ЕдИзмСрокаГодности</dataPath>
			<field>ЕдИзмСрокаГодности</field>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>КвантПоставки</dataPath>
			<field>КвантПоставки</field>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>КодТовараПоставщика</dataPath>
			<field>КодТовараПоставщика</field>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>КоличествоВОдномМесте</dataPath>
			<field>КоличествоВОдномМесте</field>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>Родитель</dataPath>
			<field>Родитель</field>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>СрокГодности</dataPath>
			<field>СрокГодности</field>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>КоличествоОстаткаНаКонец</dataPath>
			<field>КоличествоОстаткаНаКонец</field>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>Качество</dataPath>
			<field>Качество</field>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>Склад</dataPath>
			<field>Склад</field>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>РекомендуемаяРозничнаяЦена</dataPath>
			<field>РекомендуемаяРозничнаяЦена</field>
		</field>
		<item xsi:type="DataSetUnion">
			<name>Поставщик</name>
			<field xsi:type="DataSetFieldField">
				<dataPath>НомерСтроки</dataPath>
				<field>НомерСтроки</field>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>ЕдиницаИзмерения</dataPath>
				<field>ЕдиницаИзмерения</field>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>КодЕдиницыИзмерения</dataPath>
				<field>КодЕдиницыИзмерения</field>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>Количество</dataPath>
				<field>Количество</field>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>Наименование</dataPath>
				<field>Наименование</field>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>НаименованиеПолное</dataPath>
				<field>НаименованиеПолное</field>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>Номенклатура</dataPath>
				<field>Номенклатура</field>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>НомерГТД</dataPath>
				<field>НомерГТД</field>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>СерияНоменклатуры</dataPath>
				<field>СерияНоменклатуры</field>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>СтавкаНДС</dataPath>
				<field>СтавкаНДС</field>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>Страна</dataPath>
				<field>Страна</field>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>Сумма</dataPath>
				<field>Сумма</field>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>СуммаНДС</dataPath>
				<field>СуммаНДС</field>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>ТипЕдиницы</dataPath>
				<field>ТипЕдиницы</field>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>ХарактеристикаНоменклатуры</dataPath>
				<field>ХарактеристикаНоменклатуры</field>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>Цена</dataPath>
				<field>Цена</field>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>GTIN</dataPath>
				<field>GTIN</field>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>ЕдИзмСрокаГодности</dataPath>
				<field>ЕдИзмСрокаГодности</field>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>КвантПоставки</dataPath>
				<field>КвантПоставки</field>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>КодТовараПоставщика</dataPath>
				<field>КодТовараПоставщика</field>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>КоличествоВОдномМесте</dataPath>
				<field>КоличествоВОдномМесте</field>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>Родитель</dataPath>
				<field>Родитель</field>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>СрокГодности</dataPath>
				<field>СрокГодности</field>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>КоличествоОстаткаНаКонец</dataPath>
				<field>КоличествоОстаткаНаКонец</field>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>Качество</dataPath>
				<field>Качество</field>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>Склад</dataPath>
				<field>Склад</field>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>РекомендуемаяРозничнаяЦена</dataPath>
				<field>РекомендуемаяРозничнаяЦена</field>
			</field>
			<item xsi:type="DataSetUnion">
				<name>ЗапросОсновнойЦепочки</name>
				<item xsi:type="DataSetQuery">
					<name>Заказ_Реализация_СФ</name>
					<dataSource>ИсточникДанных1</dataSource>
					<query>ВЫБРАТЬ
	докЗаказПокупателя.Ссылка КАК PORDERS,
	докЗаказПокупателя.Ссылка КАК ORDERS,
	докЗаказПокупателя.Ссылка КАК ORDRSP,
	докРеализацияТоваровУслуг.Ссылка КАК DESADV,
	докРеализацияТоваровУслуг.Ссылка КАК RECADV,
	СчетФактураВыданный.Ссылка КАК INVOIC
ИЗ
	(ВЫБРАТЬ
		1 КАК Поле1) КАК Заглушка
		{ПОЛНОЕ СОЕДИНЕНИЕ Документ.СчетФактураВыданный КАК СчетФактураВыданный
			{ПОЛНОЕ СОЕДИНЕНИЕ Документ.РеализацияТоваровУслуг КАК докРеализацияТоваровУслуг
				{ПОЛНОЕ СОЕДИНЕНИЕ Документ.ЗаказПокупателя КАК докЗаказПокупателя
				ПО докРеализацияТоваровУслуг.Сделка = докЗаказПокупателя.Ссылка}
			ПО СчетФактураВыданный.ДокументОснование = докРеализацияТоваровУслуг.Ссылка}
		ПО (ИСТИНА)}</query>
					<autoFillFields>false</autoFillFields>
				</item>
				<item xsi:type="DataSetQuery">
					<name>Реализация_СФ</name>
					<dataSource>ИсточникДанных1</dataSource>
					<query>ВЫБРАТЬ
	РеализацияТоваровУслуг.Ссылка КАК PORDERS,
	РеализацияТоваровУслуг.Ссылка КАК ORDERS,
	РеализацияТоваровУслуг.Ссылка КАК ORDRSP,
	РеализацияТоваровУслуг.Ссылка КАК DESADV,
	РеализацияТоваровУслуг.Ссылка КАК RECADV,
	СчетФактураВыданный.Ссылка КАК INVOIC
ИЗ
	(ВЫБРАТЬ
		1 КАК Поле1) КАК Заглушка
		{ПОЛНОЕ СОЕДИНЕНИЕ Документ.СчетФактураВыданный КАК СчетФактураВыданный
			{ПОЛНОЕ СОЕДИНЕНИЕ Документ.РеализацияТоваровУслуг КАК РеализацияТоваровУслуг
			ПО СчетФактураВыданный.ДокументОснование = РеализацияТоваровУслуг.Ссылка}
		ПО (ИСТИНА)}</query>
					<autoFillFields>false</autoFillFields>
				</item>
				<item xsi:type="DataSetQuery">
					<name>Заказ_Реализация</name>
					<dataSource>ИсточникДанных1</dataSource>
					<query>ВЫБРАТЬ
	докЗаказПокупателя.Ссылка КАК PORDERS,
	докЗаказПокупателя.Ссылка КАК ORDERS,
	докЗаказПокупателя.Ссылка КАК ORDRSP,
	докРеализацияТоваровУслуг.Ссылка КАК DESADV,
	докРеализацияТоваровУслуг.Ссылка КАК RECADV,
	докРеализацияТоваровУслуг.Ссылка КАК INVOIC
ИЗ
	(ВЫБРАТЬ
		1 КАК Поле1) КАК Заглушка
		{ПОЛНОЕ СОЕДИНЕНИЕ Документ.РеализацияТоваровУслуг КАК докРеализацияТоваровУслуг
			{ПОЛНОЕ СОЕДИНЕНИЕ Документ.ЗаказПокупателя КАК докЗаказПокупателя
			ПО докРеализацияТоваровУслуг.Сделка = докЗаказПокупателя.Ссылка}
		ПО (ИСТИНА)}</query>
					<autoFillFields>false</autoFillFields>
				</item>
				<item xsi:type="DataSetQuery">
					<name>Реализация</name>
					<dataSource>ИсточникДанных1</dataSource>
					<query>ВЫБРАТЬ
	РеализацияТоваровУслуг.Ссылка КАК PORDERS,
	РеализацияТоваровУслуг.Ссылка КАК ORDERS,
	РеализацияТоваровУслуг.Ссылка КАК ORDRSP,
	РеализацияТоваровУслуг.Ссылка КАК DESADV,
	РеализацияТоваровУслуг.Ссылка КАК RECADV,
	РеализацияТоваровУслуг.Ссылка КАК INVOIC
ИЗ
	(ВЫБРАТЬ
		1 КАК Поле1) КАК Заглушка
		{ПОЛНОЕ СОЕДИНЕНИЕ Документ.РеализацияТоваровУслуг КАК РеализацияТоваровУслуг
		ПО (ИСТИНА)}</query>
					<autoFillFields>false</autoFillFields>
				</item>
			</item>
			<item xsi:type="DataSetUnion">
				<name>ЗапросПоТоварам</name>
				<field xsi:type="DataSetFieldField">
					<dataPath>НомерСтроки</dataPath>
					<field>НомерСтроки</field>
				</field>
				<field xsi:type="DataSetFieldField">
					<dataPath>ЕдиницаИзмерения</dataPath>
					<field>ЕдиницаИзмерения</field>
				</field>
				<field xsi:type="DataSetFieldField">
					<dataPath>КодЕдиницыИзмерения</dataPath>
					<field>КодЕдиницыИзмерения</field>
				</field>
				<field xsi:type="DataSetFieldField">
					<dataPath>Количество</dataPath>
					<field>Количество</field>
				</field>
				<field xsi:type="DataSetFieldField">
					<dataPath>Наименование</dataPath>
					<field>Наименование</field>
				</field>
				<field xsi:type="DataSetFieldField">
					<dataPath>НаименованиеПолное</dataPath>
					<field>НаименованиеПолное</field>
				</field>
				<field xsi:type="DataSetFieldField">
					<dataPath>Номенклатура</dataPath>
					<field>Номенклатура</field>
				</field>
				<field xsi:type="DataSetFieldField">
					<dataPath>НомерГТД</dataPath>
					<field>НомерГТД</field>
				</field>
				<field xsi:type="DataSetFieldField">
					<dataPath>СерияНоменклатуры</dataPath>
					<field>СерияНоменклатуры</field>
				</field>
				<field xsi:type="DataSetFieldField">
					<dataPath>СтавкаНДС</dataPath>
					<field>СтавкаНДС</field>
				</field>
				<field xsi:type="DataSetFieldField">
					<dataPath>Страна</dataPath>
					<field>Страна</field>
				</field>
				<field xsi:type="DataSetFieldField">
					<dataPath>Сумма</dataPath>
					<field>Сумма</field>
				</field>
				<field xsi:type="DataSetFieldField">
					<dataPath>СуммаНДС</dataPath>
					<field>СуммаНДС</field>
				</field>
				<field xsi:type="DataSetFieldField">
					<dataPath>ТипЕдиницы</dataPath>
					<field>ТипЕдиницы</field>
				</field>
				<field xsi:type="DataSetFieldField">
					<dataPath>ХарактеристикаНоменклатуры</dataPath>
					<field>ХарактеристикаНоменклатуры</field>
				</field>
				<field xsi:type="DataSetFieldField">
					<dataPath>Цена</dataPath>
					<field>Цена</field>
				</field>
				<field xsi:type="DataSetFieldField">
					<dataPath>GTIN</dataPath>
					<field>GTIN</field>
				</field>
				<field xsi:type="DataSetFieldField">
					<dataPath>ЕдИзмСрокаГодности</dataPath>
					<field>ЕдИзмСрокаГодности</field>
				</field>
				<field xsi:type="DataSetFieldField">
					<dataPath>КвантПоставки</dataPath>
					<field>КвантПоставки</field>
				</field>
				<field xsi:type="DataSetFieldField">
					<dataPath>КодТовараПоставщика</dataPath>
					<field>КодТовараПоставщика</field>
				</field>
				<field xsi:type="DataSetFieldField">
					<dataPath>КоличествоВОдномМесте</dataPath>
					<field>КоличествоВОдномМесте</field>
				</field>
				<field xsi:type="DataSetFieldField">
					<dataPath>Родитель</dataPath>
					<field>Родитель</field>
				</field>
				<field xsi:type="DataSetFieldField">
					<dataPath>СрокГодности</dataPath>
					<field>СрокГодности</field>
				</field>
				<field xsi:type="DataSetFieldField">
					<dataPath>КоличествоОстаткаНаКонец</dataPath>
					<field>КоличествоОстаткаНаКонец</field>
				</field>
				<field xsi:type="DataSetFieldField">
					<dataPath>Качество</dataPath>
					<field>Качество</field>
				</field>
				<field xsi:type="DataSetFieldField">
					<dataPath>Склад</dataPath>
					<field>Склад</field>
				</field>
				<field xsi:type="DataSetFieldField">
					<dataPath>РекомендуемаяРозничнаяЦена</dataPath>
					<field>РекомендуемаяРозничнаяЦена</field>
				</field>
				<item xsi:type="DataSetUnion">
					<name>_PORDERS_ORDRSP_</name>
					<item xsi:type="DataSetQuery">
						<name>ЗаказПокупателя_Проведен</name>
						<dataSource>ИсточникДанных1</dataSource>
						<query>ВЫБРАТЬ
	ЗаказыПокупателейОбороты.Цена КАК ЦенаГруппировка,
	ЗаказыПокупателейОбороты.Номенклатура КАК Номенклатура,
	ЗаказыПокупателейОбороты.ХарактеристикаНоменклатуры,
	ЗаказыПокупателейОбороты.ЕдиницаИзмерения КАК ЕдиницаИзмерения,
	ЗаказыПокупателейОбороты.ЕдиницаИзмерения.ЕдиницаПоКлассификатору.Наименование КАК КодЕдиницыИзмерения,
	ВЫБОР
		КОГДА НЕ ЗаказыПокупателейОбороты.ЕдиницаИзмерения.Коэффициент = 0
			ТОГДА ЗаказыПокупателейОбороты.КоличествоПриход * ЗаказыПокупателейОбороты.Номенклатура.ЕдиницаХраненияОстатков.Коэффициент / ЗаказыПокупателейОбороты.ЕдиницаИзмерения.Коэффициент
		ИНАЧЕ 0 
	КОНЕЦ КАК Количество,
	ВЫБОР
		КОГДА НЕ ЗаказыПокупателейОбороты.КоличествоПриход = 0 И НЕ ЗаказыПокупателейОбороты.Номенклатура.ЕдиницаХраненияОстатков.Коэффициент = 0 
			ТОГДА ЗаказыПокупателейОбороты.СуммаВзаиморасчетовПриход * ЗаказыПокупателейОбороты.ЕдиницаИзмерения.Коэффициент / (ЗаказыПокупателейОбороты.КоличествоПриход * ЗаказыПокупателейОбороты.Номенклатура.ЕдиницаХраненияОстатков.Коэффициент)
		ИНАЧЕ 0
	КОНЕЦ КАК Цена,
	ЗаказыПокупателейОбороты.СуммаВзаиморасчетовПриход КАК Сумма,
	ЗаказыПокупателейОбороты.Номенклатура.СтавкаНДС КАК СтавкаНДС,
	"" КАК ТипЕдиницы
ПОМЕСТИТЬ ВТ_ЗаказыПокупателейОбороты
ИЗ
	РегистрНакопления.ЗаказыПокупателей.Обороты(
			,
			,
			,
			ЗаказПокупателя В (&amp;Ссылка)
				И НЕ СтатусПартии = ЗНАЧЕНИЕ(Перечисление.СтатусыПартийТоваров.ВозвратнаяТара)) КАК ЗаказыПокупателейОбороты
ГДЕ
	НЕ ЗаказыПокупателейОбороты.Номенклатура.Услуга
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ
	Таб.Номенклатура КАК Номенклатура,
	Таб.ХарактеристикаНоменклатуры КАК ХарактеристикаНоменклатуры,
	МАКСИМУМ(Таб.СтавкаНДС) КАК СтавкаНДС
ПОМЕСТИТЬ ВТ_ЗаказПокупателяТовары
ИЗ
	Документ.ЗаказПокупателя.Товары КАК Таб
ГДЕ
	Таб.Ссылка В(&amp;Ссылка)

СГРУППИРОВАТЬ ПО
	Таб.Номенклатура,
	Таб.ХарактеристикаНоменклатуры
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ
	ВТ_ЗаказыПокупателейОбороты.Номенклатура КАК Номенклатура,
	ВТ_ЗаказыПокупателейОбороты.ХарактеристикаНоменклатуры КАК ХарактеристикаНоменклатуры,
	ВТ_ЗаказыПокупателейОбороты.ЕдиницаИзмерения КАК ЕдиницаИзмерения,
	ВТ_ЗаказыПокупателейОбороты.КодЕдиницыИзмерения КАК КодЕдиницыИзмерения,
	ВТ_ЗаказыПокупателейОбороты.Количество КАК Количество,
	ВТ_ЗаказыПокупателейОбороты.Цена КАК Цена,
	ВТ_ЗаказыПокупателейОбороты.Сумма КАК Сумма,
	ЕСТЬNULL(ВТ_ЗаказПокупателяТовары.СтавкаНДС, ВТ_ЗаказыПокупателейОбороты.СтавкаНДС) КАК СтавкаНДС,
	ВТ_ЗаказыПокупателейОбороты.ТипЕдиницы КАК ТипЕдиницы
ИЗ
	ВТ_ЗаказыПокупателейОбороты КАК ВТ_ЗаказыПокупателейОбороты
		ЛЕВОЕ СОЕДИНЕНИЕ ВТ_ЗаказПокупателяТовары КАК ВТ_ЗаказПокупателяТовары
		ПО ВТ_ЗаказыПокупателейОбороты.Номенклатура = ВТ_ЗаказПокупателяТовары.Номенклатура
			И ВТ_ЗаказыПокупателейОбороты.ХарактеристикаНоменклатуры = ВТ_ЗаказПокупателяТовары.ХарактеристикаНоменклатуры

ОБЪЕДИНИТЬ ВСЕ

ВЫБРАТЬ
	ЗаказПокупателяТовары.Номенклатура,
	ЗаказПокупателяТовары.ХарактеристикаНоменклатуры,
	ЗаказПокупателяТовары.ЕдиницаИзмерения,
	ЗаказПокупателяТовары.ЕдиницаИзмерения.ЕдиницаПоКлассификатору.Наименование,
	ЗаказПокупателяТовары.Количество,
	ЗаказПокупателяТовары.Цена,
	ЗаказПокупателяТовары.Сумма,
	ЗаказПокупателяТовары.СтавкаНДС,
	"Services"
ИЗ
	Документ.ЗаказПокупателя.Товары КАК ЗаказПокупателяТовары
ГДЕ
	&amp;РаботаСУслугами
	И ЗаказПокупателяТовары.Ссылка В(&amp;Ссылка)
	И ЗаказПокупателяТовары.Номенклатура.Услуга

ОБЪЕДИНИТЬ ВСЕ

ВЫБРАТЬ
	ЗаказПокупателяУслуги.Номенклатура,
	НЕОПРЕДЕЛЕНО,
	ЗаказПокупателяУслуги.Номенклатура.ЕдиницаХраненияОстатков,
	ЗаказПокупателяУслуги.Номенклатура.ЕдиницаХраненияОстатков.ЕдиницаПоКлассификатору.Наименование,
	ЗаказПокупателяУслуги.Количество,
	ЗаказПокупателяУслуги.Цена,
	ЗаказПокупателяУслуги.Сумма,
	ЗаказПокупателяУслуги.СтавкаНДС,
	"Services"
ИЗ
	Документ.ЗаказПокупателя.Услуги КАК ЗаказПокупателяУслуги
ГДЕ
	&amp;РаботаСУслугами
	И ЗаказПокупателяУслуги.Ссылка В(&amp;Ссылка)</query>
						<autoFillFields>false</autoFillFields>
					</item>
					<item xsi:type="DataSetQuery">
						<name>ЗаказПокупателя_НеПроведен</name>
						<dataSource>ИсточникДанных1</dataSource>
						<query>ВЫБРАТЬ
	ЗаказПокупателяТовары.Номенклатура,
	ЗаказПокупателяТовары.ХарактеристикаНоменклатуры КАК ХарактеристикаНоменклатуры,
	ЗаказПокупателяТовары.ЕдиницаИзмерения КАК ЕдиницаИзмерения,
	ЗаказПокупателяТовары.ЕдиницаИзмерения.ЕдиницаПоКлассификатору.Наименование КАК КодЕдиницыИзмерения,
	ЗаказПокупателяТовары.Количество КАК Количество,
	ЗаказПокупателяТовары.Цена,
	ЗаказПокупателяТовары.Сумма КАК Сумма,
	ЗаказПокупателяТовары.СтавкаНДС,
	ЗаказПокупателяТовары.СуммаНДС КАК СуммаНДС,
	ВЫБОР
		КОГДА ЗаказПокупателяТовары.Номенклатура.Услуга
			ТОГДА "Services"
		ИНАЧЕ ""
	КОНЕЦ КАК ТипЕдиницы
ИЗ
	Документ.ЗаказПокупателя.Товары КАК ЗаказПокупателяТовары
ГДЕ
	ЗаказПокупателяТовары.Ссылка В(&amp;Ссылка)
	И (НЕ ЗаказПокупателяТовары.Номенклатура.Услуга
			ИЛИ &amp;РаботаСУслугами)

ОБЪЕДИНИТЬ ВСЕ

ВЫБРАТЬ
	ЗаказПокупателяУслуги.Номенклатура,
	НЕОПРЕДЕЛЕНО,
	ЗаказПокупателяУслуги.Номенклатура.ЕдиницаХраненияОстатков,
	ЗаказПокупателяУслуги.Номенклатура.ЕдиницаХраненияОстатков.ЕдиницаПоКлассификатору.Наименование,
	ЗаказПокупателяУслуги.Количество,
	ЗаказПокупателяУслуги.Цена,
	ЗаказПокупателяУслуги.Сумма,
	ЗаказПокупателяУслуги.СтавкаНДС,
	ЗаказПокупателяУслуги.СуммаНДС,
	"Services"
ИЗ
	Документ.ЗаказПокупателя.Услуги КАК ЗаказПокупателяУслуги
ГДЕ
	&amp;РаботаСУслугами
	И ЗаказПокупателяУслуги.Ссылка В(&amp;Ссылка)</query>
						<autoFillFields>false</autoFillFields>
					</item>
					<item xsi:type="DataSetQuery">
						<name>РеализацияТоваровУслуг</name>
						<dataSource>ИсточникДанных1</dataSource>
						<query>ВЫБРАТЬ
	РеализацияТоваровУслугТовары.НомерСтроки,
	РеализацияТоваровУслугТовары.Номенклатура,
	РеализацияТоваровУслугТовары.ХарактеристикаНоменклатуры,
	РеализацияТоваровУслугТовары.ЕдиницаИзмерения КАК ЕдиницаИзмерения,
	РеализацияТоваровУслугТовары.ЕдиницаИзмерения.ЕдиницаПоКлассификатору.Наименование КАК КодЕдиницыИзмерения,
	ВЫРАЗИТЬ(РеализацияТоваровУслугТовары.Номенклатура.Наименование КАК СТРОКА(178)) КАК Наименование,
	ВЫРАЗИТЬ(РеализацияТоваровУслугТовары.Номенклатура.НаименованиеПолное КАК СТРОКА(500)) КАК НаименованиеПолное,
	РеализацияТоваровУслугТовары.Цена,
	РеализацияТоваровУслугТовары.СтавкаНДС,
	РеализацияТоваровУслугТовары.СерияНоменклатуры,
	ВЫБОР
		КОГДА (РеализацияТоваровУслугТовары.СерияНоменклатуры = ЗНАЧЕНИЕ(Справочник.СерииНоменклатуры.ПустаяСсылка)
				ИЛИ РеализацияТоваровУслугТовары.СерияНоменклатуры.СтранаПроисхождения = ЗНАЧЕНИЕ(Справочник.КлассификаторСтранМира.ПустаяСсылка))
				И РеализацияТоваровУслугТовары.Номенклатура.ВестиУчетПоСериям
			ТОГДА РеализацияТоваровУслугТовары.Номенклатура.СтранаПроисхождения
		ИНАЧЕ РеализацияТоваровУслугТовары.СерияНоменклатуры.СтранаПроисхождения
	КОНЕЦ КАК Страна,
	ВЫБОР
		КОГДА РеализацияТоваровУслугТовары.Номенклатура.ВестиУчетПоСериям
			ТОГДА ЕСТЬNULL(РеализацияТоваровУслугТовары.СерияНоменклатуры.НомерГТД.Код, ЕСТЬNULL(РеализацияТоваровУслугТовары.Номенклатура.НомерГТД.Код, ""))
		ИНАЧЕ ""
	КОНЕЦ КАК НомерГТД,
	РеализацияТоваровУслугТовары.Количество КАК Количество,
	РеализацияТоваровУслугТовары.Сумма КАК Сумма,
	РеализацияТоваровУслугТовары.СуммаНДС,
	ВЫБОР
		КОГДА РеализацияТоваровУслугТовары.Номенклатура.Услуга
			ТОГДА "Services"
		ИНАЧЕ ""
	КОНЕЦ КАК ТипЕдиницы
ИЗ
	Документ.РеализацияТоваровУслуг.Товары КАК РеализацияТоваровУслугТовары
ГДЕ
	РеализацияТоваровУслугТовары.Ссылка В(&amp;Ссылка)
	И (НЕ РеализацияТоваровУслугТовары.Номенклатура.Услуга
			ИЛИ &amp;РаботаСУслугами)

ОБЪЕДИНИТЬ ВСЕ

ВЫБРАТЬ
	РеализацияТоваровУслугВозвратнаяТара.НомерСтроки,
	РеализацияТоваровУслугВозвратнаяТара.Номенклатура,
	НЕОПРЕДЕЛЕНО,
	РеализацияТоваровУслугВозвратнаяТара.Номенклатура.ЕдиницаХраненияОстатков,
	РеализацияТоваровУслугВозвратнаяТара.Номенклатура.ЕдиницаХраненияОстатков.ЕдиницаПоКлассификатору.Наименование,
	ВЫРАЗИТЬ(РеализацияТоваровУслугВозвратнаяТара.Номенклатура.Наименование КАК СТРОКА(178)),
	ВЫРАЗИТЬ(РеализацияТоваровУслугВозвратнаяТара.Номенклатура.НаименованиеПолное КАК СТРОКА(500)),
	РеализацияТоваровУслугВозвратнаяТара.Цена,
	ЗНАЧЕНИЕ(Перечисление.СтавкиНДС.БезНДС),
	НЕОПРЕДЕЛЕНО,
	РеализацияТоваровУслугВозвратнаяТара.Номенклатура.СтранаПроисхождения,
	"",
	РеализацияТоваровУслугВозвратнаяТара.Количество,
	РеализацияТоваровУслугВозвратнаяТара.Сумма,
	0,
	"RC"
ИЗ
	Документ.РеализацияТоваровУслуг.ВозвратнаяТара КАК РеализацияТоваровУслугВозвратнаяТара
ГДЕ
	&amp;ОтправлятьВозвратнуюТару
	И РеализацияТоваровУслугВозвратнаяТара.Ссылка В(&amp;Ссылка)

ОБЪЕДИНИТЬ ВСЕ

ВЫБРАТЬ
	РеализацияТоваровУслугУслуги.НомерСтроки,
	РеализацияТоваровУслугУслуги.Номенклатура,
	НЕОПРЕДЕЛЕНО,
	РеализацияТоваровУслугУслуги.Номенклатура.ЕдиницаХраненияОстатков,
	РеализацияТоваровУслугУслуги.Номенклатура.ЕдиницаХраненияОстатков.ЕдиницаПоКлассификатору.Наименование,
	ВЫРАЗИТЬ(РеализацияТоваровУслугУслуги.Номенклатура.Наименование КАК СТРОКА(178)),
	ВЫРАЗИТЬ(РеализацияТоваровУслугУслуги.Номенклатура.НаименованиеПолное КАК СТРОКА(500)),
	РеализацияТоваровУслугУслуги.Цена,
	РеализацияТоваровУслугУслуги.СтавкаНДС,
	НЕОПРЕДЕЛЕНО,
	РеализацияТоваровУслугУслуги.Номенклатура.СтранаПроисхождения,
	"",
	РеализацияТоваровУслугУслуги.Количество,
	РеализацияТоваровУслугУслуги.Сумма,
	РеализацияТоваровУслугУслуги.СуммаНДС,
	"Services"
ИЗ
	Документ.РеализацияТоваровУслуг.Услуги КАК РеализацияТоваровУслугУслуги
ГДЕ
	&amp;РаботаСУслугами
	И РеализацияТоваровУслугУслуги.Ссылка В(&amp;Ссылка)</query>
						<autoFillFields>false</autoFillFields>
					</item>
				</item>
				<item xsi:type="DataSetUnion">
					<name>_DESADV_INVOIC_</name>
					<item xsi:type="DataSetQuery">
						<name>РеализацияТоваровУслуг</name>
						<dataSource>ИсточникДанных1</dataSource>
						<query>ВЫБРАТЬ
	РеализацияТоваровУслугТовары.НомерСтроки,
	РеализацияТоваровУслугТовары.Номенклатура,
	РеализацияТоваровУслугТовары.ХарактеристикаНоменклатуры,
	РеализацияТоваровУслугТовары.ЕдиницаИзмерения КАК ЕдиницаИзмерения,
	РеализацияТоваровУслугТовары.ЕдиницаИзмерения.ЕдиницаПоКлассификатору.Наименование КАК КодЕдиницыИзмерения,
	ВЫРАЗИТЬ(РеализацияТоваровУслугТовары.Номенклатура.Наименование КАК СТРОКА(178)) КАК Наименование,
	ВЫРАЗИТЬ(РеализацияТоваровУслугТовары.Номенклатура.НаименованиеПолное КАК СТРОКА(500)) КАК НаименованиеПолное,
	РеализацияТоваровУслугТовары.Цена,
	РеализацияТоваровУслугТовары.СтавкаНДС,
	РеализацияТоваровУслугТовары.СерияНоменклатуры,
	ВЫБОР
		КОГДА (РеализацияТоваровУслугТовары.СерияНоменклатуры = ЗНАЧЕНИЕ(Справочник.СерииНоменклатуры.ПустаяСсылка)
				ИЛИ РеализацияТоваровУслугТовары.СерияНоменклатуры.СтранаПроисхождения = ЗНАЧЕНИЕ(Справочник.КлассификаторСтранМира.ПустаяСсылка))
				И РеализацияТоваровУслугТовары.Номенклатура.ВестиУчетПоСериям
			ТОГДА РеализацияТоваровУслугТовары.Номенклатура.СтранаПроисхождения
		ИНАЧЕ РеализацияТоваровУслугТовары.СерияНоменклатуры.СтранаПроисхождения
	КОНЕЦ КАК Страна,
	ВЫБОР
		КОГДА РеализацияТоваровУслугТовары.Номенклатура.ВестиУчетПоСериям
			ТОГДА ЕСТЬNULL(РеализацияТоваровУслугТовары.СерияНоменклатуры.НомерГТД.Код, ЕСТЬNULL(РеализацияТоваровУслугТовары.Номенклатура.НомерГТД.Код, ""))
		ИНАЧЕ ""
	КОНЕЦ КАК НомерГТД,
	РеализацияТоваровУслугТовары.Количество КАК Количество,
	РеализацияТоваровУслугТовары.Сумма КАК Сумма,
	РеализацияТоваровУслугТовары.СуммаНДС,
	ВЫБОР
		КОГДА РеализацияТоваровУслугТовары.Номенклатура.Услуга
			ТОГДА "Services"
		ИНАЧЕ ""
	КОНЕЦ КАК ТипЕдиницы
ИЗ
	Документ.РеализацияТоваровУслуг.Товары КАК РеализацияТоваровУслугТовары
ГДЕ
	РеализацияТоваровУслугТовары.Ссылка В(&amp;Ссылка)
	И (НЕ РеализацияТоваровУслугТовары.Номенклатура.Услуга
			ИЛИ &amp;РаботаСУслугами)

ОБЪЕДИНИТЬ ВСЕ

ВЫБРАТЬ
	0,
	ВозвратТоваровОтПокупателяТовары.Номенклатура,
	ВозвратТоваровОтПокупателяТовары.ХарактеристикаНоменклатуры,
	ВозвратТоваровОтПокупателяТовары.ЕдиницаИзмерения,
	ВозвратТоваровОтПокупателяТовары.ЕдиницаИзмерения.ЕдиницаПоКлассификатору.Наименование,
	ВЫРАЗИТЬ(ВозвратТоваровОтПокупателяТовары.Номенклатура.Наименование КАК СТРОКА(178)),
	ВЫРАЗИТЬ(ВозвратТоваровОтПокупателяТовары.Номенклатура.НаименованиеПолное КАК СТРОКА(500)),
	ВозвратТоваровОтПокупателяТовары.Цена,
	ВозвратТоваровОтПокупателяТовары.СтавкаНДС,
	ВозвратТоваровОтПокупателяТовары.СерияНоменклатуры,
	ВЫБОР
		КОГДА (ВозвратТоваровОтПокупателяТовары.СерияНоменклатуры = ЗНАЧЕНИЕ(Справочник.СерииНоменклатуры.ПустаяСсылка)
				ИЛИ ВозвратТоваровОтПокупателяТовары.СерияНоменклатуры.СтранаПроисхождения = ЗНАЧЕНИЕ(Справочник.КлассификаторСтранМира.ПустаяСсылка))
				И ВозвратТоваровОтПокупателяТовары.Номенклатура.ВестиУчетПоСериям
			ТОГДА ВозвратТоваровОтПокупателяТовары.Номенклатура.СтранаПроисхождения
		ИНАЧЕ ВозвратТоваровОтПокупателяТовары.СерияНоменклатуры.СтранаПроисхождения
	КОНЕЦ,
	ВЫБОР
		КОГДА ВозвратТоваровОтПокупателяТовары.Номенклатура.ВестиУчетПоСериям
			ТОГДА ЕСТЬNULL(ВозвратТоваровОтПокупателяТовары.СерияНоменклатуры.НомерГТД.Код, ЕСТЬNULL(ВозвратТоваровОтПокупателяТовары.Номенклатура.НомерГТД.Код, ""))
		ИНАЧЕ ""
	КОНЕЦ,
	-ВозвратТоваровОтПокупателяТовары.Количество,
	-ВозвратТоваровОтПокупателяТовары.Сумма,
	-ВозвратТоваровОтПокупателяТовары.СуммаНДС,
	""
ИЗ
	Документ.ВозвратТоваровОтПокупателя.Товары КАК ВозвратТоваровОтПокупателяТовары
ГДЕ
	ВозвратТоваровОтПокупателяТовары.Ссылка В(&amp;Возвраты)

ОБЪЕДИНИТЬ ВСЕ

ВЫБРАТЬ
	РеализацияТоваровУслугВозвратнаяТара.НомерСтроки,
	РеализацияТоваровУслугВозвратнаяТара.Номенклатура,
	НЕОПРЕДЕЛЕНО,
	РеализацияТоваровУслугВозвратнаяТара.Номенклатура.ЕдиницаХраненияОстатков,
	РеализацияТоваровУслугВозвратнаяТара.Номенклатура.ЕдиницаХраненияОстатков.ЕдиницаПоКлассификатору.Наименование,
	ВЫРАЗИТЬ(РеализацияТоваровУслугВозвратнаяТара.Номенклатура.Наименование КАК СТРОКА(178)),
	ВЫРАЗИТЬ(РеализацияТоваровУслугВозвратнаяТара.Номенклатура.НаименованиеПолное КАК СТРОКА(500)),
	РеализацияТоваровУслугВозвратнаяТара.Цена,
	ЗНАЧЕНИЕ(Перечисление.СтавкиНДС.БезНДС),
	НЕОПРЕДЕЛЕНО,
	РеализацияТоваровУслугВозвратнаяТара.Номенклатура.СтранаПроисхождения,
	"",
	РеализацияТоваровУслугВозвратнаяТара.Количество,
	РеализацияТоваровУслугВозвратнаяТара.Сумма,
	0,
	"RC"
ИЗ
	Документ.РеализацияТоваровУслуг.ВозвратнаяТара КАК РеализацияТоваровУслугВозвратнаяТара
ГДЕ
	&amp;ОтправлятьВозвратнуюТару
	И РеализацияТоваровУслугВозвратнаяТара.Ссылка В(&amp;Ссылка)

ОБЪЕДИНИТЬ ВСЕ

ВЫБРАТЬ
	0,
	ВозвратТоваровОтПокупателяВозвратнаяТара.Номенклатура,
	НЕОПРЕДЕЛЕНО,
	ВозвратТоваровОтПокупателяВозвратнаяТара.Номенклатура.ЕдиницаХраненияОстатков,
	ВозвратТоваровОтПокупателяВозвратнаяТара.Номенклатура.ЕдиницаХраненияОстатков.ЕдиницаПоКлассификатору.Наименование,
	ВЫРАЗИТЬ(ВозвратТоваровОтПокупателяВозвратнаяТара.Номенклатура.Наименование КАК СТРОКА(178)),
	ВЫРАЗИТЬ(ВозвратТоваровОтПокупателяВозвратнаяТара.Номенклатура.НаименованиеПолное КАК СТРОКА(500)),
	ВозвратТоваровОтПокупателяВозвратнаяТара.Цена,
	ЗНАЧЕНИЕ(Перечисление.СтавкиНДС.БезНДС),
	НЕОПРЕДЕЛЕНО,
	ВозвратТоваровОтПокупателяВозвратнаяТара.Номенклатура.СтранаПроисхождения,
	"",
	-ВозвратТоваровОтПокупателяВозвратнаяТара.Количество,
	-ВозвратТоваровОтПокупателяВозвратнаяТара.Сумма,
	0,
	"RC"
ИЗ
	Документ.ВозвратТоваровОтПокупателя.ВозвратнаяТара КАК ВозвратТоваровОтПокупателяВозвратнаяТара
ГДЕ
	&amp;ОтправлятьВозвратнуюТару
	И ВозвратТоваровОтПокупателяВозвратнаяТара.Ссылка В(&amp;Возвраты)

ОБЪЕДИНИТЬ ВСЕ

ВЫБРАТЬ
	РеализацияТоваровУслугТовары.НомерСтроки,
	РеализацияТоваровУслугТовары.Номенклатура,
	НЕОПРЕДЕЛЕНО,
	РеализацияТоваровУслугТовары.Номенклатура.ЕдиницаХраненияОстатков,
	РеализацияТоваровУслугТовары.Номенклатура.ЕдиницаХраненияОстатков.ЕдиницаПоКлассификатору.Наименование,
	ВЫРАЗИТЬ(РеализацияТоваровУслугТовары.Номенклатура.Наименование КАК СТРОКА(178)),
	ВЫРАЗИТЬ(РеализацияТоваровУслугТовары.Номенклатура.НаименованиеПолное КАК СТРОКА(500)),
	РеализацияТоваровУслугТовары.Цена,
	РеализацияТоваровУслугТовары.СтавкаНДС,
	НЕОПРЕДЕЛЕНО,
	РеализацияТоваровУслугТовары.Номенклатура.СтранаПроисхождения,
	"",
	РеализацияТоваровУслугТовары.Количество,
	РеализацияТоваровУслугТовары.Сумма,
	РеализацияТоваровУслугТовары.СуммаНДС,
	"Services"
ИЗ
	Документ.РеализацияТоваровУслуг.Услуги КАК РеализацияТоваровУслугТовары
ГДЕ
	&amp;РаботаСУслугами
	И РеализацияТоваровУслугТовары.Ссылка В(&amp;Ссылка)</query>
						<autoFillFields>false</autoFillFields>
					</item>
				</item>
				<item xsi:type="DataSetUnion">
					<name>_RETINS_RETREC_</name>
					<field xsi:type="DataSetFieldField">
						<dataPath>НомерСтроки</dataPath>
						<field>НомерСтроки</field>
					</field>
					<field xsi:type="DataSetFieldField">
						<dataPath>ЕдиницаИзмерения</dataPath>
						<field>ЕдиницаИзмерения</field>
					</field>
					<field xsi:type="DataSetFieldField">
						<dataPath>КодЕдиницыИзмерения</dataPath>
						<field>КодЕдиницыИзмерения</field>
					</field>
					<field xsi:type="DataSetFieldField">
						<dataPath>Количество</dataPath>
						<field>Количество</field>
					</field>
					<field xsi:type="DataSetFieldField">
						<dataPath>Наименование</dataPath>
						<field>Наименование</field>
					</field>
					<field xsi:type="DataSetFieldField">
						<dataPath>НаименованиеПолное</dataPath>
						<field>НаименованиеПолное</field>
					</field>
					<field xsi:type="DataSetFieldField">
						<dataPath>Номенклатура</dataPath>
						<field>Номенклатура</field>
					</field>
					<field xsi:type="DataSetFieldField">
						<dataPath>НомерГТД</dataPath>
						<field>НомерГТД</field>
					</field>
					<field xsi:type="DataSetFieldField">
						<dataPath>СерияНоменклатуры</dataPath>
						<field>СерияНоменклатуры</field>
					</field>
					<field xsi:type="DataSetFieldField">
						<dataPath>СтавкаНДС</dataPath>
						<field>СтавкаНДС</field>
					</field>
					<field xsi:type="DataSetFieldField">
						<dataPath>Страна</dataPath>
						<field>Страна</field>
					</field>
					<field xsi:type="DataSetFieldField">
						<dataPath>Сумма</dataPath>
						<field>Сумма</field>
					</field>
					<field xsi:type="DataSetFieldField">
						<dataPath>СуммаНДС</dataPath>
						<field>СуммаНДС</field>
					</field>
					<field xsi:type="DataSetFieldField">
						<dataPath>ТипЕдиницы</dataPath>
						<field>ТипЕдиницы</field>
					</field>
					<field xsi:type="DataSetFieldField">
						<dataPath>ХарактеристикаНоменклатуры</dataPath>
						<field>ХарактеристикаНоменклатуры</field>
					</field>
					<field xsi:type="DataSetFieldField">
						<dataPath>Цена</dataPath>
						<field>Цена</field>
					</field>
					<item xsi:type="DataSetQuery">
						<name>ВозвратТоваровОтПокупателя</name>
						<field xsi:type="DataSetFieldField">
							<dataPath>НомерСтроки</dataPath>
							<field>НомерСтроки</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>ЕдиницаИзмерения</dataPath>
							<field>ЕдиницаИзмерения</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>КодЕдиницыИзмерения</dataPath>
							<field>КодЕдиницыИзмерения</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>Количество</dataPath>
							<field>Количество</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>Наименование</dataPath>
							<field>Наименование</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>НаименованиеПолное</dataPath>
							<field>НаименованиеПолное</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>Номенклатура</dataPath>
							<field>Номенклатура</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>НомерГТД</dataPath>
							<field>НомерГТД</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>СерияНоменклатуры</dataPath>
							<field>СерияНоменклатуры</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>СтавкаНДС</dataPath>
							<field>СтавкаНДС</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>Страна</dataPath>
							<field>Страна</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>Сумма</dataPath>
							<field>Сумма</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>СуммаНДС</dataPath>
							<field>СуммаНДС</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>ТипЕдиницы</dataPath>
							<field>ТипЕдиницы</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>ХарактеристикаНоменклатуры</dataPath>
							<field>ХарактеристикаНоменклатуры</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>Цена</dataPath>
							<field>Цена</field>
						</field>
						<dataSource>ИсточникДанных1</dataSource>
						<query>ВЫБРАТЬ
	ВозвратТоваровОтПокупателяТовары.НомерСтроки,
	ВозвратТоваровОтПокупателяТовары.Номенклатура,
	ВозвратТоваровОтПокупателяТовары.ХарактеристикаНоменклатуры,
	ВозвратТоваровОтПокупателяТовары.ЕдиницаИзмерения,
	ВозвратТоваровОтПокупателяТовары.ЕдиницаИзмерения.ЕдиницаПоКлассификатору.Наименование КАК КодЕдиницыИзмерения,
	ВЫРАЗИТЬ(ВозвратТоваровОтПокупателяТовары.Номенклатура.Наименование КАК СТРОКА(178)) КАК Наименование,
	ВЫРАЗИТЬ(ВозвратТоваровОтПокупателяТовары.Номенклатура.НаименованиеПолное КАК СТРОКА(500)) КАК НаименованиеПолное,
	ВозвратТоваровОтПокупателяТовары.Цена,
	ВозвратТоваровОтПокупателяТовары.СтавкаНДС,
	ВозвратТоваровОтПокупателяТовары.СерияНоменклатуры,
	ВЫБОР
		КОГДА (ВозвратТоваровОтПокупателяТовары.СерияНоменклатуры = ЗНАЧЕНИЕ(Справочник.СерииНоменклатуры.ПустаяСсылка)
				ИЛИ ВозвратТоваровОтПокупателяТовары.СерияНоменклатуры.СтранаПроисхождения = ЗНАЧЕНИЕ(Справочник.КлассификаторСтранМира.ПустаяСсылка))
				И ВозвратТоваровОтПокупателяТовары.Номенклатура.ВестиУчетПоСериям
			ТОГДА ВозвратТоваровОтПокупателяТовары.Номенклатура.СтранаПроисхождения
		ИНАЧЕ ВозвратТоваровОтПокупателяТовары.СерияНоменклатуры.СтранаПроисхождения
	КОНЕЦ КАК Страна,
	ВЫБОР
		КОГДА ВозвратТоваровОтПокупателяТовары.Номенклатура.ВестиУчетПоСериям
			ТОГДА ЕСТЬNULL(ВозвратТоваровОтПокупателяТовары.СерияНоменклатуры.НомерГТД.Код, ЕСТЬNULL(ВозвратТоваровОтПокупателяТовары.Номенклатура.НомерГТД.Код, ""))
		ИНАЧЕ ""
	КОНЕЦ КАК НомерГТД,
	ВозвратТоваровОтПокупателяТовары.Количество,
	ВозвратТоваровОтПокупателяТовары.Сумма,
	ВозвратТоваровОтПокупателяТовары.СуммаНДС,
	"" КАК ТипЕдиницы
ИЗ
	Документ.ВозвратТоваровОтПокупателя.Товары КАК ВозвратТоваровОтПокупателяТовары
ГДЕ
	ВозвратТоваровОтПокупателяТовары.Ссылка В(&amp;Ссылка)</query>
					</item>
					<item xsi:type="DataSetQuery">
						<name>ПоступлениеТоваровУслуг</name>
						<field xsi:type="DataSetFieldField">
							<dataPath>НомерСтроки</dataPath>
							<field>НомерСтроки</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>ЕдиницаИзмерения</dataPath>
							<field>ЕдиницаИзмерения</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>КодЕдиницыИзмерения</dataPath>
							<field>КодЕдиницыИзмерения</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>Количество</dataPath>
							<field>Количество</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>Наименование</dataPath>
							<field>Наименование</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>НаименованиеПолное</dataPath>
							<field>НаименованиеПолное</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>Номенклатура</dataPath>
							<field>Номенклатура</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>НомерГТД</dataPath>
							<field>НомерГТД</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>СерияНоменклатуры</dataPath>
							<field>СерияНоменклатуры</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>СтавкаНДС</dataPath>
							<field>СтавкаНДС</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>Страна</dataPath>
							<field>Страна</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>Сумма</dataPath>
							<field>Сумма</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>СуммаНДС</dataPath>
							<field>СуммаНДС</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>ТипЕдиницы</dataPath>
							<field>ТипЕдиницы</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>ХарактеристикаНоменклатуры</dataPath>
							<field>ХарактеристикаНоменклатуры</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>Цена</dataPath>
							<field>Цена</field>
						</field>
						<dataSource>ИсточникДанных1</dataSource>
						<query>ВЫБРАТЬ
	ПоступлениеТоваровУслугТовары.НомерСтроки,
	ПоступлениеТоваровУслугТовары.Номенклатура,
	ПоступлениеТоваровУслугТовары.ХарактеристикаНоменклатуры,
	ПоступлениеТоваровУслугТовары.ЕдиницаИзмерения,
	ПоступлениеТоваровУслугТовары.ЕдиницаИзмерения.ЕдиницаПоКлассификатору.Наименование КАК КодЕдиницыИзмерения,
	ВЫРАЗИТЬ(ПоступлениеТоваровУслугТовары.Номенклатура.Наименование КАК СТРОКА(178)) КАК Наименование,
	ВЫРАЗИТЬ(ПоступлениеТоваровУслугТовары.Номенклатура.НаименованиеПолное КАК СТРОКА(500)) КАК НаименованиеПолное,
	ПоступлениеТоваровУслугТовары.Цена,
	ПоступлениеТоваровУслугТовары.СтавкаНДС,
	ПоступлениеТоваровУслугТовары.СерияНоменклатуры,
	ВЫБОР
		КОГДА (ПоступлениеТоваровУслугТовары.СерияНоменклатуры = ЗНАЧЕНИЕ(Справочник.СерииНоменклатуры.ПустаяСсылка)
				ИЛИ ПоступлениеТоваровУслугТовары.СерияНоменклатуры.СтранаПроисхождения = ЗНАЧЕНИЕ(Справочник.КлассификаторСтранМира.ПустаяСсылка))
				И ПоступлениеТоваровУслугТовары.Номенклатура.ВестиУчетПоСериям
			ТОГДА ПоступлениеТоваровУслугТовары.Номенклатура.СтранаПроисхождения
		ИНАЧЕ ПоступлениеТоваровУслугТовары.СерияНоменклатуры.СтранаПроисхождения
	КОНЕЦ КАК Страна,
	ВЫБОР
		КОГДА ПоступлениеТоваровУслугТовары.Номенклатура.ВестиУчетПоСериям
			ТОГДА ЕСТЬNULL(ПоступлениеТоваровУслугТовары.СерияНоменклатуры.НомерГТД.Код, ЕСТЬNULL(ПоступлениеТоваровУслугТовары.Номенклатура.НомерГТД.Код, ""))
		ИНАЧЕ ""
	КОНЕЦ КАК НомерГТД,
	ПоступлениеТоваровУслугТовары.Количество,
	ПоступлениеТоваровУслугТовары.Сумма,
	ПоступлениеТоваровУслугТовары.СуммаНДС,
	"" КАК ТипЕдиницы
ИЗ
	Документ.ПоступлениеТоваровУслуг.Товары КАК ПоступлениеТоваровУслугТовары
ГДЕ
	ПоступлениеТоваровУслугТовары.Ссылка В(&amp;Ссылка)</query>
					</item>
				</item>
				<item xsi:type="DataSetUnion">
					<name>_PRICELIST_</name>
					<field xsi:type="DataSetFieldField">
						<dataPath>GTIN</dataPath>
						<field>GTIN</field>
					</field>
					<field xsi:type="DataSetFieldField">
						<dataPath>ЕдИзмСрокаГодности</dataPath>
						<field>ЕдИзмСрокаГодности</field>
					</field>
					<field xsi:type="DataSetFieldField">
						<dataPath>ЕдиницаИзмерения</dataPath>
						<field>ЕдиницаИзмерения</field>
					</field>
					<field xsi:type="DataSetFieldField">
						<dataPath>КвантПоставки</dataPath>
						<field>КвантПоставки</field>
					</field>
					<field xsi:type="DataSetFieldField">
						<dataPath>КодТовараПоставщика</dataPath>
						<field>КодТовараПоставщика</field>
					</field>
					<field xsi:type="DataSetFieldField">
						<dataPath>КоличествоВОдномМесте</dataPath>
						<field>КоличествоВОдномМесте</field>
					</field>
					<field xsi:type="DataSetFieldField">
						<dataPath>Наименование</dataPath>
						<field>Наименование</field>
					</field>
					<field xsi:type="DataSetFieldField">
						<dataPath>Номенклатура</dataPath>
						<field>Номенклатура</field>
					</field>
					<field xsi:type="DataSetFieldField">
						<dataPath>Родитель</dataPath>
						<field>Родитель</field>
					</field>
					<field xsi:type="DataSetFieldField">
						<dataPath>СрокГодности</dataPath>
						<field>СрокГодности</field>
					</field>
					<field xsi:type="DataSetFieldField">
						<dataPath>СтавкаНДС</dataPath>
						<field>СтавкаНДС</field>
					</field>
					<field xsi:type="DataSetFieldField">
						<dataPath>Страна</dataPath>
						<field>Страна</field>
					</field>
					<field xsi:type="DataSetFieldField">
						<dataPath>Цена</dataPath>
						<field>Цена</field>
					</field>
					<field xsi:type="DataSetFieldField">
						<dataPath>КоличествоОстаткаНаКонец</dataPath>
						<field>КоличествоОстаткаНаКонец</field>
					</field>
					<field xsi:type="DataSetFieldField">
						<dataPath>Качество</dataPath>
						<field>Качество</field>
					</field>
					<field xsi:type="DataSetFieldField">
						<dataPath>СерияНоменклатуры</dataPath>
						<field>СерияНоменклатуры</field>
					</field>
					<field xsi:type="DataSetFieldField">
						<dataPath>Склад</dataPath>
						<field>Склад</field>
					</field>
					<field xsi:type="DataSetFieldField">
						<dataPath>ХарактеристикаНоменклатуры</dataPath>
						<field>ХарактеристикаНоменклатуры</field>
					</field>
					<field xsi:type="DataSetFieldField">
						<dataPath>РекомендуемаяРозничнаяЦена</dataPath>
						<field>РекомендуемаяРозничнаяЦена</field>
					</field>
					<item xsi:type="DataSetQuery">
						<name>Ценовой_лист_БезЦен</name>
						<field xsi:type="DataSetFieldField">
							<dataPath>GTIN</dataPath>
							<field>GTIN</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>ЕдИзмСрокаГодности</dataPath>
							<field>ЕдИзмСрокаГодности</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>ЕдиницаИзмерения</dataPath>
							<field>ЕдиницаИзмерения</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>КвантПоставки</dataPath>
							<field>КвантПоставки</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>КодТовараПоставщика</dataPath>
							<field>КодТовараПоставщика</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>КоличествоВОдномМесте</dataPath>
							<field>КоличествоВОдномМесте</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>Наименование</dataPath>
							<field>Наименование</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>Номенклатура</dataPath>
							<field>Номенклатура</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>Родитель</dataPath>
							<field>Родитель</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>СрокГодности</dataPath>
							<field>СрокГодности</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>СтавкаНДС</dataPath>
							<field>СтавкаНДС</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>Страна</dataPath>
							<field>Страна</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>Цена</dataPath>
							<field>Цена</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>РекомендуемаяРозничнаяЦена</dataPath>
							<field>РекомендуемаяРозничнаяЦена</field>
						</field>
						<dataSource>ИсточникДанных1</dataSource>
						<query>   ВЫБРАТЬ
	СправочникНоменклатура.Родитель КАК Родитель,
	СправочникНоменклатура.Ссылка КАК Номенклатура,
	СправочникНоменклатура.ЕдиницаХраненияОстатков КАК ЕдиницаИзмерения,
	СправочникНоменклатура.Код КАК КодТовараПоставщика,
	СправочникНоменклатура.НаименованиеПолное КАК Наименование,
	СправочникНоменклатура.СтавкаНДС КАК СтавкаНДС,
	0 КАК Цена,
	0 КАК РекомендуемаяРозничнаяЦена,
	Штрихкоды.Штрихкод КАК GTIN,
	СправочникНоменклатура.ЕдиницаХраненияОстатков.Коэффициент КАК КоличествоВОдномМесте,
	СправочникНоменклатура.СтранаПроисхождения КАК Страна,
	NULL КАК КвантПоставки,
	NULL КАК ЕдИзмСрокаГодности,
	NULL КАК СрокГодности
ИЗ
	Справочник.Номенклатура КАК СправочникНоменклатура
		ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.Штрихкоды КАК Штрихкоды
		ПО СправочникНоменклатура.Ссылка = Штрихкоды.Владелец
			И (Штрихкоды.ХарактеристикаНоменклатуры = ЗНАЧЕНИЕ(Справочник.ХарактеристикиНоменклатуры.ПустаяСсылка))
			И (Штрихкоды.ЕдиницаИзмерения = СправочникНоменклатура.ЕдиницаХраненияОстатков)
ГДЕ
	НЕ СправочникНоменклатура.ЭтоГруппа
	И НЕ СправочникНоменклатура.ПометкаУдаления
	И НЕ СправочникНоменклатура.Услуга
	И &amp;УсловиеОтбораНоменклатуры</query>
					</item>
					<item xsi:type="DataSetQuery">
						<name>Ценовой_лист_СЦенами</name>
						<field xsi:type="DataSetFieldField">
							<dataPath>GTIN</dataPath>
							<field>GTIN</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>ЕдИзмСрокаГодности</dataPath>
							<field>ЕдИзмСрокаГодности</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>ЕдиницаИзмерения</dataPath>
							<field>ЕдиницаИзмерения</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>КвантПоставки</dataPath>
							<field>КвантПоставки</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>КодТовараПоставщика</dataPath>
							<field>КодТовараПоставщика</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>КоличествоВОдномМесте</dataPath>
							<field>КоличествоВОдномМесте</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>Наименование</dataPath>
							<field>Наименование</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>Номенклатура</dataPath>
							<field>Номенклатура</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>Родитель</dataPath>
							<field>Родитель</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>СрокГодности</dataPath>
							<field>СрокГодности</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>СтавкаНДС</dataPath>
							<field>СтавкаНДС</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>Страна</dataPath>
							<field>Страна</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>Цена</dataPath>
							<field>Цена</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>РекомендуемаяРозничнаяЦена</dataPath>
							<field>РекомендуемаяРозничнаяЦена</field>
						</field>
						<dataSource>ИсточникДанных1</dataSource>
						<query>  ВЫБРАТЬ
	ЦеныНоменклатурыСрезПоследних.Номенклатура.Родитель КАК Родитель,
	ЦеныНоменклатурыСрезПоследних.Номенклатура.Ссылка КАК Номенклатура,
	ЦеныНоменклатурыСрезПоследних.ЕдиницаИзмерения КАК ЕдиницаИзмерения,
	ЦеныНоменклатурыСрезПоследних.Номенклатура.Код КАК КодТовараПоставщика,
	ЦеныНоменклатурыСрезПоследних.Номенклатура.НаименованиеПолное КАК Наименование,
	ЦеныНоменклатурыСрезПоследних.Номенклатура.СтавкаНДС КАК СтавкаНДС,
	ЦеныНоменклатурыСрезПоследних.Цена,
	0 КАК РекомендуемаяРозничнаяЦена,
	Штрихкоды.Штрихкод КАК GTIN,
	ЦеныНоменклатурыСрезПоследних.ЕдиницаИзмерения.Коэффициент КАК КоличествоВОдномМесте,
	ЦеныНоменклатурыСрезПоследних.Номенклатура.СтранаПроисхождения КАК Страна,
	NULL КАК КвантПоставки,
	NULL КАК ЕдИзмСрокаГодности,
	NULL КАК СрокГодности
ИЗ
	РегистрСведений.ЦеныНоменклатуры.СрезПоследних(
			,
			ТипЦен = &amp;ТипЦен
				И НЕ Номенклатура.ПометкаУдаления
				И ХарактеристикаНоменклатуры = ЗНАЧЕНИЕ(Справочник.ХарактеристикиНоменклатуры.ПустаяСсылка)
				И НЕ Номенклатура.Услуга
				И &amp;УсловиеОтбораНоменклатуры) КАК ЦеныНоменклатурыСрезПоследних
		ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.Штрихкоды КАК Штрихкоды
		ПО ЦеныНоменклатурыСрезПоследних.Номенклатура = Штрихкоды.Владелец
			И (Штрихкоды.ХарактеристикаНоменклатуры = ЗНАЧЕНИЕ(Справочник.ХарактеристикиНоменклатуры.ПустаяСсылка))
			И (Штрихкоды.ЕдиницаИзмерения = ЦеныНоменклатурыСрезПоследних.ЕдиницаИзмерения)
ГДЕ
	ЦеныНоменклатурыСрезПоследних.Цена &gt; 0</query>
					</item>
					<item xsi:type="DataSetQuery">
						<name>Ценовой_лист_БезЦен_Остатки</name>
						<field xsi:type="DataSetFieldField">
							<dataPath>GTIN</dataPath>
							<field>GTIN</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>ЕдИзмСрокаГодности</dataPath>
							<field>ЕдИзмСрокаГодности</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>ЕдиницаИзмерения</dataPath>
							<field>ЕдиницаИзмерения</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>КвантПоставки</dataPath>
							<field>КвантПоставки</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>КодТовараПоставщика</dataPath>
							<field>КодТовараПоставщика</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>КоличествоВОдномМесте</dataPath>
							<field>КоличествоВОдномМесте</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>Наименование</dataPath>
							<field>Наименование</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>Номенклатура</dataPath>
							<field>Номенклатура</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>Родитель</dataPath>
							<field>Родитель</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>СрокГодности</dataPath>
							<field>СрокГодности</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>СтавкаНДС</dataPath>
							<field>СтавкаНДС</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>Страна</dataPath>
							<field>Страна</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>Цена</dataPath>
							<field>Цена</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>КоличествоОстаткаНаКонец</dataPath>
							<field>КоличествоОстаткаНаКонец</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>Качество</dataPath>
							<field>Качество</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>СерияНоменклатуры</dataPath>
							<field>СерияНоменклатуры</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>Склад</dataPath>
							<field>Склад</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>ХарактеристикаНоменклатуры</dataPath>
							<field>ХарактеристикаНоменклатуры</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>РекомендуемаяРозничнаяЦена</dataPath>
							<field>РекомендуемаяРозничнаяЦена</field>
						</field>
						<dataSource>ИсточникДанных1</dataSource>
						<query>ВЫБРАТЬ
	СправочникНоменклатура.Родитель КАК Родитель,
	СправочникНоменклатура.Ссылка КАК Номенклатура,
	СправочникНоменклатура.ЕдиницаХраненияОстатков КАК ЕдиницаИзмерения,
	СправочникНоменклатура.Код КАК КодТовараПоставщика,
	СправочникНоменклатура.НаименованиеПолное КАК Наименование,
	СправочникНоменклатура.СтавкаНДС КАК СтавкаНДС,
	0 КАК Цена,
	0 КАК РекомендуемаяРозничнаяЦена,
	Штрихкоды.Штрихкод КАК GTIN,
	СправочникНоменклатура.ЕдиницаХраненияОстатков.Коэффициент КАК КоличествоВОдномМесте,
	СправочникНоменклатура.СтранаПроисхождения КАК Страна,
	NULL КАК КвантПоставки,
	NULL КАК ЕдИзмСрокаГодности,
	NULL КАК СрокГодности,
	ЕСТЬNULL(ТоварыНаСкладахОстатки.КоличествоОстаток, 0) КАК КоличествоОстаткаНаКонец
ИЗ
	Справочник.Номенклатура КАК СправочникНоменклатура
		ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.Штрихкоды КАК Штрихкоды
		ПО СправочникНоменклатура.Ссылка = Штрихкоды.Владелец
			И (Штрихкоды.ХарактеристикаНоменклатуры = ЗНАЧЕНИЕ(Справочник.ХарактеристикиНоменклатуры.ПустаяСсылка))
			И (Штрихкоды.ЕдиницаИзмерения = СправочникНоменклатура.ЕдиницаХраненияОстатков)
		ЛЕВОЕ СОЕДИНЕНИЕ РегистрНакопления.ТоварыНаСкладах.Остатки(
				,
				ВЫБОР
					КОГДА &amp;Склад = НЕОПРЕДЕЛЕНО
						ТОГДА ИСТИНА
					ИНАЧЕ Склад В (&amp;Склад)
				КОНЕЦ) КАК ТоварыНаСкладахОстатки
		ПО СправочникНоменклатура.Ссылка = ТоварыНаСкладахОстатки.Номенклатура
ГДЕ
	НЕ СправочникНоменклатура.ЭтоГруппа
	И НЕ СправочникНоменклатура.ПометкаУдаления
	И НЕ СправочникНоменклатура.Услуга
	И &amp;УсловиеОтбораНоменклатуры</query>
					</item>
					<item xsi:type="DataSetQuery">
						<name>Ценовой_лист_СЦенами_Остатки</name>
						<field xsi:type="DataSetFieldField">
							<dataPath>GTIN</dataPath>
							<field>GTIN</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>ЕдИзмСрокаГодности</dataPath>
							<field>ЕдИзмСрокаГодности</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>ЕдиницаИзмерения</dataPath>
							<field>ЕдиницаИзмерения</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>КвантПоставки</dataPath>
							<field>КвантПоставки</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>КодТовараПоставщика</dataPath>
							<field>КодТовараПоставщика</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>КоличествоВОдномМесте</dataPath>
							<field>КоличествоВОдномМесте</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>Наименование</dataPath>
							<field>Наименование</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>Номенклатура</dataPath>
							<field>Номенклатура</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>Родитель</dataPath>
							<field>Родитель</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>СрокГодности</dataPath>
							<field>СрокГодности</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>СтавкаНДС</dataPath>
							<field>СтавкаНДС</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>Страна</dataPath>
							<field>Страна</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>Цена</dataPath>
							<field>Цена</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>КоличествоОстаткаНаКонец</dataPath>
							<field>КоличествоОстаткаНаКонец</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>Качество</dataPath>
							<field>Качество</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>СерияНоменклатуры</dataPath>
							<field>СерияНоменклатуры</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>Склад</dataPath>
							<field>Склад</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>ХарактеристикаНоменклатуры</dataPath>
							<field>ХарактеристикаНоменклатуры</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>РекомендуемаяРозничнаяЦена</dataPath>
							<field>РекомендуемаяРозничнаяЦена</field>
						</field>
						<dataSource>ИсточникДанных1</dataSource>
						<query>ВЫБРАТЬ
	ЦеныНоменклатурыСрезПоследних.Номенклатура.Родитель КАК Родитель,
	ЦеныНоменклатурыСрезПоследних.Номенклатура.Ссылка КАК Номенклатура,
	ЦеныНоменклатурыСрезПоследних.ЕдиницаИзмерения КАК ЕдиницаИзмерения,
	ЦеныНоменклатурыСрезПоследних.Номенклатура.Код КАК КодТовараПоставщика,
	ЦеныНоменклатурыСрезПоследних.Номенклатура.НаименованиеПолное КАК Наименование,
	ЦеныНоменклатурыСрезПоследних.Номенклатура.СтавкаНДС КАК СтавкаНДС,
	ЦеныНоменклатурыСрезПоследних.Цена,
	0 КАК РекомендуемаяРозничнаяЦена,
	Штрихкоды.Штрихкод КАК GTIN,
	ЦеныНоменклатурыСрезПоследних.ЕдиницаИзмерения.Коэффициент КАК КоличествоВОдномМесте,
	ЦеныНоменклатурыСрезПоследних.Номенклатура.СтранаПроисхождения КАК Страна,
	NULL КАК КвантПоставки,
	NULL КАК ЕдИзмСрокаГодности,
	NULL КАК СрокГодности,
	ЕСТЬNULL(ТоварыНаСкладахОстатки.КоличествоОстаток, 0) КАК КоличествоОстаткаНаКонец
ИЗ
	РегистрСведений.ЦеныНоменклатуры.СрезПоследних(
			,
			ТипЦен = &amp;ТипЦен
				И НЕ Номенклатура.ПометкаУдаления
				И ХарактеристикаНоменклатуры = ЗНАЧЕНИЕ(Справочник.ХарактеристикиНоменклатуры.ПустаяСсылка)
				И НЕ Номенклатура.Услуга
				И &amp;УсловиеОтбораНоменклатуры) КАК ЦеныНоменклатурыСрезПоследних
		ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.Штрихкоды КАК Штрихкоды
		ПО ЦеныНоменклатурыСрезПоследних.Номенклатура = Штрихкоды.Владелец
			И (Штрихкоды.ХарактеристикаНоменклатуры = ЗНАЧЕНИЕ(Справочник.ХарактеристикиНоменклатуры.ПустаяСсылка))
			И (Штрихкоды.ЕдиницаИзмерения = ЦеныНоменклатурыСрезПоследних.ЕдиницаИзмерения)
		ЛЕВОЕ СОЕДИНЕНИЕ РегистрНакопления.ТоварыНаСкладах.Остатки(
				,
				ВЫБОР
					КОГДА &amp;Склад = НЕОПРЕДЕЛЕНО
						ТОГДА ИСТИНА
					ИНАЧЕ Склад В (&amp;Склад)
				КОНЕЦ) КАК ТоварыНаСкладахОстатки
		ПО ЦеныНоменклатурыСрезПоследних.Номенклатура = ТоварыНаСкладахОстатки.Номенклатура
ГДЕ
	ЦеныНоменклатурыСрезПоследних.Цена &gt; 0</query>
					</item>
				</item>
			</item>
		</item>
		<item xsi:type="DataSetUnion">
			<name>Покупатель</name>
			<item xsi:type="DataSetUnion">
				<name>ЗапросОсновнойЦепочки</name>
				<item xsi:type="DataSetQuery">
					<name>Заказ_Поступление_СФ</name>
					<dataSource>ИсточникДанных1</dataSource>
					<query>ВЫБРАТЬ
	ЗаказПоставщику.Ссылка КАК PORDERS,
	ЗаказПоставщику.Ссылка КАК ORDERS,
	ЗаказПоставщику.Ссылка КАК ORDRSP,
	ПоступлениеТоваровУслуг.Ссылка КАК DESADV,
	ПоступлениеТоваровУслуг.Ссылка КАК RECADV,
	СчетФактураПолученный.Ссылка КАК INVOIC
ИЗ
	(ВЫБРАТЬ
		1 КАК Поле1) КАК Заглушка
		{ПОЛНОЕ СОЕДИНЕНИЕ Документ.СчетФактураПолученный КАК СчетФактураПолученный
			{ПОЛНОЕ СОЕДИНЕНИЕ Документ.ПоступлениеТоваровУслуг КАК ПоступлениеТоваровУслуг
				{ПОЛНОЕ СОЕДИНЕНИЕ Документ.ЗаказПоставщику КАК ЗаказПоставщику
				ПО ПоступлениеТоваровУслуг.Сделка = ЗаказПоставщику.Ссылка}
			ПО СчетФактураПолученный.ДокументОснование = ПоступлениеТоваровУслуг.Ссылка}
		ПО (ИСТИНА)}</query>
					<autoFillFields>false</autoFillFields>
				</item>
			</item>
			<item xsi:type="DataSetUnion">
				<name>ЗапросПоТоварам</name>
				<item xsi:type="DataSetUnion">
					<name>_ORDERS_</name>
					<item xsi:type="DataSetQuery">
						<name>ЗаказПоставщику</name>
						<dataSource>ИсточникДанных1</dataSource>
						<query>ВЫБРАТЬ
	ЗаказПоставщикуТовары.Номенклатура.Код КАК КодТовараПокупателя,
	ЗаказПоставщикуТовары.Номенклатура,
	ЗаказПоставщикуТовары.ХарактеристикаНоменклатуры,
	ЗаказПоставщикуТовары.ЕдиницаИзмерения КАК ЕдиницаИзмерения,
	ЗаказПоставщикуТовары.ЕдиницаИзмерения.ЕдиницаПоКлассификатору.Наименование КАК КодЕдиницыИзмерения,
	ВЫРАЗИТЬ(ЗаказПоставщикуТовары.Номенклатура.Наименование КАК СТРОКА(178)) КАК Наименование,
	ЗаказПоставщикуТовары.Цена,
	ЗаказПоставщикуТовары.СтавкаНДС,
	СУММА(ЗаказПоставщикуТовары.Количество) КАК Количество,
	СУММА(ЗаказПоставщикуТовары.Сумма) КАК Сумма,
	СУММА(ЗаказПоставщикуТовары.СуммаНДС) КАК СуммаНДС
ИЗ
	Документ.ЗаказПоставщику.Товары КАК ЗаказПоставщикуТовары
ГДЕ
	ЗаказПоставщикуТовары.Ссылка = &amp;Ссылка

СГРУППИРОВАТЬ ПО
	ЗаказПоставщикуТовары.Номенклатура,
	ЗаказПоставщикуТовары.ХарактеристикаНоменклатуры,
	ЗаказПоставщикуТовары.ЕдиницаИзмерения,
	ЗаказПоставщикуТовары.Цена,
	ЗаказПоставщикуТовары.СтавкаНДС,
	ЗаказПоставщикуТовары.Номенклатура.Код,
	ВЫРАЗИТЬ(ЗаказПоставщикуТовары.Номенклатура.Наименование КАК СТРОКА(178))</query>
						<autoFillFields>false</autoFillFields>
					</item>
				</item>
				<item xsi:type="DataSetUnion">
					<name>_RECADV_</name>
					<item xsi:type="DataSetQuery">
						<name>ПоступлениеТоваровУслуг</name>
						<dataSource>ИсточникДанных1</dataSource>
						<query>ВЫБРАТЬ
	ПоступлениеТоваровУслугТовары.Номенклатура,
	ПоступлениеТоваровУслугТовары.ХарактеристикаНоменклатуры,
	ПоступлениеТоваровУслугТовары.ЕдиницаИзмерения КАК ЕдиницаИзмерения,
	ПоступлениеТоваровУслугТовары.ЕдиницаИзмерения.ЕдиницаПоКлассификатору.Наименование КАК КодЕдиницыИзмерения,
	ВЫРАЗИТЬ(ПоступлениеТоваровУслугТовары.Номенклатура.Наименование КАК СТРОКА(178)) КАК Наименование,
	ПоступлениеТоваровУслугТовары.Количество КАК Количество,
	ПоступлениеТоваровУслугТовары.Цена,
	ПоступлениеТоваровУслугТовары.СтавкаНДС,
	ПоступлениеТоваровУслугТовары.Сумма,
	ПоступлениеТоваровУслугТовары.СуммаНДС
ИЗ
	Документ.ПоступлениеТоваровУслуг.Товары КАК ПоступлениеТоваровУслугТовары
ГДЕ
	ПоступлениеТоваровУслугТовары.Ссылка = &amp;Ссылка</query>
						<autoFillFields>false</autoFillFields>
					</item>
				</item>
			</item>
			<item xsi:type="DataSetQuery">
				<name>КонвертироватьТоварыEDIВ1С</name>
				<dataSource>ИсточникДанных1</dataSource>
				<query>ВЫБРАТЬ
	ТабТоваров.GTIN КАК GTIN,
	ТабТоваров.КодТовараСторонний КАК КодТовараСторонний,
	ТабТоваров.КодТовараСвой КАК КодТовараСвой,
	ТабСоответствий_КонтурEDI.Номенклатура КАК Номенклатура,
	ТабСоответствий_КонтурEDI.ХарактеристикаНоменклатуры КАК ХарактеристикаНоменклатуры,
	ТабСоответствий_КонтурEDI.ЕдиницаИзмерения КАК ЕдиницаИзмерения,
	ТабСоответствий_КонтурEDI.ТипЕдиницы КАК ТипЕдиницы,
	4 КАК Приоритет
ПОМЕСТИТЬ ВТ_НайденныеСоответствия
ИЗ
	ТабТоваров КАК ТабТоваров
		ВНУТРЕННЕЕ СОЕДИНЕНИЕ ТабСоответствий_КонтурEDI КАК ТабСоответствий_КонтурEDI
		ПО ТабТоваров.GTIN = ТабСоответствий_КонтурEDI.GTIN
			И ТабТоваров.КодТовараСторонний = ТабСоответствий_КонтурEDI.КодТовараСторонний
			И ТабТоваров.КодТовараСвой = ТабСоответствий_КонтурEDI.КодТовараСвой

ОБЪЕДИНИТЬ ВСЕ

ВЫБРАТЬ
	ТабТоваров.GTIN,
	ТабТоваров.КодТовараСторонний,
	ТабТоваров.КодТовараСвой,
	Штрихкоды.Владелец,
	Штрихкоды.ХарактеристикаНоменклатуры,
	Штрихкоды.ЕдиницаИзмерения,
	ВЫРАЗИТЬ("" КАК СТРОКА(20)),
	3
ИЗ
	ТабТоваров КАК ТабТоваров
		ВНУТРЕННЕЕ СОЕДИНЕНИЕ РегистрСведений.Штрихкоды КАК Штрихкоды
		ПО (ТабТоваров.GTIN = Штрихкоды.Штрихкод)
			И (Штрихкоды.ТипШтрихкода = ЗНАЧЕНИЕ(ПланВидовХарактеристик.ТипыШтрихкодов.EAN13))
ГДЕ
	НЕ ТабТоваров.GTIN = ""

ОБЪЕДИНИТЬ ВСЕ

ВЫБРАТЬ
	ТабТоваров.GTIN,
	ТабТоваров.КодТовараСторонний,
	ТабТоваров.КодТовараСвой,
	Штрихкоды.Владелец,
	Штрихкоды.ХарактеристикаНоменклатуры,
	Штрихкоды.ЕдиницаИзмерения,
	ВЫРАЗИТЬ("" КАК СТРОКА(20)),
	2
ИЗ
	ТабТоваров КАК ТабТоваров
		ВНУТРЕННЕЕ СОЕДИНЕНИЕ РегистрСведений.Штрихкоды КАК Штрихкоды
		ПО (ПОДСТРОКА(ТабТоваров.GTIN, 2, 13) = Штрихкоды.Штрихкод)
			И (Штрихкоды.ТипШтрихкода = ЗНАЧЕНИЕ(ПланВидовХарактеристик.ТипыШтрихкодов.EAN13))
ГДЕ
	НЕ ТабТоваров.GTIN = ""
	
ОБЪЕДИНИТЬ ВСЕ

ВЫБРАТЬ
	ТабТоваров.GTIN,
	ТабТоваров.КодТовараСторонний,
	ТабТоваров.КодТовараСвой,
	СправочникНоменклатура.Ссылка,
	НЕОПРЕДЕЛЕНО,
	СправочникНоменклатура.ЕдиницаХраненияОстатков,
	ВЫРАЗИТЬ("" КАК СТРОКА(20)),
	1
ИЗ
	ТабТоваров КАК ТабТоваров
		ВНУТРЕННЕЕ СОЕДИНЕНИЕ Справочник.Номенклатура КАК СправочникНоменклатура
		ПО ТабТоваров.КодТовараСвой = СправочникНоменклатура.Код
ГДЕ
	НЕ ТабТоваров.КодТовараСвой = ""
</query>
				<autoFillFields>false</autoFillFields>
			</item>
			<item xsi:type="DataSetQuery">
				<name>КонвертироватьТовары1СВEDIВ_GTIN</name>
				<dataSource>ИсточникДанных1</dataSource>
				<query>ВЫБРАТЬ РАЗЛИЧНЫЕ
	ТабТоваров.Номенклатура,
	ТабТоваров.ХарактеристикаНоменклатуры,
	ТабТоваров.ЕдиницаИзмерения,
	ТабТоваров.Номенклатура.Код КАК КодТовараСвой,
	КОЛИЧЕСТВО(ВЫРАЗИТЬ(Штрихкоды.Штрихкод КАК СТРОКА(14))) КАК КоличествоШК
ПОМЕСТИТЬ ПосчитанныеКоличестваШК
ИЗ
	ТабТоваров КАК ТабТоваров
		ВНУТРЕННЕЕ СОЕДИНЕНИЕ РегистрСведений.Штрихкоды КАК Штрихкоды
		ПО ТабТоваров.Номенклатура = Штрихкоды.Владелец
			И ТабТоваров.ХарактеристикаНоменклатуры = Штрихкоды.ХарактеристикаНоменклатуры
			И ТабТоваров.ЕдиницаИзмерения = Штрихкоды.ЕдиницаИзмерения
ГДЕ
	&amp;ИскатьТоварПоШК

СГРУППИРОВАТЬ ПО
	ТабТоваров.Номенклатура,
	ТабТоваров.ХарактеристикаНоменклатуры,
	ТабТоваров.ЕдиницаИзмерения,
	ТабТоваров.Номенклатура.Код

ИНДЕКСИРОВАТЬ ПО
	ТабТоваров.Номенклатура,
	ТабТоваров.ХарактеристикаНоменклатуры,
	ТабТоваров.ЕдиницаИзмерения
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ
	ПосчитанныеКоличестваШК.Номенклатура,
	ПосчитанныеКоличестваШК.ХарактеристикаНоменклатуры,
	ПосчитанныеКоличестваШК.ЕдиницаИзмерения,
	ПосчитанныеКоличестваШК.КодТовараСвой
ПОМЕСТИТЬ ТоварыСВалиднымиШК
ИЗ
	ПосчитанныеКоличестваШК КАК ПосчитанныеКоличестваШК
ГДЕ
	ПосчитанныеКоличестваШК.КоличествоШК = 1
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ РАЗЛИЧНЫЕ
	ТоварыСВалиднымиШК.Номенклатура,
	ТоварыСВалиднымиШК.ХарактеристикаНоменклатуры,
	ТоварыСВалиднымиШК.ЕдиницаИзмерения,
	ТоварыСВалиднымиШК.КодТовараСвой,
	ВЫРАЗИТЬ(Штрихкоды.Штрихкод КАК СТРОКА(14)) КАК GTIN
ПОМЕСТИТЬ ВТШтрихкодыТоваров
ИЗ
	ТоварыСВалиднымиШК КАК ТоварыСВалиднымиШК
		ВНУТРЕННЕЕ СОЕДИНЕНИЕ РегистрСведений.Штрихкоды КАК Штрихкоды
		ПО ТоварыСВалиднымиШК.Номенклатура = Штрихкоды.Владелец
			И ТоварыСВалиднымиШК.ХарактеристикаНоменклатуры = Штрихкоды.ХарактеристикаНоменклатуры
			И ТоварыСВалиднымиШК.ЕдиницаИзмерения = Штрихкоды.ЕдиницаИзмерения
ГДЕ
	&amp;ИскатьТоварПоШК

ИНДЕКСИРОВАТЬ ПО
	ТоварыСВалиднымиШК.Номенклатура,
	ТоварыСВалиднымиШК.ХарактеристикаНоменклатуры,
	ТоварыСВалиднымиШК.ЕдиницаИзмерения</query>
				<autoFillFields>false</autoFillFields>
			</item>
		</item>
	</dataSet>
	<dataSet xsi:type="DataSetUnion">
		<name>УТ_УПП_КА</name>
		<field xsi:type="DataSetFieldField">
			<dataPath>НомерСтроки</dataPath>
			<field>НомерСтроки</field>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>ЕдиницаИзмерения</dataPath>
			<field>ЕдиницаИзмерения</field>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>КодЕдиницыИзмерения</dataPath>
			<field>КодЕдиницыИзмерения</field>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>Количество</dataPath>
			<field>Количество</field>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>Наименование</dataPath>
			<field>Наименование</field>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>НаименованиеПолное</dataPath>
			<field>НаименованиеПолное</field>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>Номенклатура</dataPath>
			<field>Номенклатура</field>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>НомерГТД</dataPath>
			<field>НомерГТД</field>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>СерияНоменклатуры</dataPath>
			<field>СерияНоменклатуры</field>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>СтавкаНДС</dataPath>
			<field>СтавкаНДС</field>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>Страна</dataPath>
			<field>Страна</field>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>Сумма</dataPath>
			<field>Сумма</field>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>СуммаНДС</dataPath>
			<field>СуммаНДС</field>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>ТипЕдиницы</dataPath>
			<field>ТипЕдиницы</field>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>ХарактеристикаНоменклатуры</dataPath>
			<field>ХарактеристикаНоменклатуры</field>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>Цена</dataPath>
			<field>Цена</field>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>КоличествоДоКорректировки</dataPath>
			<field>КоличествоДоКорректировки</field>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>СтавкаНДСДоКорректировки</dataPath>
			<field>СтавкаНДСДоКорректировки</field>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>СуммаДоКорректировки</dataPath>
			<field>СуммаДоКорректировки</field>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>СуммаНДСДоКорректировки</dataPath>
			<field>СуммаНДСДоКорректировки</field>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>ЦенаДоКорректировки</dataPath>
			<field>ЦенаДоКорректировки</field>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>GTIN</dataPath>
			<field>GTIN</field>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>ЕдИзмСрокаГодности</dataPath>
			<field>ЕдИзмСрокаГодности</field>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>КвантПоставки</dataPath>
			<field>КвантПоставки</field>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>КодТовараПоставщика</dataPath>
			<field>КодТовараПоставщика</field>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>КоличествоВОдномМесте</dataPath>
			<field>КоличествоВОдномМесте</field>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>Родитель</dataPath>
			<field>Родитель</field>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>СрокГодности</dataPath>
			<field>СрокГодности</field>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>КоличествоОстаткаНаКонец</dataPath>
			<field>КоличествоОстаткаНаКонец</field>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>Качество</dataPath>
			<field>Качество</field>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>Склад</dataPath>
			<field>Склад</field>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>РекомендуемаяРозничнаяЦена</dataPath>
			<field>РекомендуемаяРозничнаяЦена</field>
		</field>
		<item xsi:type="DataSetUnion">
			<name>Поставщик</name>
			<field xsi:type="DataSetFieldField">
				<dataPath>НомерСтроки</dataPath>
				<field>НомерСтроки</field>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>ЕдиницаИзмерения</dataPath>
				<field>ЕдиницаИзмерения</field>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>КодЕдиницыИзмерения</dataPath>
				<field>КодЕдиницыИзмерения</field>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>Количество</dataPath>
				<field>Количество</field>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>Наименование</dataPath>
				<field>Наименование</field>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>НаименованиеПолное</dataPath>
				<field>НаименованиеПолное</field>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>Номенклатура</dataPath>
				<field>Номенклатура</field>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>НомерГТД</dataPath>
				<field>НомерГТД</field>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>СерияНоменклатуры</dataPath>
				<field>СерияНоменклатуры</field>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>СтавкаНДС</dataPath>
				<field>СтавкаНДС</field>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>Страна</dataPath>
				<field>Страна</field>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>Сумма</dataPath>
				<field>Сумма</field>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>СуммаНДС</dataPath>
				<field>СуммаНДС</field>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>ТипЕдиницы</dataPath>
				<field>ТипЕдиницы</field>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>ХарактеристикаНоменклатуры</dataPath>
				<field>ХарактеристикаНоменклатуры</field>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>Цена</dataPath>
				<field>Цена</field>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>КоличествоДоКорректировки</dataPath>
				<field>КоличествоДоКорректировки</field>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>СтавкаНДСДоКорректировки</dataPath>
				<field>СтавкаНДСДоКорректировки</field>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>СуммаДоКорректировки</dataPath>
				<field>СуммаДоКорректировки</field>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>СуммаНДСДоКорректировки</dataPath>
				<field>СуммаНДСДоКорректировки</field>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>ЦенаДоКорректировки</dataPath>
				<field>ЦенаДоКорректировки</field>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>GTIN</dataPath>
				<field>GTIN</field>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>ЕдИзмСрокаГодности</dataPath>
				<field>ЕдИзмСрокаГодности</field>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>КвантПоставки</dataPath>
				<field>КвантПоставки</field>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>КодТовараПоставщика</dataPath>
				<field>КодТовараПоставщика</field>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>КоличествоВОдномМесте</dataPath>
				<field>КоличествоВОдномМесте</field>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>Родитель</dataPath>
				<field>Родитель</field>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>СрокГодности</dataPath>
				<field>СрокГодности</field>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>КоличествоОстаткаНаКонец</dataPath>
				<field>КоличествоОстаткаНаКонец</field>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>Качество</dataPath>
				<field>Качество</field>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>Склад</dataPath>
				<field>Склад</field>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>РекомендуемаяРозничнаяЦена</dataPath>
				<field>РекомендуемаяРозничнаяЦена</field>
			</field>
			<item xsi:type="DataSetUnion">
				<name>ЗапросОсновнойЦепочки</name>
				<item xsi:type="DataSetQuery">
					<name>Заказ_Реализация_СФ</name>
					<dataSource>ИсточникДанных1</dataSource>
					<query>ВЫБРАТЬ
	докЗаказПокупателя.Ссылка КАК PORDERS,
	докЗаказПокупателя.Ссылка КАК ORDERS,
	докЗаказПокупателя.Ссылка КАК ORDRSP,
	докРеализацияТоваровУслуг.Ссылка КАК DESADV,
	докРеализацияТоваровУслуг.Ссылка КАК RECADV,
	СчетФактураВыданныйДокументыОснования.Ссылка КАК INVOIC
ИЗ
	(ВЫБРАТЬ
		1 КАК Поле1) КАК Заглушка
		{ПОЛНОЕ СОЕДИНЕНИЕ Документ.СчетФактураВыданный.ДокументыОснования КАК СчетФактураВыданныйДокументыОснования
			{ПОЛНОЕ СОЕДИНЕНИЕ Документ.РеализацияТоваровУслуг КАК докРеализацияТоваровУслуг
				{ПОЛНОЕ СОЕДИНЕНИЕ Документ.ЗаказПокупателя КАК докЗаказПокупателя
				ПО докРеализацияТоваровУслуг.Сделка = докЗаказПокупателя.Ссылка}
			ПО СчетФактураВыданныйДокументыОснования.ДокументОснование = докРеализацияТоваровУслуг.Ссылка}
		ПО (ИСТИНА)}</query>
					<autoFillFields>false</autoFillFields>
				</item>
				<item xsi:type="DataSetQuery">
					<name>Реализация_СФ</name>
					<dataSource>ИсточникДанных1</dataSource>
					<query>ВЫБРАТЬ
	РеализацияТоваровУслуг.Ссылка КАК PORDERS,
	РеализацияТоваровУслуг.Ссылка КАК ORDERS,
	РеализацияТоваровУслуг.Ссылка КАК ORDRSP,
	РеализацияТоваровУслуг.Ссылка КАК DESADV,
	РеализацияТоваровУслуг.Ссылка КАК RECADV,
	СчетФактураВыданныйДокументыОснования.Ссылка КАК INVOIC
ИЗ
	(ВЫБРАТЬ
		1 КАК Поле1) КАК Заглушка
		{ПОЛНОЕ СОЕДИНЕНИЕ Документ.СчетФактураВыданный.ДокументыОснования КАК СчетФактураВыданныйДокументыОснования
			{ПОЛНОЕ СОЕДИНЕНИЕ Документ.РеализацияТоваровУслуг КАК РеализацияТоваровУслуг
			ПО СчетФактураВыданныйДокументыОснования.ДокументОснование = РеализацияТоваровУслуг.Ссылка}
		ПО (ИСТИНА)}</query>
					<autoFillFields>false</autoFillFields>
				</item>
				<item xsi:type="DataSetQuery">
					<name>Заказ_Реализация</name>
					<dataSource>ИсточникДанных1</dataSource>
					<query>ВЫБРАТЬ
	докЗаказПокупателя.Ссылка КАК PORDERS,
	докЗаказПокупателя.Ссылка КАК ORDERS,
	докЗаказПокупателя.Ссылка КАК ORDRSP,
	докРеализацияТоваровУслуг.Ссылка КАК DESADV,
	докРеализацияТоваровУслуг.Ссылка КАК RECADV,
	докРеализацияТоваровУслуг.Ссылка КАК INVOIC
ИЗ
	(ВЫБРАТЬ
		1 КАК Поле1) КАК Заглушка
		{ПОЛНОЕ СОЕДИНЕНИЕ Документ.РеализацияТоваровУслуг КАК докРеализацияТоваровУслуг
			{ПОЛНОЕ СОЕДИНЕНИЕ Документ.ЗаказПокупателя КАК докЗаказПокупателя
			ПО (докРеализацияТоваровУслуг.Сделка = докЗаказПокупателя.Ссылка)}
		ПО (ИСТИНА)}</query>
					<autoFillFields>false</autoFillFields>
				</item>
				<item xsi:type="DataSetQuery">
					<name>Реализация</name>
					<dataSource>ИсточникДанных1</dataSource>
					<query>ВЫБРАТЬ
	РеализацияТоваровУслуг.Ссылка КАК PORDERS,
	РеализацияТоваровУслуг.Ссылка КАК ORDERS,
	РеализацияТоваровУслуг.Ссылка КАК ORDRSP,
	РеализацияТоваровУслуг.Ссылка КАК DESADV,
	РеализацияТоваровУслуг.Ссылка КАК RECADV,
	РеализацияТоваровУслуг.Ссылка КАК INVOIC
ИЗ
	(ВЫБРАТЬ
		1 КАК Поле1) КАК Заглушка
		{ПОЛНОЕ СОЕДИНЕНИЕ Документ.РеализацияТоваровУслуг КАК РеализацияТоваровУслуг
		ПО (ИСТИНА)}</query>
					<autoFillFields>false</autoFillFields>
				</item>
			</item>
			<item xsi:type="DataSetUnion">
				<name>ЗапросПоТоварам</name>
				<field xsi:type="DataSetFieldField">
					<dataPath>НомерСтроки</dataPath>
					<field>НомерСтроки</field>
				</field>
				<field xsi:type="DataSetFieldField">
					<dataPath>ЕдиницаИзмерения</dataPath>
					<field>ЕдиницаИзмерения</field>
				</field>
				<field xsi:type="DataSetFieldField">
					<dataPath>КодЕдиницыИзмерения</dataPath>
					<field>КодЕдиницыИзмерения</field>
				</field>
				<field xsi:type="DataSetFieldField">
					<dataPath>Количество</dataPath>
					<field>Количество</field>
				</field>
				<field xsi:type="DataSetFieldField">
					<dataPath>Наименование</dataPath>
					<field>Наименование</field>
				</field>
				<field xsi:type="DataSetFieldField">
					<dataPath>НаименованиеПолное</dataPath>
					<field>НаименованиеПолное</field>
				</field>
				<field xsi:type="DataSetFieldField">
					<dataPath>Номенклатура</dataPath>
					<field>Номенклатура</field>
				</field>
				<field xsi:type="DataSetFieldField">
					<dataPath>НомерГТД</dataPath>
					<field>НомерГТД</field>
				</field>
				<field xsi:type="DataSetFieldField">
					<dataPath>СерияНоменклатуры</dataPath>
					<field>СерияНоменклатуры</field>
				</field>
				<field xsi:type="DataSetFieldField">
					<dataPath>СтавкаНДС</dataPath>
					<field>СтавкаНДС</field>
				</field>
				<field xsi:type="DataSetFieldField">
					<dataPath>Страна</dataPath>
					<field>Страна</field>
				</field>
				<field xsi:type="DataSetFieldField">
					<dataPath>Сумма</dataPath>
					<field>Сумма</field>
				</field>
				<field xsi:type="DataSetFieldField">
					<dataPath>СуммаНДС</dataPath>
					<field>СуммаНДС</field>
				</field>
				<field xsi:type="DataSetFieldField">
					<dataPath>ТипЕдиницы</dataPath>
					<field>ТипЕдиницы</field>
				</field>
				<field xsi:type="DataSetFieldField">
					<dataPath>ХарактеристикаНоменклатуры</dataPath>
					<field>ХарактеристикаНоменклатуры</field>
				</field>
				<field xsi:type="DataSetFieldField">
					<dataPath>Цена</dataPath>
					<field>Цена</field>
				</field>
				<field xsi:type="DataSetFieldField">
					<dataPath>КоличествоДоКорректировки</dataPath>
					<field>КоличествоДоКорректировки</field>
				</field>
				<field xsi:type="DataSetFieldField">
					<dataPath>СтавкаНДСДоКорректировки</dataPath>
					<field>СтавкаНДСДоКорректировки</field>
				</field>
				<field xsi:type="DataSetFieldField">
					<dataPath>СуммаДоКорректировки</dataPath>
					<field>СуммаДоКорректировки</field>
				</field>
				<field xsi:type="DataSetFieldField">
					<dataPath>СуммаНДСДоКорректировки</dataPath>
					<field>СуммаНДСДоКорректировки</field>
				</field>
				<field xsi:type="DataSetFieldField">
					<dataPath>ЦенаДоКорректировки</dataPath>
					<field>ЦенаДоКорректировки</field>
				</field>
				<field xsi:type="DataSetFieldField">
					<dataPath>GTIN</dataPath>
					<field>GTIN</field>
				</field>
				<field xsi:type="DataSetFieldField">
					<dataPath>ЕдИзмСрокаГодности</dataPath>
					<field>ЕдИзмСрокаГодности</field>
				</field>
				<field xsi:type="DataSetFieldField">
					<dataPath>КвантПоставки</dataPath>
					<field>КвантПоставки</field>
				</field>
				<field xsi:type="DataSetFieldField">
					<dataPath>КодТовараПоставщика</dataPath>
					<field>КодТовараПоставщика</field>
				</field>
				<field xsi:type="DataSetFieldField">
					<dataPath>КоличествоВОдномМесте</dataPath>
					<field>КоличествоВОдномМесте</field>
				</field>
				<field xsi:type="DataSetFieldField">
					<dataPath>Родитель</dataPath>
					<field>Родитель</field>
				</field>
				<field xsi:type="DataSetFieldField">
					<dataPath>СрокГодности</dataPath>
					<field>СрокГодности</field>
				</field>
				<field xsi:type="DataSetFieldField">
					<dataPath>КоличествоОстаткаНаКонец</dataPath>
					<field>КоличествоОстаткаНаКонец</field>
				</field>
				<field xsi:type="DataSetFieldField">
					<dataPath>Качество</dataPath>
					<field>Качество</field>
				</field>
				<field xsi:type="DataSetFieldField">
					<dataPath>Склад</dataPath>
					<field>Склад</field>
				</field>
				<field xsi:type="DataSetFieldField">
					<dataPath>РекомендуемаяРозничнаяЦена</dataPath>
					<field>РекомендуемаяРозничнаяЦена</field>
				</field>
				<item xsi:type="DataSetUnion">
					<name>_PORDERS_ORDRSP_</name>
					<item xsi:type="DataSetQuery">
						<name>ЗаказПокупателя_Проведен</name>
						<dataSource>ИсточникДанных1</dataSource>
						<query>ВЫБРАТЬ
	ЗаказыПокупателейОбороты.Цена КАК ЦенаГруппировка,
	ЗаказыПокупателейОбороты.Номенклатура КАК Номенклатура,
	ЗаказыПокупателейОбороты.ХарактеристикаНоменклатуры,
	ЗаказыПокупателейОбороты.ЕдиницаИзмерения КАК ЕдиницаИзмерения,
	ЗаказыПокупателейОбороты.ЕдиницаИзмерения.ЕдиницаПоКлассификатору.Наименование КАК КодЕдиницыИзмерения,
	ВЫБОР
		КОГДА НЕ ЗаказыПокупателейОбороты.ЕдиницаИзмерения.Коэффициент = 0
			ТОГДА ЗаказыПокупателейОбороты.КоличествоПриход * ЗаказыПокупателейОбороты.Номенклатура.ЕдиницаХраненияОстатков.Коэффициент / ЗаказыПокупателейОбороты.ЕдиницаИзмерения.Коэффициент
		ИНАЧЕ 0 
	КОНЕЦ КАК Количество,
	ВЫБОР
		КОГДА НЕ ЗаказыПокупателейОбороты.КоличествоПриход = 0 И НЕ ЗаказыПокупателейОбороты.Номенклатура.ЕдиницаХраненияОстатков.Коэффициент = 0 
			ТОГДА ЗаказыПокупателейОбороты.СуммаВзаиморасчетовПриход * ЗаказыПокупателейОбороты.ЕдиницаИзмерения.Коэффициент / (ЗаказыПокупателейОбороты.КоличествоПриход * ЗаказыПокупателейОбороты.Номенклатура.ЕдиницаХраненияОстатков.Коэффициент)
		ИНАЧЕ 0
	КОНЕЦ КАК Цена,
	ЗаказыПокупателейОбороты.СуммаВзаиморасчетовПриход КАК Сумма,
	ЗаказыПокупателейОбороты.Номенклатура.СтавкаНДС КАК СтавкаНДС,
	"" КАК ТипЕдиницы
ПОМЕСТИТЬ ВТ_ЗаказыПокупателейОбороты
ИЗ
	РегистрНакопления.ЗаказыПокупателей.Обороты(
			,
			,
			,
			ЗаказПокупателя В (&amp;Ссылка)
				И НЕ СтатусПартии = ЗНАЧЕНИЕ(Перечисление.СтатусыПартийТоваров.ВозвратнаяТара)) КАК ЗаказыПокупателейОбороты
ГДЕ
	НЕ ЗаказыПокупателейОбороты.Номенклатура.ВидНоменклатуры.ТипНоменклатуры = ЗНАЧЕНИЕ(Перечисление.ТипыНоменклатуры.Услуга)
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ
	Таб.Номенклатура КАК Номенклатура,
	Таб.ХарактеристикаНоменклатуры КАК ХарактеристикаНоменклатуры,
	МАКСИМУМ(Таб.СтавкаНДС) КАК СтавкаНДС
ПОМЕСТИТЬ ВТ_ЗаказПокупателяТовары
ИЗ
	Документ.ЗаказПокупателя.Товары КАК Таб
ГДЕ
	Таб.Ссылка В(&amp;Ссылка)

СГРУППИРОВАТЬ ПО
	Таб.Номенклатура,
	Таб.ХарактеристикаНоменклатуры
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ
	ВТ_ЗаказыПокупателейОбороты.Номенклатура КАК Номенклатура,
	ВТ_ЗаказыПокупателейОбороты.ХарактеристикаНоменклатуры КАК ХарактеристикаНоменклатуры,
	ВТ_ЗаказыПокупателейОбороты.ЕдиницаИзмерения КАК ЕдиницаИзмерения,
	ВТ_ЗаказыПокупателейОбороты.КодЕдиницыИзмерения КАК КодЕдиницыИзмерения,
	ВТ_ЗаказыПокупателейОбороты.Количество КАК Количество,
	ВТ_ЗаказыПокупателейОбороты.Цена КАК Цена,
	ВТ_ЗаказыПокупателейОбороты.Сумма КАК Сумма,
	ЕСТЬNULL(ВТ_ЗаказПокупателяТовары.СтавкаНДС, ВТ_ЗаказыПокупателейОбороты.СтавкаНДС) КАК СтавкаНДС,
	ВТ_ЗаказыПокупателейОбороты.ТипЕдиницы КАК ТипЕдиницы
ИЗ
	ВТ_ЗаказыПокупателейОбороты КАК ВТ_ЗаказыПокупателейОбороты
		ЛЕВОЕ СОЕДИНЕНИЕ ВТ_ЗаказПокупателяТовары КАК ВТ_ЗаказПокупателяТовары
		ПО ВТ_ЗаказыПокупателейОбороты.Номенклатура = ВТ_ЗаказПокупателяТовары.Номенклатура
			И ВТ_ЗаказыПокупателейОбороты.ХарактеристикаНоменклатуры = ВТ_ЗаказПокупателяТовары.ХарактеристикаНоменклатуры

ОБЪЕДИНИТЬ ВСЕ

ВЫБРАТЬ
	ЗаказПокупателяТовары.Номенклатура,
	ЗаказПокупателяТовары.ХарактеристикаНоменклатуры,
	ЗаказПокупателяТовары.ЕдиницаИзмерения,
	ЗаказПокупателяТовары.ЕдиницаИзмерения.ЕдиницаПоКлассификатору.Наименование,
	ЗаказПокупателяТовары.Количество,
	ЗаказПокупателяТовары.Цена,
	ЗаказПокупателяТовары.Сумма,
	ЗаказПокупателяТовары.СтавкаНДС,
	"Services"
ИЗ
	Документ.ЗаказПокупателя.Товары КАК ЗаказПокупателяТовары
ГДЕ
	&amp;РаботаСУслугами
	И ЗаказПокупателяТовары.Ссылка В(&amp;Ссылка)
	И ЗаказПокупателяТовары.Номенклатура.ВидНоменклатуры.ТипНоменклатуры = ЗНАЧЕНИЕ(Перечисление.ТипыНоменклатуры.Услуга)

ОБЪЕДИНИТЬ ВСЕ

ВЫБРАТЬ
	ЗаказПокупателяУслуги.Номенклатура,
	НЕОПРЕДЕЛЕНО,
	ЗаказПокупателяУслуги.Номенклатура.ЕдиницаХраненияОстатков,
	ЗаказПокупателяУслуги.Номенклатура.ЕдиницаХраненияОстатков.ЕдиницаПоКлассификатору.Наименование,
	ЗаказПокупателяУслуги.Количество,
	ЗаказПокупателяУслуги.Цена,
	ЗаказПокупателяУслуги.Сумма,
	ЗаказПокупателяУслуги.СтавкаНДС,
	"Services"
ИЗ
	Документ.ЗаказПокупателя.Услуги КАК ЗаказПокупателяУслуги
ГДЕ
	&amp;РаботаСУслугами
	И ЗаказПокупателяУслуги.Ссылка В(&amp;Ссылка)</query>
						<autoFillFields>false</autoFillFields>
					</item>
					<item xsi:type="DataSetQuery">
						<name>ЗаказПокупателя_НеПроведен</name>
						<dataSource>ИсточникДанных1</dataSource>
						<query>ВЫБРАТЬ
	ЗаказПокупателяТовары.Номенклатура,
	ЗаказПокупателяТовары.ХарактеристикаНоменклатуры КАК ХарактеристикаНоменклатуры,
	ЗаказПокупателяТовары.ЕдиницаИзмерения КАК ЕдиницаИзмерения,
	ЗаказПокупателяТовары.ЕдиницаИзмерения.ЕдиницаПоКлассификатору.Наименование КАК КодЕдиницыИзмерения,
	ЗаказПокупателяТовары.Количество КАК Количество,
	ЗаказПокупателяТовары.Цена,
	ЗаказПокупателяТовары.Сумма КАК Сумма,
	ЗаказПокупателяТовары.СтавкаНДС,
	ЗаказПокупателяТовары.СуммаНДС КАК СуммаНДС,
	ВЫБОР
		КОГДА ЗаказПокупателяТовары.Номенклатура.ВидНоменклатуры.ТипНоменклатуры = ЗНАЧЕНИЕ(Перечисление.ТипыНоменклатуры.Услуга)
			ТОГДА "Services"
		ИНАЧЕ ""
	КОНЕЦ КАК ТипЕдиницы
ИЗ
	Документ.ЗаказПокупателя.Товары КАК ЗаказПокупателяТовары
ГДЕ
	ЗаказПокупателяТовары.Ссылка В(&amp;Ссылка)
	И (НЕ ЗаказПокупателяТовары.Номенклатура.ВидНоменклатуры.ТипНоменклатуры = ЗНАЧЕНИЕ(Перечисление.ТипыНоменклатуры.Услуга)
			ИЛИ &amp;РаботаСУслугами)

ОБЪЕДИНИТЬ ВСЕ

ВЫБРАТЬ
	ЗаказПокупателяУслуги.Номенклатура,
	НЕОПРЕДЕЛЕНО,
	ЗаказПокупателяУслуги.Номенклатура.ЕдиницаХраненияОстатков,
	ЗаказПокупателяУслуги.Номенклатура.ЕдиницаХраненияОстатков.ЕдиницаПоКлассификатору.Наименование,
	ЗаказПокупателяУслуги.Количество,
	ЗаказПокупателяУслуги.Цена,
	ЗаказПокупателяУслуги.Сумма,
	ЗаказПокупателяУслуги.СтавкаНДС,
	ЗаказПокупателяУслуги.СуммаНДС,
	"Services"
ИЗ
	Документ.ЗаказПокупателя.Услуги КАК ЗаказПокупателяУслуги
ГДЕ
	&amp;РаботаСУслугами
	И ЗаказПокупателяУслуги.Ссылка В(&amp;Ссылка)</query>
						<autoFillFields>false</autoFillFields>
					</item>
					<item xsi:type="DataSetQuery">
						<name>РеализацияТоваровУслуг</name>
						<dataSource>ИсточникДанных1</dataSource>
						<query>ВЫБРАТЬ
	РеализацияТоваровУслугТовары.НомерСтроки,
	РеализацияТоваровУслугТовары.Номенклатура,
	РеализацияТоваровУслугТовары.ХарактеристикаНоменклатуры,
	РеализацияТоваровУслугТовары.ЕдиницаИзмерения КАК ЕдиницаИзмерения,
	РеализацияТоваровУслугТовары.ЕдиницаИзмерения.ЕдиницаПоКлассификатору.Наименование КАК КодЕдиницыИзмерения,
	ВЫРАЗИТЬ(РеализацияТоваровУслугТовары.Номенклатура.Наименование КАК СТРОКА(178)) КАК Наименование,
	ВЫРАЗИТЬ(РеализацияТоваровУслугТовары.Номенклатура.НаименованиеПолное КАК СТРОКА(500)) КАК НаименованиеПолное,
	РеализацияТоваровУслугТовары.Цена,
	РеализацияТоваровУслугТовары.СтавкаНДС,
	РеализацияТоваровУслугТовары.СерияНоменклатуры,
	ВЫБОР
		КОГДА (РеализацияТоваровУслугТовары.СерияНоменклатуры = ЗНАЧЕНИЕ(Справочник.СерииНоменклатуры.ПустаяСсылка)
				ИЛИ РеализацияТоваровУслугТовары.СерияНоменклатуры.СтранаПроисхождения = ЗНАЧЕНИЕ(Справочник.КлассификаторСтранМира.ПустаяСсылка))
				И РеализацияТоваровУслугТовары.Номенклатура.ВестиУчетПоСериям
			ТОГДА РеализацияТоваровУслугТовары.Номенклатура.СтранаПроисхождения
		ИНАЧЕ РеализацияТоваровУслугТовары.СерияНоменклатуры.СтранаПроисхождения
	КОНЕЦ КАК Страна,
	ВЫБОР
		КОГДА РеализацияТоваровУслугТовары.Номенклатура.ВестиУчетПоСериям
			ТОГДА ЕСТЬNULL(РеализацияТоваровУслугТовары.СерияНоменклатуры.НомерГТД.Код, ЕСТЬNULL(РеализацияТоваровУслугТовары.Номенклатура.НомерГТД.Код, ""))
		ИНАЧЕ ""
	КОНЕЦ КАК НомерГТД,
	РеализацияТоваровУслугТовары.Количество КАК Количество,
	РеализацияТоваровУслугТовары.Сумма КАК Сумма,
	РеализацияТоваровУслугТовары.СуммаНДС,
	ВЫБОР
		КОГДА РеализацияТоваровУслугТовары.Номенклатура.ВидНоменклатуры.ТипНоменклатуры = ЗНАЧЕНИЕ(Перечисление.ТипыНоменклатуры.Услуга)
			ТОГДА "Services"
		ИНАЧЕ ""
	КОНЕЦ КАК ТипЕдиницы
ИЗ
	Документ.РеализацияТоваровУслуг.Товары КАК РеализацияТоваровУслугТовары
ГДЕ
	РеализацияТоваровУслугТовары.Ссылка В(&amp;Ссылка)
	И (НЕ РеализацияТоваровУслугТовары.Номенклатура.ВидНоменклатуры.ТипНоменклатуры = ЗНАЧЕНИЕ(Перечисление.ТипыНоменклатуры.Услуга)
			ИЛИ &amp;РаботаСУслугами)

ОБЪЕДИНИТЬ ВСЕ

ВЫБРАТЬ
	РеализацияТоваровУслугВозвратнаяТара.НомерСтроки,
	РеализацияТоваровУслугВозвратнаяТара.Номенклатура,
	НЕОПРЕДЕЛЕНО,
	РеализацияТоваровУслугВозвратнаяТара.Номенклатура.ЕдиницаХраненияОстатков,
	РеализацияТоваровУслугВозвратнаяТара.Номенклатура.ЕдиницаХраненияОстатков.ЕдиницаПоКлассификатору.Наименование,
	ВЫРАЗИТЬ(РеализацияТоваровУслугВозвратнаяТара.Номенклатура.Наименование КАК СТРОКА(178)),
	ВЫРАЗИТЬ(РеализацияТоваровУслугВозвратнаяТара.Номенклатура.НаименованиеПолное КАК СТРОКА(500)),
	РеализацияТоваровУслугВозвратнаяТара.Цена,
	ЗНАЧЕНИЕ(Перечисление.СтавкиНДС.БезНДС),
	НЕОПРЕДЕЛЕНО,
	РеализацияТоваровУслугВозвратнаяТара.Номенклатура.СтранаПроисхождения,
	"",
	РеализацияТоваровУслугВозвратнаяТара.Количество,
	РеализацияТоваровУслугВозвратнаяТара.Сумма,
	0,
	"RC"
ИЗ
	Документ.РеализацияТоваровУслуг.ВозвратнаяТара КАК РеализацияТоваровУслугВозвратнаяТара
ГДЕ
	&amp;ОтправлятьВозвратнуюТару
	И РеализацияТоваровУслугВозвратнаяТара.Ссылка В(&amp;Ссылка)

ОБЪЕДИНИТЬ ВСЕ

ВЫБРАТЬ
	РеализацияТоваровУслугУслуги.НомерСтроки,
	РеализацияТоваровУслугУслуги.Номенклатура,
	НЕОПРЕДЕЛЕНО,
	РеализацияТоваровУслугУслуги.Номенклатура.ЕдиницаХраненияОстатков,
	РеализацияТоваровУслугУслуги.Номенклатура.ЕдиницаХраненияОстатков.ЕдиницаПоКлассификатору.Наименование,
	ВЫРАЗИТЬ(РеализацияТоваровУслугУслуги.Номенклатура.Наименование КАК СТРОКА(178)),
	ВЫРАЗИТЬ(РеализацияТоваровУслугУслуги.Номенклатура.НаименованиеПолное КАК СТРОКА(500)),
	РеализацияТоваровУслугУслуги.Цена,
	РеализацияТоваровУслугУслуги.СтавкаНДС,
	НЕОПРЕДЕЛЕНО,
	РеализацияТоваровУслугУслуги.Номенклатура.СтранаПроисхождения,
	"",
	РеализацияТоваровУслугУслуги.Количество,
	РеализацияТоваровУслугУслуги.Сумма,
	РеализацияТоваровУслугУслуги.СуммаНДС,
	"Services"
ИЗ
	Документ.РеализацияТоваровУслуг.Услуги КАК РеализацияТоваровУслугУслуги
ГДЕ
	&amp;РаботаСУслугами
	И РеализацияТоваровУслугУслуги.Ссылка В(&amp;Ссылка)</query>
						<autoFillFields>false</autoFillFields>
					</item>
				</item>
				<item xsi:type="DataSetUnion">
					<name>_DESADV_INVOIC_</name>
					<item xsi:type="DataSetQuery">
						<name>РеализацияТоваровУслуг</name>
						<dataSource>ИсточникДанных1</dataSource>
						<query>ВЫБРАТЬ
	РеализацияТоваровУслугТовары.НомерСтроки,
	РеализацияТоваровУслугТовары.Номенклатура,
	РеализацияТоваровУслугТовары.ХарактеристикаНоменклатуры,
	РеализацияТоваровУслугТовары.ЕдиницаИзмерения КАК ЕдиницаИзмерения,
	РеализацияТоваровУслугТовары.ЕдиницаИзмерения.ЕдиницаПоКлассификатору.Наименование КАК КодЕдиницыИзмерения,
	ВЫРАЗИТЬ(РеализацияТоваровУслугТовары.Номенклатура.Наименование КАК СТРОКА(178)) КАК Наименование,
	ВЫРАЗИТЬ(РеализацияТоваровУслугТовары.Номенклатура.НаименованиеПолное КАК СТРОКА(500)) КАК НаименованиеПолное,
	РеализацияТоваровУслугТовары.Цена,
	РеализацияТоваровУслугТовары.СтавкаНДС,
	РеализацияТоваровУслугТовары.СерияНоменклатуры,
	ВЫБОР
		КОГДА (РеализацияТоваровУслугТовары.СерияНоменклатуры = ЗНАЧЕНИЕ(Справочник.СерииНоменклатуры.ПустаяСсылка)
				ИЛИ РеализацияТоваровУслугТовары.СерияНоменклатуры.СтранаПроисхождения = ЗНАЧЕНИЕ(Справочник.КлассификаторСтранМира.ПустаяСсылка))
				И РеализацияТоваровУслугТовары.Номенклатура.ВестиУчетПоСериям
			ТОГДА РеализацияТоваровУслугТовары.Номенклатура.СтранаПроисхождения
		ИНАЧЕ РеализацияТоваровУслугТовары.СерияНоменклатуры.СтранаПроисхождения
	КОНЕЦ КАК Страна,
	ВЫБОР
		КОГДА РеализацияТоваровУслугТовары.Номенклатура.ВестиУчетПоСериям
			ТОГДА ЕСТЬNULL(РеализацияТоваровУслугТовары.СерияНоменклатуры.НомерГТД.Код, ЕСТЬNULL(РеализацияТоваровУслугТовары.Номенклатура.НомерГТД.Код, ""))
		ИНАЧЕ ""
	КОНЕЦ КАК НомерГТД,
	РеализацияТоваровУслугТовары.Количество КАК Количество,
	РеализацияТоваровУслугТовары.Сумма КАК Сумма,
	РеализацияТоваровУслугТовары.СуммаНДС,
	ВЫБОР
		КОГДА РеализацияТоваровУслугТовары.Номенклатура.ВидНоменклатуры.ТипНоменклатуры = ЗНАЧЕНИЕ(Перечисление.ТипыНоменклатуры.Услуга)
			ТОГДА "Services"
		ИНАЧЕ ""
	КОНЕЦ КАК ТипЕдиницы
ИЗ
	Документ.РеализацияТоваровУслуг.Товары КАК РеализацияТоваровУслугТовары
ГДЕ
	РеализацияТоваровУслугТовары.Ссылка В(&amp;Ссылка)
	И (НЕ РеализацияТоваровУслугТовары.Номенклатура.ВидНоменклатуры.ТипНоменклатуры = ЗНАЧЕНИЕ(Перечисление.ТипыНоменклатуры.Услуга)
			ИЛИ &amp;РаботаСУслугами)

ОБЪЕДИНИТЬ ВСЕ

ВЫБРАТЬ
	0,
	ВозвратТоваровОтПокупателяТовары.Номенклатура,
	ВозвратТоваровОтПокупателяТовары.ХарактеристикаНоменклатуры,
	ВозвратТоваровОтПокупателяТовары.ЕдиницаИзмерения,
	ВозвратТоваровОтПокупателяТовары.ЕдиницаИзмерения.ЕдиницаПоКлассификатору.Наименование,
	ВЫРАЗИТЬ(ВозвратТоваровОтПокупателяТовары.Номенклатура.Наименование КАК СТРОКА(178)),
	ВЫРАЗИТЬ(ВозвратТоваровОтПокупателяТовары.Номенклатура.НаименованиеПолное КАК СТРОКА(500)),
	ВозвратТоваровОтПокупателяТовары.Цена,
	ВозвратТоваровОтПокупателяТовары.СтавкаНДС,
	ВозвратТоваровОтПокупателяТовары.СерияНоменклатуры,
	ВЫБОР
		КОГДА (ВозвратТоваровОтПокупателяТовары.СерияНоменклатуры = ЗНАЧЕНИЕ(Справочник.СерииНоменклатуры.ПустаяСсылка)
				ИЛИ ВозвратТоваровОтПокупателяТовары.СерияНоменклатуры.СтранаПроисхождения = ЗНАЧЕНИЕ(Справочник.КлассификаторСтранМира.ПустаяСсылка))
				И ВозвратТоваровОтПокупателяТовары.Номенклатура.ВестиУчетПоСериям
			ТОГДА ВозвратТоваровОтПокупателяТовары.Номенклатура.СтранаПроисхождения
		ИНАЧЕ ВозвратТоваровОтПокупателяТовары.СерияНоменклатуры.СтранаПроисхождения
	КОНЕЦ,
	ВЫБОР
		КОГДА ВозвратТоваровОтПокупателяТовары.Номенклатура.ВестиУчетПоСериям
			ТОГДА ЕСТЬNULL(ВозвратТоваровОтПокупателяТовары.СерияНоменклатуры.НомерГТД.Код, ЕСТЬNULL(ВозвратТоваровОтПокупателяТовары.Номенклатура.НомерГТД.Код, ""))
		ИНАЧЕ ""
	КОНЕЦ,
	-ВозвратТоваровОтПокупателяТовары.Количество,
	-ВозвратТоваровОтПокупателяТовары.Сумма,
	-ВозвратТоваровОтПокупателяТовары.СуммаНДС,
	""
ИЗ
	Документ.ВозвратТоваровОтПокупателя.Товары КАК ВозвратТоваровОтПокупателяТовары
ГДЕ
	ВозвратТоваровОтПокупателяТовары.Ссылка В(&amp;Возвраты)

ОБЪЕДИНИТЬ ВСЕ

ВЫБРАТЬ
	РеализацияТоваровУслугВозвратнаяТара.НомерСтроки,
	РеализацияТоваровУслугВозвратнаяТара.Номенклатура,
	ЗНАЧЕНИЕ(Справочник.ХарактеристикиНоменклатуры.ПустаяСсылка),
	РеализацияТоваровУслугВозвратнаяТара.Номенклатура.ЕдиницаХраненияОстатков,
	РеализацияТоваровУслугВозвратнаяТара.Номенклатура.ЕдиницаХраненияОстатков.ЕдиницаПоКлассификатору.Наименование,
	ВЫРАЗИТЬ(РеализацияТоваровУслугВозвратнаяТара.Номенклатура.Наименование КАК СТРОКА(178)),
	ВЫРАЗИТЬ(РеализацияТоваровУслугВозвратнаяТара.Номенклатура.НаименованиеПолное КАК СТРОКА(500)),
	РеализацияТоваровУслугВозвратнаяТара.Цена,
	ЗНАЧЕНИЕ(Перечисление.СтавкиНДС.БезНДС),
	НЕОПРЕДЕЛЕНО,
	РеализацияТоваровУслугВозвратнаяТара.Номенклатура.СтранаПроисхождения,
	"",
	РеализацияТоваровУслугВозвратнаяТара.Количество,
	РеализацияТоваровУслугВозвратнаяТара.Сумма,
	0,
	"RC"
ИЗ
	Документ.РеализацияТоваровУслуг.ВозвратнаяТара КАК РеализацияТоваровУслугВозвратнаяТара
ГДЕ
	&amp;ОтправлятьВозвратнуюТару
	И РеализацияТоваровУслугВозвратнаяТара.Ссылка В(&amp;Ссылка)

ОБЪЕДИНИТЬ ВСЕ

ВЫБРАТЬ
	0,
	ВозвратТоваровОтПокупателяВозвратнаяТара.Номенклатура,
	НЕОПРЕДЕЛЕНО,
	ВозвратТоваровОтПокупателяВозвратнаяТара.Номенклатура.ЕдиницаХраненияОстатков,
	ВозвратТоваровОтПокупателяВозвратнаяТара.Номенклатура.ЕдиницаХраненияОстатков.ЕдиницаПоКлассификатору.Наименование,
	ВЫРАЗИТЬ(ВозвратТоваровОтПокупателяВозвратнаяТара.Номенклатура.Наименование КАК СТРОКА(178)),
	ВЫРАЗИТЬ(ВозвратТоваровОтПокупателяВозвратнаяТара.Номенклатура.НаименованиеПолное КАК СТРОКА(500)),
	ВозвратТоваровОтПокупателяВозвратнаяТара.Цена,
	ЗНАЧЕНИЕ(Перечисление.СтавкиНДС.БезНДС),
	НЕОПРЕДЕЛЕНО,
	ВозвратТоваровОтПокупателяВозвратнаяТара.Номенклатура.СтранаПроисхождения,
	"",
	-ВозвратТоваровОтПокупателяВозвратнаяТара.Количество,
	-ВозвратТоваровОтПокупателяВозвратнаяТара.Сумма,
	0,
	"RC"
ИЗ
	Документ.ВозвратТоваровОтПокупателя.ВозвратнаяТара КАК ВозвратТоваровОтПокупателяВозвратнаяТара
ГДЕ
	&amp;ОтправлятьВозвратнуюТару
	И ВозвратТоваровОтПокупателяВозвратнаяТара.Ссылка В(&amp;Возвраты)

ОБЪЕДИНИТЬ ВСЕ

ВЫБРАТЬ
	РеализацияТоваровУслугТовары.НомерСтроки,
	РеализацияТоваровУслугТовары.Номенклатура,
	НЕОПРЕДЕЛЕНО,
	РеализацияТоваровУслугТовары.Номенклатура.ЕдиницаХраненияОстатков,
	РеализацияТоваровУслугТовары.Номенклатура.ЕдиницаХраненияОстатков.ЕдиницаПоКлассификатору.Наименование,
	ВЫРАЗИТЬ(РеализацияТоваровУслугТовары.Номенклатура.Наименование КАК СТРОКА(178)),
	ВЫРАЗИТЬ(РеализацияТоваровУслугТовары.Номенклатура.НаименованиеПолное КАК СТРОКА(500)),
	РеализацияТоваровУслугТовары.Цена,
	РеализацияТоваровУслугТовары.СтавкаНДС,
	НЕОПРЕДЕЛЕНО,
	РеализацияТоваровУслугТовары.Номенклатура.СтранаПроисхождения,
	"",
	РеализацияТоваровУслугТовары.Количество,
	РеализацияТоваровУслугТовары.Сумма,
	РеализацияТоваровУслугТовары.СуммаНДС,
	"Services"
ИЗ
	Документ.РеализацияТоваровУслуг.Услуги КАК РеализацияТоваровУслугТовары
ГДЕ
	&amp;РаботаСУслугами
	И РеализацияТоваровУслугТовары.Ссылка В(&amp;Ссылка)</query>
						<autoFillFields>false</autoFillFields>
					</item>
				</item>
				<item xsi:type="DataSetUnion">
					<name>_RETINS_RETREC_</name>
					<field xsi:type="DataSetFieldField">
						<dataPath>НомерСтроки</dataPath>
						<field>НомерСтроки</field>
					</field>
					<field xsi:type="DataSetFieldField">
						<dataPath>ЕдиницаИзмерения</dataPath>
						<field>ЕдиницаИзмерения</field>
					</field>
					<field xsi:type="DataSetFieldField">
						<dataPath>КодЕдиницыИзмерения</dataPath>
						<field>КодЕдиницыИзмерения</field>
					</field>
					<field xsi:type="DataSetFieldField">
						<dataPath>Количество</dataPath>
						<field>Количество</field>
					</field>
					<field xsi:type="DataSetFieldField">
						<dataPath>Наименование</dataPath>
						<field>Наименование</field>
					</field>
					<field xsi:type="DataSetFieldField">
						<dataPath>НаименованиеПолное</dataPath>
						<field>НаименованиеПолное</field>
					</field>
					<field xsi:type="DataSetFieldField">
						<dataPath>Номенклатура</dataPath>
						<field>Номенклатура</field>
					</field>
					<field xsi:type="DataSetFieldField">
						<dataPath>НомерГТД</dataPath>
						<field>НомерГТД</field>
					</field>
					<field xsi:type="DataSetFieldField">
						<dataPath>СерияНоменклатуры</dataPath>
						<field>СерияНоменклатуры</field>
					</field>
					<field xsi:type="DataSetFieldField">
						<dataPath>СтавкаНДС</dataPath>
						<field>СтавкаНДС</field>
					</field>
					<field xsi:type="DataSetFieldField">
						<dataPath>Страна</dataPath>
						<field>Страна</field>
					</field>
					<field xsi:type="DataSetFieldField">
						<dataPath>Сумма</dataPath>
						<field>Сумма</field>
					</field>
					<field xsi:type="DataSetFieldField">
						<dataPath>СуммаНДС</dataPath>
						<field>СуммаНДС</field>
					</field>
					<field xsi:type="DataSetFieldField">
						<dataPath>ТипЕдиницы</dataPath>
						<field>ТипЕдиницы</field>
					</field>
					<field xsi:type="DataSetFieldField">
						<dataPath>ХарактеристикаНоменклатуры</dataPath>
						<field>ХарактеристикаНоменклатуры</field>
					</field>
					<field xsi:type="DataSetFieldField">
						<dataPath>Цена</dataPath>
						<field>Цена</field>
					</field>
					<item xsi:type="DataSetQuery">
						<name>ВозвратТоваровОтПокупателя</name>
						<field xsi:type="DataSetFieldField">
							<dataPath>НомерСтроки</dataPath>
							<field>НомерСтроки</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>ЕдиницаИзмерения</dataPath>
							<field>ЕдиницаИзмерения</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>КодЕдиницыИзмерения</dataPath>
							<field>КодЕдиницыИзмерения</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>Количество</dataPath>
							<field>Количество</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>Наименование</dataPath>
							<field>Наименование</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>НаименованиеПолное</dataPath>
							<field>НаименованиеПолное</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>Номенклатура</dataPath>
							<field>Номенклатура</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>НомерГТД</dataPath>
							<field>НомерГТД</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>СерияНоменклатуры</dataPath>
							<field>СерияНоменклатуры</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>СтавкаНДС</dataPath>
							<field>СтавкаНДС</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>Страна</dataPath>
							<field>Страна</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>Сумма</dataPath>
							<field>Сумма</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>СуммаНДС</dataPath>
							<field>СуммаНДС</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>ТипЕдиницы</dataPath>
							<field>ТипЕдиницы</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>ХарактеристикаНоменклатуры</dataPath>
							<field>ХарактеристикаНоменклатуры</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>Цена</dataPath>
							<field>Цена</field>
						</field>
						<dataSource>ИсточникДанных1</dataSource>
						<query>ВЫБРАТЬ
	ВозвратТоваровОтПокупателяТовары.НомерСтроки,
	ВозвратТоваровОтПокупателяТовары.Номенклатура,
	ВозвратТоваровОтПокупателяТовары.ХарактеристикаНоменклатуры,
	ВозвратТоваровОтПокупателяТовары.ЕдиницаИзмерения,
	ВозвратТоваровОтПокупателяТовары.ЕдиницаИзмерения.ЕдиницаПоКлассификатору.Наименование КАК КодЕдиницыИзмерения,
	ВЫРАЗИТЬ(ВозвратТоваровОтПокупателяТовары.Номенклатура.Наименование КАК СТРОКА(178)) КАК Наименование,
	ВЫРАЗИТЬ(ВозвратТоваровОтПокупателяТовары.Номенклатура.НаименованиеПолное КАК СТРОКА(500)) КАК НаименованиеПолное,
	ВозвратТоваровОтПокупателяТовары.Цена,
	ВозвратТоваровОтПокупателяТовары.СтавкаНДС,
	ВозвратТоваровОтПокупателяТовары.СерияНоменклатуры,
	ВЫБОР
		КОГДА (ВозвратТоваровОтПокупателяТовары.СерияНоменклатуры = ЗНАЧЕНИЕ(Справочник.СерииНоменклатуры.ПустаяСсылка)
				ИЛИ ВозвратТоваровОтПокупателяТовары.СерияНоменклатуры.СтранаПроисхождения = ЗНАЧЕНИЕ(Справочник.КлассификаторСтранМира.ПустаяСсылка))
				И ВозвратТоваровОтПокупателяТовары.Номенклатура.ВестиУчетПоСериям
			ТОГДА ВозвратТоваровОтПокупателяТовары.Номенклатура.СтранаПроисхождения
		ИНАЧЕ ВозвратТоваровОтПокупателяТовары.СерияНоменклатуры.СтранаПроисхождения
	КОНЕЦ КАК Страна,
	ВЫБОР
		КОГДА ВозвратТоваровОтПокупателяТовары.Номенклатура.ВестиУчетПоСериям
			ТОГДА ЕСТЬNULL(ВозвратТоваровОтПокупателяТовары.СерияНоменклатуры.НомерГТД.Код, ЕСТЬNULL(ВозвратТоваровОтПокупателяТовары.Номенклатура.НомерГТД.Код, ""))
		ИНАЧЕ ""
	КОНЕЦ КАК НомерГТД,
	ВозвратТоваровОтПокупателяТовары.Количество,
	ВозвратТоваровОтПокупателяТовары.Сумма,
	ВозвратТоваровОтПокупателяТовары.СуммаНДС,
	"" КАК ТипЕдиницы
ИЗ
	Документ.ВозвратТоваровОтПокупателя.Товары КАК ВозвратТоваровОтПокупателяТовары
ГДЕ
	ВозвратТоваровОтПокупателяТовары.Ссылка В(&amp;Ссылка)</query>
					</item>
					<item xsi:type="DataSetQuery">
						<name>ПоступлениеТоваровУслуг</name>
						<field xsi:type="DataSetFieldField">
							<dataPath>НомерСтроки</dataPath>
							<field>НомерСтроки</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>ЕдиницаИзмерения</dataPath>
							<field>ЕдиницаИзмерения</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>КодЕдиницыИзмерения</dataPath>
							<field>КодЕдиницыИзмерения</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>Количество</dataPath>
							<field>Количество</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>Наименование</dataPath>
							<field>Наименование</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>НаименованиеПолное</dataPath>
							<field>НаименованиеПолное</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>Номенклатура</dataPath>
							<field>Номенклатура</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>НомерГТД</dataPath>
							<field>НомерГТД</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>СерияНоменклатуры</dataPath>
							<field>СерияНоменклатуры</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>СтавкаНДС</dataPath>
							<field>СтавкаНДС</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>Страна</dataPath>
							<field>Страна</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>Сумма</dataPath>
							<field>Сумма</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>СуммаНДС</dataPath>
							<field>СуммаНДС</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>ТипЕдиницы</dataPath>
							<field>ТипЕдиницы</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>ХарактеристикаНоменклатуры</dataPath>
							<field>ХарактеристикаНоменклатуры</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>Цена</dataPath>
							<field>Цена</field>
						</field>
						<dataSource>ИсточникДанных1</dataSource>
						<query>ВЫБРАТЬ
	ПоступлениеТоваровУслугТовары.НомерСтроки,
	ПоступлениеТоваровУслугТовары.Номенклатура,
	ПоступлениеТоваровУслугТовары.ХарактеристикаНоменклатуры,
	ПоступлениеТоваровУслугТовары.ЕдиницаИзмерения,
	ПоступлениеТоваровУслугТовары.ЕдиницаИзмерения.ЕдиницаПоКлассификатору.Наименование КАК КодЕдиницыИзмерения,
	ВЫРАЗИТЬ(ПоступлениеТоваровУслугТовары.Номенклатура.Наименование КАК СТРОКА(178)) КАК Наименование,
	ВЫРАЗИТЬ(ПоступлениеТоваровУслугТовары.Номенклатура.НаименованиеПолное КАК СТРОКА(500)) КАК НаименованиеПолное,
	ПоступлениеТоваровУслугТовары.Цена,
	ПоступлениеТоваровУслугТовары.СтавкаНДС,
	ПоступлениеТоваровУслугТовары.СерияНоменклатуры,
	ВЫБОР
		КОГДА (ПоступлениеТоваровУслугТовары.СерияНоменклатуры = ЗНАЧЕНИЕ(Справочник.СерииНоменклатуры.ПустаяСсылка)
				ИЛИ ПоступлениеТоваровУслугТовары.СерияНоменклатуры.СтранаПроисхождения = ЗНАЧЕНИЕ(Справочник.КлассификаторСтранМира.ПустаяСсылка))
				И ПоступлениеТоваровУслугТовары.Номенклатура.ВестиУчетПоСериям
			ТОГДА ПоступлениеТоваровУслугТовары.Номенклатура.СтранаПроисхождения
		ИНАЧЕ ПоступлениеТоваровУслугТовары.СерияНоменклатуры.СтранаПроисхождения
	КОНЕЦ КАК Страна,
	ВЫБОР
		КОГДА ПоступлениеТоваровУслугТовары.Номенклатура.ВестиУчетПоСериям
			ТОГДА ЕСТЬNULL(ПоступлениеТоваровУслугТовары.СерияНоменклатуры.НомерГТД.Код, ЕСТЬNULL(ПоступлениеТоваровУслугТовары.Номенклатура.НомерГТД.Код, ""))
		ИНАЧЕ ""
	КОНЕЦ КАК НомерГТД,
	ПоступлениеТоваровУслугТовары.Количество,
	ПоступлениеТоваровУслугТовары.Сумма,
	ПоступлениеТоваровУслугТовары.СуммаНДС,
	"" КАК ТипЕдиницы
ИЗ
	Документ.ПоступлениеТоваровУслуг.Товары КАК ПоступлениеТоваровУслугТовары
ГДЕ
	ПоступлениеТоваровУслугТовары.Ссылка В(&amp;Ссылка)</query>
					</item>
				</item>
				<item xsi:type="DataSetUnion">
					<name>_COINVOIC_IINVOIC_</name>
					<field xsi:type="DataSetFieldField">
						<dataPath>ЕдиницаИзмерения</dataPath>
						<field>ЕдиницаИзмерения</field>
					</field>
					<field xsi:type="DataSetFieldField">
						<dataPath>Количество</dataPath>
						<field>Количество</field>
					</field>
					<field xsi:type="DataSetFieldField">
						<dataPath>КоличествоДоКорректировки</dataPath>
						<field>КоличествоДоКорректировки</field>
					</field>
					<field xsi:type="DataSetFieldField">
						<dataPath>Номенклатура</dataPath>
						<field>Номенклатура</field>
					</field>
					<field xsi:type="DataSetFieldField">
						<dataPath>НомерГТД</dataPath>
						<field>НомерГТД</field>
					</field>
					<field xsi:type="DataSetFieldField">
						<dataPath>СерияНоменклатуры</dataPath>
						<field>СерияНоменклатуры</field>
					</field>
					<field xsi:type="DataSetFieldField">
						<dataPath>СтавкаНДС</dataPath>
						<field>СтавкаНДС</field>
					</field>
					<field xsi:type="DataSetFieldField">
						<dataPath>СтавкаНДСДоКорректировки</dataPath>
						<field>СтавкаНДСДоКорректировки</field>
					</field>
					<field xsi:type="DataSetFieldField">
						<dataPath>Страна</dataPath>
						<field>Страна</field>
					</field>
					<field xsi:type="DataSetFieldField">
						<dataPath>Сумма</dataPath>
						<field>Сумма</field>
					</field>
					<field xsi:type="DataSetFieldField">
						<dataPath>СуммаДоКорректировки</dataPath>
						<field>СуммаДоКорректировки</field>
					</field>
					<field xsi:type="DataSetFieldField">
						<dataPath>СуммаНДС</dataPath>
						<field>СуммаНДС</field>
					</field>
					<field xsi:type="DataSetFieldField">
						<dataPath>СуммаНДСДоКорректировки</dataPath>
						<field>СуммаНДСДоКорректировки</field>
					</field>
					<field xsi:type="DataSetFieldField">
						<dataPath>ТипЕдиницы</dataPath>
						<field>ТипЕдиницы</field>
					</field>
					<field xsi:type="DataSetFieldField">
						<dataPath>ХарактеристикаНоменклатуры</dataPath>
						<field>ХарактеристикаНоменклатуры</field>
					</field>
					<field xsi:type="DataSetFieldField">
						<dataPath>Цена</dataPath>
						<field>Цена</field>
					</field>
					<field xsi:type="DataSetFieldField">
						<dataPath>ЦенаДоКорректировки</dataPath>
						<field>ЦенаДоКорректировки</field>
					</field>
					<field xsi:type="DataSetFieldField">
						<dataPath>Наименование</dataPath>
						<field>Наименование</field>
					</field>
					<field xsi:type="DataSetFieldField">
						<dataPath>НаименованиеПолное</dataPath>
						<field>НаименованиеПолное</field>
					</field>
					<item xsi:type="DataSetQuery">
						<name>КорректировкаРеализации</name>
						<field xsi:type="DataSetFieldField">
							<dataPath>ЕдиницаИзмерения</dataPath>
							<field>ЕдиницаИзмерения</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>Количество</dataPath>
							<field>Количество</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>КоличествоДоКорректировки</dataPath>
							<field>КоличествоДоКорректировки</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>Номенклатура</dataPath>
							<field>Номенклатура</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>НомерГТД</dataPath>
							<field>НомерГТД</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>СерияНоменклатуры</dataPath>
							<field>СерияНоменклатуры</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>СтавкаНДС</dataPath>
							<field>СтавкаНДС</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>СтавкаНДСДоКорректировки</dataPath>
							<field>СтавкаНДСДоКорректировки</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>Страна</dataPath>
							<field>Страна</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>Сумма</dataPath>
							<field>Сумма</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>СуммаДоКорректировки</dataPath>
							<field>СуммаДоКорректировки</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>СуммаНДС</dataPath>
							<field>СуммаНДС</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>СуммаНДСДоКорректировки</dataPath>
							<field>СуммаНДСДоКорректировки</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>ТипЕдиницы</dataPath>
							<field>ТипЕдиницы</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>ХарактеристикаНоменклатуры</dataPath>
							<field>ХарактеристикаНоменклатуры</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>Цена</dataPath>
							<field>Цена</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>ЦенаДоКорректировки</dataPath>
							<field>ЦенаДоКорректировки</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>Наименование</dataPath>
							<field>Наименование</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>НаименованиеПолное</dataPath>
							<field>НаименованиеПолное</field>
						</field>
						<dataSource>ИсточникДанных1</dataSource>
						<query>ВЫБРАТЬ
	КорректировкаРеализацииТовары.Номенклатура,
	КорректировкаРеализацииТовары.ХарактеристикаНоменклатуры,
	КорректировкаРеализацииТовары.ЕдиницаИзмерения,
	ВЫРАЗИТЬ(КорректировкаРеализацииТовары.Номенклатура.Наименование КАК СТРОКА(178)) КАК НоменклатураНаименование,
	ПОДСТРОКА(КорректировкаРеализацииТовары.Номенклатура.НаименованиеПолное, 0, 500) КАК НоменклатураНаименованиеПолное,
	МАКСИМУМ(КорректировкаРеализацииТовары.Цена) КАК Цена,
	КорректировкаРеализацииТовары.ЦенаДоКорректировки КАК ЦенаДоКорректировки,
	КорректировкаРеализацииТовары.СтавкаНДС,
	КорректировкаРеализацииТовары.СтавкаНДСДоИзменения КАК СтавкаНДСДоКорректировки,
	ВЫБОР
		КОГДА &amp;СворачиватьСтроки
			ТОГДА НЕОПРЕДЕЛЕНО
		ИНАЧЕ КорректировкаРеализацииТовары.СерияНоменклатуры
	КОНЕЦ КАК СерияНоменклатуры,
	ВЫБОР
		КОГДА &amp;ТипСообщения = "INVOIC"
			ТОГДА ВЫБОР
					КОГДА КорректировкаРеализацииТовары.СерияНоменклатуры &lt;&gt; ЗНАЧЕНИЕ(Справочник.СерииНоменклатуры.ПустаяСсылка)
							И КорректировкаРеализацииТовары.СерияНоменклатуры.СтранаПроисхождения &lt;&gt; ЗНАЧЕНИЕ(Справочник.КлассификаторСтранМира.ПустаяСсылка)
						ТОГДА КорректировкаРеализацииТовары.СерияНоменклатуры.СтранаПроисхождения
					ИНАЧЕ КорректировкаРеализацииТовары.Номенклатура.СтранаПроисхождения
				КОНЕЦ
		ИНАЧЕ ЗНАЧЕНИЕ(Справочник.КлассификаторСтранМира.ПустаяСсылка)
	КОНЕЦ КАК Страна,
	ВЫБОР
		КОГДА &amp;ТипСообщения = "INVOIC"
			ТОГДА ВЫБОР
					КОГДА ЕСТЬNULL(КорректировкаРеализацииТовары.СерияНоменклатуры.НомерГТД, ЗНАЧЕНИЕ(Справочник.НомераГТД.ПустаяСсылка)) = ЗНАЧЕНИЕ(Справочник.НомераГТД.ПустаяСсылка)
						ТОГДА КорректировкаРеализацииТовары.Номенклатура.НомерГТД
					ИНАЧЕ КорректировкаРеализацииТовары.СерияНоменклатуры.НомерГТД
				КОНЕЦ
		ИНАЧЕ ЗНАЧЕНИЕ(Справочник.НомераГТД.ПустаяСсылка)
	КОНЕЦ КАК НомерГТД,
	СУММА(КорректировкаРеализацииТовары.Количество) КАК Количество,
	СУММА(КорректировкаРеализацииТовары.КоличествоДоКорректировки) КАК КоличествоДоКорректировки,
	СУММА(КорректировкаРеализацииТовары.Сумма) КАК Сумма,
	СУММА(КорректировкаРеализацииТовары.СуммаДоКорректировки) КАК СуммаДоКорректировки,
	СУММА(КорректировкаРеализацииТовары.СуммаНДС) КАК СуммаНДС,
	СУММА(КорректировкаРеализацииТовары.СуммаНДСДоКорректировки) КАК СуммаНДСДоКорректировки,
	ВЫБОР
		КОГДА КорректировкаРеализацииТовары.Номенклатура.ВидНоменклатуры.ТипНоменклатуры = ЗНАЧЕНИЕ(Перечисление.ТипыНоменклатуры.Услуга)
			ТОГДА "Services"
		ИНАЧЕ ""
	КОНЕЦ КАК ТипЕдиницы
ПОМЕСТИТЬ табКорректировки
ИЗ
	Документ.КорректировкаРеализации.Товары КАК КорректировкаРеализацииТовары
ГДЕ
	КорректировкаРеализацииТовары.Ссылка = &amp;Ссылка

СГРУППИРОВАТЬ ПО
	КорректировкаРеализацииТовары.Номенклатура,
	КорректировкаРеализацииТовары.ХарактеристикаНоменклатуры,
	КорректировкаРеализацииТовары.ЕдиницаИзмерения,
	ВЫРАЗИТЬ(КорректировкаРеализацииТовары.Номенклатура.Наименование КАК СТРОКА(178)),
	ПОДСТРОКА(КорректировкаРеализацииТовары.Номенклатура.НаименованиеПолное, 0, 500),
	КорректировкаРеализацииТовары.СтавкаНДС,
	КорректировкаРеализацииТовары.СтавкаНДСДоИзменения,
	ВЫБОР
		КОГДА &amp;СворачиватьСтроки
			ТОГДА НЕОПРЕДЕЛЕНО
		ИНАЧЕ КорректировкаРеализацииТовары.СерияНоменклатуры
	КОНЕЦ,
	ВЫБОР
		КОГДА КорректировкаРеализацииТовары.Номенклатура.ВидНоменклатуры.ТипНоменклатуры = ЗНАЧЕНИЕ(Перечисление.ТипыНоменклатуры.Услуга)
			ТОГДА "Services"
		ИНАЧЕ ""
	КОНЕЦ,
	ВЫБОР
		КОГДА &amp;ТипСообщения = "INVOIC"
			ТОГДА ВЫБОР
					КОГДА КорректировкаРеализацииТовары.СерияНоменклатуры &lt;&gt; ЗНАЧЕНИЕ(Справочник.СерииНоменклатуры.ПустаяСсылка)
							И КорректировкаРеализацииТовары.СерияНоменклатуры.СтранаПроисхождения &lt;&gt; ЗНАЧЕНИЕ(Справочник.КлассификаторСтранМира.ПустаяСсылка)
						ТОГДА КорректировкаРеализацииТовары.СерияНоменклатуры.СтранаПроисхождения
					ИНАЧЕ КорректировкаРеализацииТовары.Номенклатура.СтранаПроисхождения
				КОНЕЦ
		ИНАЧЕ ЗНАЧЕНИЕ(Справочник.КлассификаторСтранМира.ПустаяСсылка)
	КОНЕЦ,
	ВЫБОР
		КОГДА &amp;ТипСообщения = "INVOIC"
			ТОГДА ВЫБОР
					КОГДА ЕСТЬNULL(КорректировкаРеализацииТовары.СерияНоменклатуры.НомерГТД, ЗНАЧЕНИЕ(Справочник.НомераГТД.ПустаяСсылка)) = ЗНАЧЕНИЕ(Справочник.НомераГТД.ПустаяСсылка)
						ТОГДА КорректировкаРеализацииТовары.Номенклатура.НомерГТД
					ИНАЧЕ КорректировкаРеализацииТовары.СерияНоменклатуры.НомерГТД
				КОНЕЦ
		ИНАЧЕ ЗНАЧЕНИЕ(Справочник.НомераГТД.ПустаяСсылка)
	КОНЕЦ,
	КорректировкаРеализацииТовары.ЦенаДоКорректировки

ОБЪЕДИНИТЬ ВСЕ

ВЫБРАТЬ
	КорректировкаРеализацииУслуги.Номенклатура,
	ЗНАЧЕНИЕ(Справочник.ХарактеристикиНоменклатуры.ПустаяСсылка),
	ЗНАЧЕНИЕ(Справочник.ЕдиницыИзмерения.ПустаяСсылка),
	ВЫРАЗИТЬ(КорректировкаРеализацииУслуги.Номенклатура.Наименование КАК СТРОКА(178)),
	ПОДСТРОКА(КорректировкаРеализацииУслуги.Номенклатура.НаименованиеПолное, 0, 500),
	МАКСИМУМ(КорректировкаРеализацииУслуги.Цена),
	КорректировкаРеализацииУслуги.ЦенаДоКорректировки,
	КорректировкаРеализацииУслуги.СтавкаНДС,
	КорректировкаРеализацииУслуги.СтавкаНДСДоИзменения,
	ЗНАЧЕНИЕ(Справочник.СерииНоменклатуры.ПустаяСсылка),
	NULL,
	NULL,
	СУММА(КорректировкаРеализацииУслуги.Количество),
	СУММА(КорректировкаРеализацииУслуги.КоличествоДоКорректировки),
	СУММА(КорректировкаРеализацииУслуги.Сумма),
	СУММА(КорректировкаРеализацииУслуги.СуммаДоКорректировки),
	СУММА(КорректировкаРеализацииУслуги.СуммаНДС),
	СУММА(КорректировкаРеализацииУслуги.СуммаНДСДоКорректировки),
	"Services"
ИЗ
	Документ.КорректировкаРеализации.Услуги КАК КорректировкаРеализацииУслуги
ГДЕ
	КорректировкаРеализацииУслуги.Ссылка = &amp;Ссылка

СГРУППИРОВАТЬ ПО
	КорректировкаРеализацииУслуги.Номенклатура,
	ВЫРАЗИТЬ(КорректировкаРеализацииУслуги.Номенклатура.Наименование КАК СТРОКА(178)),
	ПОДСТРОКА(КорректировкаРеализацииУслуги.Номенклатура.НаименованиеПолное, 0, 500),
	КорректировкаРеализацииУслуги.СтавкаНДС,
	КорректировкаРеализацииУслуги.СтавкаНДСДоИзменения,
	КорректировкаРеализацииУслуги.ЦенаДоКорректировки
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ
	табКорректировки.Номенклатура,
	табКорректировки.ХарактеристикаНоменклатуры,
	табКорректировки.ЕдиницаИзмерения,
	ВЫРАЗИТЬ(табКорректировки.НоменклатураНаименование КАК СТРОКА(178)) КАК Наименование,
	ВЫРАЗИТЬ(табКорректировки.НоменклатураНаименованиеПолное КАК СТРОКА(500)) КАК НаименованиеПолное,
	ВЫБОР
		КОГДА табКорректировки.Цена &lt;&gt; 0
			ТОГДА табКорректировки.Цена
		КОГДА НЕ табКорректировки.Количество = 0
			ТОГДА табКорректировки.Сумма / табКорректировки.Количество
		ИНАЧЕ 0
	КОНЕЦ КАК Цена,
	табКорректировки.ЦенаДоКорректировки КАК ЦенаДоКорректировки,
	табКорректировки.СтавкаНДС,
	табКорректировки.СтавкаНДСДоКорректировки,
	табКорректировки.СерияНоменклатуры,
	табКорректировки.Страна,
	табКорректировки.НомерГТД,
	табКорректировки.Количество,
	табКорректировки.КоличествоДоКорректировки,
	табКорректировки.Сумма,
	табКорректировки.СуммаДоКорректировки,
	табКорректировки.СуммаНДС,
	табКорректировки.СуммаНДСДоКорректировки,
	табКорректировки.ТипЕдиницы
ИЗ
	табКорректировки КАК табКорректировки</query>
					</item>
				</item>
				<item xsi:type="DataSetUnion">
					<name>_PRICELIST_</name>
					<field xsi:type="DataSetFieldField">
						<dataPath>GTIN</dataPath>
						<field>GTIN</field>
					</field>
					<field xsi:type="DataSetFieldField">
						<dataPath>ЕдИзмСрокаГодности</dataPath>
						<field>ЕдИзмСрокаГодности</field>
					</field>
					<field xsi:type="DataSetFieldField">
						<dataPath>ЕдиницаИзмерения</dataPath>
						<field>ЕдиницаИзмерения</field>
					</field>
					<field xsi:type="DataSetFieldField">
						<dataPath>КвантПоставки</dataPath>
						<field>КвантПоставки</field>
					</field>
					<field xsi:type="DataSetFieldField">
						<dataPath>КодТовараПоставщика</dataPath>
						<field>КодТовараПоставщика</field>
					</field>
					<field xsi:type="DataSetFieldField">
						<dataPath>КоличествоВОдномМесте</dataPath>
						<field>КоличествоВОдномМесте</field>
					</field>
					<field xsi:type="DataSetFieldField">
						<dataPath>Наименование</dataPath>
						<field>Наименование</field>
					</field>
					<field xsi:type="DataSetFieldField">
						<dataPath>Номенклатура</dataPath>
						<field>Номенклатура</field>
					</field>
					<field xsi:type="DataSetFieldField">
						<dataPath>Родитель</dataPath>
						<field>Родитель</field>
					</field>
					<field xsi:type="DataSetFieldField">
						<dataPath>СрокГодности</dataPath>
						<field>СрокГодности</field>
					</field>
					<field xsi:type="DataSetFieldField">
						<dataPath>СтавкаНДС</dataPath>
						<field>СтавкаНДС</field>
					</field>
					<field xsi:type="DataSetFieldField">
						<dataPath>Страна</dataPath>
						<field>Страна</field>
					</field>
					<field xsi:type="DataSetFieldField">
						<dataPath>Цена</dataPath>
						<field>Цена</field>
					</field>
					<field xsi:type="DataSetFieldField">
						<dataPath>КоличествоОстаткаНаКонец</dataPath>
						<field>КоличествоОстаткаНаКонец</field>
					</field>
					<field xsi:type="DataSetFieldField">
						<dataPath>Качество</dataPath>
						<field>Качество</field>
					</field>
					<field xsi:type="DataSetFieldField">
						<dataPath>СерияНоменклатуры</dataPath>
						<field>СерияНоменклатуры</field>
					</field>
					<field xsi:type="DataSetFieldField">
						<dataPath>Склад</dataPath>
						<field>Склад</field>
					</field>
					<field xsi:type="DataSetFieldField">
						<dataPath>ХарактеристикаНоменклатуры</dataPath>
						<field>ХарактеристикаНоменклатуры</field>
					</field>
					<field xsi:type="DataSetFieldField">
						<dataPath>РекомендуемаяРозничнаяЦена</dataPath>
						<field>РекомендуемаяРозничнаяЦена</field>
					</field>
					<item xsi:type="DataSetQuery">
						<name>Ценовой_лист_БезЦен</name>
						<field xsi:type="DataSetFieldField">
							<dataPath>GTIN</dataPath>
							<field>GTIN</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>ЕдИзмСрокаГодности</dataPath>
							<field>ЕдИзмСрокаГодности</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>ЕдиницаИзмерения</dataPath>
							<field>ЕдиницаИзмерения</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>КвантПоставки</dataPath>
							<field>КвантПоставки</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>КодТовараПоставщика</dataPath>
							<field>КодТовараПоставщика</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>КоличествоВОдномМесте</dataPath>
							<field>КоличествоВОдномМесте</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>Наименование</dataPath>
							<field>Наименование</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>Номенклатура</dataPath>
							<field>Номенклатура</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>Родитель</dataPath>
							<field>Родитель</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>СрокГодности</dataPath>
							<field>СрокГодности</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>СтавкаНДС</dataPath>
							<field>СтавкаНДС</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>Страна</dataPath>
							<field>Страна</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>Цена</dataPath>
							<field>Цена</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>РекомендуемаяРозничнаяЦена</dataPath>
							<field>РекомендуемаяРозничнаяЦена</field>
						</field>
						<dataSource>ИсточникДанных1</dataSource>
						<query>   ВЫБРАТЬ
	СправочникНоменклатура.Родитель КАК Родитель,
	СправочникНоменклатура.Ссылка КАК Номенклатура,
	СправочникНоменклатура.ЕдиницаХраненияОстатков КАК ЕдиницаИзмерения,
	СправочникНоменклатура.Код КАК КодТовараПоставщика,
	СправочникНоменклатура.НаименованиеПолное КАК Наименование,
	СправочникНоменклатура.СтавкаНДС КАК СтавкаНДС,
	0 КАК Цена,
	0 КАК РекомендуемаяРозничнаяЦена,
	Штрихкоды.Штрихкод КАК GTIN,
	СправочникНоменклатура.ЕдиницаХраненияОстатков.Коэффициент КАК КоличествоВОдномМесте,
	СправочникНоменклатура.СтранаПроисхождения КАК Страна,
	NULL КАК КвантПоставки,
	NULL КАК ЕдИзмСрокаГодности,
	NULL КАК СрокГодности
ИЗ
	Справочник.Номенклатура КАК СправочникНоменклатура
		ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.Штрихкоды КАК Штрихкоды
		ПО СправочникНоменклатура.Ссылка = Штрихкоды.Владелец
			И (Штрихкоды.ХарактеристикаНоменклатуры = ЗНАЧЕНИЕ(Справочник.ХарактеристикиНоменклатуры.ПустаяСсылка))
			И (Штрихкоды.ЕдиницаИзмерения = СправочникНоменклатура.ЕдиницаХраненияОстатков)
ГДЕ
	НЕ СправочникНоменклатура.ЭтоГруппа
	И НЕ СправочникНоменклатура.ПометкаУдаления
	И НЕ СправочникНоменклатура.Услуга
	И &amp;УсловиеОтбораНоменклатуры</query>
					</item>
					<item xsi:type="DataSetQuery">
						<name>Ценовой_лист_СЦенами</name>
						<field xsi:type="DataSetFieldField">
							<dataPath>GTIN</dataPath>
							<field>GTIN</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>ЕдИзмСрокаГодности</dataPath>
							<field>ЕдИзмСрокаГодности</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>ЕдиницаИзмерения</dataPath>
							<field>ЕдиницаИзмерения</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>КвантПоставки</dataPath>
							<field>КвантПоставки</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>КодТовараПоставщика</dataPath>
							<field>КодТовараПоставщика</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>КоличествоВОдномМесте</dataPath>
							<field>КоличествоВОдномМесте</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>Наименование</dataPath>
							<field>Наименование</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>Номенклатура</dataPath>
							<field>Номенклатура</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>Родитель</dataPath>
							<field>Родитель</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>СрокГодности</dataPath>
							<field>СрокГодности</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>СтавкаНДС</dataPath>
							<field>СтавкаНДС</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>Страна</dataPath>
							<field>Страна</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>Цена</dataPath>
							<field>Цена</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>РекомендуемаяРозничнаяЦена</dataPath>
							<field>РекомендуемаяРозничнаяЦена</field>
						</field>
						<dataSource>ИсточникДанных1</dataSource>
						<query>  ВЫБРАТЬ
	ЦеныНоменклатурыСрезПоследних.Номенклатура.Родитель КАК Родитель,
	ЦеныНоменклатурыСрезПоследних.Номенклатура.Ссылка КАК Номенклатура,
	ЦеныНоменклатурыСрезПоследних.ЕдиницаИзмерения КАК ЕдиницаИзмерения,
	ЦеныНоменклатурыСрезПоследних.Номенклатура.Код КАК КодТовараПоставщика,
	ЦеныНоменклатурыСрезПоследних.Номенклатура.НаименованиеПолное КАК Наименование,
	ЦеныНоменклатурыСрезПоследних.Номенклатура.СтавкаНДС КАК СтавкаНДС,
	ЦеныНоменклатурыСрезПоследних.Цена,
	0 КАК РекомендуемаяРозничнаяЦена,
	Штрихкоды.Штрихкод КАК GTIN,
	ЦеныНоменклатурыСрезПоследних.ЕдиницаИзмерения.Коэффициент КАК КоличествоВОдномМесте,
	ЦеныНоменклатурыСрезПоследних.Номенклатура.СтранаПроисхождения КАК Страна,
	NULL КАК КвантПоставки,
	NULL КАК ЕдИзмСрокаГодности,
	NULL КАК СрокГодности
ИЗ
	РегистрСведений.ЦеныНоменклатуры.СрезПоследних(
			,
			ТипЦен = &amp;ТипЦен
				И НЕ Номенклатура.ПометкаУдаления
				И ХарактеристикаНоменклатуры = ЗНАЧЕНИЕ(Справочник.ХарактеристикиНоменклатуры.ПустаяСсылка)
				И НЕ Номенклатура.Услуга
				И &amp;УсловиеОтбораНоменклатуры) КАК ЦеныНоменклатурыСрезПоследних
		ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.Штрихкоды КАК Штрихкоды
		ПО ЦеныНоменклатурыСрезПоследних.Номенклатура = Штрихкоды.Владелец
			И (Штрихкоды.ХарактеристикаНоменклатуры = ЗНАЧЕНИЕ(Справочник.ХарактеристикиНоменклатуры.ПустаяСсылка))
			И (Штрихкоды.ЕдиницаИзмерения = ЦеныНоменклатурыСрезПоследних.ЕдиницаИзмерения)
ГДЕ
	ЦеныНоменклатурыСрезПоследних.Цена &gt; 0</query>
					</item>
					<item xsi:type="DataSetQuery">
						<name>Ценовой_лист_БезЦен_Остатки</name>
						<field xsi:type="DataSetFieldField">
							<dataPath>GTIN</dataPath>
							<field>GTIN</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>ЕдИзмСрокаГодности</dataPath>
							<field>ЕдИзмСрокаГодности</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>ЕдиницаИзмерения</dataPath>
							<field>ЕдиницаИзмерения</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>КвантПоставки</dataPath>
							<field>КвантПоставки</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>КодТовараПоставщика</dataPath>
							<field>КодТовараПоставщика</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>КоличествоВОдномМесте</dataPath>
							<field>КоличествоВОдномМесте</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>Наименование</dataPath>
							<field>Наименование</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>Номенклатура</dataPath>
							<field>Номенклатура</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>Родитель</dataPath>
							<field>Родитель</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>СрокГодности</dataPath>
							<field>СрокГодности</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>СтавкаНДС</dataPath>
							<field>СтавкаНДС</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>Страна</dataPath>
							<field>Страна</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>Цена</dataPath>
							<field>Цена</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>КоличествоОстаткаНаКонец</dataPath>
							<field>КоличествоОстаткаНаКонец</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>Качество</dataPath>
							<field>Качество</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>СерияНоменклатуры</dataPath>
							<field>СерияНоменклатуры</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>Склад</dataPath>
							<field>Склад</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>ХарактеристикаНоменклатуры</dataPath>
							<field>ХарактеристикаНоменклатуры</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>РекомендуемаяРозничнаяЦена</dataPath>
							<field>РекомендуемаяРозничнаяЦена</field>
						</field>
						<dataSource>ИсточникДанных1</dataSource>
						<query>ВЫБРАТЬ
	СправочникНоменклатура.Родитель КАК Родитель,
	СправочникНоменклатура.Ссылка КАК Номенклатура,
	СправочникНоменклатура.ЕдиницаХраненияОстатков КАК ЕдиницаИзмерения,
	СправочникНоменклатура.Код КАК КодТовараПоставщика,
	СправочникНоменклатура.НаименованиеПолное КАК Наименование,
	СправочникНоменклатура.СтавкаНДС КАК СтавкаНДС,
	0 КАК Цена,
	0 КАК РекомендуемаяРозничнаяЦена,
	Штрихкоды.Штрихкод КАК GTIN,
	СправочникНоменклатура.ЕдиницаХраненияОстатков.Коэффициент КАК КоличествоВОдномМесте,
	СправочникНоменклатура.СтранаПроисхождения КАК Страна,
	NULL КАК КвантПоставки,
	NULL КАК ЕдИзмСрокаГодности,
	NULL КАК СрокГодности,
	ЕСТЬNULL(ТоварыНаСкладахОстатки.КоличествоОстаток, 0) КАК КоличествоОстаткаНаКонец
ИЗ
	Справочник.Номенклатура КАК СправочникНоменклатура
		ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.Штрихкоды КАК Штрихкоды
		ПО СправочникНоменклатура.Ссылка = Штрихкоды.Владелец
			И (Штрихкоды.ХарактеристикаНоменклатуры = ЗНАЧЕНИЕ(Справочник.ХарактеристикиНоменклатуры.ПустаяСсылка))
			И (Штрихкоды.ЕдиницаИзмерения = СправочникНоменклатура.ЕдиницаХраненияОстатков)
		ЛЕВОЕ СОЕДИНЕНИЕ РегистрНакопления.ТоварыНаСкладах.Остатки(
				,
				ВЫБОР
					КОГДА &amp;Склад = НЕОПРЕДЕЛЕНО
						ТОГДА ИСТИНА
					ИНАЧЕ Склад В (&amp;Склад)
				КОНЕЦ) КАК ТоварыНаСкладахОстатки
		ПО СправочникНоменклатура.Ссылка = ТоварыНаСкладахОстатки.Номенклатура
ГДЕ
	НЕ СправочникНоменклатура.ЭтоГруппа
	И НЕ СправочникНоменклатура.ПометкаУдаления
	И НЕ СправочникНоменклатура.Услуга
	И &amp;УсловиеОтбораНоменклатуры</query>
					</item>
					<item xsi:type="DataSetQuery">
						<name>Ценовой_лист_СЦенами_Остатки</name>
						<field xsi:type="DataSetFieldField">
							<dataPath>GTIN</dataPath>
							<field>GTIN</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>ЕдИзмСрокаГодности</dataPath>
							<field>ЕдИзмСрокаГодности</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>ЕдиницаИзмерения</dataPath>
							<field>ЕдиницаИзмерения</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>КвантПоставки</dataPath>
							<field>КвантПоставки</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>КодТовараПоставщика</dataPath>
							<field>КодТовараПоставщика</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>КоличествоВОдномМесте</dataPath>
							<field>КоличествоВОдномМесте</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>Наименование</dataPath>
							<field>Наименование</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>Номенклатура</dataPath>
							<field>Номенклатура</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>Родитель</dataPath>
							<field>Родитель</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>СрокГодности</dataPath>
							<field>СрокГодности</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>СтавкаНДС</dataPath>
							<field>СтавкаНДС</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>Страна</dataPath>
							<field>Страна</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>Цена</dataPath>
							<field>Цена</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>КоличествоОстаткаНаКонец</dataPath>
							<field>КоличествоОстаткаНаКонец</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>Качество</dataPath>
							<field>Качество</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>СерияНоменклатуры</dataPath>
							<field>СерияНоменклатуры</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>Склад</dataPath>
							<field>Склад</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>ХарактеристикаНоменклатуры</dataPath>
							<field>ХарактеристикаНоменклатуры</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>РекомендуемаяРозничнаяЦена</dataPath>
							<field>РекомендуемаяРозничнаяЦена</field>
						</field>
						<dataSource>ИсточникДанных1</dataSource>
						<query>ВЫБРАТЬ
	ЦеныНоменклатурыСрезПоследних.Номенклатура.Родитель КАК Родитель,
	ЦеныНоменклатурыСрезПоследних.Номенклатура.Ссылка КАК Номенклатура,
	ЦеныНоменклатурыСрезПоследних.ЕдиницаИзмерения КАК ЕдиницаИзмерения,
	ЦеныНоменклатурыСрезПоследних.Номенклатура.Код КАК КодТовараПоставщика,
	ЦеныНоменклатурыСрезПоследних.Номенклатура.НаименованиеПолное КАК Наименование,
	ЦеныНоменклатурыСрезПоследних.Номенклатура.СтавкаНДС КАК СтавкаНДС,
	ЦеныНоменклатурыСрезПоследних.Цена,
	0 КАК РекомендуемаяРозничнаяЦена,
	Штрихкоды.Штрихкод КАК GTIN,
	ЦеныНоменклатурыСрезПоследних.ЕдиницаИзмерения.Коэффициент КАК КоличествоВОдномМесте,
	ЦеныНоменклатурыСрезПоследних.Номенклатура.СтранаПроисхождения КАК Страна,
	NULL КАК КвантПоставки,
	NULL КАК ЕдИзмСрокаГодности,
	NULL КАК СрокГодности,
	ЕСТЬNULL(ТоварыНаСкладахОстатки.КоличествоОстаток, 0) КАК КоличествоОстаткаНаКонец
ИЗ
	РегистрСведений.ЦеныНоменклатуры.СрезПоследних(
			,
			ТипЦен = &amp;ТипЦен
				И НЕ Номенклатура.ПометкаУдаления
				И ХарактеристикаНоменклатуры = ЗНАЧЕНИЕ(Справочник.ХарактеристикиНоменклатуры.ПустаяСсылка)
				И НЕ Номенклатура.Услуга
				И &amp;УсловиеОтбораНоменклатуры) КАК ЦеныНоменклатурыСрезПоследних
		ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.Штрихкоды КАК Штрихкоды
		ПО ЦеныНоменклатурыСрезПоследних.Номенклатура = Штрихкоды.Владелец
			И (Штрихкоды.ХарактеристикаНоменклатуры = ЗНАЧЕНИЕ(Справочник.ХарактеристикиНоменклатуры.ПустаяСсылка))
			И (Штрихкоды.ЕдиницаИзмерения = ЦеныНоменклатурыСрезПоследних.ЕдиницаИзмерения)
		ЛЕВОЕ СОЕДИНЕНИЕ РегистрНакопления.ТоварыНаСкладах.Остатки(
				,
				ВЫБОР
					КОГДА &amp;Склад = НЕОПРЕДЕЛЕНО
						ТОГДА ИСТИНА
					ИНАЧЕ Склад В (&amp;Склад)
				КОНЕЦ) КАК ТоварыНаСкладахОстатки
		ПО ЦеныНоменклатурыСрезПоследних.Номенклатура = ТоварыНаСкладахОстатки.Номенклатура
ГДЕ
	ЦеныНоменклатурыСрезПоследних.Цена &gt; 0</query>
					</item>
				</item>
			</item>
			<item xsi:type="DataSetUnion">
				<name>ЗапросПоCOINVOIC</name>
				<item xsi:type="DataSetQuery">
					<name>Заказ_Реализация_СФ</name>
					<dataSource>ИсточникДанных1</dataSource>
					<query>ВЫБРАТЬ РАЗРЕШЕННЫЕ
	докКорректировка.Ссылка КАК Корректировка,
	ВЫБОР
		КОГДА НЕ докКорректировка.Проведен
			ТОГДА докКорректировка.Ссылка
		ИНАЧЕ ЕСТЬNULL(докСчетФактура.Ссылка, докКорректировка.Ссылка)
	КОНЕЦ КАК Документ,
	ВЫБОР
		КОГДА НЕ докКорректировка.Проведен
			ТОГДА "Провести Корректировка реализации"
		КОГДА докСчетФактура.Ссылка ЕСТЬ NULL 
			ТОГДА "Создать Счет-фактура по корректировке"
		КОГДА НЕ докСчетФактура.Ссылка.Проведен И &amp;ТребуетсяПроведениеCOINVOIC
			ТОГДА "Провести Счет-фактура по корректировке"
		КОГДА докСчетФактура.Ссылка.ВидСчетаФактуры &lt;&gt; ЗНАЧЕНИЕ(Перечисление.ВидСчетаФактурыВыставленного.Корректировочный)
			ТОГДА "Отправить счет-фактуру"
		ИНАЧЕ "Отправить корректировочный счет-фактуру"
	КОНЕЦ КАК ТребуемоеДействие,
	ВЫБОР
		КОГДА докСчетФактура.Ссылка.ВидСчетаФактуры &lt;&gt; ЗНАЧЕНИЕ(Перечисление.ВидСчетаФактурыВыставленного.Корректировочный)
			ТОГДА "INVOIC"
		ИНАЧЕ "COINVOIC"
	КОНЕЦ КАК ТипСообщения,
	докКорректировка.ДокументРеализации,
	ТаблицаКэшПартнеровКонтрагентов.Партнер
ПОМЕСТИТЬ табКорректировки
ИЗ
	ТаблицаКэшПартнеровКонтрагентов КАК ТаблицаКэшПартнеровКонтрагентов
		ВНУТРЕННЕЕ СОЕДИНЕНИЕ Документ.КорректировкаРеализации КАК докКорректировка
			ЛЕВОЕ СОЕДИНЕНИЕ Документ.СчетФактураВыданный.ДокументыОснования КАК докСчетФактура
				ЛЕВОЕ СОЕДИНЕНИЕ Справочник.КонтурEDI_Сообщения КАК КонтурEDI_Сообщения
				ПО (КонтурEDI_Сообщения.Документ = докСчетФактура.Ссылка)
					И (КонтурEDI_Сообщения.ТипСообщения = "COINVOIC"
						ИЛИ КонтурEDI_Сообщения.ТипСообщения = "INVOIC")
			ПО докКорректировка.Ссылка = докСчетФактура.ДокументОснование
				И (докСчетФактура.Ссылка.ПометкаУдаления = ЛОЖЬ)
		ПО ТаблицаКэшПартнеровКонтрагентов.Контрагент = докКорректировка.Контрагент
			И (ТаблицаКэшПартнеровКонтрагентов.COINVOIC = ИСТИНА)
ГДЕ
	НЕ докКорректировка.ПометкаУдаления
	И докКорректировка.Дата МЕЖДУ &amp;НачалоПериода И &amp;КонецПериода
	И (докКорректировка.ДокументРеализации ССЫЛКА Документ.РеализацияТоваровУслуг
			ИЛИ докКорректировка.ДокументРеализации ССЫЛКА Документ.КорректировкаРеализации)
	И ВЫБОР
			КОГДА &amp;ТолькоТребуемые
				ТОГДА КонтурEDI_Сообщения.Ссылка ЕСТЬ NULL 
			ИНАЧЕ ИСТИНА
		КОНЕЦ
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ РАЗРЕШЕННЫЕ
	табКорректировки.Корректировка,
	ЕСТЬNULL(СчетФактураВыданныйДокументыОснования.Ссылка, табКорректировки.ДокументРеализации) КАК ПредыдущийДокумент
ПОМЕСТИТЬ табПредыдущихДокументов
ИЗ
	табКорректировки КАК табКорректировки
		ВНУТРЕННЕЕ СОЕДИНЕНИЕ Документ.СчетФактураВыданный.ДокументыОснования КАК СчетФактураВыданныйДокументыОснования
		ПО табКорректировки.ДокументРеализации = СчетФактураВыданныйДокументыОснования.ДокументОснование
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ РАЗРЕШЕННЫЕ
	КонтурEDI_Сообщения.Ссылка КАК Сообщение,
	табПредыдущихДокументов.Корректировка,
	табПредыдущихДокументов.ПредыдущийДокумент
ПОМЕСТИТЬ табРазрешенийНаОтправку
ИЗ
	табПредыдущихДокументов КАК табПредыдущихДокументов
		ЛЕВОЕ СОЕДИНЕНИЕ Справочник.КонтурEDI_Сообщения КАК КонтурEDI_Сообщения
		ПО табПредыдущихДокументов.ПредыдущийДокумент = КонтурEDI_Сообщения.Документ
			И (НЕ КонтурEDI_Сообщения.Статус В (&amp;БлокирующиеСтатусыПервичногоINVOIC))
			И (КонтурEDI_Сообщения.ТипСообщения = "COINVOIC"
				ИЛИ КонтурEDI_Сообщения.ТипСообщения = "INVOIC")
ГДЕ
	ВЫБОР
			КОГДА &amp;ТолькоТребуемые
				ТОГДА КонтурEDI_Сообщения.Ссылка ЕСТЬ НЕ NULL 
			ИНАЧЕ ИСТИНА
		КОНЕЦ
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ РАЗРЕШЕННЫЕ
	табКорректировки.Корректировка,
	табКорректировки.Документ,
	табКорректировки.ТребуемоеДействие,
	табКорректировки.ТипСообщения,
	табРазрешенийНаОтправку.Сообщение,
	табКорректировки.Партнер,
	табРазрешенийНаОтправку.ПредыдущийДокумент
ПОМЕСТИТЬ ВТ_КоррИспрСФ
ИЗ
	табКорректировки КАК табКорректировки
		ЛЕВОЕ СОЕДИНЕНИЕ табРазрешенийНаОтправку КАК табРазрешенийНаОтправку
		ПО табКорректировки.Корректировка = табРазрешенийНаОтправку.Корректировка
ГДЕ
	ВЫБОР
			КОГДА &amp;ТолькоТребуемые
				ТОГДА табРазрешенийНаОтправку.Корректировка ЕСТЬ НЕ NULL 
			ИНАЧЕ ИСТИНА
		КОНЕЦ
;

////////////////////////////////////////////////////////////////////////////////
УНИЧТОЖИТЬ табКорректировки
;

////////////////////////////////////////////////////////////////////////////////
УНИЧТОЖИТЬ табПредыдущихДокументов
;

////////////////////////////////////////////////////////////////////////////////
УНИЧТОЖИТЬ табРазрешенийНаОтправку</query>
				</item>
				<item xsi:type="DataSetQuery">
					<name>Реализация_СФ</name>
					<dataSource>ИсточникДанных1</dataSource>
					<query>ВЫБРАТЬ РАЗРЕШЕННЫЕ
	докКорректировка.Ссылка КАК Корректировка,
	ВЫБОР
		КОГДА НЕ докКорректировка.Проведен
			ТОГДА докКорректировка.Ссылка
		ИНАЧЕ ЕСТЬNULL(докСчетФактура.Ссылка, докКорректировка.Ссылка)
	КОНЕЦ КАК Документ,
	ВЫБОР
		КОГДА НЕ докКорректировка.Проведен
			ТОГДА "Провести Корректировка реализации"
		КОГДА докСчетФактура.Ссылка ЕСТЬ NULL 
			ТОГДА "Создать Счет-фактура по корректировке"
		КОГДА НЕ докСчетФактура.Ссылка.Проведен И &amp;ТребуетсяПроведениеCOINVOIC
			ТОГДА "Провести Счет-фактура по корректировке" 
		КОГДА докСчетФактура.Ссылка.ВидСчетаФактуры &lt;&gt; ЗНАЧЕНИЕ(Перечисление.ВидСчетаФактурыВыставленного.Корректировочный)
			ТОГДА "Отправить счет-фактуру"
		ИНАЧЕ "Отправить корректировочный счет-фактуру"
	КОНЕЦ КАК ТребуемоеДействие,
	ВЫБОР
		КОГДА докСчетФактура.Ссылка.ВидСчетаФактуры &lt;&gt; ЗНАЧЕНИЕ(Перечисление.ВидСчетаФактурыВыставленного.Корректировочный)
			ТОГДА "INVOIC"
		ИНАЧЕ "COINVOIC"
	КОНЕЦ КАК ТипСообщения,
	докКорректировка.ДокументРеализации,
	ТаблицаКэшПартнеровКонтрагентов.Партнер
ПОМЕСТИТЬ табКорректировки
ИЗ
	ТаблицаКэшПартнеровКонтрагентов КАК ТаблицаКэшПартнеровКонтрагентов
		ВНУТРЕННЕЕ СОЕДИНЕНИЕ Документ.КорректировкаРеализации КАК докКорректировка
			ЛЕВОЕ СОЕДИНЕНИЕ Документ.СчетФактураВыданный.ДокументыОснования КАК докСчетФактура
				ЛЕВОЕ СОЕДИНЕНИЕ Справочник.КонтурEDI_Сообщения КАК КонтурEDI_Сообщения
				ПО (КонтурEDI_Сообщения.Документ = докСчетФактура.Ссылка)
					И (КонтурEDI_Сообщения.ТипСообщения = "COINVOIC"
						ИЛИ КонтурEDI_Сообщения.ТипСообщения = "INVOIC")
			ПО докКорректировка.Ссылка = докСчетФактура.ДокументОснование
				И (докСчетФактура.Ссылка.ПометкаУдаления = ЛОЖЬ)
		ПО ТаблицаКэшПартнеровКонтрагентов.Контрагент = докКорректировка.Контрагент
			И (ТаблицаКэшПартнеровКонтрагентов.COINVOIC = ИСТИНА)
ГДЕ
	НЕ докКорректировка.ПометкаУдаления
	И докКорректировка.Дата МЕЖДУ &amp;НачалоПериода И &amp;КонецПериода
	И (докКорректировка.ДокументРеализации ССЫЛКА Документ.РеализацияТоваровУслуг
			ИЛИ докКорректировка.ДокументРеализации ССЫЛКА Документ.КорректировкаРеализации)
	И ВЫБОР
			КОГДА &amp;ТолькоТребуемые
				ТОГДА КонтурEDI_Сообщения.Ссылка ЕСТЬ NULL 
			ИНАЧЕ ИСТИНА
		КОНЕЦ
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ РАЗРЕШЕННЫЕ
	табКорректировки.Корректировка,
	ЕСТЬNULL(СчетФактураВыданныйДокументыОснования.Ссылка, табКорректировки.ДокументРеализации) КАК ПредыдущийДокумент
ПОМЕСТИТЬ табПредыдущихДокументов
ИЗ
	табКорректировки КАК табКорректировки
		ВНУТРЕННЕЕ СОЕДИНЕНИЕ Документ.СчетФактураВыданный.ДокументыОснования КАК СчетФактураВыданныйДокументыОснования
		ПО табКорректировки.ДокументРеализации = СчетФактураВыданныйДокументыОснования.ДокументОснование
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ РАЗРЕШЕННЫЕ
	КонтурEDI_Сообщения.Ссылка КАК Сообщение,
	табПредыдущихДокументов.Корректировка,
	табПредыдущихДокументов.ПредыдущийДокумент
ПОМЕСТИТЬ табРазрешенийНаОтправку
ИЗ
	табПредыдущихДокументов КАК табПредыдущихДокументов
		ЛЕВОЕ СОЕДИНЕНИЕ Справочник.КонтурEDI_Сообщения КАК КонтурEDI_Сообщения
		ПО табПредыдущихДокументов.ПредыдущийДокумент = КонтурEDI_Сообщения.Документ
			И (НЕ КонтурEDI_Сообщения.Статус В (&amp;БлокирующиеСтатусыПервичногоINVOIC))
			И (КонтурEDI_Сообщения.ТипСообщения = "COINVOIC"
				ИЛИ КонтурEDI_Сообщения.ТипСообщения = "INVOIC")
ГДЕ
	ВЫБОР
			КОГДА &amp;ТолькоТребуемые
				ТОГДА КонтурEDI_Сообщения.Ссылка ЕСТЬ НЕ NULL 
			ИНАЧЕ ИСТИНА
		КОНЕЦ
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ РАЗРЕШЕННЫЕ
	табКорректировки.Корректировка,
	табКорректировки.Документ,
	табКорректировки.ТребуемоеДействие,
	табКорректировки.ТипСообщения,
	табРазрешенийНаОтправку.Сообщение,
	табКорректировки.Партнер,
	табРазрешенийНаОтправку.ПредыдущийДокумент
ПОМЕСТИТЬ ВТ_КоррИспрСФ
ИЗ
	табКорректировки КАК табКорректировки
		ЛЕВОЕ СОЕДИНЕНИЕ табРазрешенийНаОтправку КАК табРазрешенийНаОтправку
		ПО табКорректировки.Корректировка = табРазрешенийНаОтправку.Корректировка
ГДЕ
	ВЫБОР
			КОГДА &amp;ТолькоТребуемые
				ТОГДА табРазрешенийНаОтправку.Корректировка ЕСТЬ НЕ NULL 
			ИНАЧЕ ИСТИНА
		КОНЕЦ
;

////////////////////////////////////////////////////////////////////////////////
УНИЧТОЖИТЬ табКорректировки
;

////////////////////////////////////////////////////////////////////////////////
УНИЧТОЖИТЬ табПредыдущихДокументов
;

////////////////////////////////////////////////////////////////////////////////
УНИЧТОЖИТЬ табРазрешенийНаОтправку</query>
				</item>
				<item xsi:type="DataSetQuery">
					<name>Заказ_Реализация</name>
					<dataSource>ИсточникДанных1</dataSource>
					<query>ВЫБРАТЬ РАЗРЕШЕННЫЕ
	докКорректировка.Ссылка КАК Корректировка,
	ВЫБОР
		КОГДА НЕ докКорректировка.Проведен
			ТОГДА докКорректировка.Ссылка
		КОГДА докКорректировка.ВидОперации &lt;&gt; ЗНАЧЕНИЕ(Перечисление.ВидыОперацийИсправленияПоступленияРеализации.СогласованноеИзменение)
			ТОГДА ЕСТЬNULL(докСчетФактура.Ссылка, докКорректировка.Ссылка)
		ИНАЧЕ докКорректировка.Ссылка
	КОНЕЦ КАК Документ,
	ВЫБОР
		КОГДА НЕ докКорректировка.Проведен
			ТОГДА "Провести Корректировка реализации"
		КОГДА докКорректировка.ВидОперации &lt;&gt; ЗНАЧЕНИЕ(Перечисление.ВидыОперацийИсправленияПоступленияРеализации.СогласованноеИзменение)
			ТОГДА ВЫБОР
					КОГДА докСчетФактура.Ссылка ЕСТЬ NULL 
						ТОГДА "Создать Счет-фактура по корректировке"
					КОГДА НЕ докСчетФактура.Ссылка.Проведен И &amp;ТребуетсяПроведениеCOINVOIC
						ТОГДА "Провести Счет-фактура по корректировке"
					ИНАЧЕ "Отправить счет-фактуру"
				КОНЕЦ
		ИНАЧЕ "Отправить корректировочный счет-фактуру"
	КОНЕЦ КАК ТребуемоеДействие,
	ВЫБОР
		КОГДА докКорректировка.ВидОперации = ЗНАЧЕНИЕ(Перечисление.ВидыОперацийИсправленияПоступленияРеализации.СогласованноеИзменение)
			ТОГДА "COINVOIC"
		КОГДА докСчетФактура.Ссылка.ВидСчетаФактуры &lt;&gt; ЗНАЧЕНИЕ(Перечисление.ВидСчетаФактурыВыставленного.Корректировочный)
			ТОГДА "INVOIC"
		ИНАЧЕ "COINVOIC"
	КОНЕЦ КАК ТипСообщения,
	докКорректировка.ДокументРеализации,
	ТаблицаКэшПартнеровКонтрагентов.Партнер
ПОМЕСТИТЬ табКорректировки
ИЗ
	ТаблицаКэшПартнеровКонтрагентов КАК ТаблицаКэшПартнеровКонтрагентов
		ВНУТРЕННЕЕ СОЕДИНЕНИЕ Документ.КорректировкаРеализации КАК докКорректировка
			ЛЕВОЕ СОЕДИНЕНИЕ Документ.СчетФактураВыданный.ДокументыОснования КАК докСчетФактура
			ПО докКорректировка.Ссылка = докСчетФактура.ДокументОснование
				И (докСчетФактура.Ссылка.ПометкаУдаления = ЛОЖЬ)
		ПО ТаблицаКэшПартнеровКонтрагентов.Контрагент = докКорректировка.Контрагент
			И (ТаблицаКэшПартнеровКонтрагентов.COINVOIC = ИСТИНА)
ГДЕ
	НЕ докКорректировка.ПометкаУдаления
	И докКорректировка.Дата МЕЖДУ &amp;НачалоПериода И &amp;КонецПериода
	И (докКорректировка.ДокументРеализации ССЫЛКА Документ.РеализацияТоваровУслуг
			ИЛИ докКорректировка.ДокументРеализации ССЫЛКА Документ.КорректировкаРеализации)
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ РАЗРЕШЕННЫЕ
	табКорректировки.Корректировка,
	табКорректировки.Документ,
	табКорректировки.ТребуемоеДействие,
	табКорректировки.ТипСообщения,
	табКорректировки.ДокументРеализации,
	табКорректировки.Партнер
ПОМЕСТИТЬ табКорректировкиИСообщения
ИЗ
	табКорректировки КАК табКорректировки
		ЛЕВОЕ СОЕДИНЕНИЕ Справочник.КонтурEDI_Сообщения КАК КонтурEDI_Сообщения
		ПО табКорректировки.Документ = КонтурEDI_Сообщения.Документ
			И (КонтурEDI_Сообщения.ТипСообщения = "COINVOIC"
				ИЛИ КонтурEDI_Сообщения.ТипСообщения = "INVOIC")
ГДЕ
	ВЫБОР
			КОГДА &amp;ТолькоТребуемые
				ТОГДА КонтурEDI_Сообщения.Ссылка ЕСТЬ NULL 
			ИНАЧЕ ИСТИНА
		КОНЕЦ
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ РАЗРЕШЕННЫЕ
	табКорректировкиИСообщения.Корректировка,
	ЕСТЬNULL(СчетФактураВыданныйДокументыОснования.Ссылка, табКорректировкиИСообщения.ДокументРеализации) КАК ПредыдущийДокумент
ПОМЕСТИТЬ табПредыдущихДокументов
ИЗ
	табКорректировкиИСообщения КАК табКорректировкиИСообщения
		ЛЕВОЕ СОЕДИНЕНИЕ Документ.СчетФактураВыданный.ДокументыОснования КАК СчетФактураВыданныйДокументыОснования
		ПО табКорректировкиИСообщения.ДокументРеализации = СчетФактураВыданныйДокументыОснования.ДокументОснование
			И (НЕ табКорректировкиИСообщения.ДокументРеализации ССЫЛКА Документ.РеализацияТоваровУслуг)
			И (НЕ табКорректировкиИСообщения.ДокументРеализации.ВидОперации = ЗНАЧЕНИЕ(Перечисление.ВидыОперацийИсправленияПоступленияРеализации.СогласованноеИзменение))
ГДЕ
	(табКорректировкиИСообщения.ДокументРеализации ССЫЛКА Документ.РеализацияТоваровУслуг
			ИЛИ табКорректировкиИСообщения.ДокументРеализации.ВидОперации = ЗНАЧЕНИЕ(Перечисление.ВидыОперацийИсправленияПоступленияРеализации.СогласованноеИзменение)
			ИЛИ СчетФактураВыданныйДокументыОснования.Ссылка ЕСТЬ НЕ NULL )
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ РАЗРЕШЕННЫЕ
	КонтурEDI_Сообщения.Ссылка КАК Сообщение,
	табПредыдущихДокументов.Корректировка,
	табПредыдущихДокументов.ПредыдущийДокумент
ПОМЕСТИТЬ табРазрешенийНаОтправку
ИЗ
	табПредыдущихДокументов КАК табПредыдущихДокументов
		ЛЕВОЕ СОЕДИНЕНИЕ Справочник.КонтурEDI_Сообщения КАК КонтурEDI_Сообщения
		ПО табПредыдущихДокументов.ПредыдущийДокумент = КонтурEDI_Сообщения.Документ
			И (НЕ КонтурEDI_Сообщения.Статус В (&amp;БлокирующиеСтатусыПервичногоINVOIC))
			И (КонтурEDI_Сообщения.ТипСообщения = "COINVOIC"
				ИЛИ КонтурEDI_Сообщения.ТипСообщения = "INVOIC")
ГДЕ
	ВЫБОР
			КОГДА &amp;ТолькоТребуемые
				ТОГДА КонтурEDI_Сообщения.Ссылка ЕСТЬ НЕ NULL 
			ИНАЧЕ ИСТИНА
		КОНЕЦ
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ РАЗРЕШЕННЫЕ
	табКорректировкиИСообщения.Корректировка,
	табКорректировкиИСообщения.Документ,
	табКорректировкиИСообщения.ТребуемоеДействие,
	табКорректировкиИСообщения.ТипСообщения,
	табРазрешенийНаОтправку.Сообщение,
	табКорректировкиИСообщения.Партнер,
	табРазрешенийНаОтправку.ПредыдущийДокумент
ПОМЕСТИТЬ ВТ_КоррИспрСФ
ИЗ
	табКорректировкиИСообщения КАК табКорректировкиИСообщения
		ЛЕВОЕ СОЕДИНЕНИЕ табРазрешенийНаОтправку КАК табРазрешенийНаОтправку
		ПО табКорректировкиИСообщения.Корректировка = табРазрешенийНаОтправку.Корректировка
ГДЕ
	ВЫБОР
			КОГДА &amp;ТолькоТребуемые
				ТОГДА табРазрешенийНаОтправку.Корректировка ЕСТЬ НЕ NULL 
			ИНАЧЕ ИСТИНА
		КОНЕЦ
;

////////////////////////////////////////////////////////////////////////////////
УНИЧТОЖИТЬ табКорректировки
;

////////////////////////////////////////////////////////////////////////////////
УНИЧТОЖИТЬ табПредыдущихДокументов
;

////////////////////////////////////////////////////////////////////////////////
УНИЧТОЖИТЬ табРазрешенийНаОтправку
;

////////////////////////////////////////////////////////////////////////////////
УНИЧТОЖИТЬ табКорректировкиИСообщения</query>
				</item>
				<item xsi:type="DataSetQuery">
					<name>Реализация</name>
					<dataSource>ИсточникДанных1</dataSource>
					<query>ВЫБРАТЬ РАЗРЕШЕННЫЕ
	докКорректировка.Ссылка КАК Корректировка,
	ВЫБОР
		КОГДА НЕ докКорректировка.Проведен
			ТОГДА докКорректировка.Ссылка
		КОГДА докКорректировка.ВидОперации &lt;&gt; ЗНАЧЕНИЕ(Перечисление.ВидыОперацийИсправленияПоступленияРеализации.СогласованноеИзменение)
			ТОГДА ЕСТЬNULL(докСчетФактура.Ссылка, докКорректировка.Ссылка)
		ИНАЧЕ докКорректировка.Ссылка
	КОНЕЦ КАК Документ,
	ВЫБОР
		КОГДА НЕ докКорректировка.Проведен
			ТОГДА "Провести Корректировка реализации"
		КОГДА докКорректировка.ВидОперации &lt;&gt; ЗНАЧЕНИЕ(Перечисление.ВидыОперацийИсправленияПоступленияРеализации.СогласованноеИзменение)
			ТОГДА ВЫБОР
					КОГДА докСчетФактура.Ссылка ЕСТЬ NULL 
						ТОГДА "Создать Счет-фактура по корректировке"
					КОГДА НЕ докСчетФактура.Ссылка.Проведен И &amp;ТребуетсяПроведениеCOINVOIC
						ТОГДА "Провести Счет-фактура по корректировке"
					ИНАЧЕ "Отправить счет-фактуру"
				КОНЕЦ
		ИНАЧЕ "Отправить корректировочный счет-фактуру"
	КОНЕЦ КАК ТребуемоеДействие,
	ВЫБОР
		КОГДА докКорректировка.ВидОперации = ЗНАЧЕНИЕ(Перечисление.ВидыОперацийИсправленияПоступленияРеализации.СогласованноеИзменение)
			ТОГДА "COINVOIC"
		КОГДА докСчетФактура.Ссылка.ВидСчетаФактуры &lt;&gt; ЗНАЧЕНИЕ(Перечисление.ВидСчетаФактурыВыставленного.Корректировочный)
			ТОГДА "INVOIC"
		ИНАЧЕ "COINVOIC"
	КОНЕЦ КАК ТипСообщения,
	докКорректировка.ДокументРеализации,
	ТаблицаКэшПартнеровКонтрагентов.Партнер
ПОМЕСТИТЬ табКорректировки
ИЗ
	ТаблицаКэшПартнеровКонтрагентов КАК ТаблицаКэшПартнеровКонтрагентов
		ВНУТРЕННЕЕ СОЕДИНЕНИЕ Документ.КорректировкаРеализации КАК докКорректировка
			ЛЕВОЕ СОЕДИНЕНИЕ Документ.СчетФактураВыданный.ДокументыОснования КАК докСчетФактура
			ПО докКорректировка.Ссылка = докСчетФактура.ДокументОснование
				И (докСчетФактура.Ссылка.ПометкаУдаления = ЛОЖЬ)
		ПО ТаблицаКэшПартнеровКонтрагентов.Контрагент = докКорректировка.Контрагент
			И (ТаблицаКэшПартнеровКонтрагентов.COINVOIC = ИСТИНА)
ГДЕ
	НЕ докКорректировка.ПометкаУдаления
	И докКорректировка.Дата МЕЖДУ &amp;НачалоПериода И &amp;КонецПериода
	И (докКорректировка.ДокументРеализации ССЫЛКА Документ.РеализацияТоваровУслуг
			ИЛИ докКорректировка.ДокументРеализации ССЫЛКА Документ.КорректировкаРеализации)
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ РАЗРЕШЕННЫЕ
	табКорректировки.Корректировка,
	табКорректировки.Документ,
	табКорректировки.ТребуемоеДействие,
	табКорректировки.ТипСообщения,
	табКорректировки.ДокументРеализации,
	табКорректировки.Партнер
ПОМЕСТИТЬ табКорректировкиИСообщения
ИЗ
	табКорректировки КАК табКорректировки
		ЛЕВОЕ СОЕДИНЕНИЕ Справочник.КонтурEDI_Сообщения КАК КонтурEDI_Сообщения
		ПО табКорректировки.Документ = КонтурEDI_Сообщения.Документ
			И (КонтурEDI_Сообщения.ТипСообщения = "COINVOIC"
				ИЛИ КонтурEDI_Сообщения.ТипСообщения = "INVOIC")
ГДЕ
	ВЫБОР
			КОГДА &amp;ТолькоТребуемые
				ТОГДА КонтурEDI_Сообщения.Ссылка ЕСТЬ NULL 
			ИНАЧЕ ИСТИНА
		КОНЕЦ
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ РАЗРЕШЕННЫЕ
	табКорректировкиИСообщения.Корректировка,
	ЕСТЬNULL(СчетФактураВыданныйДокументыОснования.Ссылка, табКорректировкиИСообщения.ДокументРеализации) КАК ПредыдущийДокумент
ПОМЕСТИТЬ табПредыдущихДокументов
ИЗ
	табКорректировкиИСообщения КАК табКорректировкиИСообщения
		ЛЕВОЕ СОЕДИНЕНИЕ Документ.СчетФактураВыданный.ДокументыОснования КАК СчетФактураВыданныйДокументыОснования
		ПО табКорректировкиИСообщения.ДокументРеализации = СчетФактураВыданныйДокументыОснования.ДокументОснование
			И (НЕ табКорректировкиИСообщения.ДокументРеализации ССЫЛКА Документ.РеализацияТоваровУслуг)
			И (НЕ табКорректировкиИСообщения.ДокументРеализации.ВидОперации = ЗНАЧЕНИЕ(Перечисление.ВидыОперацийИсправленияПоступленияРеализации.СогласованноеИзменение))
ГДЕ
	(табКорректировкиИСообщения.ДокументРеализации ССЫЛКА Документ.РеализацияТоваровУслуг
			ИЛИ табКорректировкиИСообщения.ДокументРеализации.ВидОперации = ЗНАЧЕНИЕ(Перечисление.ВидыОперацийИсправленияПоступленияРеализации.СогласованноеИзменение)
			ИЛИ СчетФактураВыданныйДокументыОснования.Ссылка ЕСТЬ НЕ NULL )
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ РАЗРЕШЕННЫЕ
	КонтурEDI_Сообщения.Ссылка КАК Сообщение,
	табПредыдущихДокументов.Корректировка,
	табПредыдущихДокументов.ПредыдущийДокумент
ПОМЕСТИТЬ табРазрешенийНаОтправку
ИЗ
	табПредыдущихДокументов КАК табПредыдущихДокументов
		ЛЕВОЕ СОЕДИНЕНИЕ Справочник.КонтурEDI_Сообщения КАК КонтурEDI_Сообщения
		ПО табПредыдущихДокументов.ПредыдущийДокумент = КонтурEDI_Сообщения.Документ
			И (НЕ КонтурEDI_Сообщения.Статус В (&amp;БлокирующиеСтатусыПервичногоINVOIC))
			И (КонтурEDI_Сообщения.ТипСообщения = "COINVOIC"
				ИЛИ КонтурEDI_Сообщения.ТипСообщения = "INVOIC")
ГДЕ
	ВЫБОР
			КОГДА &amp;ТолькоТребуемые
				ТОГДА КонтурEDI_Сообщения.Ссылка ЕСТЬ НЕ NULL 
			ИНАЧЕ ИСТИНА
		КОНЕЦ
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ РАЗРЕШЕННЫЕ
	табКорректировкиИСообщения.Корректировка,
	табКорректировкиИСообщения.Документ,
	табКорректировкиИСообщения.ТребуемоеДействие,
	табКорректировкиИСообщения.ТипСообщения,
	табРазрешенийНаОтправку.Сообщение,
	табКорректировкиИСообщения.Партнер,
	табРазрешенийНаОтправку.ПредыдущийДокумент
ПОМЕСТИТЬ ВТ_КоррИспрСФ
ИЗ
	табКорректировкиИСообщения КАК табКорректировкиИСообщения
		ЛЕВОЕ СОЕДИНЕНИЕ табРазрешенийНаОтправку КАК табРазрешенийНаОтправку
		ПО табКорректировкиИСообщения.Корректировка = табРазрешенийНаОтправку.Корректировка
ГДЕ
	ВЫБОР
			КОГДА &amp;ТолькоТребуемые
				ТОГДА табРазрешенийНаОтправку.Корректировка ЕСТЬ НЕ NULL 
			ИНАЧЕ ИСТИНА
		КОНЕЦ
;

////////////////////////////////////////////////////////////////////////////////
УНИЧТОЖИТЬ табКорректировки
;

////////////////////////////////////////////////////////////////////////////////
УНИЧТОЖИТЬ табПредыдущихДокументов
;

////////////////////////////////////////////////////////////////////////////////
УНИЧТОЖИТЬ табРазрешенийНаОтправку
;

////////////////////////////////////////////////////////////////////////////////
УНИЧТОЖИТЬ табКорректировкиИСообщения</query>
				</item>
			</item>
		</item>
		<item xsi:type="DataSetUnion">
			<name>Покупатель</name>
			<field xsi:type="DataSetFieldField">
				<dataPath>Номенклатура</dataPath>
				<field>Номенклатура</field>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>ЕдиницаИзмерения</dataPath>
				<field>ЕдиницаИзмерения</field>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>Наименование</dataPath>
				<field>Наименование</field>
				<title xsi:type="v8:LocalStringType">
					<v8:item>
						<v8:lang>ru</v8:lang>
						<v8:content>Наименование</v8:content>
					</v8:item>
				</title>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>ХарактеристикаНоменклатуры</dataPath>
				<field>ХарактеристикаНоменклатуры</field>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>Сумма</dataPath>
				<field>Сумма</field>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>ТипЕдиницы</dataPath>
				<field>ТипЕдиницы</field>
				<title xsi:type="v8:LocalStringType">
					<v8:item>
						<v8:lang>ru</v8:lang>
						<v8:content>Тип единицы</v8:content>
					</v8:item>
				</title>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>КодЕдиницыИзмерения</dataPath>
				<field>КодЕдиницыИзмерения</field>
				<title xsi:type="v8:LocalStringType">
					<v8:item>
						<v8:lang>ru</v8:lang>
						<v8:content>Код единицы измерения</v8:content>
					</v8:item>
				</title>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>Количество</dataPath>
				<field>Количество</field>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>Цена</dataPath>
				<field>Цена</field>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>СтавкаНДС</dataPath>
				<field>СтавкаНДС</field>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>СуммаНДС</dataPath>
				<field>СуммаНДС</field>
			</field>
			<item xsi:type="DataSetUnion">
				<name>ЗапросОсновнойЦепочки</name>
				<item xsi:type="DataSetQuery">
					<name>Заказ_Поступление_СФ</name>
					<dataSource>ИсточникДанных1</dataSource>
					<query>ВЫБРАТЬ
	докЗаказПоставщику.Ссылка КАК PORDERS,
	докЗаказПоставщику.Ссылка КАК ORDERS,
	докЗаказПоставщику.Ссылка КАК ORDRSP,
	докПоступлениеТоваровУслуг.Ссылка КАК DESADV,
	докПоступлениеТоваровУслуг.Ссылка КАК RECADV,
	СчетФактураПолученныйДокументыОснования.Ссылка КАК INVOIC
ИЗ
	(ВЫБРАТЬ
		1 КАК Поле1) КАК Заглушка
		{ПОЛНОЕ СОЕДИНЕНИЕ Документ.СчетФактураПолученный.ДокументыОснования КАК СчетФактураПолученныйДокументыОснования
			{ПОЛНОЕ СОЕДИНЕНИЕ Документ.ПоступлениеТоваровУслуг КАК докПоступлениеТоваровУслуг
				{ПОЛНОЕ СОЕДИНЕНИЕ Документ.ЗаказПоставщику КАК докЗаказПоставщику
				ПО (докПоступлениеТоваровУслуг.Сделка = докЗаказПоставщику.Ссылка)}
			ПО (СчетФактураПолученныйДокументыОснования.ДокументОснование = докПоступлениеТоваровУслуг.Ссылка)}
		ПО (ИСТИНА)}</query>
					<autoFillFields>false</autoFillFields>
				</item>
			</item>
			<item xsi:type="DataSetUnion">
				<name>ЗапросПоТоварам</name>
				<field xsi:type="DataSetFieldField">
					<dataPath>Номенклатура</dataPath>
					<field>Номенклатура</field>
				</field>
				<field xsi:type="DataSetFieldField">
					<dataPath>ЕдиницаИзмерения</dataPath>
					<field>ЕдиницаИзмерения</field>
				</field>
				<field xsi:type="DataSetFieldField">
					<dataPath>Наименование</dataPath>
					<field>Наименование</field>
					<title xsi:type="v8:LocalStringType">
						<v8:item>
							<v8:lang>ru</v8:lang>
							<v8:content>Наименование</v8:content>
						</v8:item>
					</title>
				</field>
				<field xsi:type="DataSetFieldField">
					<dataPath>ХарактеристикаНоменклатуры</dataPath>
					<field>ХарактеристикаНоменклатуры</field>
				</field>
				<field xsi:type="DataSetFieldField">
					<dataPath>Сумма</dataPath>
					<field>Сумма</field>
				</field>
				<field xsi:type="DataSetFieldField">
					<dataPath>ТипЕдиницы</dataPath>
					<field>ТипЕдиницы</field>
					<title xsi:type="v8:LocalStringType">
						<v8:item>
							<v8:lang>ru</v8:lang>
							<v8:content>Тип единицы</v8:content>
						</v8:item>
					</title>
				</field>
				<field xsi:type="DataSetFieldField">
					<dataPath>КодЕдиницыИзмерения</dataPath>
					<field>КодЕдиницыИзмерения</field>
					<title xsi:type="v8:LocalStringType">
						<v8:item>
							<v8:lang>ru</v8:lang>
							<v8:content>Код единицы измерения</v8:content>
						</v8:item>
					</title>
				</field>
				<field xsi:type="DataSetFieldField">
					<dataPath>Количество</dataPath>
					<field>Количество</field>
				</field>
				<field xsi:type="DataSetFieldField">
					<dataPath>Цена</dataPath>
					<field>Цена</field>
				</field>
				<field xsi:type="DataSetFieldField">
					<dataPath>СтавкаНДС</dataPath>
					<field>СтавкаНДС</field>
				</field>
				<field xsi:type="DataSetFieldField">
					<dataPath>СуммаНДС</dataPath>
					<field>СуммаНДС</field>
				</field>
				<item xsi:type="DataSetUnion">
					<name>_ORDERS_</name>
					<item xsi:type="DataSetQuery">
						<name>ЗаказПоставщику</name>
						<dataSource>ИсточникДанных1</dataSource>
						<query>ВЫБРАТЬ
	ЗаказПоставщикуТовары.Номенклатура.Код КАК КодТовараПокупателя,
	ЗаказПоставщикуТовары.Номенклатура,
	ЗаказПоставщикуТовары.ХарактеристикаНоменклатуры,
	ЗаказПоставщикуТовары.ЕдиницаИзмерения КАК ЕдиницаИзмерения,
	ЗаказПоставщикуТовары.ЕдиницаИзмерения.ЕдиницаПоКлассификатору.Наименование КАК КодЕдиницыИзмерения,
	ВЫРАЗИТЬ(ЗаказПоставщикуТовары.Номенклатура.Наименование КАК СТРОКА(178)) КАК Наименование,
	ЗаказПоставщикуТовары.Цена,
	ЗаказПоставщикуТовары.СтавкаНДС,
	СУММА(ЗаказПоставщикуТовары.Количество) КАК Количество,
	СУММА(ЗаказПоставщикуТовары.Сумма) КАК Сумма,
	СУММА(ЗаказПоставщикуТовары.СуммаНДС) КАК СуммаНДС,
	ВЫБОР
		КОГДА ЗаказПоставщикуТовары.Номенклатура.ВидНоменклатуры.ТипНоменклатуры = ЗНАЧЕНИЕ(Перечисление.ТипыНоменклатуры.Услуга)
			ТОГДА "Services"
		ИНАЧЕ ""
	КОНЕЦ КАК ТипЕдиницы
ИЗ
	Документ.ЗаказПоставщику.Товары КАК ЗаказПоставщикуТовары
ГДЕ
	ЗаказПоставщикуТовары.Ссылка = &amp;Ссылка

СГРУППИРОВАТЬ ПО
	ЗаказПоставщикуТовары.Номенклатура,
	ЗаказПоставщикуТовары.ХарактеристикаНоменклатуры,
	ЗаказПоставщикуТовары.ЕдиницаИзмерения,
	ЗаказПоставщикуТовары.Цена,
	ВЫРАЗИТЬ(ЗаказПоставщикуТовары.Номенклатура.Наименование КАК СТРОКА(178)),
	ЗаказПоставщикуТовары.СтавкаНДС,
	ЗаказПоставщикуТовары.Номенклатура.Код,
	ЗаказПоставщикуТовары.ЕдиницаИзмерения.ЕдиницаПоКлассификатору.Наименование,
	ВЫБОР
		КОГДА ЗаказПоставщикуТовары.Номенклатура.ВидНоменклатуры.ТипНоменклатуры = ЗНАЧЕНИЕ(Перечисление.ТипыНоменклатуры.Услуга)
			ТОГДА "Services"
		ИНАЧЕ ""
	КОНЕЦ

ОБЪЕДИНИТЬ ВСЕ

ВЫБРАТЬ
	ЗаказПоставщикуУслуги.Номенклатура.Код,
	ЗаказПоставщикуУслуги.Номенклатура,
	НЕОПРЕДЕЛЕНО,
	ЗаказПоставщикуУслуги.Номенклатура.ЕдиницаХраненияОстатков,
	ЗаказПоставщикуУслуги.Номенклатура.ЕдиницаХраненияОстатков.ЕдиницаПоКлассификатору.Код,
	ВЫРАЗИТЬ(ЗаказПоставщикуУслуги.Номенклатура.Наименование КАК СТРОКА(178)),
	ЗаказПоставщикуУслуги.Цена,
	ЗаказПоставщикуУслуги.СтавкаНДС,
	ЗаказПоставщикуУслуги.Количество,
	ЗаказПоставщикуУслуги.Сумма,
	ЗаказПоставщикуУслуги.СуммаНДС,
	"Services"
ИЗ
	Документ.ЗаказПоставщику.Услуги КАК ЗаказПоставщикуУслуги
ГДЕ
	ЗаказПоставщикуУслуги.Ссылка = &amp;Ссылка</query>
						<autoFillFields>false</autoFillFields>
					</item>
				</item>
				<item xsi:type="DataSetUnion">
					<name>_RECADV_</name>
					<item xsi:type="DataSetQuery">
						<name>ПоступлениеТоваровУслуг</name>
						<dataSource>ИсточникДанных1</dataSource>
						<query>ВЫБРАТЬ
	ПоступлениеТоваровУслугТовары.Номенклатура,
	ПоступлениеТоваровУслугТовары.ХарактеристикаНоменклатуры,
	ПоступлениеТоваровУслугТовары.ЕдиницаИзмерения КАК ЕдиницаИзмерения,
	ПоступлениеТоваровУслугТовары.ЕдиницаИзмерения.ЕдиницаПоКлассификатору.Наименование КАК КодЕдиницыИзмерения,
	ВЫРАЗИТЬ(ПоступлениеТоваровУслугТовары.Номенклатура.Наименование КАК СТРОКА(178)) КАК Наименование,
	ПоступлениеТоваровУслугТовары.Количество КАК Количество,
	ПоступлениеТоваровУслугТовары.Цена,
	ПоступлениеТоваровУслугТовары.СтавкаНДС,
	ПоступлениеТоваровУслугТовары.Сумма,
	ПоступлениеТоваровУслугТовары.СуммаНДС,
	ВЫБОР
		КОГДА ПоступлениеТоваровУслугТовары.Номенклатура.ВидНоменклатуры.ТипНоменклатуры = ЗНАЧЕНИЕ(Перечисление.ТипыНоменклатуры.Услуга)
			ТОГДА "Services"
		ИНАЧЕ ""
	КОНЕЦ КАК ТипЕдиницы
ИЗ
	Документ.ПоступлениеТоваровУслуг.Товары КАК ПоступлениеТоваровУслугТовары
ГДЕ
	ПоступлениеТоваровУслугТовары.Ссылка = &amp;Ссылка

ОБЪЕДИНИТЬ ВСЕ

ВЫБРАТЬ
	ПоступлениеТоваровУслугУслуги.Номенклатура,
	НЕОПРЕДЕЛЕНО,
	ПоступлениеТоваровУслугУслуги.Номенклатура.ЕдиницаХраненияОстатков,
	ПоступлениеТоваровУслугУслуги.Номенклатура.ЕдиницаХраненияОстатков.ЕдиницаПоКлассификатору.Код,
	ВЫРАЗИТЬ(ПоступлениеТоваровУслугУслуги.Номенклатура.Наименование КАК СТРОКА(178)),
	ПоступлениеТоваровУслугУслуги.Количество,
	ПоступлениеТоваровУслугУслуги.Цена,
	ПоступлениеТоваровУслугУслуги.СтавкаНДС,
	ПоступлениеТоваровУслугУслуги.Сумма,
	ПоступлениеТоваровУслугУслуги.СуммаНДС,
	"Services"
ИЗ
	Документ.ПоступлениеТоваровУслуг.Услуги КАК ПоступлениеТоваровУслугУслуги
ГДЕ
	ПоступлениеТоваровУслугУслуги.Ссылка = &amp;Ссылка</query>
						<autoFillFields>false</autoFillFields>
					</item>
				</item>
				<item xsi:type="DataSetUnion">
					<name>_RETANN_RETDES_</name>
					<field xsi:type="DataSetFieldField">
						<dataPath>Номенклатура</dataPath>
						<field>Номенклатура</field>
					</field>
					<field xsi:type="DataSetFieldField">
						<dataPath>ЕдиницаИзмерения</dataPath>
						<field>ЕдиницаИзмерения</field>
					</field>
					<field xsi:type="DataSetFieldField">
						<dataPath>Наименование</dataPath>
						<field>Наименование</field>
						<title xsi:type="v8:LocalStringType">
							<v8:item>
								<v8:lang>ru</v8:lang>
								<v8:content>Наименование</v8:content>
							</v8:item>
						</title>
					</field>
					<field xsi:type="DataSetFieldField">
						<dataPath>ХарактеристикаНоменклатуры</dataPath>
						<field>ХарактеристикаНоменклатуры</field>
					</field>
					<field xsi:type="DataSetFieldField">
						<dataPath>Сумма</dataPath>
						<field>Сумма</field>
					</field>
					<field xsi:type="DataSetFieldField">
						<dataPath>ТипЕдиницы</dataPath>
						<field>ТипЕдиницы</field>
						<title xsi:type="v8:LocalStringType">
							<v8:item>
								<v8:lang>ru</v8:lang>
								<v8:content>Тип единицы</v8:content>
							</v8:item>
						</title>
					</field>
					<field xsi:type="DataSetFieldField">
						<dataPath>КодЕдиницыИзмерения</dataPath>
						<field>КодЕдиницыИзмерения</field>
						<title xsi:type="v8:LocalStringType">
							<v8:item>
								<v8:lang>ru</v8:lang>
								<v8:content>Код единицы измерения</v8:content>
							</v8:item>
						</title>
					</field>
					<field xsi:type="DataSetFieldField">
						<dataPath>Количество</dataPath>
						<field>Количество</field>
					</field>
					<field xsi:type="DataSetFieldField">
						<dataPath>Цена</dataPath>
						<field>Цена</field>
					</field>
					<field xsi:type="DataSetFieldField">
						<dataPath>СтавкаНДС</dataPath>
						<field>СтавкаНДС</field>
					</field>
					<field xsi:type="DataSetFieldField">
						<dataPath>СуммаНДС</dataPath>
						<field>СуммаНДС</field>
					</field>
					<item xsi:type="DataSetQuery">
						<name>ВозвратТоваровПоставщику</name>
						<field xsi:type="DataSetFieldField">
							<dataPath>Номенклатура</dataPath>
							<field>Номенклатура</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>ЕдиницаИзмерения</dataPath>
							<field>ЕдиницаИзмерения</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>Наименование</dataPath>
							<field>Наименование</field>
							<title xsi:type="v8:LocalStringType">
								<v8:item>
									<v8:lang>ru</v8:lang>
									<v8:content>Наименование</v8:content>
								</v8:item>
							</title>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>ХарактеристикаНоменклатуры</dataPath>
							<field>ХарактеристикаНоменклатуры</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>Сумма</dataPath>
							<field>Сумма</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>ТипЕдиницы</dataPath>
							<field>ТипЕдиницы</field>
							<title xsi:type="v8:LocalStringType">
								<v8:item>
									<v8:lang>ru</v8:lang>
									<v8:content>Тип единицы</v8:content>
								</v8:item>
							</title>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>КодЕдиницыИзмерения</dataPath>
							<field>КодЕдиницыИзмерения</field>
							<title xsi:type="v8:LocalStringType">
								<v8:item>
									<v8:lang>ru</v8:lang>
									<v8:content>Код единицы измерения</v8:content>
								</v8:item>
							</title>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>Количество</dataPath>
							<field>Количество</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>Цена</dataPath>
							<field>Цена</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>СтавкаНДС</dataPath>
							<field>СтавкаНДС</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>СуммаНДС</dataPath>
							<field>СуммаНДС</field>
						</field>
						<dataSource>ИсточникДанных1</dataSource>
						<query>ВЫБРАТЬ
	ВозвратТоваровПоставщику.Номенклатура,
	ВозвратТоваровПоставщику.ХарактеристикаНоменклатуры,
	ВозвратТоваровПоставщику.ЕдиницаИзмерения КАК ЕдиницаИзмерения,
	ВозвратТоваровПоставщику.ЕдиницаИзмерения.ЕдиницаПоКлассификатору.Наименование КАК КодЕдиницыИзмерения,
	ВЫРАЗИТЬ(ВозвратТоваровПоставщику.Номенклатура.Наименование КАК СТРОКА(178)) КАК Наименование,
	ВозвратТоваровПоставщику.Количество КАК Количество,
	ВозвратТоваровПоставщику.Цена,
	ВозвратТоваровПоставщику.СтавкаНДС,
	ВозвратТоваровПоставщику.Сумма,
	ВозвратТоваровПоставщику.СуммаНДС,
	ВЫБОР
		КОГДА ВозвратТоваровПоставщику.Номенклатура.ВидНоменклатуры.ТипНоменклатуры = ЗНАЧЕНИЕ(Перечисление.ТипыНоменклатуры.Услуга)
			ТОГДА "Services"
		ИНАЧЕ ""
	КОНЕЦ КАК ТипЕдиницы
ИЗ
	Документ.ВозвратТоваровПоставщику.Товары КАК ВозвратТоваровПоставщику
ГДЕ
	ВозвратТоваровПоставщику.Ссылка = &amp;Ссылка</query>
					</item>
				</item>
			</item>
			<item xsi:type="DataSetQuery">
				<name>КонвертироватьТоварыEDIВ1С</name>
				<dataSource>ИсточникДанных1</dataSource>
				<query>ВЫБРАТЬ
	ТабТоваров.GTIN КАК GTIN,
	ТабТоваров.КодТовараСторонний КАК КодТовараСторонний,
	ТабТоваров.КодТовараСвой КАК КодТовараСвой,
	ТабСоответствий_КонтурEDI.Номенклатура КАК Номенклатура,
	ТабСоответствий_КонтурEDI.ХарактеристикаНоменклатуры КАК ХарактеристикаНоменклатуры,
	ТабСоответствий_КонтурEDI.ЕдиницаИзмерения КАК ЕдиницаИзмерения,
	ТабСоответствий_КонтурEDI.ТипЕдиницы КАК ТипЕдиницы,
	4 КАК Приоритет
ПОМЕСТИТЬ ВТ_НайденныеСоответствия
ИЗ
	ТабТоваров КАК ТабТоваров
		ВНУТРЕННЕЕ СОЕДИНЕНИЕ ТабСоответствий_КонтурEDI КАК ТабСоответствий_КонтурEDI
		ПО ТабТоваров.GTIN = ТабСоответствий_КонтурEDI.GTIN
			И ТабТоваров.КодТовараСторонний = ТабСоответствий_КонтурEDI.КодТовараСторонний
			И ТабТоваров.КодТовараСвой = ТабСоответствий_КонтурEDI.КодТовараСвой

ОБЪЕДИНИТЬ ВСЕ

ВЫБРАТЬ
	ТабТоваров.GTIN,
	ТабТоваров.КодТовараСторонний,
	ТабТоваров.КодТовараСвой,
	Штрихкоды.Владелец,
	Штрихкоды.ХарактеристикаНоменклатуры,
	Штрихкоды.ЕдиницаИзмерения,
	ВЫРАЗИТЬ("" КАК СТРОКА(20)),
	3
ИЗ
	ТабТоваров КАК ТабТоваров
		ВНУТРЕННЕЕ СОЕДИНЕНИЕ РегистрСведений.Штрихкоды КАК Штрихкоды
		ПО (ТабТоваров.GTIN = Штрихкоды.Штрихкод)
			И (Штрихкоды.ТипШтрихкода = ЗНАЧЕНИЕ(ПланВидовХарактеристик.ТипыШтрихкодов.EAN13))
ГДЕ
	НЕ ТабТоваров.GTIN = ""

ОБЪЕДИНИТЬ ВСЕ

ВЫБРАТЬ
	ТабТоваров.GTIN,
	ТабТоваров.КодТовараСторонний,
	ТабТоваров.КодТовараСвой,
	Штрихкоды.Владелец,
	Штрихкоды.ХарактеристикаНоменклатуры,
	Штрихкоды.ЕдиницаИзмерения,
	ВЫРАЗИТЬ("" КАК СТРОКА(20)),
	2
ИЗ
	ТабТоваров КАК ТабТоваров
		ВНУТРЕННЕЕ СОЕДИНЕНИЕ РегистрСведений.Штрихкоды КАК Штрихкоды
		ПО (ПОДСТРОКА(ТабТоваров.GTIN, 2, 13) = Штрихкоды.Штрихкод)
			И (Штрихкоды.ТипШтрихкода = ЗНАЧЕНИЕ(ПланВидовХарактеристик.ТипыШтрихкодов.EAN13))
ГДЕ
	НЕ ТабТоваров.GTIN = ""
	
ОБЪЕДИНИТЬ ВСЕ

ВЫБРАТЬ
	ТабТоваров.GTIN,
	ТабТоваров.КодТовараСторонний,
	ТабТоваров.КодТовараСвой,
	СправочникНоменклатура.Ссылка,
	НЕОПРЕДЕЛЕНО,
	СправочникНоменклатура.ЕдиницаХраненияОстатков,
	ВЫРАЗИТЬ(ВЫБОР
			КОГДА СправочникНоменклатура.ВидНоменклатуры.ТипНоменклатуры = ЗНАЧЕНИЕ(Перечисление.ТипыНоменклатуры.Услуга)
				ТОГДА "Services"
			ИНАЧЕ ""
		КОНЕЦ КАК СТРОКА(20)),
	1
ИЗ
	ТабТоваров КАК ТабТоваров
		ВНУТРЕННЕЕ СОЕДИНЕНИЕ Справочник.Номенклатура КАК СправочникНоменклатура
		ПО ТабТоваров.КодТовараСвой = СправочникНоменклатура.Код
ГДЕ
	НЕ ТабТоваров.КодТовараСвой = ""
</query>
				<autoFillFields>false</autoFillFields>
			</item>
			<item xsi:type="DataSetQuery">
				<name>КонвертироватьТовары1СВEDIВ_GTIN</name>
				<dataSource>ИсточникДанных1</dataSource>
				<query>ВЫБРАТЬ РАЗЛИЧНЫЕ
	ТабТоваров.Номенклатура,
	ТабТоваров.ХарактеристикаНоменклатуры,
	ТабТоваров.ЕдиницаИзмерения,
	ТабТоваров.Номенклатура.Код КАК КодТовараСвой,
	КОЛИЧЕСТВО(ВЫРАЗИТЬ(Штрихкоды.Штрихкод КАК СТРОКА(14))) КАК КоличествоШК
ПОМЕСТИТЬ ПосчитанныеКоличестваШК
ИЗ
	ТабТоваров КАК ТабТоваров
		ВНУТРЕННЕЕ СОЕДИНЕНИЕ РегистрСведений.Штрихкоды КАК Штрихкоды
		ПО ТабТоваров.Номенклатура = Штрихкоды.Владелец
			И ТабТоваров.ХарактеристикаНоменклатуры = Штрихкоды.ХарактеристикаНоменклатуры
			И ТабТоваров.ЕдиницаИзмерения = Штрихкоды.ЕдиницаИзмерения
ГДЕ
	&amp;ИскатьТоварПоШК

СГРУППИРОВАТЬ ПО
	ТабТоваров.Номенклатура,
	ТабТоваров.ХарактеристикаНоменклатуры,
	ТабТоваров.ЕдиницаИзмерения,
	ТабТоваров.Номенклатура.Код

ИНДЕКСИРОВАТЬ ПО
	ТабТоваров.Номенклатура,
	ТабТоваров.ХарактеристикаНоменклатуры,
	ТабТоваров.ЕдиницаИзмерения
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ
	ПосчитанныеКоличестваШК.Номенклатура,
	ПосчитанныеКоличестваШК.ХарактеристикаНоменклатуры,
	ПосчитанныеКоличестваШК.ЕдиницаИзмерения,
	ПосчитанныеКоличестваШК.КодТовараСвой
ПОМЕСТИТЬ ТоварыСВалиднымиШК
ИЗ
	ПосчитанныеКоличестваШК КАК ПосчитанныеКоличестваШК
ГДЕ
	ПосчитанныеКоличестваШК.КоличествоШК = 1
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ РАЗЛИЧНЫЕ
	ТоварыСВалиднымиШК.Номенклатура,
	ТоварыСВалиднымиШК.ХарактеристикаНоменклатуры,
	ТоварыСВалиднымиШК.ЕдиницаИзмерения,
	ТоварыСВалиднымиШК.КодТовараСвой,
	ВЫРАЗИТЬ(Штрихкоды.Штрихкод КАК СТРОКА(14)) КАК GTIN
ПОМЕСТИТЬ ВТШтрихкодыТоваров
ИЗ
	ТоварыСВалиднымиШК КАК ТоварыСВалиднымиШК
		ВНУТРЕННЕЕ СОЕДИНЕНИЕ РегистрСведений.Штрихкоды КАК Штрихкоды
		ПО ТоварыСВалиднымиШК.Номенклатура = Штрихкоды.Владелец
			И ТоварыСВалиднымиШК.ХарактеристикаНоменклатуры = Штрихкоды.ХарактеристикаНоменклатуры
			И ТоварыСВалиднымиШК.ЕдиницаИзмерения = Штрихкоды.ЕдиницаИзмерения
ГДЕ
	&amp;ИскатьТоварПоШК

ИНДЕКСИРОВАТЬ ПО
	ТоварыСВалиднымиШК.Номенклатура,
	ТоварыСВалиднымиШК.ХарактеристикаНоменклатуры,
	ТоварыСВалиднымиШК.ЕдиницаИзмерения</query>
				<autoFillFields>false</autoFillFields>
			</item>
		</item>
	</dataSet>
	<dataSet xsi:type="DataSetUnion">
		<name>УФ_БП</name>
		<field xsi:type="DataSetFieldField">
			<dataPath>СуммаНДС</dataPath>
			<field>СуммаНДС</field>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>НомерСтроки</dataPath>
			<field>НомерСтроки</field>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>Сумма</dataPath>
			<field>Сумма</field>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>Наименование</dataPath>
			<field>Наименование</field>
			<title xsi:type="v8:LocalStringType">
				<v8:item>
					<v8:lang>ru</v8:lang>
					<v8:content>Наименование</v8:content>
				</v8:item>
			</title>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>НаименованиеПолное</dataPath>
			<field>НаименованиеПолное</field>
			<title xsi:type="v8:LocalStringType">
				<v8:item>
					<v8:lang>ru</v8:lang>
					<v8:content>Наименование полное</v8:content>
				</v8:item>
			</title>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>СтавкаНДС</dataPath>
			<field>СтавкаНДС</field>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>ХарактеристикаНоменклатуры</dataPath>
			<field>ХарактеристикаНоменклатуры</field>
			<title xsi:type="v8:LocalStringType">
				<v8:item>
					<v8:lang>ru</v8:lang>
					<v8:content>Характеристика номенклатуры</v8:content>
				</v8:item>
			</title>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>НомерГТД</dataPath>
			<field>НомерГТД</field>
			<title xsi:type="v8:LocalStringType">
				<v8:item>
					<v8:lang>ru</v8:lang>
					<v8:content>Номер ГТД</v8:content>
				</v8:item>
			</title>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>ТипЕдиницы</dataPath>
			<field>ТипЕдиницы</field>
			<title xsi:type="v8:LocalStringType">
				<v8:item>
					<v8:lang>ru</v8:lang>
					<v8:content>Тип единицы</v8:content>
				</v8:item>
			</title>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>Количество</dataPath>
			<field>Количество</field>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>Страна</dataPath>
			<field>Страна</field>
			<title xsi:type="v8:LocalStringType">
				<v8:item>
					<v8:lang>ru</v8:lang>
					<v8:content>Страна</v8:content>
				</v8:item>
			</title>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>ЕдиницаИзмерения</dataPath>
			<field>ЕдиницаИзмерения</field>
			<title xsi:type="v8:LocalStringType">
				<v8:item>
					<v8:lang>ru</v8:lang>
					<v8:content>Единица измерения</v8:content>
				</v8:item>
			</title>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>Номенклатура</dataPath>
			<field>Номенклатура</field>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>Цена</dataPath>
			<field>Цена</field>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>СерияНоменклатуры</dataPath>
			<field>СерияНоменклатуры</field>
			<title xsi:type="v8:LocalStringType">
				<v8:item>
					<v8:lang>ru</v8:lang>
					<v8:content>Серия номенклатуры</v8:content>
				</v8:item>
			</title>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>КодЕдиницыИзмерения</dataPath>
			<field>КодЕдиницыИзмерения</field>
			<title xsi:type="v8:LocalStringType">
				<v8:item>
					<v8:lang>ru</v8:lang>
					<v8:content>Код единицы измерения</v8:content>
				</v8:item>
			</title>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>КоличествоДоКорректировки</dataPath>
			<field>КоличествоДоКорректировки</field>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>СтавкаНДСДоКорректировки</dataPath>
			<field>СтавкаНДСДоКорректировки</field>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>СуммаДоКорректировки</dataPath>
			<field>СуммаДоКорректировки</field>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>СуммаНДСДоКорректировки</dataPath>
			<field>СуммаНДСДоКорректировки</field>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>ЦенаДоКорректировки</dataPath>
			<field>ЦенаДоКорректировки</field>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>GTIN</dataPath>
			<field>GTIN</field>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>ЕдИзмСрокаГодности</dataPath>
			<field>ЕдИзмСрокаГодности</field>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>КвантПоставки</dataPath>
			<field>КвантПоставки</field>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>КодТовараПоставщика</dataPath>
			<field>КодТовараПоставщика</field>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>КоличествоВОдномМесте</dataPath>
			<field>КоличествоВОдномМесте</field>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>Родитель</dataPath>
			<field>Родитель</field>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>СрокГодности</dataPath>
			<field>СрокГодности</field>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>РекомендуемаяРозничнаяЦена</dataPath>
			<field>РекомендуемаяРозничнаяЦена</field>
			<title xsi:type="v8:LocalStringType">
				<v8:item>
					<v8:lang>ru</v8:lang>
					<v8:content>Рекомендуемая розничная цена</v8:content>
				</v8:item>
			</title>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>КоличествоОстаткаНаКонец</dataPath>
			<field>КоличествоОстаткаНаКонец</field>
			<title xsi:type="v8:LocalStringType">
				<v8:item>
					<v8:lang>ru</v8:lang>
					<v8:content>Количество остатка на конец</v8:content>
				</v8:item>
			</title>
		</field>
		<item xsi:type="DataSetUnion">
			<name>Поставщик</name>
			<field xsi:type="DataSetFieldField">
				<dataPath>СуммаНДС</dataPath>
				<field>СуммаНДС</field>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>НомерСтроки</dataPath>
				<field>НомерСтроки</field>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>Сумма</dataPath>
				<field>Сумма</field>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>Наименование</dataPath>
				<field>Наименование</field>
				<title xsi:type="v8:LocalStringType">
					<v8:item>
						<v8:lang>ru</v8:lang>
						<v8:content>Наименование</v8:content>
					</v8:item>
				</title>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>НаименованиеПолное</dataPath>
				<field>НаименованиеПолное</field>
				<title xsi:type="v8:LocalStringType">
					<v8:item>
						<v8:lang>ru</v8:lang>
						<v8:content>Наименование полное</v8:content>
					</v8:item>
				</title>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>СтавкаНДС</dataPath>
				<field>СтавкаНДС</field>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>ХарактеристикаНоменклатуры</dataPath>
				<field>ХарактеристикаНоменклатуры</field>
				<title xsi:type="v8:LocalStringType">
					<v8:item>
						<v8:lang>ru</v8:lang>
						<v8:content>Характеристика номенклатуры</v8:content>
					</v8:item>
				</title>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>НомерГТД</dataPath>
				<field>НомерГТД</field>
				<title xsi:type="v8:LocalStringType">
					<v8:item>
						<v8:lang>ru</v8:lang>
						<v8:content>Номер ГТД</v8:content>
					</v8:item>
				</title>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>ТипЕдиницы</dataPath>
				<field>ТипЕдиницы</field>
				<title xsi:type="v8:LocalStringType">
					<v8:item>
						<v8:lang>ru</v8:lang>
						<v8:content>Тип единицы</v8:content>
					</v8:item>
				</title>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>Количество</dataPath>
				<field>Количество</field>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>Страна</dataPath>
				<field>Страна</field>
				<title xsi:type="v8:LocalStringType">
					<v8:item>
						<v8:lang>ru</v8:lang>
						<v8:content>Страна</v8:content>
					</v8:item>
				</title>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>ЕдиницаИзмерения</dataPath>
				<field>ЕдиницаИзмерения</field>
				<title xsi:type="v8:LocalStringType">
					<v8:item>
						<v8:lang>ru</v8:lang>
						<v8:content>Единица измерения</v8:content>
					</v8:item>
				</title>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>Номенклатура</dataPath>
				<field>Номенклатура</field>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>Цена</dataPath>
				<field>Цена</field>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>СерияНоменклатуры</dataPath>
				<field>СерияНоменклатуры</field>
				<title xsi:type="v8:LocalStringType">
					<v8:item>
						<v8:lang>ru</v8:lang>
						<v8:content>Серия номенклатуры</v8:content>
					</v8:item>
				</title>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>КодЕдиницыИзмерения</dataPath>
				<field>КодЕдиницыИзмерения</field>
				<title xsi:type="v8:LocalStringType">
					<v8:item>
						<v8:lang>ru</v8:lang>
						<v8:content>Код единицы измерения</v8:content>
					</v8:item>
				</title>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>КоличествоДоКорректировки</dataPath>
				<field>КоличествоДоКорректировки</field>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>СтавкаНДСДоКорректировки</dataPath>
				<field>СтавкаНДСДоКорректировки</field>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>СуммаДоКорректировки</dataPath>
				<field>СуммаДоКорректировки</field>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>СуммаНДСДоКорректировки</dataPath>
				<field>СуммаНДСДоКорректировки</field>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>ЦенаДоКорректировки</dataPath>
				<field>ЦенаДоКорректировки</field>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>GTIN</dataPath>
				<field>GTIN</field>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>ЕдИзмСрокаГодности</dataPath>
				<field>ЕдИзмСрокаГодности</field>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>КвантПоставки</dataPath>
				<field>КвантПоставки</field>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>КодТовараПоставщика</dataPath>
				<field>КодТовараПоставщика</field>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>КоличествоВОдномМесте</dataPath>
				<field>КоличествоВОдномМесте</field>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>Родитель</dataPath>
				<field>Родитель</field>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>СрокГодности</dataPath>
				<field>СрокГодности</field>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>РекомендуемаяРозничнаяЦена</dataPath>
				<field>РекомендуемаяРозничнаяЦена</field>
				<title xsi:type="v8:LocalStringType">
					<v8:item>
						<v8:lang>ru</v8:lang>
						<v8:content>Рекомендуемая розничная цена</v8:content>
					</v8:item>
				</title>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>КоличествоОстаткаНаКонец</dataPath>
				<field>КоличествоОстаткаНаКонец</field>
				<title xsi:type="v8:LocalStringType">
					<v8:item>
						<v8:lang>ru</v8:lang>
						<v8:content>Количество остатка на конец</v8:content>
					</v8:item>
				</title>
			</field>
			<item xsi:type="DataSetUnion">
				<name>ЗапросОсновнойЦепочки</name>
				<item xsi:type="DataSetQuery">
					<name>Счет_Реализация_СФ</name>
					<dataSource>ИсточникДанных1</dataSource>
					<query>ВЫБРАТЬ
	докСчетНаОплатуПокупателю.Ссылка КАК PORDERS,
	докСчетНаОплатуПокупателю.Ссылка КАК ORDERS,
	докСчетНаОплатуПокупателю.Ссылка КАК ORDRSP,
	докРеализацияТоваровУслуг.Ссылка КАК DESADV,
	докРеализацияТоваровУслуг.Ссылка КАК RECADV,
	СчетФактураВыданный.Ссылка КАК INVOIC
ИЗ
	(ВЫБРАТЬ
		1 КАК Поле1) КАК Заглушка
		{ПОЛНОЕ СОЕДИНЕНИЕ Документ.СчетФактураВыданный КАК СчетФактураВыданный
			{ПОЛНОЕ СОЕДИНЕНИЕ Документ.РеализацияТоваровУслуг КАК докРеализацияТоваровУслуг
				{ПОЛНОЕ СОЕДИНЕНИЕ Документ.СчетНаОплатуПокупателю КАК докСчетНаОплатуПокупателю
				ПО докРеализацияТоваровУслуг.СчетНаОплатуПокупателю = докСчетНаОплатуПокупателю.Ссылка}
			ПО ((СчетФактураВыданный.ДокументОснование) = докРеализацияТоваровУслуг.Ссылка)}
		ПО (ИСТИНА)}</query>
					<autoFillFields>false</autoFillFields>
				</item>
				<item xsi:type="DataSetQuery">
					<name>Реализация_СФ</name>
					<dataSource>ИсточникДанных1</dataSource>
					<query>ВЫБРАТЬ
	РеализацияТоваровУслуг.Ссылка КАК PORDERS,
	РеализацияТоваровУслуг.Ссылка КАК ORDERS,
	РеализацияТоваровУслуг.Ссылка КАК ORDRSP,
	РеализацияТоваровУслуг.Ссылка КАК DESADV,
	РеализацияТоваровУслуг.Ссылка КАК RECADV,
	СчетФактураВыданный.Ссылка КАК INVOIC
ИЗ
	(ВЫБРАТЬ
		1 КАК Поле1) КАК Заглушка
		{ПОЛНОЕ СОЕДИНЕНИЕ Документ.СчетФактураВыданный КАК СчетФактураВыданный
			{ПОЛНОЕ СОЕДИНЕНИЕ Документ.РеализацияТоваровУслуг КАК РеализацияТоваровУслуг
			ПО ((СчетФактураВыданный.ДокументОснование) = РеализацияТоваровУслуг.Ссылка)}
		ПО (ИСТИНА)}</query>
					<autoFillFields>false</autoFillFields>
				</item>
				<item xsi:type="DataSetQuery">
					<name>Счет_Реализация</name>
					<dataSource>ИсточникДанных1</dataSource>
					<query>ВЫБРАТЬ
	докСчетНаОплатуПокупателю.Ссылка КАК PORDERS,
	докСчетНаОплатуПокупателю.Ссылка КАК ORDERS,
	докСчетНаОплатуПокупателю.Ссылка КАК ORDRSP,
	докРеализацияТоваровУслуг.Ссылка КАК DESADV,
	докРеализацияТоваровУслуг.Ссылка КАК RECADV,
	докРеализацияТоваровУслуг.Ссылка КАК INVOIC
ИЗ
	(ВЫБРАТЬ
		1 КАК Поле1) КАК Заглушка
		{ПОЛНОЕ СОЕДИНЕНИЕ Документ.РеализацияТоваровУслуг КАК докРеализацияТоваровУслуг
			{ПОЛНОЕ СОЕДИНЕНИЕ Документ.СчетНаОплатуПокупателю КАК докСчетНаОплатуПокупателю
			ПО докРеализацияТоваровУслуг.СчетНаОплатуПокупателю = докСчетНаОплатуПокупателю.Ссылка}
		ПО (ИСТИНА)}</query>
					<autoFillFields>false</autoFillFields>
				</item>
				<item xsi:type="DataSetQuery">
					<name>Реализация</name>
					<dataSource>ИсточникДанных1</dataSource>
					<query>ВЫБРАТЬ
	РеализацияТоваровУслуг.Ссылка КАК PORDERS,
	РеализацияТоваровУслуг.Ссылка КАК ORDERS,
	РеализацияТоваровУслуг.Ссылка КАК ORDRSP,
	РеализацияТоваровУслуг.Ссылка КАК DESADV,
	РеализацияТоваровУслуг.Ссылка КАК RECADV,
	РеализацияТоваровУслуг.Ссылка КАК INVOIC
ИЗ
	(ВЫБРАТЬ
		1 КАК Поле1) КАК Заглушка
		{ПОЛНОЕ СОЕДИНЕНИЕ Документ.РеализацияТоваровУслуг КАК РеализацияТоваровУслуг
		ПО (ИСТИНА)}</query>
					<autoFillFields>false</autoFillFields>
				</item>
			</item>
			<item xsi:type="DataSetUnion">
				<name>ЗапросПоТоварам</name>
				<field xsi:type="DataSetFieldField">
					<dataPath>СуммаНДС</dataPath>
					<field>СуммаНДС</field>
				</field>
				<field xsi:type="DataSetFieldField">
					<dataPath>НомерСтроки</dataPath>
					<field>НомерСтроки</field>
				</field>
				<field xsi:type="DataSetFieldField">
					<dataPath>Сумма</dataPath>
					<field>Сумма</field>
				</field>
				<field xsi:type="DataSetFieldField">
					<dataPath>Наименование</dataPath>
					<field>Наименование</field>
					<title xsi:type="v8:LocalStringType">
						<v8:item>
							<v8:lang>ru</v8:lang>
							<v8:content>Наименование</v8:content>
						</v8:item>
					</title>
				</field>
				<field xsi:type="DataSetFieldField">
					<dataPath>НаименованиеПолное</dataPath>
					<field>НаименованиеПолное</field>
					<title xsi:type="v8:LocalStringType">
						<v8:item>
							<v8:lang>ru</v8:lang>
							<v8:content>Наименование полное</v8:content>
						</v8:item>
					</title>
				</field>
				<field xsi:type="DataSetFieldField">
					<dataPath>СтавкаНДС</dataPath>
					<field>СтавкаНДС</field>
				</field>
				<field xsi:type="DataSetFieldField">
					<dataPath>ХарактеристикаНоменклатуры</dataPath>
					<field>ХарактеристикаНоменклатуры</field>
					<title xsi:type="v8:LocalStringType">
						<v8:item>
							<v8:lang>ru</v8:lang>
							<v8:content>Характеристика номенклатуры</v8:content>
						</v8:item>
					</title>
				</field>
				<field xsi:type="DataSetFieldField">
					<dataPath>НомерГТД</dataPath>
					<field>НомерГТД</field>
					<title xsi:type="v8:LocalStringType">
						<v8:item>
							<v8:lang>ru</v8:lang>
							<v8:content>Номер ГТД</v8:content>
						</v8:item>
					</title>
				</field>
				<field xsi:type="DataSetFieldField">
					<dataPath>ТипЕдиницы</dataPath>
					<field>ТипЕдиницы</field>
					<title xsi:type="v8:LocalStringType">
						<v8:item>
							<v8:lang>ru</v8:lang>
							<v8:content>Тип единицы</v8:content>
						</v8:item>
					</title>
				</field>
				<field xsi:type="DataSetFieldField">
					<dataPath>Количество</dataPath>
					<field>Количество</field>
				</field>
				<field xsi:type="DataSetFieldField">
					<dataPath>Страна</dataPath>
					<field>Страна</field>
					<title xsi:type="v8:LocalStringType">
						<v8:item>
							<v8:lang>ru</v8:lang>
							<v8:content>Страна</v8:content>
						</v8:item>
					</title>
				</field>
				<field xsi:type="DataSetFieldField">
					<dataPath>ЕдиницаИзмерения</dataPath>
					<field>ЕдиницаИзмерения</field>
					<title xsi:type="v8:LocalStringType">
						<v8:item>
							<v8:lang>ru</v8:lang>
							<v8:content>Единица измерения</v8:content>
						</v8:item>
					</title>
				</field>
				<field xsi:type="DataSetFieldField">
					<dataPath>Номенклатура</dataPath>
					<field>Номенклатура</field>
				</field>
				<field xsi:type="DataSetFieldField">
					<dataPath>Цена</dataPath>
					<field>Цена</field>
				</field>
				<field xsi:type="DataSetFieldField">
					<dataPath>СерияНоменклатуры</dataPath>
					<field>СерияНоменклатуры</field>
					<title xsi:type="v8:LocalStringType">
						<v8:item>
							<v8:lang>ru</v8:lang>
							<v8:content>Серия номенклатуры</v8:content>
						</v8:item>
					</title>
				</field>
				<field xsi:type="DataSetFieldField">
					<dataPath>КодЕдиницыИзмерения</dataPath>
					<field>КодЕдиницыИзмерения</field>
					<title xsi:type="v8:LocalStringType">
						<v8:item>
							<v8:lang>ru</v8:lang>
							<v8:content>Код единицы измерения</v8:content>
						</v8:item>
					</title>
				</field>
				<field xsi:type="DataSetFieldField">
					<dataPath>КоличествоДоКорректировки</dataPath>
					<field>КоличествоДоКорректировки</field>
				</field>
				<field xsi:type="DataSetFieldField">
					<dataPath>СтавкаНДСДоКорректировки</dataPath>
					<field>СтавкаНДСДоКорректировки</field>
				</field>
				<field xsi:type="DataSetFieldField">
					<dataPath>СуммаДоКорректировки</dataPath>
					<field>СуммаДоКорректировки</field>
				</field>
				<field xsi:type="DataSetFieldField">
					<dataPath>СуммаНДСДоКорректировки</dataPath>
					<field>СуммаНДСДоКорректировки</field>
				</field>
				<field xsi:type="DataSetFieldField">
					<dataPath>ЦенаДоКорректировки</dataPath>
					<field>ЦенаДоКорректировки</field>
				</field>
				<field xsi:type="DataSetFieldField">
					<dataPath>GTIN</dataPath>
					<field>GTIN</field>
				</field>
				<field xsi:type="DataSetFieldField">
					<dataPath>ЕдИзмСрокаГодности</dataPath>
					<field>ЕдИзмСрокаГодности</field>
				</field>
				<field xsi:type="DataSetFieldField">
					<dataPath>КвантПоставки</dataPath>
					<field>КвантПоставки</field>
				</field>
				<field xsi:type="DataSetFieldField">
					<dataPath>КодТовараПоставщика</dataPath>
					<field>КодТовараПоставщика</field>
				</field>
				<field xsi:type="DataSetFieldField">
					<dataPath>КоличествоВОдномМесте</dataPath>
					<field>КоличествоВОдномМесте</field>
				</field>
				<field xsi:type="DataSetFieldField">
					<dataPath>Родитель</dataPath>
					<field>Родитель</field>
				</field>
				<field xsi:type="DataSetFieldField">
					<dataPath>СрокГодности</dataPath>
					<field>СрокГодности</field>
				</field>
				<field xsi:type="DataSetFieldField">
					<dataPath>РекомендуемаяРозничнаяЦена</dataPath>
					<field>РекомендуемаяРозничнаяЦена</field>
					<title xsi:type="v8:LocalStringType">
						<v8:item>
							<v8:lang>ru</v8:lang>
							<v8:content>Рекомендуемая розничная цена</v8:content>
						</v8:item>
					</title>
				</field>
				<field xsi:type="DataSetFieldField">
					<dataPath>КоличествоОстаткаНаКонец</dataPath>
					<field>КоличествоОстаткаНаКонец</field>
					<title xsi:type="v8:LocalStringType">
						<v8:item>
							<v8:lang>ru</v8:lang>
							<v8:content>Количество остатка на конец</v8:content>
						</v8:item>
					</title>
				</field>
				<item xsi:type="DataSetUnion">
					<name>_PORDERS_ORDRSP_</name>
					<item xsi:type="DataSetQuery">
						<name>СчетНаОплатуПокупателю</name>
						<dataSource>ИсточникДанных1</dataSource>
						<query>ВЫБРАТЬ
    ЗаказПокупателяТовары.Номенклатура,
    Неопределено КАК ХарактеристикаНоменклатуры,
    ЗаказПокупателяТовары.Номенклатура.ЕдиницаИзмерения КАК ЕдиницаИзмерения,
    ЗаказПокупателяТовары.Цена,
    ЗаказПокупателяТовары.СтавкаНДС,
    ЗаказПокупателяТовары.Количество КАК Количество,
    ЛОЖЬ КАК Пометка,
    ЗаказПокупателяТовары.Сумма КАК Сумма,
    ЗаказПокупателяТовары.СуммаНДС КАК СуммаНДС,
	ВЫБОР
		КОГДА ЗаказПокупателяТовары.Номенклатура.Услуга
			ТОГДА "Services"
		ИНАЧЕ ""
	КОНЕЦ КАК ТипЕдиницы
ИЗ
    Документ.СчетНаОплатуПокупателю.Товары КАК ЗаказПокупателяТовары
ГДЕ
    ЗаказПокупателяТовары.Ссылка В(&amp;Ссылка)
    И (НЕ ЗаказПокупателяТовары.Номенклатура.Услуга
			ИЛИ &amp;РаботаСУслугами)
</query>
						<autoFillFields>false</autoFillFields>
					</item>
					<item xsi:type="DataSetQuery">
						<name>РеализацияТоваровУслуг</name>
						<dataSource>ИсточникДанных1</dataSource>
						<query>ВЫБРАТЬ
	РеализацияТоваровУслугТовары.НомерСтроки,
	РеализацияТоваровУслугТовары.Номенклатура,
	ВЫБОР
		КОГДА РеализацияТоваровУслугТовары.ЕдиницаИзмерения = ЗНАЧЕНИЕ(Справочник.КлассификаторЕдиницИзмерения.ПустаяСсылка)
			ТОГДА РеализацияТоваровУслугТовары.Номенклатура.ЕдиницаИзмерения
		ИНАЧЕ РеализацияТоваровУслугТовары.ЕдиницаИзмерения
	КОНЕЦ КАК ЕдиницаИзмерения,
	ВЫРАЗИТЬ(РеализацияТоваровУслугТовары.Номенклатура.Наименование КАК СТРОКА(178)) КАК Наименование,
	ВЫРАЗИТЬ(РеализацияТоваровУслугТовары.Номенклатура.НаименованиеПолное КАК СТРОКА(500)) КАК НаименованиеПолное,
	НЕОПРЕДЕЛЕНО КАК ХарактеристикаНоменклатуры,
	НЕОПРЕДЕЛЕНО КАК СерияНоменклатуры,
	РеализацияТоваровУслугТовары.Цена,
	РеализацияТоваровУслугТовары.СтавкаНДС,
	РеализацияТоваровУслугТовары.СтранаПроисхождения КАК Страна,
	РеализацияТоваровУслугТовары.НомерГТД КАК НомерГТД,
	РеализацияТоваровУслугТовары.Количество КАК Количество,
	РеализацияТоваровУслугТовары.Сумма КАК Сумма,
	РеализацияТоваровУслугТовары.СуммаНДС КАК СуммаНДС,
	ВЫБОР
		КОГДА РеализацияТоваровУслугТовары.Номенклатура.Услуга
			ТОГДА "Services"
		ИНАЧЕ ""
	КОНЕЦ КАК ТипЕдиницы
ИЗ
	Документ.РеализацияТоваровУслуг.Товары КАК РеализацияТоваровУслугТовары
ГДЕ
	РеализацияТоваровУслугТовары.Ссылка В(&amp;Ссылка)
	И (НЕ РеализацияТоваровУслугТовары.Номенклатура.Услуга
			ИЛИ &amp;РаботаСУслугами)

ОБЪЕДИНИТЬ ВСЕ

ВЫБРАТЬ
	РеализацияТоваровУслугТовары.НомерСтроки,
	РеализацияТоваровУслугТовары.Номенклатура,
	РеализацияТоваровУслугТовары.Номенклатура.ЕдиницаИзмерения,
	ВЫРАЗИТЬ(РеализацияТоваровУслугТовары.Номенклатура.Наименование КАК СТРОКА(178)),
	ВЫРАЗИТЬ(РеализацияТоваровУслугТовары.Номенклатура.НаименованиеПолное КАК СТРОКА(500)),
	НЕОПРЕДЕЛЕНО,
	НЕОПРЕДЕЛЕНО,
	РеализацияТоваровУслугТовары.Цена,
	РеализацияТоваровУслугТовары.СтавкаНДС,
	РеализацияТоваровУслугТовары.Номенклатура.СтранаПроисхождения,
	РеализацияТоваровУслугТовары.Номенклатура.НомерГТД,
	РеализацияТоваровУслугТовары.Количество,
	РеализацияТоваровУслугТовары.Сумма,
	РеализацияТоваровУслугТовары.СуммаНДС,
	"Services"
ИЗ
	Документ.РеализацияТоваровУслуг.Услуги КАК РеализацияТоваровУслугТовары
ГДЕ
	&amp;РаботаСУслугами
	И РеализацияТоваровУслугТовары.Ссылка В(&amp;Ссылка)

ОБЪЕДИНИТЬ ВСЕ

ВЫБРАТЬ
	РеализацияТоваровУслугВозвратнаяТара.НомерСтроки,
	РеализацияТоваровУслугВозвратнаяТара.Номенклатура,
	РеализацияТоваровУслугВозвратнаяТара.Номенклатура.ЕдиницаИзмерения,
	ВЫРАЗИТЬ(РеализацияТоваровУслугВозвратнаяТара.Номенклатура.Наименование КАК СТРОКА(178)),
	ВЫРАЗИТЬ(РеализацияТоваровУслугВозвратнаяТара.Номенклатура.НаименованиеПолное КАК СТРОКА(500)),
	НЕОПРЕДЕЛЕНО,
	НЕОПРЕДЕЛЕНО,
	РеализацияТоваровУслугВозвратнаяТара.Цена,
	ЗНАЧЕНИЕ(Перечисление.СтавкиНДС.БезНДС),
	РеализацияТоваровУслугВозвратнаяТара.Номенклатура.СтранаПроисхождения,
	РеализацияТоваровУслугВозвратнаяТара.Номенклатура.НомерГТД,
	РеализацияТоваровУслугВозвратнаяТара.Количество,
	РеализацияТоваровУслугВозвратнаяТара.Сумма,
	0,
	"RC"
ИЗ
	Документ.РеализацияТоваровУслуг.ВозвратнаяТара КАК РеализацияТоваровУслугВозвратнаяТара
ГДЕ
	&amp;ОтправлятьВозвратнуюТару
	И РеализацияТоваровУслугВозвратнаяТара.Ссылка В(&amp;Ссылка)</query>
						<autoFillFields>false</autoFillFields>
					</item>
				</item>
				<item xsi:type="DataSetUnion">
					<name>_DESADV_INVOIC_</name>
					<item xsi:type="DataSetQuery">
						<name>РеализацияТоваровУслуг</name>
						<dataSource>ИсточникДанных1</dataSource>
						<query>ВЫБРАТЬ
	РеализацияТоваровУслугТовары.НомерСтроки,
	РеализацияТоваровУслугТовары.Номенклатура,
	ВЫБОР
		КОГДА РеализацияТоваровУслугТовары.ЕдиницаИзмерения = ЗНАЧЕНИЕ(Справочник.КлассификаторЕдиницИзмерения.ПустаяСсылка)
			ТОГДА РеализацияТоваровУслугТовары.Номенклатура.ЕдиницаИзмерения
		ИНАЧЕ РеализацияТоваровУслугТовары.ЕдиницаИзмерения
	КОНЕЦ КАК ЕдиницаИзмерения,
	ВЫРАЗИТЬ(РеализацияТоваровУслугТовары.Номенклатура.Наименование КАК СТРОКА(178)) КАК Наименование,
	ВЫРАЗИТЬ(РеализацияТоваровУслугТовары.Номенклатура.НаименованиеПолное КАК СТРОКА(500)) КАК НаименованиеПолное,
	НЕОПРЕДЕЛЕНО КАК ХарактеристикаНоменклатуры,
	НЕОПРЕДЕЛЕНО КАК СерияНоменклатуры,
	РеализацияТоваровУслугТовары.Цена,
	РеализацияТоваровУслугТовары.СтавкаНДС,
	РеализацияТоваровУслугТовары.СтранаПроисхождения КАК Страна,
	РеализацияТоваровУслугТовары.НомерГТД КАК НомерГТД,
	РеализацияТоваровУслугТовары.Количество КАК Количество,
	РеализацияТоваровУслугТовары.Сумма КАК Сумма,
	РеализацияТоваровУслугТовары.СуммаНДС КАК СуммаНДС,
	ВЫБОР
		КОГДА РеализацияТоваровУслугТовары.Номенклатура.Услуга
			ТОГДА "Services"
		ИНАЧЕ ""
	КОНЕЦ КАК ТипЕдиницы
ИЗ
	Документ.РеализацияТоваровУслуг.Товары КАК РеализацияТоваровУслугТовары
ГДЕ
	РеализацияТоваровУслугТовары.Ссылка В(&amp;Ссылка)
	И (НЕ РеализацияТоваровУслугТовары.Номенклатура.Услуга
			ИЛИ &amp;РаботаСУслугами)

ОБЪЕДИНИТЬ ВСЕ

ВЫБРАТЬ
	РеализацияТоваровУслугТовары.НомерСтроки,
	РеализацияТоваровУслугТовары.Номенклатура,
	РеализацияТоваровУслугТовары.Номенклатура.ЕдиницаИзмерения,
	ВЫРАЗИТЬ(РеализацияТоваровУслугТовары.Номенклатура.Наименование КАК СТРОКА(178)),
	ВЫРАЗИТЬ(РеализацияТоваровУслугТовары.Номенклатура.НаименованиеПолное КАК СТРОКА(500)),
	НЕОПРЕДЕЛЕНО,
	НЕОПРЕДЕЛЕНО,
	РеализацияТоваровУслугТовары.Цена,
	РеализацияТоваровУслугТовары.СтавкаНДС,
	РеализацияТоваровУслугТовары.Номенклатура.СтранаПроисхождения,
	РеализацияТоваровУслугТовары.Номенклатура.НомерГТД,
	РеализацияТоваровУслугТовары.Количество,
	РеализацияТоваровУслугТовары.Сумма,
	РеализацияТоваровУслугТовары.СуммаНДС,
	"Services"
ИЗ
	Документ.РеализацияТоваровУслуг.Услуги КАК РеализацияТоваровУслугТовары
ГДЕ
	&amp;РаботаСУслугами
	И РеализацияТоваровУслугТовары.Ссылка В(&amp;Ссылка)

ОБЪЕДИНИТЬ ВСЕ

ВЫБРАТЬ
	0,
	ВозвратТоваровОтПокупателяТовары.Номенклатура,
	ВозвратТоваровОтПокупателяТовары.Номенклатура.ЕдиницаИзмерения,
	ВЫРАЗИТЬ(ВозвратТоваровОтПокупателяТовары.Номенклатура.Наименование КАК СТРОКА(178)),
	ВЫРАЗИТЬ(ВозвратТоваровОтПокупателяТовары.Номенклатура.НаименованиеПолное КАК СТРОКА(500)),
	НЕОПРЕДЕЛЕНО,
	НЕОПРЕДЕЛЕНО,
	ВозвратТоваровОтПокупателяТовары.Цена,
	ВозвратТоваровОтПокупателяТовары.СтавкаНДС,
	ВозвратТоваровОтПокупателяТовары.СтранаПроисхождения,
	ВозвратТоваровОтПокупателяТовары.НомерГТД,
	-ВозвратТоваровОтПокупателяТовары.Количество,
	-ВозвратТоваровОтПокупателяТовары.Сумма,
	-ВозвратТоваровОтПокупателяТовары.СуммаНДС,
	""
ИЗ
	Документ.ВозвратТоваровОтПокупателя.Товары КАК ВозвратТоваровОтПокупателяТовары
ГДЕ
	ВозвратТоваровОтПокупателяТовары.Ссылка В(&amp;Возвраты)

ОБЪЕДИНИТЬ ВСЕ

ВЫБРАТЬ
	РеализацияТоваровУслугВозвратнаяТара.НомерСтроки,
	РеализацияТоваровУслугВозвратнаяТара.Номенклатура,
	РеализацияТоваровУслугВозвратнаяТара.Номенклатура.ЕдиницаИзмерения,
	ВЫРАЗИТЬ(РеализацияТоваровУслугВозвратнаяТара.Номенклатура.Наименование КАК СТРОКА(178)),
	ВЫРАЗИТЬ(РеализацияТоваровУслугВозвратнаяТара.Номенклатура.НаименованиеПолное КАК СТРОКА(500)),
	НЕОПРЕДЕЛЕНО,
	НЕОПРЕДЕЛЕНО,
	РеализацияТоваровУслугВозвратнаяТара.Цена,
	ЗНАЧЕНИЕ(Перечисление.СтавкиНДС.БезНДС),
	РеализацияТоваровУслугВозвратнаяТара.Номенклатура.СтранаПроисхождения,
	РеализацияТоваровУслугВозвратнаяТара.Номенклатура.НомерГТД,
	РеализацияТоваровУслугВозвратнаяТара.Количество,
	РеализацияТоваровУслугВозвратнаяТара.Сумма,
	0,
	"RC"
ИЗ
	Документ.РеализацияТоваровУслуг.ВозвратнаяТара КАК РеализацияТоваровУслугВозвратнаяТара
ГДЕ
	&amp;ОтправлятьВозвратнуюТару
	И РеализацияТоваровУслугВозвратнаяТара.Ссылка В(&amp;Ссылка)

ОБЪЕДИНИТЬ ВСЕ

ВЫБРАТЬ
	0,
	ВозвратТоваровОтПокупателяВозвратнаяТара.Номенклатура,
	ВозвратТоваровОтПокупателяВозвратнаяТара.Номенклатура.ЕдиницаИзмерения,
	ВЫРАЗИТЬ(ВозвратТоваровОтПокупателяВозвратнаяТара.Номенклатура.Наименование КАК СТРОКА(178)),
	ВЫРАЗИТЬ(ВозвратТоваровОтПокупателяВозвратнаяТара.Номенклатура.НаименованиеПолное КАК СТРОКА(500)),
	НЕОПРЕДЕЛЕНО,
	НЕОПРЕДЕЛЕНО,
	ВозвратТоваровОтПокупателяВозвратнаяТара.Цена,
	ЗНАЧЕНИЕ(Перечисление.СтавкиНДС.БезНДС),
	ВозвратТоваровОтПокупателяВозвратнаяТара.Номенклатура.СтранаПроисхождения,
	ВозвратТоваровОтПокупателяВозвратнаяТара.Номенклатура.НомерГТД,
	-ВозвратТоваровОтПокупателяВозвратнаяТара.Количество,
	-ВозвратТоваровОтПокупателяВозвратнаяТара.Сумма,
	0,
	"RC"
ИЗ
	Документ.ВозвратТоваровОтПокупателя.ВозвратнаяТара КАК ВозвратТоваровОтПокупателяВозвратнаяТара
ГДЕ
	&amp;ОтправлятьВозвратнуюТару
	И ВозвратТоваровОтПокупателяВозвратнаяТара.Ссылка В(&amp;Возвраты)</query>
						<autoFillFields>false</autoFillFields>
					</item>
				</item>
				<item xsi:type="DataSetUnion">
					<name>_RETINS_RETREC_</name>
					<field xsi:type="DataSetFieldField">
						<dataPath>СуммаНДС</dataPath>
						<field>СуммаНДС</field>
					</field>
					<field xsi:type="DataSetFieldField">
						<dataPath>НомерСтроки</dataPath>
						<field>НомерСтроки</field>
					</field>
					<field xsi:type="DataSetFieldField">
						<dataPath>Сумма</dataPath>
						<field>Сумма</field>
					</field>
					<field xsi:type="DataSetFieldField">
						<dataPath>Наименование</dataPath>
						<field>Наименование</field>
						<title xsi:type="v8:LocalStringType">
							<v8:item>
								<v8:lang>ru</v8:lang>
								<v8:content>Наименование</v8:content>
							</v8:item>
						</title>
					</field>
					<field xsi:type="DataSetFieldField">
						<dataPath>НаименованиеПолное</dataPath>
						<field>НаименованиеПолное</field>
						<title xsi:type="v8:LocalStringType">
							<v8:item>
								<v8:lang>ru</v8:lang>
								<v8:content>Наименование полное</v8:content>
							</v8:item>
						</title>
					</field>
					<field xsi:type="DataSetFieldField">
						<dataPath>СтавкаНДС</dataPath>
						<field>СтавкаНДС</field>
					</field>
					<field xsi:type="DataSetFieldField">
						<dataPath>ХарактеристикаНоменклатуры</dataPath>
						<field>ХарактеристикаНоменклатуры</field>
						<title xsi:type="v8:LocalStringType">
							<v8:item>
								<v8:lang>ru</v8:lang>
								<v8:content>Характеристика номенклатуры</v8:content>
							</v8:item>
						</title>
					</field>
					<field xsi:type="DataSetFieldField">
						<dataPath>НомерГТД</dataPath>
						<field>НомерГТД</field>
						<title xsi:type="v8:LocalStringType">
							<v8:item>
								<v8:lang>ru</v8:lang>
								<v8:content>Номер ГТД</v8:content>
							</v8:item>
						</title>
					</field>
					<field xsi:type="DataSetFieldField">
						<dataPath>ТипЕдиницы</dataPath>
						<field>ТипЕдиницы</field>
						<title xsi:type="v8:LocalStringType">
							<v8:item>
								<v8:lang>ru</v8:lang>
								<v8:content>Тип единицы</v8:content>
							</v8:item>
						</title>
					</field>
					<field xsi:type="DataSetFieldField">
						<dataPath>Количество</dataPath>
						<field>Количество</field>
					</field>
					<field xsi:type="DataSetFieldField">
						<dataPath>Страна</dataPath>
						<field>Страна</field>
						<title xsi:type="v8:LocalStringType">
							<v8:item>
								<v8:lang>ru</v8:lang>
								<v8:content>Страна</v8:content>
							</v8:item>
						</title>
					</field>
					<field xsi:type="DataSetFieldField">
						<dataPath>ЕдиницаИзмерения</dataPath>
						<field>ЕдиницаИзмерения</field>
						<title xsi:type="v8:LocalStringType">
							<v8:item>
								<v8:lang>ru</v8:lang>
								<v8:content>Единица измерения</v8:content>
							</v8:item>
						</title>
					</field>
					<field xsi:type="DataSetFieldField">
						<dataPath>Номенклатура</dataPath>
						<field>Номенклатура</field>
					</field>
					<field xsi:type="DataSetFieldField">
						<dataPath>Цена</dataPath>
						<field>Цена</field>
					</field>
					<field xsi:type="DataSetFieldField">
						<dataPath>СерияНоменклатуры</dataPath>
						<field>СерияНоменклатуры</field>
						<title xsi:type="v8:LocalStringType">
							<v8:item>
								<v8:lang>ru</v8:lang>
								<v8:content>Серия номенклатуры</v8:content>
							</v8:item>
						</title>
					</field>
					<field xsi:type="DataSetFieldField">
						<dataPath>КодЕдиницыИзмерения</dataPath>
						<field>КодЕдиницыИзмерения</field>
						<title xsi:type="v8:LocalStringType">
							<v8:item>
								<v8:lang>ru</v8:lang>
								<v8:content>Код единицы измерения</v8:content>
							</v8:item>
						</title>
					</field>
					<item xsi:type="DataSetQuery">
						<name>ВозвратТоваровОтПокупателя</name>
						<field xsi:type="DataSetFieldField">
							<dataPath>СуммаНДС</dataPath>
							<field>СуммаНДС</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>НомерСтроки</dataPath>
							<field>НомерСтроки</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>Сумма</dataPath>
							<field>Сумма</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>Наименование</dataPath>
							<field>Наименование</field>
							<title xsi:type="v8:LocalStringType">
								<v8:item>
									<v8:lang>ru</v8:lang>
									<v8:content>Наименование</v8:content>
								</v8:item>
							</title>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>НаименованиеПолное</dataPath>
							<field>НаименованиеПолное</field>
							<title xsi:type="v8:LocalStringType">
								<v8:item>
									<v8:lang>ru</v8:lang>
									<v8:content>Наименование полное</v8:content>
								</v8:item>
							</title>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>СтавкаНДС</dataPath>
							<field>СтавкаНДС</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>ХарактеристикаНоменклатуры</dataPath>
							<field>ХарактеристикаНоменклатуры</field>
							<title xsi:type="v8:LocalStringType">
								<v8:item>
									<v8:lang>ru</v8:lang>
									<v8:content>Характеристика номенклатуры</v8:content>
								</v8:item>
							</title>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>НомерГТД</dataPath>
							<field>НомерГТД</field>
							<title xsi:type="v8:LocalStringType">
								<v8:item>
									<v8:lang>ru</v8:lang>
									<v8:content>Номер ГТД</v8:content>
								</v8:item>
							</title>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>ТипЕдиницы</dataPath>
							<field>ТипЕдиницы</field>
							<title xsi:type="v8:LocalStringType">
								<v8:item>
									<v8:lang>ru</v8:lang>
									<v8:content>Тип единицы</v8:content>
								</v8:item>
							</title>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>Количество</dataPath>
							<field>Количество</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>Страна</dataPath>
							<field>Страна</field>
							<title xsi:type="v8:LocalStringType">
								<v8:item>
									<v8:lang>ru</v8:lang>
									<v8:content>Страна</v8:content>
								</v8:item>
							</title>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>ЕдиницаИзмерения</dataPath>
							<field>ЕдиницаИзмерения</field>
							<title xsi:type="v8:LocalStringType">
								<v8:item>
									<v8:lang>ru</v8:lang>
									<v8:content>Единица измерения</v8:content>
								</v8:item>
							</title>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>Номенклатура</dataPath>
							<field>Номенклатура</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>Цена</dataPath>
							<field>Цена</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>СерияНоменклатуры</dataPath>
							<field>СерияНоменклатуры</field>
							<title xsi:type="v8:LocalStringType">
								<v8:item>
									<v8:lang>ru</v8:lang>
									<v8:content>Серия номенклатуры</v8:content>
								</v8:item>
							</title>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>КодЕдиницыИзмерения</dataPath>
							<field>КодЕдиницыИзмерения</field>
							<title xsi:type="v8:LocalStringType">
								<v8:item>
									<v8:lang>ru</v8:lang>
									<v8:content>Код единицы измерения</v8:content>
								</v8:item>
							</title>
						</field>
						<dataSource>ИсточникДанных1</dataSource>
						<query>ВЫБРАТЬ
	ВозвратТоваровОтПокупателяТовары.НомерСтроки,
	ВозвратТоваровОтПокупателяТовары.Номенклатура,
	Неопределено КАК ХарактеристикаНоменклатуры,
	ВозвратТоваровОтПокупателяТовары.Номенклатура.ЕдиницаИзмерения КАК ЕдиницаИзмерения,
	ВозвратТоваровОтПокупателяТовары.Номенклатура.ЕдиницаИзмерения.Код КАК КодЕдиницыИзмерения,
	ВЫРАЗИТЬ(ВозвратТоваровОтПокупателяТовары.Номенклатура.Наименование КАК СТРОКА(178)) КАК Наименование,
	ВЫРАЗИТЬ(ВозвратТоваровОтПокупателяТовары.Номенклатура.НаименованиеПолное КАК СТРОКА(500)) КАК НаименованиеПолное,
	ВозвратТоваровОтПокупателяТовары.Цена,
	ВозвратТоваровОтПокупателяТовары.СтавкаНДС,
	Неопределено КАК СерияНоменклатуры,
	ВЫБОР
		КОГДА ВозвратТоваровОтПокупателяТовары.СтранаПроисхождения = ЗНАЧЕНИЕ(Справочник.СтраныМира.ПустаяСсылка)
			ТОГДА ВозвратТоваровОтПокупателяТовары.Номенклатура.СтранаПроисхождения
		ИНАЧЕ ВозвратТоваровОтПокупателяТовары.СтранаПроисхождения
	КОНЕЦ КАК Страна,
	ЕСТЬNULL(ВозвратТоваровОтПокупателяТовары.НомерГТД.Код, ЕСТЬNULL(ВозвратТоваровОтПокупателяТовары.Номенклатура.НомерГТД.Код, "")) КАК НомерГТД,
	ВозвратТоваровОтПокупателяТовары.Количество,
	ВозвратТоваровОтПокупателяТовары.Сумма,
	ВозвратТоваровОтПокупателяТовары.СуммаНДС,
	"" КАК ТипЕдиницы
ИЗ
	Документ.ВозвратТоваровОтПокупателя.Товары КАК ВозвратТоваровОтПокупателяТовары
ГДЕ
	ВозвратТоваровОтПокупателяТовары.Ссылка В(&amp;Ссылка)</query>
					</item>
					<item xsi:type="DataSetQuery">
						<name>ПоступлениеТоваровУслуг</name>
						<field xsi:type="DataSetFieldField">
							<dataPath>СуммаНДС</dataPath>
							<field>СуммаНДС</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>НомерСтроки</dataPath>
							<field>НомерСтроки</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>Сумма</dataPath>
							<field>Сумма</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>Наименование</dataPath>
							<field>Наименование</field>
							<title xsi:type="v8:LocalStringType">
								<v8:item>
									<v8:lang>ru</v8:lang>
									<v8:content>Наименование</v8:content>
								</v8:item>
							</title>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>НаименованиеПолное</dataPath>
							<field>НаименованиеПолное</field>
							<title xsi:type="v8:LocalStringType">
								<v8:item>
									<v8:lang>ru</v8:lang>
									<v8:content>Наименование полное</v8:content>
								</v8:item>
							</title>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>СтавкаНДС</dataPath>
							<field>СтавкаНДС</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>ХарактеристикаНоменклатуры</dataPath>
							<field>ХарактеристикаНоменклатуры</field>
							<title xsi:type="v8:LocalStringType">
								<v8:item>
									<v8:lang>ru</v8:lang>
									<v8:content>Характеристика номенклатуры</v8:content>
								</v8:item>
							</title>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>НомерГТД</dataPath>
							<field>НомерГТД</field>
							<title xsi:type="v8:LocalStringType">
								<v8:item>
									<v8:lang>ru</v8:lang>
									<v8:content>Номер ГТД</v8:content>
								</v8:item>
							</title>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>ТипЕдиницы</dataPath>
							<field>ТипЕдиницы</field>
							<title xsi:type="v8:LocalStringType">
								<v8:item>
									<v8:lang>ru</v8:lang>
									<v8:content>Тип единицы</v8:content>
								</v8:item>
							</title>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>Количество</dataPath>
							<field>Количество</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>Страна</dataPath>
							<field>Страна</field>
							<title xsi:type="v8:LocalStringType">
								<v8:item>
									<v8:lang>ru</v8:lang>
									<v8:content>Страна</v8:content>
								</v8:item>
							</title>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>ЕдиницаИзмерения</dataPath>
							<field>ЕдиницаИзмерения</field>
							<title xsi:type="v8:LocalStringType">
								<v8:item>
									<v8:lang>ru</v8:lang>
									<v8:content>Единица измерения</v8:content>
								</v8:item>
							</title>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>Номенклатура</dataPath>
							<field>Номенклатура</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>Цена</dataPath>
							<field>Цена</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>СерияНоменклатуры</dataPath>
							<field>СерияНоменклатуры</field>
							<title xsi:type="v8:LocalStringType">
								<v8:item>
									<v8:lang>ru</v8:lang>
									<v8:content>Серия номенклатуры</v8:content>
								</v8:item>
							</title>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>КодЕдиницыИзмерения</dataPath>
							<field>КодЕдиницыИзмерения</field>
							<title xsi:type="v8:LocalStringType">
								<v8:item>
									<v8:lang>ru</v8:lang>
									<v8:content>Код единицы измерения</v8:content>
								</v8:item>
							</title>
						</field>
						<dataSource>ИсточникДанных1</dataSource>
						<query>ВЫБРАТЬ
	ПоступлениеТоваровУслугТовары.НомерСтроки,
	ПоступлениеТоваровУслугТовары.Номенклатура,
	НЕОПРЕДЕЛЕНО КАК ХарактеристикаНоменклатуры,
	ВЫБОР
		КОГДА ПоступлениеТоваровУслугТовары.ЕдиницаИзмерения = ЗНАЧЕНИЕ(Справочник.КлассификаторЕдиницИзмерения.ПустаяСсылка)
			ТОГДА ПоступлениеТоваровУслугТовары.Номенклатура.ЕдиницаИзмерения
		ИНАЧЕ ПоступлениеТоваровУслугТовары.ЕдиницаИзмерения
	КОНЕЦ КАК ЕдиницаИзмерения,
	ВЫРАЗИТЬ(ВЫБОР
			КОГДА ПоступлениеТоваровУслугТовары.ЕдиницаИзмерения = ЗНАЧЕНИЕ(Справочник.КлассификаторЕдиницИзмерения.ПустаяСсылка)
				ТОГДА ПоступлениеТоваровУслугТовары.Номенклатура.ЕдиницаИзмерения
			ИНАЧЕ ПоступлениеТоваровУслугТовары.ЕдиницаИзмерения
		КОНЕЦ КАК Справочник.КлассификаторЕдиницИзмерения).Наименование КАК КодЕдиницыИзмерения,
	ВЫРАЗИТЬ(ПоступлениеТоваровУслугТовары.Номенклатура.Наименование КАК СТРОКА(178)) КАК Наименование,
	ВЫРАЗИТЬ(ПоступлениеТоваровУслугТовары.Номенклатура.НаименованиеПолное КАК СТРОКА(500)) КАК НаименованиеПолное,
	ПоступлениеТоваровУслугТовары.Цена,
	ПоступлениеТоваровУслугТовары.СтавкаНДС,
	НЕОПРЕДЕЛЕНО КАК СерияНоменклатуры,
	ВЫБОР
		КОГДА ПоступлениеТоваровУслугТовары.СтранаПроисхождения = ЗНАЧЕНИЕ(Справочник.СтраныМира.ПустаяСсылка)
			ТОГДА ПоступлениеТоваровУслугТовары.Номенклатура.СтранаПроисхождения
		ИНАЧЕ ПоступлениеТоваровУслугТовары.СтранаПроисхождения
	КОНЕЦ КАК Страна,
	ЕСТЬNULL(ПоступлениеТоваровУслугТовары.НомерГТД.Код, ЕСТЬNULL(ПоступлениеТоваровУслугТовары.Номенклатура.НомерГТД.Код, "")) КАК НомерГТД,
	ПоступлениеТоваровУслугТовары.Количество,
	ПоступлениеТоваровУслугТовары.Сумма,
	ПоступлениеТоваровУслугТовары.СуммаНДС,
	"" КАК ТипЕдиницы
ИЗ
	Документ.ПоступлениеТоваровУслуг.Товары КАК ПоступлениеТоваровУслугТовары
ГДЕ
	ПоступлениеТоваровУслугТовары.Ссылка В(&amp;Ссылка)</query>
					</item>
				</item>
				<item xsi:type="DataSetUnion">
					<name>_COINVOIC_IINVOIC_</name>
					<field xsi:type="DataSetFieldField">
						<dataPath>ЕдиницаИзмерения</dataPath>
						<field>ЕдиницаИзмерения</field>
					</field>
					<field xsi:type="DataSetFieldField">
						<dataPath>Количество</dataPath>
						<field>Количество</field>
					</field>
					<field xsi:type="DataSetFieldField">
						<dataPath>КоличествоДоКорректировки</dataPath>
						<field>КоличествоДоКорректировки</field>
					</field>
					<field xsi:type="DataSetFieldField">
						<dataPath>Номенклатура</dataPath>
						<field>Номенклатура</field>
					</field>
					<field xsi:type="DataSetFieldField">
						<dataPath>НомерГТД</dataPath>
						<field>НомерГТД</field>
					</field>
					<field xsi:type="DataSetFieldField">
						<dataPath>СерияНоменклатуры</dataPath>
						<field>СерияНоменклатуры</field>
					</field>
					<field xsi:type="DataSetFieldField">
						<dataPath>СтавкаНДС</dataPath>
						<field>СтавкаНДС</field>
					</field>
					<field xsi:type="DataSetFieldField">
						<dataPath>СтавкаНДСДоКорректировки</dataPath>
						<field>СтавкаНДСДоКорректировки</field>
					</field>
					<field xsi:type="DataSetFieldField">
						<dataPath>Страна</dataPath>
						<field>Страна</field>
					</field>
					<field xsi:type="DataSetFieldField">
						<dataPath>Сумма</dataPath>
						<field>Сумма</field>
					</field>
					<field xsi:type="DataSetFieldField">
						<dataPath>СуммаДоКорректировки</dataPath>
						<field>СуммаДоКорректировки</field>
					</field>
					<field xsi:type="DataSetFieldField">
						<dataPath>СуммаНДС</dataPath>
						<field>СуммаНДС</field>
					</field>
					<field xsi:type="DataSetFieldField">
						<dataPath>СуммаНДСДоКорректировки</dataPath>
						<field>СуммаНДСДоКорректировки</field>
					</field>
					<field xsi:type="DataSetFieldField">
						<dataPath>ТипЕдиницы</dataPath>
						<field>ТипЕдиницы</field>
					</field>
					<field xsi:type="DataSetFieldField">
						<dataPath>ХарактеристикаНоменклатуры</dataPath>
						<field>ХарактеристикаНоменклатуры</field>
					</field>
					<field xsi:type="DataSetFieldField">
						<dataPath>Цена</dataPath>
						<field>Цена</field>
					</field>
					<field xsi:type="DataSetFieldField">
						<dataPath>ЦенаДоКорректировки</dataPath>
						<field>ЦенаДоКорректировки</field>
					</field>
					<field xsi:type="DataSetFieldField">
						<dataPath>Наименование</dataPath>
						<field>Наименование</field>
						<title xsi:type="v8:LocalStringType">
							<v8:item>
								<v8:lang>ru</v8:lang>
								<v8:content>Наименование</v8:content>
							</v8:item>
						</title>
					</field>
					<field xsi:type="DataSetFieldField">
						<dataPath>НаименованиеПолное</dataPath>
						<field>НаименованиеПолное</field>
						<title xsi:type="v8:LocalStringType">
							<v8:item>
								<v8:lang>ru</v8:lang>
								<v8:content>Наименование полное</v8:content>
							</v8:item>
						</title>
					</field>
					<item xsi:type="DataSetQuery">
						<name>КорректировкаРеализации</name>
						<field xsi:type="DataSetFieldField">
							<dataPath>ЕдиницаИзмерения</dataPath>
							<field>ЕдиницаИзмерения</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>Количество</dataPath>
							<field>Количество</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>КоличествоДоКорректировки</dataPath>
							<field>КоличествоДоКорректировки</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>Номенклатура</dataPath>
							<field>Номенклатура</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>НомерГТД</dataPath>
							<field>НомерГТД</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>СерияНоменклатуры</dataPath>
							<field>СерияНоменклатуры</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>СтавкаНДС</dataPath>
							<field>СтавкаНДС</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>СтавкаНДСДоКорректировки</dataPath>
							<field>СтавкаНДСДоКорректировки</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>Страна</dataPath>
							<field>Страна</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>Сумма</dataPath>
							<field>Сумма</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>СуммаДоКорректировки</dataPath>
							<field>СуммаДоКорректировки</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>СуммаНДС</dataPath>
							<field>СуммаНДС</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>СуммаНДСДоКорректировки</dataPath>
							<field>СуммаНДСДоКорректировки</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>ТипЕдиницы</dataPath>
							<field>ТипЕдиницы</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>ХарактеристикаНоменклатуры</dataPath>
							<field>ХарактеристикаНоменклатуры</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>Цена</dataPath>
							<field>Цена</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>ЦенаДоКорректировки</dataPath>
							<field>ЦенаДоКорректировки</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>Наименование</dataPath>
							<field>Наименование</field>
							<title xsi:type="v8:LocalStringType">
								<v8:item>
									<v8:lang>ru</v8:lang>
									<v8:content>Наименование</v8:content>
								</v8:item>
							</title>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>НаименованиеПолное</dataPath>
							<field>НаименованиеПолное</field>
							<title xsi:type="v8:LocalStringType">
								<v8:item>
									<v8:lang>ru</v8:lang>
									<v8:content>Наименование полное</v8:content>
								</v8:item>
							</title>
						</field>
						<dataSource>ИсточникДанных1</dataSource>
						<query>ВЫБРАТЬ
	КорректировкаРеализацииТовары.Номенклатура КАК Номенклатура,
	НЕОПРЕДЕЛЕНО КАК ХарактеристикаНоменклатуры,
	КорректировкаРеализацииТовары.Номенклатура.ЕдиницаИзмерения КАК ЕдиницаИзмерения,
	ВЫРАЗИТЬ(КорректировкаРеализацииТовары.Номенклатура.Наименование КАК СТРОКА(178)) КАК НоменклатураНаименование,
	ПОДСТРОКА(КорректировкаРеализацииТовары.Номенклатура.НаименованиеПолное, 0, 500) КАК НоменклатураНаименованиеПолное,
	МАКСИМУМ(КорректировкаРеализацииТовары.Цена) КАК Цена,
	КорректировкаРеализацииТовары.ЦенаДоКорректировки КАК ЦенаДоКорректировки,
	КорректировкаРеализацииТовары.СтавкаНДС КАК СтавкаНДС,
	КорректировкаРеализацииТовары.СтавкаНДСДоИзменения КАК СтавкаНДСДоКорректировки,
	НЕОПРЕДЕЛЕНО КАК СерияНоменклатуры,
	ВЫБОР
		КОГДА &amp;ТипСообщения = "INVOIC"
			ТОГДА ВЫБОР
					КОГДА ЕСТЬNULL(КорректировкаРеализацииТовары.СтранаПроисхождения, ЗНАЧЕНИЕ(Справочник.СтраныМира.ПустаяСсылка)) = ЗНАЧЕНИЕ(Справочник.СтраныМира.ПустаяСсылка)
						ТОГДА ЕСТЬNULL(КорректировкаРеализацииТовары.Номенклатура.СтранаПроисхождения, ЗНАЧЕНИЕ(Справочник.СтраныМира.ПустаяСсылка))
					ИНАЧЕ КорректировкаРеализацииТовары.СтранаПроисхождения
				КОНЕЦ
		ИНАЧЕ ЗНАЧЕНИЕ(Справочник.СтраныМира.ПустаяСсылка)
	КОНЕЦ КАК Страна,
	ВЫБОР
		КОГДА &amp;ТипСообщения = "INVOIC"
			ТОГДА ВЫБОР
					КОГДА ЕСТЬNULL(КорректировкаРеализацииТовары.НомерГТД, ЗНАЧЕНИЕ(Справочник.НомераГТД.ПустаяСсылка)) = ЗНАЧЕНИЕ(Справочник.НомераГТД.ПустаяСсылка)
						ТОГДА ЕСТЬNULL(КорректировкаРеализацииТовары.Номенклатура.НомерГТД, ЗНАЧЕНИЕ(Справочник.НомераГТД.ПустаяСсылка))
					ИНАЧЕ КорректировкаРеализацииТовары.НомерГТД
				КОНЕЦ
		ИНАЧЕ ЗНАЧЕНИЕ(Справочник.НомераГТД.ПустаяСсылка)
	КОНЕЦ КАК НомерГТД,
	СУММА(КорректировкаРеализацииТовары.Количество) КАК Количество,
	СУММА(КорректировкаРеализацииТовары.КоличествоДоКорректировки) КАК КоличествоДоКорректировки,
	СУММА(КорректировкаРеализацииТовары.Сумма) КАК Сумма,
	СУММА(КорректировкаРеализацииТовары.СуммаДоКорректировки) КАК СуммаДоКорректировки,
	СУММА(КорректировкаРеализацииТовары.СуммаНДС) КАК СуммаНДС,
	СУММА(КорректировкаРеализацииТовары.СуммаНДСДоКорректировки) КАК СуммаНДСДоКорректировки,
	ВЫБОР
		КОГДА КорректировкаРеализацииТовары.Номенклатура.Услуга
			ТОГДА "Services"
		ИНАЧЕ ""
	КОНЕЦ КАК ТипЕдиницы
ПОМЕСТИТЬ табКорректировки
ИЗ
	Документ.КорректировкаРеализации.Товары КАК КорректировкаРеализацииТовары
ГДЕ
	КорректировкаРеализацииТовары.Ссылка = &amp;Ссылка

СГРУППИРОВАТЬ ПО
	КорректировкаРеализацииТовары.Номенклатура,
	КорректировкаРеализацииТовары.Номенклатура.ЕдиницаИзмерения,
	ВЫРАЗИТЬ(КорректировкаРеализацииТовары.Номенклатура.Наименование КАК СТРОКА(178)),
	ПОДСТРОКА(КорректировкаРеализацииТовары.Номенклатура.НаименованиеПолное, 0, 500),
	КорректировкаРеализацииТовары.СтавкаНДС,
	КорректировкаРеализацииТовары.СтавкаНДСДоИзменения,
	ВЫБОР
		КОГДА КорректировкаРеализацииТовары.Номенклатура.Услуга
			ТОГДА "Services"
		ИНАЧЕ ""
	КОНЕЦ,
	ВЫБОР
		КОГДА &amp;ТипСообщения = "INVOIC"
			ТОГДА ВЫБОР
					КОГДА ЕСТЬNULL(КорректировкаРеализацииТовары.СтранаПроисхождения, ЗНАЧЕНИЕ(Справочник.СтраныМира.ПустаяСсылка)) = ЗНАЧЕНИЕ(Справочник.СтраныМира.ПустаяСсылка)
						ТОГДА ЕСТЬNULL(КорректировкаРеализацииТовары.Номенклатура.СтранаПроисхождения, ЗНАЧЕНИЕ(Справочник.СтраныМира.ПустаяСсылка))
					ИНАЧЕ КорректировкаРеализацииТовары.СтранаПроисхождения
				КОНЕЦ
		ИНАЧЕ ЗНАЧЕНИЕ(Справочник.СтраныМира.ПустаяСсылка)
	КОНЕЦ,
	ВЫБОР
		КОГДА &amp;ТипСообщения = "INVOIC"
			ТОГДА ВЫБОР
					КОГДА ЕСТЬNULL(КорректировкаРеализацииТовары.НомерГТД, ЗНАЧЕНИЕ(Справочник.НомераГТД.ПустаяСсылка)) = ЗНАЧЕНИЕ(Справочник.НомераГТД.ПустаяСсылка)
						ТОГДА ЕСТЬNULL(КорректировкаРеализацииТовары.Номенклатура.НомерГТД, ЗНАЧЕНИЕ(Справочник.НомераГТД.ПустаяСсылка))
					ИНАЧЕ КорректировкаРеализацииТовары.НомерГТД
				КОНЕЦ
		ИНАЧЕ ЗНАЧЕНИЕ(Справочник.НомераГТД.ПустаяСсылка)
	КОНЕЦ,
	КорректировкаРеализацииТовары.ЦенаДоКорректировки

ОБЪЕДИНИТЬ ВСЕ

ВЫБРАТЬ
	КорректировкаРеализацииУслуги.Номенклатура,
	НЕОПРЕДЕЛЕНО,
	КорректировкаРеализацииУслуги.Номенклатура.ЕдиницаИзмерения,
	ВЫРАЗИТЬ(КорректировкаРеализацииУслуги.Номенклатура.Наименование КАК СТРОКА(178)),
	ПОДСТРОКА(КорректировкаРеализацииУслуги.Номенклатура.НаименованиеПолное, 0, 500),
	МАКСИМУМ(КорректировкаРеализацииУслуги.Цена),
	КорректировкаРеализацииУслуги.ЦенаДоКорректировки,
	КорректировкаРеализацииУслуги.СтавкаНДС,
	КорректировкаРеализацииУслуги.СтавкаНДС,
	НЕОПРЕДЕЛЕНО,
	NULL,
	NULL,
	СУММА(КорректировкаРеализацииУслуги.Количество),
	СУММА(КорректировкаРеализацииУслуги.КоличествоДоКорректировки),
	СУММА(КорректировкаРеализацииУслуги.Сумма),
	СУММА(КорректировкаРеализацииУслуги.СуммаДоКорректировки),
	СУММА(КорректировкаРеализацииУслуги.СуммаНДС),
	СУММА(КорректировкаРеализацииУслуги.СуммаНДСДоКорректировки),
	"Services"
ИЗ
	Документ.КорректировкаРеализации.Услуги КАК КорректировкаРеализацииУслуги
ГДЕ
	КорректировкаРеализацииУслуги.Ссылка = &amp;Ссылка

СГРУППИРОВАТЬ ПО
	КорректировкаРеализацииУслуги.Номенклатура,
	КорректировкаРеализацииУслуги.Номенклатура.ЕдиницаИзмерения,
	ВЫРАЗИТЬ(КорректировкаРеализацииУслуги.Номенклатура.Наименование КАК СТРОКА(178)),
	ПОДСТРОКА(КорректировкаРеализацииУслуги.Номенклатура.НаименованиеПолное, 0, 500),
	КорректировкаРеализацииУслуги.СтавкаНДС,
	КорректировкаРеализацииУслуги.ЦенаДоКорректировки,
	КорректировкаРеализацииУслуги.СтавкаНДС
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ
	табКорректировки.Номенклатура КАК Номенклатура,
	табКорректировки.ХарактеристикаНоменклатуры КАК ХарактеристикаНоменклатуры,
	табКорректировки.ЕдиницаИзмерения КАК ЕдиницаИзмерения,
	табКорректировки.НоменклатураНаименование КАК Наименование,
	табКорректировки.НоменклатураНаименованиеПолное КАК НаименованиеПолное,
	табКорректировки.СтавкаНДС КАК СтавкаНДС,
	табКорректировки.СтавкаНДСДоКорректировки КАК СтавкаНДСДоКорректировки,
	табКорректировки.СерияНоменклатуры КАК СерияНоменклатуры,
	табКорректировки.Страна КАК Страна,
	табКорректировки.НомерГТД КАК НомерГТД,
	табКорректировки.Количество КАК Количество,
	табКорректировки.КоличествоДоКорректировки КАК КоличествоДоКорректировки,
	табКорректировки.Сумма КАК Сумма,
	табКорректировки.СуммаДоКорректировки КАК СуммаДоКорректировки,
	табКорректировки.СуммаНДС КАК СуммаНДС,
	табКорректировки.СуммаНДСДоКорректировки КАК СуммаНДСДоКорректировки,
	табКорректировки.ТипЕдиницы КАК ТипЕдиницы,
	ВЫБОР
		КОГДА НЕ ЕСТЬNULL(табКорректировки.Цена, 0) = 0
			ТОГДА табКорректировки.Цена
		КОГДА НЕ табКорректировки.Количество = 0
			ТОГДА табКорректировки.Сумма / табКорректировки.Количество
		ИНАЧЕ 0
	КОНЕЦ КАК Цена,
	табКорректировки.ЦенаДоКорректировки КАК ЦенаДоКорректировки
ИЗ
	табКорректировки КАК табКорректировки</query>
					</item>
				</item>
				<item xsi:type="DataSetUnion">
					<name>_PRICELIST_</name>
					<field xsi:type="DataSetFieldField">
						<dataPath>GTIN</dataPath>
						<field>GTIN</field>
					</field>
					<field xsi:type="DataSetFieldField">
						<dataPath>ЕдИзмСрокаГодности</dataPath>
						<field>ЕдИзмСрокаГодности</field>
					</field>
					<field xsi:type="DataSetFieldField">
						<dataPath>ЕдиницаИзмерения</dataPath>
						<field>ЕдиницаИзмерения</field>
					</field>
					<field xsi:type="DataSetFieldField">
						<dataPath>КвантПоставки</dataPath>
						<field>КвантПоставки</field>
					</field>
					<field xsi:type="DataSetFieldField">
						<dataPath>КодТовараПоставщика</dataPath>
						<field>КодТовараПоставщика</field>
					</field>
					<field xsi:type="DataSetFieldField">
						<dataPath>КоличествоВОдномМесте</dataPath>
						<field>КоличествоВОдномМесте</field>
					</field>
					<field xsi:type="DataSetFieldField">
						<dataPath>Наименование</dataPath>
						<field>Наименование</field>
					</field>
					<field xsi:type="DataSetFieldField">
						<dataPath>Номенклатура</dataPath>
						<field>Номенклатура</field>
					</field>
					<field xsi:type="DataSetFieldField">
						<dataPath>Родитель</dataPath>
						<field>Родитель</field>
					</field>
					<field xsi:type="DataSetFieldField">
						<dataPath>СрокГодности</dataPath>
						<field>СрокГодности</field>
					</field>
					<field xsi:type="DataSetFieldField">
						<dataPath>СтавкаНДС</dataPath>
						<field>СтавкаНДС</field>
					</field>
					<field xsi:type="DataSetFieldField">
						<dataPath>Страна</dataPath>
						<field>Страна</field>
					</field>
					<field xsi:type="DataSetFieldField">
						<dataPath>Цена</dataPath>
						<field>Цена</field>
					</field>
					<field xsi:type="DataSetFieldField">
						<dataPath>РекомендуемаяРозничнаяЦена</dataPath>
						<field>РекомендуемаяРозничнаяЦена</field>
						<title xsi:type="v8:LocalStringType">
							<v8:item>
								<v8:lang>ru</v8:lang>
								<v8:content>Рекомендуемая розничная цена</v8:content>
							</v8:item>
						</title>
					</field>
					<field xsi:type="DataSetFieldField">
						<dataPath>КоличествоОстаткаНаКонец</dataPath>
						<field>КоличествоОстаткаНаКонец</field>
						<title xsi:type="v8:LocalStringType">
							<v8:item>
								<v8:lang>ru</v8:lang>
								<v8:content>Количество остатка на конец</v8:content>
							</v8:item>
						</title>
					</field>
					<item xsi:type="DataSetQuery">
						<name>Ценовой_лист_БезЦен</name>
						<field xsi:type="DataSetFieldField">
							<dataPath>GTIN</dataPath>
							<field>GTIN</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>ЕдИзмСрокаГодности</dataPath>
							<field>ЕдИзмСрокаГодности</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>ЕдиницаИзмерения</dataPath>
							<field>ЕдиницаИзмерения</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>КвантПоставки</dataPath>
							<field>КвантПоставки</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>КодТовараПоставщика</dataPath>
							<field>КодТовараПоставщика</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>КоличествоВОдномМесте</dataPath>
							<field>КоличествоВОдномМесте</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>Наименование</dataPath>
							<field>Наименование</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>Номенклатура</dataPath>
							<field>Номенклатура</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>Родитель</dataPath>
							<field>Родитель</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>СрокГодности</dataPath>
							<field>СрокГодности</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>СтавкаНДС</dataPath>
							<field>СтавкаНДС</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>Страна</dataPath>
							<field>Страна</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>Цена</dataPath>
							<field>Цена</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>РекомендуемаяРозничнаяЦена</dataPath>
							<field>РекомендуемаяРозничнаяЦена</field>
							<title xsi:type="v8:LocalStringType">
								<v8:item>
									<v8:lang>ru</v8:lang>
									<v8:content>Рекомендуемая розничная цена</v8:content>
								</v8:item>
							</title>
						</field>
						<dataSource>ИсточникДанных1</dataSource>
						<query>ВЫБРАТЬ
	СправочникНоменклатура.Родитель КАК Родитель,
	СправочникНоменклатура.Ссылка КАК Номенклатура,
	СправочникНоменклатура.ЕдиницаИзмерения КАК ЕдиницаИзмерения,
	СправочникНоменклатура.Код КАК КодТовараПоставщика,
	СправочникНоменклатура.НаименованиеПолное КАК Наименование,
	СправочникНоменклатура.СтавкаНДС КАК СтавкаНДС,
	0 КАК Цена,
	0 КАК РекомендуемаяРозничнаяЦена,
	NULL КАК GTIN,
	NULL КАК КоличествоВОдномМесте,
	СправочникНоменклатура.СтранаПроисхождения КАК Страна,
	NULL КАК КвантПоставки,
	NULL КАК ЕдИзмСрокаГодности,
	NULL КАК СрокГодности
ИЗ
	Справочник.Номенклатура КАК СправочникНоменклатура
ГДЕ
	НЕ СправочникНоменклатура.ЭтоГруппа
	И НЕ СправочникНоменклатура.ПометкаУдаления
	И НЕ СправочникНоменклатура.Услуга
	И &amp;УсловиеОтбораНоменклатуры</query>
					</item>
					<item xsi:type="DataSetQuery">
						<name>Ценовой_лист_СЦенами</name>
						<field xsi:type="DataSetFieldField">
							<dataPath>GTIN</dataPath>
							<field>GTIN</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>ЕдИзмСрокаГодности</dataPath>
							<field>ЕдИзмСрокаГодности</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>ЕдиницаИзмерения</dataPath>
							<field>ЕдиницаИзмерения</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>КвантПоставки</dataPath>
							<field>КвантПоставки</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>КодТовараПоставщика</dataPath>
							<field>КодТовараПоставщика</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>КоличествоВОдномМесте</dataPath>
							<field>КоличествоВОдномМесте</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>Наименование</dataPath>
							<field>Наименование</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>Номенклатура</dataPath>
							<field>Номенклатура</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>Родитель</dataPath>
							<field>Родитель</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>СрокГодности</dataPath>
							<field>СрокГодности</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>СтавкаНДС</dataPath>
							<field>СтавкаНДС</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>Страна</dataPath>
							<field>Страна</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>Цена</dataPath>
							<field>Цена</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>РекомендуемаяРозничнаяЦена</dataPath>
							<field>РекомендуемаяРозничнаяЦена</field>
							<title xsi:type="v8:LocalStringType">
								<v8:item>
									<v8:lang>ru</v8:lang>
									<v8:content>Рекомендуемая розничная цена</v8:content>
								</v8:item>
							</title>
						</field>
						<dataSource>ИсточникДанных1</dataSource>
						<query>ВЫБРАТЬ
	ЦеныНоменклатурыСрезПоследних.Номенклатура.Родитель КАК Родитель,
	ЦеныНоменклатурыСрезПоследних.Номенклатура.Ссылка КАК Номенклатура,
	ЦеныНоменклатурыСрезПоследних.Номенклатура.ЕдиницаИзмерения КАК ЕдиницаИзмерения,
	ЦеныНоменклатурыСрезПоследних.Номенклатура.Код КАК КодТовараПоставщика,
	ЦеныНоменклатурыСрезПоследних.Номенклатура.НаименованиеПолное КАК Наименование,
	ЦеныНоменклатурыСрезПоследних.Номенклатура.СтавкаНДС КАК СтавкаНДС,
	ЦеныНоменклатурыСрезПоследних.Цена,
	0 КАК РекомендуемаяРозничнаяЦена,
	NULL КАК GTIN,
	NULL КАК КоличествоВОдномМесте,
	ЦеныНоменклатурыСрезПоследних.Номенклатура.СтранаПроисхождения КАК Страна,
	NULL КАК КвантПоставки,
	NULL КАК ЕдИзмСрокаГодности,
	NULL КАК СрокГодности
ИЗ
	РегистрСведений.ЦеныНоменклатуры.СрезПоследних(
			,
			ТипЦен = &amp;ТипЦен
				И НЕ Номенклатура.ПометкаУдаления
				И НЕ Номенклатура.Услуга
				И &amp;УсловиеОтбораНоменклатуры) КАК ЦеныНоменклатурыСрезПоследних
ГДЕ
	ЦеныНоменклатурыСрезПоследних.Цена &gt; 0</query>
					</item>
					<item xsi:type="DataSetQuery">
						<name>Ценовой_лист_БезЦен_Остатки</name>
						<field xsi:type="DataSetFieldField">
							<dataPath>GTIN</dataPath>
							<field>GTIN</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>ЕдИзмСрокаГодности</dataPath>
							<field>ЕдИзмСрокаГодности</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>ЕдиницаИзмерения</dataPath>
							<field>ЕдиницаИзмерения</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>КвантПоставки</dataPath>
							<field>КвантПоставки</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>КодТовараПоставщика</dataPath>
							<field>КодТовараПоставщика</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>КоличествоВОдномМесте</dataPath>
							<field>КоличествоВОдномМесте</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>Наименование</dataPath>
							<field>Наименование</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>Номенклатура</dataPath>
							<field>Номенклатура</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>Родитель</dataPath>
							<field>Родитель</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>СрокГодности</dataPath>
							<field>СрокГодности</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>СтавкаНДС</dataPath>
							<field>СтавкаНДС</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>Страна</dataPath>
							<field>Страна</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>Цена</dataPath>
							<field>Цена</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>КоличествоОстаткаНаКонец</dataPath>
							<field>КоличествоОстаткаНаКонец</field>
							<title xsi:type="v8:LocalStringType">
								<v8:item>
									<v8:lang>ru</v8:lang>
									<v8:content>Количество остатка на конец</v8:content>
								</v8:item>
							</title>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>РекомендуемаяРозничнаяЦена</dataPath>
							<field>РекомендуемаяРозничнаяЦена</field>
							<title xsi:type="v8:LocalStringType">
								<v8:item>
									<v8:lang>ru</v8:lang>
									<v8:content>Рекомендуемая розничная цена</v8:content>
								</v8:item>
							</title>
						</field>
						<dataSource>ИсточникДанных1</dataSource>
						<query>ВЫБРАТЬ
	СправочникНоменклатура.Родитель КАК Родитель,
	СправочникНоменклатура.Ссылка КАК Номенклатура,
	СправочникНоменклатура.ЕдиницаИзмерения КАК ЕдиницаИзмерения,
	СправочникНоменклатура.Код КАК КодТовараПоставщика,
	СправочникНоменклатура.НаименованиеПолное КАК Наименование,
	СправочникНоменклатура.СтавкаНДС КАК СтавкаНДС,
	0 КАК Цена,
	0 КАК РекомендуемаяРозничнаяЦена,
	NULL КАК GTIN,
	NULL КАК КоличествоВОдномМесте,
	СправочникНоменклатура.СтранаПроисхождения КАК Страна,
	NULL КАК КвантПоставки,
	NULL КАК ЕдИзмСрокаГодности,
	NULL КАК СрокГодности,
	0 КАК КоличествоОстаткаНаКонец
ИЗ
	Справочник.Номенклатура КАК СправочникНоменклатура
ГДЕ
	НЕ СправочникНоменклатура.ЭтоГруппа
	И НЕ СправочникНоменклатура.ПометкаУдаления
	И НЕ СправочникНоменклатура.Услуга
	И &amp;УсловиеОтбораНоменклатуры</query>
					</item>
					<item xsi:type="DataSetQuery">
						<name>Ценовой_лист_СЦенами_Остатки</name>
						<field xsi:type="DataSetFieldField">
							<dataPath>GTIN</dataPath>
							<field>GTIN</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>ЕдИзмСрокаГодности</dataPath>
							<field>ЕдИзмСрокаГодности</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>ЕдиницаИзмерения</dataPath>
							<field>ЕдиницаИзмерения</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>КвантПоставки</dataPath>
							<field>КвантПоставки</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>КодТовараПоставщика</dataPath>
							<field>КодТовараПоставщика</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>КоличествоВОдномМесте</dataPath>
							<field>КоличествоВОдномМесте</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>Наименование</dataPath>
							<field>Наименование</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>Номенклатура</dataPath>
							<field>Номенклатура</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>Родитель</dataPath>
							<field>Родитель</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>СрокГодности</dataPath>
							<field>СрокГодности</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>СтавкаНДС</dataPath>
							<field>СтавкаНДС</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>Страна</dataPath>
							<field>Страна</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>Цена</dataPath>
							<field>Цена</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>КоличествоОстаткаНаКонец</dataPath>
							<field>КоличествоОстаткаНаКонец</field>
							<title xsi:type="v8:LocalStringType">
								<v8:item>
									<v8:lang>ru</v8:lang>
									<v8:content>Количество остатка на конец</v8:content>
								</v8:item>
							</title>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>РекомендуемаяРозничнаяЦена</dataPath>
							<field>РекомендуемаяРозничнаяЦена</field>
							<title xsi:type="v8:LocalStringType">
								<v8:item>
									<v8:lang>ru</v8:lang>
									<v8:content>Рекомендуемая розничная цена</v8:content>
								</v8:item>
							</title>
						</field>
						<dataSource>ИсточникДанных1</dataSource>
						<query>ВЫБРАТЬ
	ЦеныНоменклатурыСрезПоследних.Номенклатура.Родитель КАК Родитель,
	ЦеныНоменклатурыСрезПоследних.Номенклатура.Ссылка КАК Номенклатура,
	ЦеныНоменклатурыСрезПоследних.Номенклатура.ЕдиницаИзмерения КАК ЕдиницаИзмерения,
	ЦеныНоменклатурыСрезПоследних.Номенклатура.Код КАК КодТовараПоставщика,
	ЦеныНоменклатурыСрезПоследних.Номенклатура.НаименованиеПолное КАК Наименование,
	ЦеныНоменклатурыСрезПоследних.Номенклатура.СтавкаНДС КАК СтавкаНДС,
	ЦеныНоменклатурыСрезПоследних.Цена,
	0 КАК РекомендуемаяРозничнаяЦена,
	NULL КАК GTIN,
	NULL КАК КоличествоВОдномМесте,
	ЦеныНоменклатурыСрезПоследних.Номенклатура.СтранаПроисхождения КАК Страна,
	NULL КАК КвантПоставки,
	NULL КАК ЕдИзмСрокаГодности,
	NULL КАК СрокГодности,
	0 КАК КоличествоОстаткаНаКонец
ИЗ
	РегистрСведений.ЦеныНоменклатуры.СрезПоследних(
			,
			ТипЦен = &amp;ТипЦен
				И НЕ Номенклатура.ПометкаУдаления
				И НЕ Номенклатура.Услуга
				И &amp;УсловиеОтбораНоменклатуры) КАК ЦеныНоменклатурыСрезПоследних
ГДЕ
	ЦеныНоменклатурыСрезПоследних.Цена &gt; 0</query>
					</item>
				</item>
			</item>
			<item xsi:type="DataSetUnion">
				<name>ЗапросПоCOINVOIC</name>
				<item xsi:type="DataSetQuery">
					<name>Счет_Реализация_СФ</name>
					<dataSource>ИсточникДанных1</dataSource>
					<query>ВЫБРАТЬ РАЗРЕШЕННЫЕ
	докКорректировка.Ссылка КАК Корректировка,
	ВЫБОР
		КОГДА НЕ докКорректировка.Проведен
			ТОГДА докКорректировка.Ссылка
		ИНАЧЕ ЕСТЬNULL(докСчетФактура.Ссылка, докКорректировка.Ссылка)
	КОНЕЦ КАК Документ,
	ВЫБОР
		КОГДА НЕ докКорректировка.Проведен
			ТОГДА "Провести Корректировка реализации"
		КОГДА докСчетФактура.Ссылка ЕСТЬ NULL 
			ТОГДА "Создать Счет-фактура по корректировке"
		КОГДА НЕ докСчетФактура.Ссылка.Проведен И &amp;ТребуетсяПроведениеCOINVOIC
			ТОГДА "Провести Счет-фактура по корректировке"
		КОГДА докСчетФактура.Ссылка.ВидСчетаФактуры &lt;&gt; ЗНАЧЕНИЕ(Перечисление.ВидСчетаФактурыВыставленного.Корректировочный)
			ТОГДА "Отправить счет-фактуру"
		ИНАЧЕ "Отправить корректировочный счет-фактуру"
	КОНЕЦ КАК ТребуемоеДействие,
	ВЫБОР
		КОГДА докСчетФактура.Ссылка.ВидСчетаФактуры &lt;&gt; ЗНАЧЕНИЕ(Перечисление.ВидСчетаФактурыВыставленного.Корректировочный)
			ТОГДА "INVOIC"
		ИНАЧЕ "COINVOIC"
	КОНЕЦ КАК ТипСообщения,
	докКорректировка.ДокументРеализации,
	ТаблицаКэшПартнеровКонтрагентов.Партнер
ПОМЕСТИТЬ табКорректировки
ИЗ
	ТаблицаКэшПартнеровКонтрагентов КАК ТаблицаКэшПартнеровКонтрагентов
		ВНУТРЕННЕЕ СОЕДИНЕНИЕ Документ.КорректировкаРеализации КАК докКорректировка
			ЛЕВОЕ СОЕДИНЕНИЕ Документ.СчетФактураВыданный.ДокументыОснования КАК докСчетФактура
				ЛЕВОЕ СОЕДИНЕНИЕ Справочник.КонтурEDI_Сообщения КАК КонтурEDI_Сообщения
				ПО (КонтурEDI_Сообщения.Документ = докСчетФактура.Ссылка)
					И (КонтурEDI_Сообщения.ТипСообщения = "COINVOIC"
						ИЛИ КонтурEDI_Сообщения.ТипСообщения = "INVOIC")
			ПО докКорректировка.Ссылка = докСчетФактура.ДокументОснование
				И (докСчетФактура.Ссылка.ПометкаУдаления = ЛОЖЬ)
		ПО ТаблицаКэшПартнеровКонтрагентов.Контрагент = докКорректировка.Контрагент
			И (ТаблицаКэшПартнеровКонтрагентов.COINVOIC = ИСТИНА)
ГДЕ
	НЕ докКорректировка.ПометкаУдаления
	И докКорректировка.Дата МЕЖДУ &amp;НачалоПериода И &amp;КонецПериода
	И (докКорректировка.ДокументРеализации ССЫЛКА Документ.РеализацияТоваровУслуг
			ИЛИ докКорректировка.ДокументРеализации ССЫЛКА Документ.КорректировкаРеализации)
	И ВЫБОР
			КОГДА &amp;ТолькоТребуемые
				ТОГДА КонтурEDI_Сообщения.Ссылка ЕСТЬ NULL 
			ИНАЧЕ ИСТИНА
		КОНЕЦ
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ РАЗРЕШЕННЫЕ
	табКорректировки.Корректировка,
	ЕСТЬNULL(СчетФактураВыданныйДокументыОснования.Ссылка, табКорректировки.ДокументРеализации) КАК ПредыдущийДокумент
ПОМЕСТИТЬ табПредыдущихДокументов
ИЗ
	табКорректировки КАК табКорректировки
		ВНУТРЕННЕЕ СОЕДИНЕНИЕ Документ.СчетФактураВыданный.ДокументыОснования КАК СчетФактураВыданныйДокументыОснования
		ПО табКорректировки.ДокументРеализации = СчетФактураВыданныйДокументыОснования.ДокументОснование
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ РАЗРЕШЕННЫЕ
	КонтурEDI_Сообщения.Ссылка КАК Сообщение,
	табПредыдущихДокументов.Корректировка,
	табПредыдущихДокументов.ПредыдущийДокумент
ПОМЕСТИТЬ табРазрешенийНаОтправку
ИЗ
	табПредыдущихДокументов КАК табПредыдущихДокументов
		ЛЕВОЕ СОЕДИНЕНИЕ Справочник.КонтурEDI_Сообщения КАК КонтурEDI_Сообщения
		ПО табПредыдущихДокументов.ПредыдущийДокумент = КонтурEDI_Сообщения.Документ
			И (НЕ КонтурEDI_Сообщения.Статус В (&amp;БлокирующиеСтатусыПервичногоINVOIC))
			И (КонтурEDI_Сообщения.ТипСообщения = "COINVOIC"
				ИЛИ КонтурEDI_Сообщения.ТипСообщения = "INVOIC")
ГДЕ
	ВЫБОР
			КОГДА &amp;ТолькоТребуемые
				ТОГДА КонтурEDI_Сообщения.Ссылка ЕСТЬ НЕ NULL 
			ИНАЧЕ ИСТИНА
		КОНЕЦ
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ РАЗРЕШЕННЫЕ
	табКорректировки.Корректировка,
	табКорректировки.Документ,
	табКорректировки.ТребуемоеДействие,
	табКорректировки.ТипСообщения,
	табРазрешенийНаОтправку.Сообщение,
	табКорректировки.Партнер,
	табРазрешенийНаОтправку.ПредыдущийДокумент
ПОМЕСТИТЬ ВТ_КоррИспрСФ
ИЗ
	табКорректировки КАК табКорректировки
		ЛЕВОЕ СОЕДИНЕНИЕ табРазрешенийНаОтправку КАК табРазрешенийНаОтправку
		ПО табКорректировки.Корректировка = табРазрешенийНаОтправку.Корректировка
ГДЕ
	ВЫБОР
			КОГДА &amp;ТолькоТребуемые
				ТОГДА табРазрешенийНаОтправку.Корректировка ЕСТЬ НЕ NULL 
			ИНАЧЕ ИСТИНА
		КОНЕЦ
;

////////////////////////////////////////////////////////////////////////////////
УНИЧТОЖИТЬ табКорректировки
;

////////////////////////////////////////////////////////////////////////////////
УНИЧТОЖИТЬ табПредыдущихДокументов
;

////////////////////////////////////////////////////////////////////////////////
УНИЧТОЖИТЬ табРазрешенийНаОтправку</query>
				</item>
				<item xsi:type="DataSetQuery">
					<name>Реализация_СФ</name>
					<dataSource>ИсточникДанных1</dataSource>
					<query>ВЫБРАТЬ РАЗРЕШЕННЫЕ
	докКорректировка.Ссылка КАК Корректировка,
	ВЫБОР
		КОГДА НЕ докКорректировка.Проведен
			ТОГДА докКорректировка.Ссылка
		ИНАЧЕ ЕСТЬNULL(докСчетФактура.Ссылка, докКорректировка.Ссылка)
	КОНЕЦ КАК Документ,
	ВЫБОР
		КОГДА НЕ докКорректировка.Проведен
			ТОГДА "Провести Корректировка реализации"
		КОГДА докСчетФактура.Ссылка ЕСТЬ NULL 
			ТОГДА "Создать Счет-фактура по корректировке"
		КОГДА НЕ докСчетФактура.Ссылка.Проведен И &amp;ТребуетсяПроведениеCOINVOIC
			ТОГДА "Провести Счет-фактура по корректировке"
		КОГДА докСчетФактура.Ссылка.ВидСчетаФактуры &lt;&gt; ЗНАЧЕНИЕ(Перечисление.ВидСчетаФактурыВыставленного.Корректировочный)
			ТОГДА "Отправить счет-фактуру"
		ИНАЧЕ "Отправить корректировочный счет-фактуру"
	КОНЕЦ КАК ТребуемоеДействие,
	ВЫБОР
		КОГДА докСчетФактура.Ссылка.ВидСчетаФактуры &lt;&gt; ЗНАЧЕНИЕ(Перечисление.ВидСчетаФактурыВыставленного.Корректировочный)
			ТОГДА "INVOIC"
		ИНАЧЕ "COINVOIC"
	КОНЕЦ КАК ТипСообщения,
	докКорректировка.ДокументРеализации,
	ТаблицаКэшПартнеровКонтрагентов.Партнер
ПОМЕСТИТЬ табКорректировки
ИЗ
	ТаблицаКэшПартнеровКонтрагентов КАК ТаблицаКэшПартнеровКонтрагентов
		ВНУТРЕННЕЕ СОЕДИНЕНИЕ Документ.КорректировкаРеализации КАК докКорректировка
			ЛЕВОЕ СОЕДИНЕНИЕ Документ.СчетФактураВыданный.ДокументыОснования КАК докСчетФактура
				ЛЕВОЕ СОЕДИНЕНИЕ Справочник.КонтурEDI_Сообщения КАК КонтурEDI_Сообщения
				ПО (КонтурEDI_Сообщения.Документ = докСчетФактура.Ссылка)
					И (КонтурEDI_Сообщения.ТипСообщения = "COINVOIC"
						ИЛИ КонтурEDI_Сообщения.ТипСообщения = "INVOIC")
			ПО докКорректировка.Ссылка = докСчетФактура.ДокументОснование
				И (докСчетФактура.Ссылка.ПометкаУдаления = ЛОЖЬ)
		ПО ТаблицаКэшПартнеровКонтрагентов.Контрагент = докКорректировка.Контрагент
			И (ТаблицаКэшПартнеровКонтрагентов.COINVOIC = ИСТИНА)
ГДЕ
	НЕ докКорректировка.ПометкаУдаления
	И докКорректировка.Дата МЕЖДУ &amp;НачалоПериода И &amp;КонецПериода
	И (докКорректировка.ДокументРеализации ССЫЛКА Документ.РеализацияТоваровУслуг
			ИЛИ докКорректировка.ДокументРеализации ССЫЛКА Документ.КорректировкаРеализации)
	И ВЫБОР
			КОГДА &amp;ТолькоТребуемые
				ТОГДА КонтурEDI_Сообщения.Ссылка ЕСТЬ NULL 
			ИНАЧЕ ИСТИНА
		КОНЕЦ
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ РАЗРЕШЕННЫЕ
	табКорректировки.Корректировка,
	ЕСТЬNULL(СчетФактураВыданныйДокументыОснования.Ссылка, табКорректировки.ДокументРеализации) КАК ПредыдущийДокумент
ПОМЕСТИТЬ табПредыдущихДокументов
ИЗ
	табКорректировки КАК табКорректировки
		ВНУТРЕННЕЕ СОЕДИНЕНИЕ Документ.СчетФактураВыданный.ДокументыОснования КАК СчетФактураВыданныйДокументыОснования
		ПО табКорректировки.ДокументРеализации = СчетФактураВыданныйДокументыОснования.ДокументОснование
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ РАЗРЕШЕННЫЕ
	КонтурEDI_Сообщения.Ссылка КАК Сообщение,
	табПредыдущихДокументов.Корректировка,
	табПредыдущихДокументов.ПредыдущийДокумент
ПОМЕСТИТЬ табРазрешенийНаОтправку
ИЗ
	табПредыдущихДокументов КАК табПредыдущихДокументов
		ЛЕВОЕ СОЕДИНЕНИЕ Справочник.КонтурEDI_Сообщения КАК КонтурEDI_Сообщения
		ПО табПредыдущихДокументов.ПредыдущийДокумент = КонтурEDI_Сообщения.Документ
			И (НЕ КонтурEDI_Сообщения.Статус В (&amp;БлокирующиеСтатусыПервичногоINVOIC))
			И (КонтурEDI_Сообщения.ТипСообщения = "COINVOIC"
				ИЛИ КонтурEDI_Сообщения.ТипСообщения = "INVOIC")
ГДЕ
	ВЫБОР
			КОГДА &amp;ТолькоТребуемые
				ТОГДА КонтурEDI_Сообщения.Ссылка ЕСТЬ НЕ NULL 
			ИНАЧЕ ИСТИНА
		КОНЕЦ
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ РАЗРЕШЕННЫЕ
	табКорректировки.Корректировка,
	табКорректировки.Документ,
	табКорректировки.ТребуемоеДействие,
	табКорректировки.ТипСообщения,
	табРазрешенийНаОтправку.Сообщение,
	табКорректировки.Партнер,
	табРазрешенийНаОтправку.ПредыдущийДокумент
ПОМЕСТИТЬ ВТ_КоррИспрСФ
ИЗ
	табКорректировки КАК табКорректировки
		ЛЕВОЕ СОЕДИНЕНИЕ табРазрешенийНаОтправку КАК табРазрешенийНаОтправку
		ПО табКорректировки.Корректировка = табРазрешенийНаОтправку.Корректировка
ГДЕ
	ВЫБОР
			КОГДА &amp;ТолькоТребуемые
				ТОГДА табРазрешенийНаОтправку.Корректировка ЕСТЬ НЕ NULL 
			ИНАЧЕ ИСТИНА
		КОНЕЦ
;

////////////////////////////////////////////////////////////////////////////////
УНИЧТОЖИТЬ табКорректировки
;

////////////////////////////////////////////////////////////////////////////////
УНИЧТОЖИТЬ табПредыдущихДокументов
;

////////////////////////////////////////////////////////////////////////////////
УНИЧТОЖИТЬ табРазрешенийНаОтправку</query>
				</item>
				<item xsi:type="DataSetQuery">
					<name>Счет_Реализация</name>
					<dataSource>ИсточникДанных1</dataSource>
					<query>ВЫБРАТЬ РАЗРЕШЕННЫЕ
	докКорректировка.Ссылка КАК Корректировка,
	ВЫБОР
		КОГДА НЕ докКорректировка.Проведен
			ТОГДА докКорректировка.Ссылка
		КОГДА докКорректировка.ВидОперации &lt;&gt; ЗНАЧЕНИЕ(Перечисление.ВидыОперацийИсправленияПоступленияРеализации.СогласованноеИзменение)
			ТОГДА ЕСТЬNULL(докСчетФактура.Ссылка, докКорректировка.Ссылка)
		ИНАЧЕ докКорректировка.Ссылка
	КОНЕЦ КАК Документ,
	ВЫБОР
		КОГДА НЕ докКорректировка.Проведен
			ТОГДА "Провести Корректировка реализации"
		КОГДА докКорректировка.ВидОперации &lt;&gt; ЗНАЧЕНИЕ(Перечисление.ВидыОперацийИсправленияПоступленияРеализации.СогласованноеИзменение)
			ТОГДА ВЫБОР
					КОГДА докСчетФактура.Ссылка ЕСТЬ NULL 
						ТОГДА "Создать Счет-фактура по корректировке"
					КОГДА НЕ докСчетФактура.Ссылка.Проведен И &amp;ТребуетсяПроведениеCOINVOIC
						ТОГДА "Провести Счет-фактура по корректировке"
					ИНАЧЕ "Отправить счет-фактуру"
				КОНЕЦ
		ИНАЧЕ "Отправить корректировочный счет-фактуру"
	КОНЕЦ КАК ТребуемоеДействие,
	ВЫБОР
		КОГДА докКорректировка.ВидОперации = ЗНАЧЕНИЕ(Перечисление.ВидыОперацийИсправленияПоступленияРеализации.СогласованноеИзменение)
			ТОГДА "COINVOIC"
		КОГДА докСчетФактура.Ссылка.ВидСчетаФактуры &lt;&gt; ЗНАЧЕНИЕ(Перечисление.ВидСчетаФактурыВыставленного.Корректировочный)
			ТОГДА "INVOIC"
		ИНАЧЕ "COINVOIC"
	КОНЕЦ КАК ТипСообщения,
	докКорректировка.ДокументРеализации,
	ТаблицаКэшПартнеровКонтрагентов.Партнер
ПОМЕСТИТЬ табКорректировки
ИЗ
	ТаблицаКэшПартнеровКонтрагентов КАК ТаблицаКэшПартнеровКонтрагентов
		ВНУТРЕННЕЕ СОЕДИНЕНИЕ Документ.КорректировкаРеализации КАК докКорректировка
			ЛЕВОЕ СОЕДИНЕНИЕ Документ.СчетФактураВыданный.ДокументыОснования КАК докСчетФактура
			ПО докКорректировка.Ссылка = докСчетФактура.ДокументОснование
				И (докСчетФактура.Ссылка.ПометкаУдаления = ЛОЖЬ)
		ПО ТаблицаКэшПартнеровКонтрагентов.Контрагент = докКорректировка.Контрагент
			И (ТаблицаКэшПартнеровКонтрагентов.COINVOIC = ИСТИНА)
ГДЕ
	НЕ докКорректировка.ПометкаУдаления
	И докКорректировка.Дата МЕЖДУ &amp;НачалоПериода И &amp;КонецПериода
	И (докКорректировка.ДокументРеализации ССЫЛКА Документ.РеализацияТоваровУслуг
			ИЛИ докКорректировка.ДокументРеализации ССЫЛКА Документ.КорректировкаРеализации)
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ РАЗРЕШЕННЫЕ
	табКорректировки.Корректировка,
	табКорректировки.Документ,
	табКорректировки.ТребуемоеДействие,
	табКорректировки.ТипСообщения,
	табКорректировки.ДокументРеализации,
	табКорректировки.Партнер
ПОМЕСТИТЬ табКорректировкиИСообщения
ИЗ
	табКорректировки КАК табКорректировки
		ЛЕВОЕ СОЕДИНЕНИЕ Справочник.КонтурEDI_Сообщения КАК КонтурEDI_Сообщения
		ПО табКорректировки.Документ = КонтурEDI_Сообщения.Документ
			И (КонтурEDI_Сообщения.ТипСообщения = "COINVOIC"
				ИЛИ КонтурEDI_Сообщения.ТипСообщения = "INVOIC")
ГДЕ
	ВЫБОР
			КОГДА &amp;ТолькоТребуемые
				ТОГДА КонтурEDI_Сообщения.Ссылка ЕСТЬ NULL 
			ИНАЧЕ ИСТИНА
		КОНЕЦ
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ РАЗРЕШЕННЫЕ
	табКорректировкиИСообщения.Корректировка,
	ЕСТЬNULL(СчетФактураВыданныйДокументыОснования.Ссылка, табКорректировкиИСообщения.ДокументРеализации) КАК ПредыдущийДокумент
ПОМЕСТИТЬ табПредыдущихДокументов
ИЗ
	табКорректировкиИСообщения КАК табКорректировкиИСообщения
		ЛЕВОЕ СОЕДИНЕНИЕ Документ.СчетФактураВыданный.ДокументыОснования КАК СчетФактураВыданныйДокументыОснования
		ПО табКорректировкиИСообщения.ДокументРеализации = СчетФактураВыданныйДокументыОснования.ДокументОснование
			И (НЕ табКорректировкиИСообщения.ДокументРеализации ССЫЛКА Документ.РеализацияТоваровУслуг)
			И (НЕ табКорректировкиИСообщения.ДокументРеализации.ВидОперации = ЗНАЧЕНИЕ(Перечисление.ВидыОперацийИсправленияПоступленияРеализации.СогласованноеИзменение))
ГДЕ
	(табКорректировкиИСообщения.ДокументРеализации ССЫЛКА Документ.РеализацияТоваровУслуг
			ИЛИ табКорректировкиИСообщения.ДокументРеализации.ВидОперации = ЗНАЧЕНИЕ(Перечисление.ВидыОперацийИсправленияПоступленияРеализации.СогласованноеИзменение)
			ИЛИ СчетФактураВыданныйДокументыОснования.Ссылка ЕСТЬ НЕ NULL )
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ РАЗРЕШЕННЫЕ
	КонтурEDI_Сообщения.Ссылка КАК Сообщение,
	табПредыдущихДокументов.Корректировка,
	табПредыдущихДокументов.ПредыдущийДокумент
ПОМЕСТИТЬ табРазрешенийНаОтправку
ИЗ
	табПредыдущихДокументов КАК табПредыдущихДокументов
		ЛЕВОЕ СОЕДИНЕНИЕ Справочник.КонтурEDI_Сообщения КАК КонтурEDI_Сообщения
		ПО табПредыдущихДокументов.ПредыдущийДокумент = КонтурEDI_Сообщения.Документ
			И (НЕ КонтурEDI_Сообщения.Статус В (&amp;БлокирующиеСтатусыПервичногоINVOIC))
			И (КонтурEDI_Сообщения.ТипСообщения = "COINVOIC"
				ИЛИ КонтурEDI_Сообщения.ТипСообщения = "INVOIC")
ГДЕ
	ВЫБОР
			КОГДА &amp;ТолькоТребуемые
				ТОГДА КонтурEDI_Сообщения.Ссылка ЕСТЬ НЕ NULL 
			ИНАЧЕ ИСТИНА
		КОНЕЦ
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ РАЗРЕШЕННЫЕ
	табКорректировкиИСообщения.Корректировка,
	табКорректировкиИСообщения.Документ,
	табКорректировкиИСообщения.ТребуемоеДействие,
	табКорректировкиИСообщения.ТипСообщения,
	табРазрешенийНаОтправку.Сообщение,
	табКорректировкиИСообщения.Партнер,
	табРазрешенийНаОтправку.ПредыдущийДокумент
ПОМЕСТИТЬ ВТ_КоррИспрСФ
ИЗ
	табКорректировкиИСообщения КАК табКорректировкиИСообщения
		ЛЕВОЕ СОЕДИНЕНИЕ табРазрешенийНаОтправку КАК табРазрешенийНаОтправку
		ПО табКорректировкиИСообщения.Корректировка = табРазрешенийНаОтправку.Корректировка
ГДЕ
	ВЫБОР
			КОГДА &amp;ТолькоТребуемые
				ТОГДА табРазрешенийНаОтправку.Корректировка ЕСТЬ НЕ NULL 
			ИНАЧЕ ИСТИНА
		КОНЕЦ
;

////////////////////////////////////////////////////////////////////////////////
УНИЧТОЖИТЬ табКорректировки
;

////////////////////////////////////////////////////////////////////////////////
УНИЧТОЖИТЬ табПредыдущихДокументов
;

////////////////////////////////////////////////////////////////////////////////
УНИЧТОЖИТЬ табРазрешенийНаОтправку
;

////////////////////////////////////////////////////////////////////////////////
УНИЧТОЖИТЬ табКорректировкиИСообщения</query>
				</item>
				<item xsi:type="DataSetQuery">
					<name>Реализация</name>
					<dataSource>ИсточникДанных1</dataSource>
					<query>ВЫБРАТЬ РАЗРЕШЕННЫЕ
	докКорректировка.Ссылка КАК Корректировка,
	ВЫБОР
		КОГДА НЕ докКорректировка.Проведен
			ТОГДА докКорректировка.Ссылка
		КОГДА докКорректировка.ВидОперации &lt;&gt; ЗНАЧЕНИЕ(Перечисление.ВидыОперацийИсправленияПоступленияРеализации.СогласованноеИзменение)
			ТОГДА ЕСТЬNULL(докСчетФактура.Ссылка, докКорректировка.Ссылка)
		ИНАЧЕ докКорректировка.Ссылка
	КОНЕЦ КАК Документ,
	ВЫБОР
		КОГДА НЕ докКорректировка.Проведен
			ТОГДА "Провести Корректировка реализации"
		КОГДА докКорректировка.ВидОперации &lt;&gt; ЗНАЧЕНИЕ(Перечисление.ВидыОперацийИсправленияПоступленияРеализации.СогласованноеИзменение)
			ТОГДА ВЫБОР
					КОГДА докСчетФактура.Ссылка ЕСТЬ NULL 
						ТОГДА "Создать Счет-фактура по корректировке"
					КОГДА НЕ докСчетФактура.Ссылка.Проведен И &amp;ТребуетсяПроведениеCOINVOIC
						ТОГДА "Провести Счет-фактура по корректировке"
					ИНАЧЕ "Отправить счет-фактуру"
				КОНЕЦ
		ИНАЧЕ "Отправить корректировочный счет-фактуру"
	КОНЕЦ КАК ТребуемоеДействие,
	ВЫБОР
		КОГДА докКорректировка.ВидОперации = ЗНАЧЕНИЕ(Перечисление.ВидыОперацийИсправленияПоступленияРеализации.СогласованноеИзменение)
			ТОГДА "COINVOIC"
		КОГДА докСчетФактура.Ссылка.ВидСчетаФактуры &lt;&gt; ЗНАЧЕНИЕ(Перечисление.ВидСчетаФактурыВыставленного.Корректировочный)
			ТОГДА "INVOIC"
		ИНАЧЕ "COINVOIC"
	КОНЕЦ КАК ТипСообщения,
	докКорректировка.ДокументРеализации,
	ТаблицаКэшПартнеровКонтрагентов.Партнер
ПОМЕСТИТЬ табКорректировки
ИЗ
	ТаблицаКэшПартнеровКонтрагентов КАК ТаблицаКэшПартнеровКонтрагентов
		ВНУТРЕННЕЕ СОЕДИНЕНИЕ Документ.КорректировкаРеализации КАК докКорректировка
			ЛЕВОЕ СОЕДИНЕНИЕ Документ.СчетФактураВыданный.ДокументыОснования КАК докСчетФактура
			ПО докКорректировка.Ссылка = докСчетФактура.ДокументОснование
				И (докСчетФактура.Ссылка.ПометкаУдаления = ЛОЖЬ)
		ПО ТаблицаКэшПартнеровКонтрагентов.Контрагент = докКорректировка.Контрагент
			И (ТаблицаКэшПартнеровКонтрагентов.COINVOIC = ИСТИНА)
ГДЕ
	НЕ докКорректировка.ПометкаУдаления
	И докКорректировка.Дата МЕЖДУ &amp;НачалоПериода И &amp;КонецПериода
	И (докКорректировка.ДокументРеализации ССЫЛКА Документ.РеализацияТоваровУслуг
			ИЛИ докКорректировка.ДокументРеализации ССЫЛКА Документ.КорректировкаРеализации)
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ РАЗРЕШЕННЫЕ
	табКорректировки.Корректировка,
	табКорректировки.Документ,
	табКорректировки.ТребуемоеДействие,
	табКорректировки.ТипСообщения,
	табКорректировки.ДокументРеализации,
	табКорректировки.Партнер
ПОМЕСТИТЬ табКорректировкиИСообщения
ИЗ
	табКорректировки КАК табКорректировки
		ЛЕВОЕ СОЕДИНЕНИЕ Справочник.КонтурEDI_Сообщения КАК КонтурEDI_Сообщения
		ПО табКорректировки.Документ = КонтурEDI_Сообщения.Документ
			И (КонтурEDI_Сообщения.ТипСообщения = "COINVOIC"
				ИЛИ КонтурEDI_Сообщения.ТипСообщения = "INVOIC")
ГДЕ
	ВЫБОР
			КОГДА &amp;ТолькоТребуемые
				ТОГДА КонтурEDI_Сообщения.Ссылка ЕСТЬ NULL 
			ИНАЧЕ ИСТИНА
		КОНЕЦ
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ РАЗРЕШЕННЫЕ
	табКорректировкиИСообщения.Корректировка,
	ЕСТЬNULL(СчетФактураВыданныйДокументыОснования.Ссылка, табКорректировкиИСообщения.ДокументРеализации) КАК ПредыдущийДокумент
ПОМЕСТИТЬ табПредыдущихДокументов
ИЗ
	табКорректировкиИСообщения КАК табКорректировкиИСообщения
		ЛЕВОЕ СОЕДИНЕНИЕ Документ.СчетФактураВыданный.ДокументыОснования КАК СчетФактураВыданныйДокументыОснования
		ПО табКорректировкиИСообщения.ДокументРеализации = СчетФактураВыданныйДокументыОснования.ДокументОснование
			И (НЕ табКорректировкиИСообщения.ДокументРеализации ССЫЛКА Документ.РеализацияТоваровУслуг)
			И (НЕ табКорректировкиИСообщения.ДокументРеализации.ВидОперации = ЗНАЧЕНИЕ(Перечисление.ВидыОперацийИсправленияПоступленияРеализации.СогласованноеИзменение))
ГДЕ
	(табКорректировкиИСообщения.ДокументРеализации ССЫЛКА Документ.РеализацияТоваровУслуг
			ИЛИ табКорректировкиИСообщения.ДокументРеализации.ВидОперации = ЗНАЧЕНИЕ(Перечисление.ВидыОперацийИсправленияПоступленияРеализации.СогласованноеИзменение)
			ИЛИ СчетФактураВыданныйДокументыОснования.Ссылка ЕСТЬ НЕ NULL )
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ РАЗРЕШЕННЫЕ
	КонтурEDI_Сообщения.Ссылка КАК Сообщение,
	табПредыдущихДокументов.Корректировка,
	табПредыдущихДокументов.ПредыдущийДокумент
ПОМЕСТИТЬ табРазрешенийНаОтправку
ИЗ
	табПредыдущихДокументов КАК табПредыдущихДокументов
		ЛЕВОЕ СОЕДИНЕНИЕ Справочник.КонтурEDI_Сообщения КАК КонтурEDI_Сообщения
		ПО табПредыдущихДокументов.ПредыдущийДокумент = КонтурEDI_Сообщения.Документ
			И (НЕ КонтурEDI_Сообщения.Статус В (&amp;БлокирующиеСтатусыПервичногоINVOIC))
			И (КонтурEDI_Сообщения.ТипСообщения = "COINVOIC"
				ИЛИ КонтурEDI_Сообщения.ТипСообщения = "INVOIC")
ГДЕ
	ВЫБОР
			КОГДА &amp;ТолькоТребуемые
				ТОГДА КонтурEDI_Сообщения.Ссылка ЕСТЬ НЕ NULL 
			ИНАЧЕ ИСТИНА
		КОНЕЦ
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ РАЗРЕШЕННЫЕ
	табКорректировкиИСообщения.Корректировка,
	табКорректировкиИСообщения.Документ,
	табКорректировкиИСообщения.ТребуемоеДействие,
	табКорректировкиИСообщения.ТипСообщения,
	табРазрешенийНаОтправку.Сообщение,
	табКорректировкиИСообщения.Партнер,
	табРазрешенийНаОтправку.ПредыдущийДокумент
ПОМЕСТИТЬ ВТ_КоррИспрСФ
ИЗ
	табКорректировкиИСообщения КАК табКорректировкиИСообщения
		ЛЕВОЕ СОЕДИНЕНИЕ табРазрешенийНаОтправку КАК табРазрешенийНаОтправку
		ПО табКорректировкиИСообщения.Корректировка = табРазрешенийНаОтправку.Корректировка
ГДЕ
	ВЫБОР
			КОГДА &amp;ТолькоТребуемые
				ТОГДА табРазрешенийНаОтправку.Корректировка ЕСТЬ НЕ NULL 
			ИНАЧЕ ИСТИНА
		КОНЕЦ
;

////////////////////////////////////////////////////////////////////////////////
УНИЧТОЖИТЬ табКорректировки
;

////////////////////////////////////////////////////////////////////////////////
УНИЧТОЖИТЬ табПредыдущихДокументов
;

////////////////////////////////////////////////////////////////////////////////
УНИЧТОЖИТЬ табРазрешенийНаОтправку
;

////////////////////////////////////////////////////////////////////////////////
УНИЧТОЖИТЬ табКорректировкиИСообщения</query>
				</item>
			</item>
		</item>
		<item xsi:type="DataSetUnion">
			<name>Покупатель</name>
			<item xsi:type="DataSetUnion">
				<name>ЗапросОсновнойЦепочки</name>
				<item xsi:type="DataSetQuery">
					<name>ПоступлениеТоваровУслуг_СФ</name>
					<dataSource>ИсточникДанных1</dataSource>
					<query>ВЫБРАТЬ
	ПоступлениеТоваровУслуг.Ссылка КАК PORDERS,
	ПоступлениеТоваровУслуг.Ссылка КАК ORDERS,
	ПоступлениеТоваровУслуг.Ссылка КАК ORDRSP,
	ПоступлениеТоваровУслуг.Ссылка КАК DESADV,
	ПоступлениеТоваровУслуг.Ссылка КАК RECADV,
	СчетФактураПолученный.Ссылка КАК INVOIC
ИЗ
	(ВЫБРАТЬ
		1 КАК Поле1) КАК Заглушка
		{ПОЛНОЕ СОЕДИНЕНИЕ Документ.СчетФактураПолученный КАК СчетФактураПолученный
			{ПОЛНОЕ СОЕДИНЕНИЕ Документ.ПоступлениеТоваровУслуг КАК ПоступлениеТоваровУслуг
			ПО СчетФактураПолученный.ДокументОснование = ПоступлениеТоваровУслуг.Ссылка}
		ПО (ИСТИНА)}</query>
					<autoFillFields>false</autoFillFields>
				</item>
			</item>
			<item xsi:type="DataSetUnion">
				<name>ЗапросПоТоварам</name>
				<item xsi:type="DataSetUnion">
					<name>_ORDERS_</name>
					<item xsi:type="DataSetQuery">
						<name>ПоступлениеТоваровУслуг</name>
						<dataSource>ИсточникДанных1</dataSource>
						<query>ВЫБРАТЬ
	ПоступлениеТоваровУслугТовары.Номенклатура,
	НЕОПРЕДЕЛЕНО КАК ХарактеристикаНоменклатуры,
	ВЫБОР
		КОГДА ПоступлениеТоваровУслугТовары.ЕдиницаИзмерения = ЗНАЧЕНИЕ(Справочник.КлассификаторЕдиницИзмерения.ПустаяСсылка)
			ТОГДА ПоступлениеТоваровУслугТовары.Номенклатура.ЕдиницаИзмерения
		ИНАЧЕ ПоступлениеТоваровУслугТовары.ЕдиницаИзмерения
	КОНЕЦ КАК ЕдиницаИзмерения,
	ВЫРАЗИТЬ(ВЫБОР
			КОГДА ПоступлениеТоваровУслугТовары.ЕдиницаИзмерения = ЗНАЧЕНИЕ(Справочник.КлассификаторЕдиницИзмерения.ПустаяСсылка)
				ТОГДА ПоступлениеТоваровУслугТовары.Номенклатура.ЕдиницаИзмерения
			ИНАЧЕ ПоступлениеТоваровУслугТовары.ЕдиницаИзмерения
		КОНЕЦ КАК Справочник.КлассификаторЕдиницИзмерения).Наименование КАК КодЕдиницыИзмерения,
	ВЫРАЗИТЬ(ПоступлениеТоваровУслугТовары.Номенклатура.Наименование КАК СТРОКА(178)) КАК Наименование,
	ПоступлениеТоваровУслугТовары.Количество КАК Количество,
	ПоступлениеТоваровУслугТовары.Цена,
	ПоступлениеТоваровУслугТовары.СтавкаНДС,
	ПоступлениеТоваровУслугТовары.Сумма,
	ПоступлениеТоваровУслугТовары.СуммаНДС
ИЗ
	Документ.ПоступлениеТоваровУслуг.Товары КАК ПоступлениеТоваровУслугТовары
ГДЕ
	ПоступлениеТоваровУслугТовары.Ссылка = &amp;Ссылка</query>
						<autoFillFields>false</autoFillFields>
					</item>
				</item>
				<item xsi:type="DataSetUnion">
					<name>_RECADV_</name>
					<item xsi:type="DataSetQuery">
						<name>ПоступлениеТоваровУслуг</name>
						<dataSource>ИсточникДанных1</dataSource>
						<query>ВЫБРАТЬ
	ПоступлениеТоваровУслугТовары.Номенклатура,
	НЕОПРЕДЕЛЕНО КАК ХарактеристикаНоменклатуры,
	ВЫБОР
		КОГДА ПоступлениеТоваровУслугТовары.ЕдиницаИзмерения = ЗНАЧЕНИЕ(Справочник.КлассификаторЕдиницИзмерения.ПустаяСсылка)
			ТОГДА ПоступлениеТоваровУслугТовары.Номенклатура.ЕдиницаИзмерения
		ИНАЧЕ ПоступлениеТоваровУслугТовары.ЕдиницаИзмерения
	КОНЕЦ КАК ЕдиницаИзмерения,
	ВЫРАЗИТЬ(ВЫБОР
			КОГДА ПоступлениеТоваровУслугТовары.ЕдиницаИзмерения = ЗНАЧЕНИЕ(Справочник.КлассификаторЕдиницИзмерения.ПустаяСсылка)
				ТОГДА ПоступлениеТоваровУслугТовары.Номенклатура.ЕдиницаИзмерения
			ИНАЧЕ ПоступлениеТоваровУслугТовары.ЕдиницаИзмерения
		КОНЕЦ КАК Справочник.КлассификаторЕдиницИзмерения).Наименование КАК КодЕдиницыИзмерения,
	ВЫРАЗИТЬ(ПоступлениеТоваровУслугТовары.Номенклатура.Наименование КАК СТРОКА(178)) КАК Наименование,
	ПоступлениеТоваровУслугТовары.Количество КАК Количество,
	ПоступлениеТоваровУслугТовары.Цена,
	ПоступлениеТоваровУслугТовары.СтавкаНДС,
	ПоступлениеТоваровУслугТовары.Сумма,
	ПоступлениеТоваровУслугТовары.СуммаНДС
ИЗ
	Документ.ПоступлениеТоваровУслуг.Товары КАК ПоступлениеТоваровУслугТовары
ГДЕ
	ПоступлениеТоваровУслугТовары.Ссылка = &amp;Ссылка</query>
						<autoFillFields>false</autoFillFields>
					</item>
				</item>
			</item>
			<item xsi:type="DataSetQuery">
				<name>КонвертироватьТоварыEDIВ1С</name>
				<dataSource>ИсточникДанных1</dataSource>
				<query>ВЫБРАТЬ
	ТабТоваров.GTIN КАК GTIN,
	ТабТоваров.КодТовараСторонний КАК КодТовараСторонний,
	ТабТоваров.КодТовараСвой КАК КодТовараСвой,
	ТабСоответствий_КонтурEDI.Номенклатура КАК Номенклатура,
	ТабСоответствий_КонтурEDI.ХарактеристикаНоменклатуры КАК ХарактеристикаНоменклатуры,
	ТабСоответствий_КонтурEDI.ЕдиницаИзмерения КАК ЕдиницаИзмерения,
	ТабСоответствий_КонтурEDI.ТипЕдиницы КАК ТипЕдиницы,
	3 КАК Приоритет
ПОМЕСТИТЬ ВТ_НайденныеСоответствия
ИЗ
	ТабТоваров КАК ТабТоваров
		ВНУТРЕННЕЕ СОЕДИНЕНИЕ ТабСоответствий_КонтурEDI КАК ТабСоответствий_КонтурEDI
		ПО ТабТоваров.GTIN = ТабСоответствий_КонтурEDI.GTIN
			И ТабТоваров.КодТовараСторонний = ТабСоответствий_КонтурEDI.КодТовараСторонний
			И ТабТоваров.КодТовараСвой = ТабСоответствий_КонтурEDI.КодТовараСвой

ОБЪЕДИНИТЬ ВСЕ

ВЫБРАТЬ
	ТабТоваров.GTIN,
	ТабТоваров.КодТовараСторонний,
	ТабТоваров.КодТовараСвой,
	СправочникНоменклатура.Ссылка,
	НЕОПРЕДЕЛЕНО,
	СправочникНоменклатура.ЕдиницаИзмерения,
	ВЫРАЗИТЬ("" КАК СТРОКА(20)),
	2
ИЗ
	ТабТоваров КАК ТабТоваров
		ВНУТРЕННЕЕ СОЕДИНЕНИЕ Справочник.Номенклатура КАК СправочникНоменклатура
		ПО ТабТоваров.КодТовараСвой = СправочникНоменклатура.Код
ГДЕ
	(НЕ ТабТоваров.КодТовараСвой = "")
</query>
				<autoFillFields>false</autoFillFields>
			</item>
			<item xsi:type="DataSetQuery">
				<name>КонвертироватьТовары1СВEDIВ_GTIN</name>
				<dataSource>ИсточникДанных1</dataSource>
				<query>ВЫБРАТЬ
	ТабТоваров.Номенклатура,
	ТабТоваров.ХарактеристикаНоменклатуры,
	ТабТоваров.ЕдиницаИзмерения,
	ВЫРАЗИТЬ(ТабТоваров.Номенклатура.Код КАК СТРОКА) КАК КодТовараСвой,
	"" КАК GTIN
ПОМЕСТИТЬ ВТШтрихкодыТоваров
ИЗ
	ТабТоваров КАК ТабТоваров

ИНДЕКСИРОВАТЬ ПО
	ТабТоваров.Номенклатура,
	ТабТоваров.ХарактеристикаНоменклатуры,
	ТабТоваров.ЕдиницаИзмерения</query>
				<autoFillFields>false</autoFillFields>
			</item>
		</item>
	</dataSet>
	<dataSet xsi:type="DataSetUnion">
		<name>УФ_УНФ</name>
		<field xsi:type="DataSetFieldField">
			<dataPath>ЕдиницаИзмерения</dataPath>
			<field>ЕдиницаИзмерения</field>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>Количество</dataPath>
			<field>Количество</field>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>КоличествоДоКорректировки</dataPath>
			<field>КоличествоДоКорректировки</field>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>Номенклатура</dataPath>
			<field>Номенклатура</field>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>НоменклатураНаименование</dataPath>
			<field>НоменклатураНаименование</field>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>НоменклатураНаименованиеПолное</dataPath>
			<field>НоменклатураНаименованиеПолное</field>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>НомерГТД</dataPath>
			<field>НомерГТД</field>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>НомерСтроки</dataPath>
			<field>НомерСтроки</field>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>СерияНоменклатуры</dataPath>
			<field>СерияНоменклатуры</field>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>СтавкаНДС</dataPath>
			<field>СтавкаНДС</field>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>СтавкаНДСДоКорректировки</dataPath>
			<field>СтавкаНДСДоКорректировки</field>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>Страна</dataPath>
			<field>Страна</field>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>Сумма</dataPath>
			<field>Сумма</field>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>СуммаДоКорректировки</dataPath>
			<field>СуммаДоКорректировки</field>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>СуммаНДС</dataPath>
			<field>СуммаНДС</field>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>СуммаНДСДоКорректировки</dataPath>
			<field>СуммаНДСДоКорректировки</field>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>ТипЕдиницы</dataPath>
			<field>ТипЕдиницы</field>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>ХарактеристикаНоменклатуры</dataPath>
			<field>ХарактеристикаНоменклатуры</field>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>Цена</dataPath>
			<field>Цена</field>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>ЦенаДоКорректировки</dataPath>
			<field>ЦенаДоКорректировки</field>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>GTIN</dataPath>
			<field>GTIN</field>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>ЕдИзмСрокаГодности</dataPath>
			<field>ЕдИзмСрокаГодности</field>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>КвантПоставки</dataPath>
			<field>КвантПоставки</field>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>КодТовараПоставщика</dataPath>
			<field>КодТовараПоставщика</field>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>КоличествоВОдномМесте</dataPath>
			<field>КоличествоВОдномМесте</field>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>Наименование</dataPath>
			<field>Наименование</field>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>Родитель</dataPath>
			<field>Родитель</field>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>СрокГодности</dataPath>
			<field>СрокГодности</field>
		</field>
		<item xsi:type="DataSetUnion">
			<name>Поставщик</name>
			<field xsi:type="DataSetFieldField">
				<dataPath>ЕдиницаИзмерения</dataPath>
				<field>ЕдиницаИзмерения</field>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>Количество</dataPath>
				<field>Количество</field>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>КоличествоДоКорректировки</dataPath>
				<field>КоличествоДоКорректировки</field>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>Номенклатура</dataPath>
				<field>Номенклатура</field>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>НоменклатураНаименование</dataPath>
				<field>НоменклатураНаименование</field>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>НоменклатураНаименованиеПолное</dataPath>
				<field>НоменклатураНаименованиеПолное</field>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>НомерГТД</dataPath>
				<field>НомерГТД</field>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>НомерСтроки</dataPath>
				<field>НомерСтроки</field>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>СерияНоменклатуры</dataPath>
				<field>СерияНоменклатуры</field>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>СтавкаНДС</dataPath>
				<field>СтавкаНДС</field>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>СтавкаНДСДоКорректировки</dataPath>
				<field>СтавкаНДСДоКорректировки</field>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>Страна</dataPath>
				<field>Страна</field>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>Сумма</dataPath>
				<field>Сумма</field>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>СуммаДоКорректировки</dataPath>
				<field>СуммаДоКорректировки</field>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>СуммаНДС</dataPath>
				<field>СуммаНДС</field>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>СуммаНДСДоКорректировки</dataPath>
				<field>СуммаНДСДоКорректировки</field>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>ТипЕдиницы</dataPath>
				<field>ТипЕдиницы</field>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>ХарактеристикаНоменклатуры</dataPath>
				<field>ХарактеристикаНоменклатуры</field>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>Цена</dataPath>
				<field>Цена</field>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>ЦенаДоКорректировки</dataPath>
				<field>ЦенаДоКорректировки</field>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>GTIN</dataPath>
				<field>GTIN</field>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>ЕдИзмСрокаГодности</dataPath>
				<field>ЕдИзмСрокаГодности</field>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>КвантПоставки</dataPath>
				<field>КвантПоставки</field>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>КодТовараПоставщика</dataPath>
				<field>КодТовараПоставщика</field>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>КоличествоВОдномМесте</dataPath>
				<field>КоличествоВОдномМесте</field>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>Наименование</dataPath>
				<field>Наименование</field>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>Родитель</dataPath>
				<field>Родитель</field>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>СрокГодности</dataPath>
				<field>СрокГодности</field>
			</field>
			<item xsi:type="DataSetUnion">
				<name>ЗапросОсновнойЦепочки</name>
				<item xsi:type="DataSetQuery">
					<name>Заказ_Реализация_СФ</name>
					<dataSource>ИсточникДанных1</dataSource>
					<query>ВЫБРАТЬ
	докЗаказПокупателя.Ссылка КАК PORDERS,
	докЗаказПокупателя.Ссылка КАК ORDERS,
	докЗаказПокупателя.Ссылка КАК ORDRSP,
	докРеализацияТоваровУслуг.Ссылка КАК DESADV,
	докРеализацияТоваровУслуг.Ссылка КАК RECADV,
	СчетФактураВыданныйДокументыОснования.Ссылка КАК INVOIC
ИЗ
	(ВЫБРАТЬ
		1 КАК Поле1) КАК Заглушка
		{ПОЛНОЕ СОЕДИНЕНИЕ Документ.СчетФактура.ДокументыОснования КАК СчетФактураВыданныйДокументыОснования
			{ПОЛНОЕ СОЕДИНЕНИЕ Документ.РасходнаяНакладная КАК докРеализацияТоваровУслуг
				{ПОЛНОЕ СОЕДИНЕНИЕ Документ.ЗаказПокупателя КАК докЗаказПокупателя
				ПО ((докРеализацияТоваровУслуг.Заказ) = докЗаказПокупателя.Ссылка)}
			ПО ((СчетФактураВыданныйДокументыОснования.ДокументОснование) = докРеализацияТоваровУслуг.Ссылка)}
		ПО (ИСТИНА)}</query>
					<autoFillFields>false</autoFillFields>
				</item>
				<item xsi:type="DataSetQuery">
					<name>Реализация_СФ</name>
					<dataSource>ИсточникДанных1</dataSource>
					<query>ВЫБРАТЬ
	РеализацияТоваровУслуг.Ссылка КАК PORDERS,
	РеализацияТоваровУслуг.Ссылка КАК ORDERS,
	РеализацияТоваровУслуг.Ссылка КАК ORDRSP,
	РеализацияТоваровУслуг.Ссылка КАК DESADV,
	РеализацияТоваровУслуг.Ссылка КАК RECADV,
	СчетФактураВыданныйДокументыОснования.Ссылка КАК INVOIC
ИЗ
	(ВЫБРАТЬ
		1 КАК Поле1) КАК Заглушка
		{ПОЛНОЕ СОЕДИНЕНИЕ Документ.СчетФактура.ДокументыОснования КАК СчетФактураВыданныйДокументыОснования
			{ПОЛНОЕ СОЕДИНЕНИЕ Документ.РасходнаяНакладная КАК РеализацияТоваровУслуг
			ПО ((СчетФактураВыданныйДокументыОснования.ДокументОснование) = РеализацияТоваровУслуг.Ссылка)}
		ПО (ИСТИНА)}</query>
					<autoFillFields>false</autoFillFields>
				</item>
				<item xsi:type="DataSetQuery">
					<name>Заказ_Реализация</name>
					<dataSource>ИсточникДанных1</dataSource>
					<query>ВЫБРАТЬ
	докЗаказПокупателя.Ссылка КАК PORDERS,
	докЗаказПокупателя.Ссылка КАК ORDERS,
	докЗаказПокупателя.Ссылка КАК ORDRSP,
	докРеализацияТоваровУслуг.Ссылка КАК DESADV,
	докРеализацияТоваровУслуг.Ссылка КАК RECADV,
	докРеализацияТоваровУслуг.Ссылка КАК INVOIC
ИЗ
	(ВЫБРАТЬ
		1 КАК Поле1) КАК Заглушка
		{ПОЛНОЕ СОЕДИНЕНИЕ Документ.РасходнаяНакладная КАК докРеализацияТоваровУслуг
			{ПОЛНОЕ СОЕДИНЕНИЕ Документ.ЗаказПокупателя КАК докЗаказПокупателя
			ПО ((докРеализацияТоваровУслуг.Заказ) = докЗаказПокупателя.Ссылка)}
		ПО (ИСТИНА)}</query>
					<autoFillFields>false</autoFillFields>
				</item>
				<item xsi:type="DataSetQuery">
					<name>Реализация</name>
					<dataSource>ИсточникДанных1</dataSource>
					<query>ВЫБРАТЬ
	РеализацияТоваровУслуг.Ссылка КАК PORDERS,
	РеализацияТоваровУслуг.Ссылка КАК ORDERS,
	РеализацияТоваровУслуг.Ссылка КАК ORDRSP,
	РеализацияТоваровУслуг.Ссылка КАК DESADV,
	РеализацияТоваровУслуг.Ссылка КАК RECADV,
	РеализацияТоваровУслуг.Ссылка КАК INVOIC
ИЗ
	(ВЫБРАТЬ
		1 КАК Поле1) КАК Заглушка
		{ПОЛНОЕ СОЕДИНЕНИЕ Документ.РасходнаяНакладная КАК РеализацияТоваровУслуг
		ПО (ИСТИНА)}</query>
					<autoFillFields>false</autoFillFields>
				</item>
			</item>
			<item xsi:type="DataSetUnion">
				<name>ЗапросПоТоварам</name>
				<field xsi:type="DataSetFieldField">
					<dataPath>ЕдиницаИзмерения</dataPath>
					<field>ЕдиницаИзмерения</field>
				</field>
				<field xsi:type="DataSetFieldField">
					<dataPath>Количество</dataPath>
					<field>Количество</field>
				</field>
				<field xsi:type="DataSetFieldField">
					<dataPath>КоличествоДоКорректировки</dataPath>
					<field>КоличествоДоКорректировки</field>
				</field>
				<field xsi:type="DataSetFieldField">
					<dataPath>Номенклатура</dataPath>
					<field>Номенклатура</field>
				</field>
				<field xsi:type="DataSetFieldField">
					<dataPath>НоменклатураНаименование</dataPath>
					<field>НоменклатураНаименование</field>
				</field>
				<field xsi:type="DataSetFieldField">
					<dataPath>НоменклатураНаименованиеПолное</dataPath>
					<field>НоменклатураНаименованиеПолное</field>
				</field>
				<field xsi:type="DataSetFieldField">
					<dataPath>НомерГТД</dataPath>
					<field>НомерГТД</field>
				</field>
				<field xsi:type="DataSetFieldField">
					<dataPath>НомерСтроки</dataPath>
					<field>НомерСтроки</field>
				</field>
				<field xsi:type="DataSetFieldField">
					<dataPath>СерияНоменклатуры</dataPath>
					<field>СерияНоменклатуры</field>
				</field>
				<field xsi:type="DataSetFieldField">
					<dataPath>СтавкаНДС</dataPath>
					<field>СтавкаНДС</field>
				</field>
				<field xsi:type="DataSetFieldField">
					<dataPath>СтавкаНДСДоКорректировки</dataPath>
					<field>СтавкаНДСДоКорректировки</field>
				</field>
				<field xsi:type="DataSetFieldField">
					<dataPath>Страна</dataPath>
					<field>Страна</field>
				</field>
				<field xsi:type="DataSetFieldField">
					<dataPath>Сумма</dataPath>
					<field>Сумма</field>
				</field>
				<field xsi:type="DataSetFieldField">
					<dataPath>СуммаДоКорректировки</dataPath>
					<field>СуммаДоКорректировки</field>
				</field>
				<field xsi:type="DataSetFieldField">
					<dataPath>СуммаНДС</dataPath>
					<field>СуммаНДС</field>
				</field>
				<field xsi:type="DataSetFieldField">
					<dataPath>СуммаНДСДоКорректировки</dataPath>
					<field>СуммаНДСДоКорректировки</field>
				</field>
				<field xsi:type="DataSetFieldField">
					<dataPath>ТипЕдиницы</dataPath>
					<field>ТипЕдиницы</field>
				</field>
				<field xsi:type="DataSetFieldField">
					<dataPath>ХарактеристикаНоменклатуры</dataPath>
					<field>ХарактеристикаНоменклатуры</field>
				</field>
				<field xsi:type="DataSetFieldField">
					<dataPath>Цена</dataPath>
					<field>Цена</field>
				</field>
				<field xsi:type="DataSetFieldField">
					<dataPath>ЦенаДоКорректировки</dataPath>
					<field>ЦенаДоКорректировки</field>
				</field>
				<field xsi:type="DataSetFieldField">
					<dataPath>GTIN</dataPath>
					<field>GTIN</field>
				</field>
				<field xsi:type="DataSetFieldField">
					<dataPath>ЕдИзмСрокаГодности</dataPath>
					<field>ЕдИзмСрокаГодности</field>
				</field>
				<field xsi:type="DataSetFieldField">
					<dataPath>КвантПоставки</dataPath>
					<field>КвантПоставки</field>
				</field>
				<field xsi:type="DataSetFieldField">
					<dataPath>КодТовараПоставщика</dataPath>
					<field>КодТовараПоставщика</field>
				</field>
				<field xsi:type="DataSetFieldField">
					<dataPath>КоличествоВОдномМесте</dataPath>
					<field>КоличествоВОдномМесте</field>
				</field>
				<field xsi:type="DataSetFieldField">
					<dataPath>Наименование</dataPath>
					<field>Наименование</field>
				</field>
				<field xsi:type="DataSetFieldField">
					<dataPath>Родитель</dataPath>
					<field>Родитель</field>
				</field>
				<field xsi:type="DataSetFieldField">
					<dataPath>СрокГодности</dataPath>
					<field>СрокГодности</field>
				</field>
				<item xsi:type="DataSetUnion">
					<name>_PORDERS_ORDRSP_</name>
					<item xsi:type="DataSetQuery">
						<name>ЗаказПокупателя</name>
						<dataSource>ИсточникДанных1</dataSource>
						<query>ВЫБРАТЬ
	ВЫРАЗИТЬ(ЗаказПокупателяТовары.Номенклатура КАК Справочник.Номенклатура) КАК Номенклатура,
	ЗаказПокупателяТовары.Характеристика КАК ХарактеристикаНоменклатуры,
	ЗаказПокупателяТовары.ЕдиницаИзмерения КАК ЕдиницаИзмерения,
	ЗаказПокупателяТовары.Цена,
	ЗаказПокупателяТовары.СтавкаНДС,
	ЗаказПокупателяТовары.Количество КАК Количество,
	ЛОЖЬ КАК Пометка,
	ЗаказПокупателяТовары.Сумма КАК Сумма,
	ЗаказПокупателяТовары.СуммаНДС КАК СуммаНДС,
	ВЫБОР
		КОГДА ЗаказПокупателяТовары.Номенклатура.ТипНоменклатуры = ЗНАЧЕНИЕ(Перечисление.ТипыНоменклатуры.Услуга)
			ТОГДА "Services"
		ИНАЧЕ ""
	КОНЕЦ КАК ТипЕдиницы
ИЗ
	Документ.ЗаказПокупателя.Запасы КАК ЗаказПокупателяТовары
ГДЕ
	ЗаказПокупателяТовары.Ссылка в (&amp;Ссылка)
 	И (НЕ ЗаказПокупателяТовары.Номенклатура.ТипНоменклатуры = ЗНАЧЕНИЕ(Перечисление.ТипыНоменклатуры.Услуга)
		ИЛИ &amp;РаботаСУслугами)
</query>
						<autoFillFields>false</autoFillFields>
					</item>
					<item xsi:type="DataSetQuery">
						<name>РасходнаяНакладная</name>
						<dataSource>ИсточникДанных1</dataSource>
						<query>ВЫБРАТЬ
	РеализацияТоваровУслугТовары.НомерСтроки,
	РеализацияТоваровУслугТовары.Номенклатура КАК Номенклатура,
	РеализацияТоваровУслугТовары.Характеристика КАК ХарактеристикаНоменклатуры,
	РеализацияТоваровУслугТовары.ЕдиницаИзмерения КАК ЕдиницаИзмерения,
	ВЫРАЗИТЬ(РеализацияТоваровУслугТовары.Номенклатура.Наименование КАК СТРОКА(178)) КАК Наименование,
	ВЫРАЗИТЬ(РеализацияТоваровУслугТовары.Номенклатура.НаименованиеПолное КАК СТРОКА(500)) КАК НаименованиеПолное,
	РеализацияТоваровУслугТовары.Цена,
	РеализацияТоваровУслугТовары.СтавкаНДС,
	НЕОПРЕДЕЛЕНО КАК СерияНоменклатуры,
	РеализацияТоваровУслугТовары.СтранаПроисхождения КАК Страна,
	РеализацияТоваровУслугТовары.НомерГТД КАК НомерГТД,
	РеализацияТоваровУслугТовары.Количество КАК Количество,
	РеализацияТоваровУслугТовары.Сумма КАК Сумма,
	РеализацияТоваровУслугТовары.СуммаНДС,
	ВЫБОР
		КОГДА РеализацияТоваровУслугТовары.Номенклатура.ТипНоменклатуры = ЗНАЧЕНИЕ(Перечисление.ТипыНоменклатуры.Услуга)
			ТОГДА "Services"
		ИНАЧЕ ""
	КОНЕЦ КАК ТипЕдиницы
ИЗ
	Документ.РасходнаяНакладная.Запасы КАК РеализацияТоваровУслугТовары
ГДЕ
	РеализацияТоваровУслугТовары.Ссылка В(&amp;Ссылка)
	И (НЕ РеализацияТоваровУслугТовары.Номенклатура.ТипНоменклатуры = ЗНАЧЕНИЕ(Перечисление.ТипыНоменклатуры.Услуга)
			ИЛИ &amp;РаботаСУслугами)</query>
						<autoFillFields>false</autoFillFields>
					</item>
				</item>
				<item xsi:type="DataSetUnion">
					<name>_DESADV_</name>
					<item xsi:type="DataSetQuery">
						<name>РасходнаяНакладная</name>
						<dataSource>ИсточникДанных1</dataSource>
						<query>ВЫБРАТЬ
	РеализацияТоваровУслугТовары.НомерСтроки КАК НомерСтроки,
	РеализацияТоваровУслугТовары.Номенклатура КАК Номенклатура,
	РеализацияТоваровУслугТовары.Характеристика КАК ХарактеристикаНоменклатуры,
	РеализацияТоваровУслугТовары.ЕдиницаИзмерения КАК ЕдиницаИзмерения,
	ВЫРАЗИТЬ(РеализацияТоваровУслугТовары.Номенклатура.Наименование КАК СТРОКА(178)) КАК Наименование,
	ВЫРАЗИТЬ(РеализацияТоваровУслугТовары.Номенклатура.НаименованиеПолное КАК СТРОКА(500)) КАК НаименованиеПолное,
	РеализацияТоваровУслугТовары.Цена КАК Цена,
	РеализацияТоваровУслугТовары.СтавкаНДС КАК СтавкаНДС,
	РеализацияТоваровУслугТовары.Партия КАК СерияНоменклатуры,
	РеализацияТоваровУслугТовары.СтранаПроисхождения КАК Страна,
	ЕСТЬNULL(РеализацияТоваровУслугТовары.НомерГТД, "") КАК НомерГТД,
	РеализацияТоваровУслугТовары.Количество КАК Количество,
	РеализацияТоваровУслугТовары.Сумма КАК Сумма,
	РеализацияТоваровУслугТовары.СуммаНДС КАК СуммаНДС,
	ВЫБОР
		КОГДА РеализацияТоваровУслугТовары.Номенклатура.ТипНоменклатуры = ЗНАЧЕНИЕ(Перечисление.ТипыНоменклатуры.Услуга)
			ТОГДА "Services"
		ИНАЧЕ ""
	КОНЕЦ КАК ТипЕдиницы
ИЗ
	Документ.РасходнаяНакладная.Запасы КАК РеализацияТоваровУслугТовары
ГДЕ
	РеализацияТоваровУслугТовары.Ссылка В(&amp;Ссылка)
	И (НЕ РеализацияТоваровУслугТовары.Номенклатура.ТипНоменклатуры = ЗНАЧЕНИЕ(Перечисление.ТипыНоменклатуры.Услуга)
			ИЛИ &amp;РаботаСУслугами)

ОБЪЕДИНИТЬ ВСЕ

ВЫБРАТЬ
	0,
	ВозвратТоваровОтПокупателяТовары.Номенклатура,
	ВозвратТоваровОтПокупателяТовары.Характеристика,
	ВозвратТоваровОтПокупателяТовары.ЕдиницаИзмерения,
	ВЫРАЗИТЬ(ВозвратТоваровОтПокупателяТовары.Номенклатура.Наименование КАК СТРОКА(178)),
	ВЫРАЗИТЬ(ВозвратТоваровОтПокупателяТовары.Номенклатура.НаименованиеПолное КАК СТРОКА(500)),
	ВозвратТоваровОтПокупателяТовары.Цена,
	ВозвратТоваровОтПокупателяТовары.СтавкаНДС,
	ВозвратТоваровОтПокупателяТовары.Партия,
	ВозвратТоваровОтПокупателяТовары.СтранаПроисхождения,
	ЕСТЬNULL(ВозвратТоваровОтПокупателяТовары.НомерГТД, ""),
	-ВозвратТоваровОтПокупателяТовары.Количество,
	-ВозвратТоваровОтПокупателяТовары.Сумма,
	-ВозвратТоваровОтПокупателяТовары.СуммаНДС,
	""
ИЗ
	Документ.ПриходнаяНакладная.Запасы КАК ВозвратТоваровОтПокупателяТовары
ГДЕ
	ВозвратТоваровОтПокупателяТовары.Ссылка В(&amp;Возвраты)</query>
						<autoFillFields>false</autoFillFields>
					</item>
				</item>
				<item xsi:type="DataSetUnion">
					<name>_INVOIC_</name>
					<item xsi:type="DataSetQuery">
						<name>РасходнаяНакладная</name>
						<dataSource>ИсточникДанных1</dataSource>
						<query>ВЫБРАТЬ
	РеализацияТоваровУслугТовары.НомерСтроки КАК НомерСтроки,
	РеализацияТоваровУслугТовары.Номенклатура КАК Номенклатура,
	РеализацияТоваровУслугТовары.Характеристика КАК ХарактеристикаНоменклатуры,
	РеализацияТоваровУслугТовары.ЕдиницаИзмерения КАК ЕдиницаИзмерения,
	ВЫРАЗИТЬ(РеализацияТоваровУслугТовары.Номенклатура.Наименование КАК СТРОКА(178)) КАК Наименование,
	ВЫРАЗИТЬ(РеализацияТоваровУслугТовары.Номенклатура.НаименованиеПолное КАК СТРОКА(500)) КАК НаименованиеПолное,
	РеализацияТоваровУслугТовары.Цена КАК Цена,
	РеализацияТоваровУслугТовары.СтавкаНДС КАК СтавкаНДС,
	РеализацияТоваровУслугТовары.Партия КАК СерияНоменклатуры,
	РеализацияТоваровУслугТовары.СтранаПроисхождения КАК Страна,
	ЕСТЬNULL(РеализацияТоваровУслугТовары.НомерГТД, "") КАК НомерГТД,
	РеализацияТоваровУслугТовары.Количество КАК Количество,
	РеализацияТоваровУслугТовары.Сумма КАК Сумма,
	РеализацияТоваровУслугТовары.СуммаНДС КАК СуммаНДС,
	ВЫБОР
		КОГДА РеализацияТоваровУслугТовары.Номенклатура.ТипНоменклатуры = ЗНАЧЕНИЕ(Перечисление.ТипыНоменклатуры.Услуга)
			ТОГДА "Services"
		ИНАЧЕ ""
	КОНЕЦ КАК ТипЕдиницы
ИЗ
	Документ.РасходнаяНакладная.Запасы КАК РеализацияТоваровУслугТовары
ГДЕ
	РеализацияТоваровУслугТовары.Ссылка В(&amp;Ссылка)
	И (НЕ РеализацияТоваровУслугТовары.Номенклатура.ТипНоменклатуры = ЗНАЧЕНИЕ(Перечисление.ТипыНоменклатуры.Услуга)
			ИЛИ &amp;РаботаСУслугами)

ОБЪЕДИНИТЬ ВСЕ

ВЫБРАТЬ
	0,
	ВозвратТоваровОтПокупателяТовары.Номенклатура,
	ВозвратТоваровОтПокупателяТовары.Характеристика,
	ВозвратТоваровОтПокупателяТовары.ЕдиницаИзмерения,
	ВЫРАЗИТЬ(ВозвратТоваровОтПокупателяТовары.Номенклатура.Наименование КАК СТРОКА(178)),
	ВЫРАЗИТЬ(ВозвратТоваровОтПокупателяТовары.Номенклатура.НаименованиеПолное КАК СТРОКА(500)),
	ВозвратТоваровОтПокупателяТовары.Цена,
	ВозвратТоваровОтПокупателяТовары.СтавкаНДС,
	ВозвратТоваровОтПокупателяТовары.Партия,
	ВозвратТоваровОтПокупателяТовары.СтранаПроисхождения,
	ЕСТЬNULL(ВозвратТоваровОтПокупателяТовары.НомерГТД, ""),
	-ВозвратТоваровОтПокупателяТовары.Количество,
	-ВозвратТоваровОтПокупателяТовары.Сумма,
	-ВозвратТоваровОтПокупателяТовары.СуммаНДС,
	""
ИЗ
	Документ.ПриходнаяНакладная.Запасы КАК ВозвратТоваровОтПокупателяТовары
ГДЕ
	ВозвратТоваровОтПокупателяТовары.Ссылка В(&amp;Возвраты)</query>
						<autoFillFields>false</autoFillFields>
					</item>
					<item xsi:type="DataSetQuery">
						<name>СчетФактура</name>
						<dataSource>ИсточникДанных1</dataSource>
						<query>ВЫБРАТЬ
	РеализацияТоваровУслугТовары.НомерСтроки КАК НомерСтроки,
	РеализацияТоваровУслугТовары.Номенклатура КАК Номенклатура,
	РеализацияТоваровУслугТовары.Характеристика КАК ХарактеристикаНоменклатуры,
	РеализацияТоваровУслугТовары.ЕдиницаИзмерения КАК ЕдиницаИзмерения,
	ВЫРАЗИТЬ(РеализацияТоваровУслугТовары.Номенклатура.Наименование КАК СТРОКА(178)) КАК Наименование,
	ВЫРАЗИТЬ(РеализацияТоваровУслугТовары.Номенклатура.НаименованиеПолное КАК СТРОКА(500)) КАК НаименованиеПолное,
	РеализацияТоваровУслугТовары.Цена КАК Цена,
	РеализацияТоваровУслугТовары.СтавкаНДС КАК СтавкаНДС,
	РеализацияТоваровУслугТовары.Партия КАК СерияНоменклатуры,
	РеализацияТоваровУслугТовары.СтранаПроисхождения КАК Страна,
	ЕСТЬNULL(РеализацияТоваровУслугТовары.НомерГТД, "") КАК НомерГТД,
	РеализацияТоваровУслугТовары.Количество КАК Количество,
	ВЫБОР
		КОГДА &amp;СуммаВключаетНДС
			ТОГДА РеализацияТоваровУслугТовары.Всего
		ИНАЧЕ РеализацияТоваровУслугТовары.Сумма
	КОНЕЦ КАК Сумма,
	РеализацияТоваровУслугТовары.СуммаНДС КАК СуммаНДС,
	ВЫБОР
		КОГДА РеализацияТоваровУслугТовары.Номенклатура.ТипНоменклатуры = ЗНАЧЕНИЕ(Перечисление.ТипыНоменклатуры.Услуга)
			ТОГДА "Services"
		ИНАЧЕ ""
	КОНЕЦ КАК ТипЕдиницы
ИЗ
	Документ.СчетФактура.Запасы КАК РеализацияТоваровУслугТовары
ГДЕ
	РеализацияТоваровУслугТовары.Ссылка В(&amp;Ссылка)
	И (НЕ РеализацияТоваровУслугТовары.Номенклатура.ТипНоменклатуры = ЗНАЧЕНИЕ(Перечисление.ТипыНоменклатуры.Услуга)
			ИЛИ &amp;РаботаСУслугами)

ОБЪЕДИНИТЬ ВСЕ

ВЫБРАТЬ
	0,
	ВозвратТоваровОтПокупателяТовары.Номенклатура,
	ВозвратТоваровОтПокупателяТовары.Характеристика,
	ВозвратТоваровОтПокупателяТовары.ЕдиницаИзмерения,
	ВЫРАЗИТЬ(ВозвратТоваровОтПокупателяТовары.Номенклатура.Наименование КАК СТРОКА(178)),
	ВЫРАЗИТЬ(ВозвратТоваровОтПокупателяТовары.Номенклатура.НаименованиеПолное КАК СТРОКА(500)),
	ВозвратТоваровОтПокупателяТовары.Цена,
	ВозвратТоваровОтПокупателяТовары.СтавкаНДС,
	ВозвратТоваровОтПокупателяТовары.Партия,
	ВозвратТоваровОтПокупателяТовары.СтранаПроисхождения,
	ЕСТЬNULL(ВозвратТоваровОтПокупателяТовары.НомерГТД, ""),
	-ВозвратТоваровОтПокупателяТовары.Количество,
	-ВозвратТоваровОтПокупателяТовары.Сумма,
	-ВозвратТоваровОтПокупателяТовары.СуммаНДС,
	""
ИЗ
	Документ.ПриходнаяНакладная.Запасы КАК ВозвратТоваровОтПокупателяТовары
ГДЕ
	ВозвратТоваровОтПокупателяТовары.Ссылка В(&amp;Возвраты)</query>
						<autoFillFields>false</autoFillFields>
					</item>
				</item>
				<item xsi:type="DataSetUnion">
					<name>_RETINS_RETREC_</name>
					<item xsi:type="DataSetQuery">
						<name>ПриходнаяНакладная</name>
						<dataSource>ИсточникДанных1</dataSource>
						<query>ВЫБРАТЬ
	ПриходнаяНакладнаяЗапасы.НомерСтроки,
	ПриходнаяНакладнаяЗапасы.Номенклатура,
	ПриходнаяНакладнаяЗапасы.Характеристика КАК ХарактеристикаНоменклатуры,
	ПриходнаяНакладнаяЗапасы.ЕдиницаИзмерения,
	ВЫРАЗИТЬ(ПриходнаяНакладнаяЗапасы.Номенклатура.Наименование КАК СТРОКА(178)) КАК Наименование,
	ВЫРАЗИТЬ(ПриходнаяНакладнаяЗапасы.Номенклатура.НаименованиеПолное КАК СТРОКА(500)) КАК НаименованиеПолное,
	ПриходнаяНакладнаяЗапасы.Цена,
	ПриходнаяНакладнаяЗапасы.СтавкаНДС,
	НЕОПРЕДЕЛЕНО КАК СерияНоменклатуры,
	НЕОПРЕДЕЛЕНО КАК Страна,
	НЕОПРЕДЕЛЕНО КАК НомерГТД,
	ПриходнаяНакладнаяЗапасы.Количество,
	ПриходнаяНакладнаяЗапасы.Сумма,
	ПриходнаяНакладнаяЗапасы.СуммаНДС,
	"" КАК ТипЕдиницы
ИЗ
	Документ.ПриходнаяНакладная.Запасы КАК ПриходнаяНакладнаяЗапасы
ГДЕ
	ПриходнаяНакладнаяЗапасы.Ссылка В(&amp;Ссылка)</query>
					</item>
				</item>
				<item xsi:type="DataSetUnion">
					<name>_COINVOIC_IINVOIC_</name>
					<field xsi:type="DataSetFieldField">
						<dataPath>ЕдиницаИзмерения</dataPath>
						<field>ЕдиницаИзмерения</field>
					</field>
					<field xsi:type="DataSetFieldField">
						<dataPath>Количество</dataPath>
						<field>Количество</field>
					</field>
					<field xsi:type="DataSetFieldField">
						<dataPath>КоличествоДоКорректировки</dataPath>
						<field>КоличествоДоКорректировки</field>
					</field>
					<field xsi:type="DataSetFieldField">
						<dataPath>Номенклатура</dataPath>
						<field>Номенклатура</field>
					</field>
					<field xsi:type="DataSetFieldField">
						<dataPath>НоменклатураНаименование</dataPath>
						<field>НоменклатураНаименование</field>
					</field>
					<field xsi:type="DataSetFieldField">
						<dataPath>НоменклатураНаименованиеПолное</dataPath>
						<field>НоменклатураНаименованиеПолное</field>
					</field>
					<field xsi:type="DataSetFieldField">
						<dataPath>НомерГТД</dataPath>
						<field>НомерГТД</field>
					</field>
					<field xsi:type="DataSetFieldField">
						<dataPath>НомерСтроки</dataPath>
						<field>НомерСтроки</field>
					</field>
					<field xsi:type="DataSetFieldField">
						<dataPath>СерияНоменклатуры</dataPath>
						<field>СерияНоменклатуры</field>
					</field>
					<field xsi:type="DataSetFieldField">
						<dataPath>СтавкаНДС</dataPath>
						<field>СтавкаНДС</field>
					</field>
					<field xsi:type="DataSetFieldField">
						<dataPath>СтавкаНДСДоКорректировки</dataPath>
						<field>СтавкаНДСДоКорректировки</field>
					</field>
					<field xsi:type="DataSetFieldField">
						<dataPath>Страна</dataPath>
						<field>Страна</field>
					</field>
					<field xsi:type="DataSetFieldField">
						<dataPath>Сумма</dataPath>
						<field>Сумма</field>
					</field>
					<field xsi:type="DataSetFieldField">
						<dataPath>СуммаДоКорректировки</dataPath>
						<field>СуммаДоКорректировки</field>
					</field>
					<field xsi:type="DataSetFieldField">
						<dataPath>СуммаНДС</dataPath>
						<field>СуммаНДС</field>
					</field>
					<field xsi:type="DataSetFieldField">
						<dataPath>СуммаНДСДоКорректировки</dataPath>
						<field>СуммаНДСДоКорректировки</field>
					</field>
					<field xsi:type="DataSetFieldField">
						<dataPath>ТипЕдиницы</dataPath>
						<field>ТипЕдиницы</field>
					</field>
					<field xsi:type="DataSetFieldField">
						<dataPath>ХарактеристикаНоменклатуры</dataPath>
						<field>ХарактеристикаНоменклатуры</field>
					</field>
					<field xsi:type="DataSetFieldField">
						<dataPath>Цена</dataPath>
						<field>Цена</field>
					</field>
					<field xsi:type="DataSetFieldField">
						<dataPath>ЦенаДоКорректировки</dataPath>
						<field>ЦенаДоКорректировки</field>
					</field>
					<item xsi:type="DataSetQuery">
						<name>КорректировкаРеализации</name>
						<field xsi:type="DataSetFieldField">
							<dataPath>ЕдиницаИзмерения</dataPath>
							<field>ЕдиницаИзмерения</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>Количество</dataPath>
							<field>Количество</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>КоличествоДоКорректировки</dataPath>
							<field>КоличествоДоКорректировки</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>Номенклатура</dataPath>
							<field>Номенклатура</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>НоменклатураНаименование</dataPath>
							<field>НоменклатураНаименование</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>НоменклатураНаименованиеПолное</dataPath>
							<field>НоменклатураНаименованиеПолное</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>НомерГТД</dataPath>
							<field>НомерГТД</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>НомерСтроки</dataPath>
							<field>НомерСтроки</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>СерияНоменклатуры</dataPath>
							<field>СерияНоменклатуры</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>СтавкаНДС</dataPath>
							<field>СтавкаНДС</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>СтавкаНДСДоКорректировки</dataPath>
							<field>СтавкаНДСДоКорректировки</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>Страна</dataPath>
							<field>Страна</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>Сумма</dataPath>
							<field>Сумма</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>СуммаДоКорректировки</dataPath>
							<field>СуммаДоКорректировки</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>СуммаНДС</dataPath>
							<field>СуммаНДС</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>СуммаНДСДоКорректировки</dataPath>
							<field>СуммаНДСДоКорректировки</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>ТипЕдиницы</dataPath>
							<field>ТипЕдиницы</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>ХарактеристикаНоменклатуры</dataPath>
							<field>ХарактеристикаНоменклатуры</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>Цена</dataPath>
							<field>Цена</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>ЦенаДоКорректировки</dataPath>
							<field>ЦенаДоКорректировки</field>
						</field>
						<dataSource>ИсточникДанных1</dataSource>
						<query>ВЫБРАТЬ
	КорректировкаРеализацииЗапасы.Номенклатура КАК Номенклатура,
	КорректировкаРеализацииЗапасы.Характеристика КАК ХарактеристикаНоменклатуры,
	КорректировкаРеализацииЗапасы.ЕдиницаИзмерения КАК ЕдиницаИзмерения,
	ВЫРАЗИТЬ(КорректировкаРеализацииЗапасы.Номенклатура.Наименование КАК СТРОКА(178)) КАК Наименование,
	ПОДСТРОКА(КорректировкаРеализацииЗапасы.Номенклатура.НаименованиеПолное, 0, 500) КАК НаименованиеПолное,
	КорректировкаРеализацииЗапасы.СтавкаНДС КАК СтавкаНДС,
	ВЫБОР
		КОГДА &amp;СворачиватьСтроки
			ТОГДА НЕОПРЕДЕЛЕНО
		ИНАЧЕ КорректировкаРеализацииЗапасы.Партия
	КОНЕЦ КАК СерияНоменклатуры,
	ВЫБОР
		КОГДА &amp;ТипСообщения = "INVOIC"
			ТОГДА ВЫБОР
					КОГДА КорректировкаРеализацииЗапасы.СтранаПроисхождения = ЗНАЧЕНИЕ(Справочник.СтраныМира.ПустаяСсылка)
						ТОГДА КорректировкаРеализацииЗапасы.СтранаПроисхождения
					ИНАЧЕ КорректировкаРеализацииЗапасы.СтранаПроисхождения
				КОНЕЦ
		ИНАЧЕ КорректировкаРеализацииЗапасы.СтранаПроисхождения
	КОНЕЦ КАК Страна,
	ВЫБОР
		КОГДА &amp;ТипСообщения = "INVOIC"
			ТОГДА  ВЫБОР
					КОГДА КорректировкаРеализацииЗапасы.НомерГТД = ЗНАЧЕНИЕ(Справочник.НомераГТД.ПустаяСсылка)
						ТОГДА ЗНАЧЕНИЕ(Справочник.НомераГТД.ПустаяСсылка)
					ИНАЧЕ КорректировкаРеализацииЗапасы.НомерГТД
				КОНЕЦ 
		ИНАЧЕ ЗНАЧЕНИЕ(Справочник.НомераГТД.ПустаяСсылка)
	КОНЕЦ КАК НомерГТД,
	СУММА(КорректировкаРеализацииЗапасы.Количество) КАК Количество,
	СУММА(КорректировкаРеализацииЗапасы.Сумма) КАК Сумма,
	СУММА(КорректировкаРеализацииЗапасы.СуммаНДС) КАК СуммаНДС,
	МАКСИМУМ(КорректировкаРеализацииЗапасы.Цена) КАК Цена,
	КорректировкаРеализацииЗапасы.ЦенаДоКорректировки КАК ЦенаДоКорректировки,
	КорректировкаРеализацииЗапасы.СтавкаНДСДоИзменения КАК СтавкаНДСДоКорректировки,
	СУММА(КорректировкаРеализацииЗапасы.КоличествоДоКорректировки) КАК КоличествоДоКорректировки,
	СУММА(КорректировкаРеализацииЗапасы.СуммаДоКорректировки) КАК СуммаДоКорректировки,
	СУММА(КорректировкаРеализацииЗапасы.СуммаНДСДоКорректировки) КАК СуммаНДСДоКорректировки,
	ВЫБОР
		КОГДА КорректировкаРеализацииЗапасы.Номенклатура.ТипНоменклатуры = ЗНАЧЕНИЕ(Перечисление.ТипыНоменклатуры.Услуга)
			ТОГДА "Services"
		ИНАЧЕ ""
	КОНЕЦ КАК ТипЕдиницы
ПОМЕСТИТЬ табКорректировки
ИЗ
	Документ.КорректировкаРеализации.Запасы КАК КорректировкаРеализацииЗапасы
ГДЕ
	КорректировкаРеализацииЗапасы.Ссылка В(&amp;Ссылка)

СГРУППИРОВАТЬ ПО
	КорректировкаРеализацииЗапасы.Номенклатура,
	КорректировкаРеализацииЗапасы.Характеристика,
	КорректировкаРеализацииЗапасы.ЕдиницаИзмерения,
	ВЫРАЗИТЬ(КорректировкаРеализацииЗапасы.Номенклатура.Наименование КАК СТРОКА(178)),
	ПОДСТРОКА(КорректировкаРеализацииЗапасы.Номенклатура.НаименованиеПолное, 0, 500),
	КорректировкаРеализацииЗапасы.СтавкаНДС,
	ВЫБОР
		КОГДА &amp;СворачиватьСтроки
			ТОГДА НЕОПРЕДЕЛЕНО
		ИНАЧЕ КорректировкаРеализацииЗапасы.Партия
	КОНЕЦ,
	ВЫБОР
		КОГДА &amp;ТипСообщения = "INVOIC"
			ТОГДА ВЫБОР
					КОГДА КорректировкаРеализацииЗапасы.СтранаПроисхождения = ЗНАЧЕНИЕ(Справочник.СтраныМира.ПустаяСсылка)
						ТОГДА КорректировкаРеализацииЗапасы.СтранаПроисхождения
					ИНАЧЕ КорректировкаРеализацииЗапасы.СтранаПроисхождения
				КОНЕЦ
		ИНАЧЕ КорректировкаРеализацииЗапасы.СтранаПроисхождения
	КОНЕЦ,
	ВЫБОР
		КОГДА &amp;ТипСообщения = "INVOIC"
			ТОГДА  ВЫБОР
					КОГДА КорректировкаРеализацииЗапасы.НомерГТД = ЗНАЧЕНИЕ(Справочник.НомераГТД.ПустаяСсылка)
						ТОГДА ЗНАЧЕНИЕ(Справочник.НомераГТД.ПустаяСсылка)
					ИНАЧЕ КорректировкаРеализацииЗапасы.НомерГТД
				КОНЕЦ 
		ИНАЧЕ ЗНАЧЕНИЕ(Справочник.НомераГТД.ПустаяСсылка)
	КОНЕЦ,
	КорректировкаРеализацииЗапасы.СтавкаНДСДоИзменения,
	ВЫБОР
		КОГДА КорректировкаРеализацииЗапасы.Номенклатура.ТипНоменклатуры = ЗНАЧЕНИЕ(Перечисление.ТипыНоменклатуры.Услуга)
			ТОГДА "Services"
		ИНАЧЕ ""
	КОНЕЦ,
	КорректировкаРеализацииЗапасы.ЦенаДоКорректировки
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ
	табКорректировки.Номенклатура КАК Номенклатура,
	табКорректировки.ХарактеристикаНоменклатуры КАК ХарактеристикаНоменклатуры,
	табКорректировки.ЕдиницаИзмерения КАК ЕдиницаИзмерения,
	табКорректировки.Наименование КАК Наименование,
	табКорректировки.НаименованиеПолное КАК НаименованиеПолное,
	табКорректировки.СтавкаНДС КАК СтавкаНДС,
	табКорректировки.СерияНоменклатуры КАК СерияНоменклатуры,
	табКорректировки.Страна КАК Страна,
	табКорректировки.НомерГТД КАК НомерГТД,
	табКорректировки.Количество КАК Количество,
	табКорректировки.Сумма КАК Сумма,
	табКорректировки.СуммаНДС КАК СуммаНДС,
	ВЫБОР
		КОГДА НЕ табКорректировки.Цена = 0
			ТОГДА табКорректировки.Цена
		КОГДА НЕ табКорректировки.Количество = 0
			ТОГДА табКорректировки.Сумма / табКорректировки.Количество
		ИНАЧЕ 0
	КОНЕЦ КАК Цена,
	табКорректировки.ЦенаДоКорректировки КАК ЦенаДоКорректировки,
	табКорректировки.СтавкаНДСДоКорректировки КАК СтавкаНДСДоКорректировки,
	табКорректировки.КоличествоДоКорректировки КАК КоличествоДоКорректировки,
	табКорректировки.СуммаДоКорректировки КАК СуммаДоКорректировки,
	табКорректировки.СуммаНДСДоКорректировки КАК СуммаНДСДоКорректировки,
	табКорректировки.ТипЕдиницы КАК ТипЕдиницы
ИЗ
	табКорректировки КАК табКорректировки</query>
					</item>
				</item>
				<item xsi:type="DataSetUnion">
					<name>_PRICELIST_</name>
					<field xsi:type="DataSetFieldField">
						<dataPath>GTIN</dataPath>
						<field>GTIN</field>
					</field>
					<field xsi:type="DataSetFieldField">
						<dataPath>ЕдИзмСрокаГодности</dataPath>
						<field>ЕдИзмСрокаГодности</field>
					</field>
					<field xsi:type="DataSetFieldField">
						<dataPath>ЕдиницаИзмерения</dataPath>
						<field>ЕдиницаИзмерения</field>
					</field>
					<field xsi:type="DataSetFieldField">
						<dataPath>КвантПоставки</dataPath>
						<field>КвантПоставки</field>
					</field>
					<field xsi:type="DataSetFieldField">
						<dataPath>КодТовараПоставщика</dataPath>
						<field>КодТовараПоставщика</field>
					</field>
					<field xsi:type="DataSetFieldField">
						<dataPath>КоличествоВОдномМесте</dataPath>
						<field>КоличествоВОдномМесте</field>
					</field>
					<field xsi:type="DataSetFieldField">
						<dataPath>Наименование</dataPath>
						<field>Наименование</field>
					</field>
					<field xsi:type="DataSetFieldField">
						<dataPath>Номенклатура</dataPath>
						<field>Номенклатура</field>
					</field>
					<field xsi:type="DataSetFieldField">
						<dataPath>Родитель</dataPath>
						<field>Родитель</field>
					</field>
					<field xsi:type="DataSetFieldField">
						<dataPath>СрокГодности</dataPath>
						<field>СрокГодности</field>
					</field>
					<field xsi:type="DataSetFieldField">
						<dataPath>СтавкаНДС</dataPath>
						<field>СтавкаНДС</field>
					</field>
					<field xsi:type="DataSetFieldField">
						<dataPath>Страна</dataPath>
						<field>Страна</field>
					</field>
					<field xsi:type="DataSetFieldField">
						<dataPath>Цена</dataPath>
						<field>Цена</field>
					</field>
					<item xsi:type="DataSetQuery">
						<name>Ценовой_лист_БезЦен</name>
						<field xsi:type="DataSetFieldField">
							<dataPath>GTIN</dataPath>
							<field>GTIN</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>ЕдИзмСрокаГодности</dataPath>
							<field>ЕдИзмСрокаГодности</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>ЕдиницаИзмерения</dataPath>
							<field>ЕдиницаИзмерения</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>КвантПоставки</dataPath>
							<field>КвантПоставки</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>КодТовараПоставщика</dataPath>
							<field>КодТовараПоставщика</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>КоличествоВОдномМесте</dataPath>
							<field>КоличествоВОдномМесте</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>Наименование</dataPath>
							<field>Наименование</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>Номенклатура</dataPath>
							<field>Номенклатура</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>Родитель</dataPath>
							<field>Родитель</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>СрокГодности</dataPath>
							<field>СрокГодности</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>СтавкаНДС</dataPath>
							<field>СтавкаНДС</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>Страна</dataPath>
							<field>Страна</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>Цена</dataPath>
							<field>Цена</field>
						</field>
						<dataSource>ИсточникДанных1</dataSource>
						<query>ВЫБРАТЬ
	СправочникНоменклатура.Родитель КАК Родитель,
	СправочникНоменклатура.Ссылка КАК Номенклатура,
	СправочникНоменклатура.ЕдиницаИзмерения КАК ЕдиницаИзмерения,
	СправочникНоменклатура.Код КАК КодТовараПоставщика,
	СправочникНоменклатура.НаименованиеПолное КАК Наименование,
	СправочникНоменклатура.СтавкаНДС КАК СтавкаНДС,
	0 КАК Цена,
	0 КАК РекомендуемаяРозничнаяЦена,
	Штрихкоды.Штрихкод КАК GTIN,
	NULL КАК КоличествоВОдномМесте,
	СправочникНоменклатура.СтранаПроисхождения КАК Страна,
	NULL КАК КвантПоставки,
	NULL КАК ЕдИзмСрокаГодности,
	NULL КАК СрокГодности
ИЗ
	Справочник.Номенклатура КАК СправочникНоменклатура
		ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.ШтрихкодыНоменклатуры КАК Штрихкоды
		ПО СправочникНоменклатура.Ссылка = Штрихкоды.Номенклатура
			И (Штрихкоды.Характеристика = ЗНАЧЕНИЕ(Справочник.ХарактеристикиНоменклатуры.ПустаяСсылка))
			И (Штрихкоды.ЕдиницаИзмерения = СправочникНоменклатура.ЕдиницаИзмерения)
ГДЕ
	НЕ СправочникНоменклатура.ЭтоГруппа
	И НЕ СправочникНоменклатура.ПометкаУдаления
	И НЕ СправочникНоменклатура.ТипНоменклатуры = ЗНАЧЕНИЕ(Перечисление.ТипыНоменклатуры.Услуга)
	И &amp;УсловиеОтбораНоменклатуры</query>
					</item>
					<item xsi:type="DataSetQuery">
						<name>Ценовой_лист_СЦенами</name>
						<field xsi:type="DataSetFieldField">
							<dataPath>GTIN</dataPath>
							<field>GTIN</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>ЕдИзмСрокаГодности</dataPath>
							<field>ЕдИзмСрокаГодности</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>ЕдиницаИзмерения</dataPath>
							<field>ЕдиницаИзмерения</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>КвантПоставки</dataPath>
							<field>КвантПоставки</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>КодТовараПоставщика</dataPath>
							<field>КодТовараПоставщика</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>КоличествоВОдномМесте</dataPath>
							<field>КоличествоВОдномМесте</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>Наименование</dataPath>
							<field>Наименование</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>Номенклатура</dataPath>
							<field>Номенклатура</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>Родитель</dataPath>
							<field>Родитель</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>СрокГодности</dataPath>
							<field>СрокГодности</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>СтавкаНДС</dataPath>
							<field>СтавкаНДС</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>Страна</dataPath>
							<field>Страна</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>Цена</dataPath>
							<field>Цена</field>
						</field>
						<dataSource>ИсточникДанных1</dataSource>
						<query>ВЫБРАТЬ
	ЦеныНоменклатурыСрезПоследних.Номенклатура.Родитель КАК Родитель,
	ЦеныНоменклатурыСрезПоследних.Номенклатура.Ссылка КАК Номенклатура,
	ЦеныНоменклатурыСрезПоследних.ЕдиницаИзмерения КАК ЕдиницаИзмерения,
	ЦеныНоменклатурыСрезПоследних.Номенклатура.Код КАК КодТовараПоставщика,
	ЦеныНоменклатурыСрезПоследних.Номенклатура.НаименованиеПолное КАК Наименование,
	ЦеныНоменклатурыСрезПоследних.Номенклатура.СтавкаНДС КАК СтавкаНДС,
	ЦеныНоменклатурыСрезПоследних.Цена,
	0 КАК РекомендуемаяРозничнаяЦена,
	Штрихкоды.Штрихкод КАК GTIN,
	NULL КАК КоличествоВОдномМесте,
	ЦеныНоменклатурыСрезПоследних.Номенклатура.СтранаПроисхождения КАК Страна,
	NULL КАК КвантПоставки,
	NULL КАК ЕдИзмСрокаГодности,
	NULL КАК СрокГодности
ИЗ
	РегистрСведений.ЦеныНоменклатуры.СрезПоследних(
			,
			ВидЦен = &amp;ТипЦен
				И НЕ Номенклатура.ПометкаУдаления
				И НЕ Номенклатура.ТипНоменклатуры = ЗНАЧЕНИЕ(Перечисление.ТипыНоменклатуры.Услуга)
				И &amp;УсловиеОтбораНоменклатуры) КАК ЦеныНоменклатурыСрезПоследних
		ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.ШтрихкодыНоменклатуры КАК Штрихкоды
		ПО ЦеныНоменклатурыСрезПоследних.Номенклатура = Штрихкоды.Номенклатура
			И (Штрихкоды.ЕдиницаИзмерения = ЦеныНоменклатурыСрезПоследних.ЕдиницаИзмерения)
ГДЕ
	ЦеныНоменклатурыСрезПоследних.Цена &gt; 0</query>
					</item>
					<item xsi:type="DataSetQuery">
						<name>Ценовой_лист_БезЦен_Остатки</name>
						<field xsi:type="DataSetFieldField">
							<dataPath>GTIN</dataPath>
							<field>GTIN</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>ЕдИзмСрокаГодности</dataPath>
							<field>ЕдИзмСрокаГодности</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>ЕдиницаИзмерения</dataPath>
							<field>ЕдиницаИзмерения</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>КвантПоставки</dataPath>
							<field>КвантПоставки</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>КодТовараПоставщика</dataPath>
							<field>КодТовараПоставщика</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>КоличествоВОдномМесте</dataPath>
							<field>КоличествоВОдномМесте</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>Наименование</dataPath>
							<field>Наименование</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>Номенклатура</dataPath>
							<field>Номенклатура</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>Родитель</dataPath>
							<field>Родитель</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>СрокГодности</dataPath>
							<field>СрокГодности</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>СтавкаНДС</dataPath>
							<field>СтавкаНДС</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>Страна</dataPath>
							<field>Страна</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>Цена</dataPath>
							<field>Цена</field>
						</field>
						<dataSource>ИсточникДанных1</dataSource>
						<query>ВЫБРАТЬ
	СправочникНоменклатура.Родитель КАК Родитель,
	СправочникНоменклатура.Ссылка КАК Номенклатура,
	СправочникНоменклатура.ЕдиницаИзмерения КАК ЕдиницаИзмерения,
	СправочникНоменклатура.Код КАК КодТовараПоставщика,
	СправочникНоменклатура.НаименованиеПолное КАК Наименование,
	СправочникНоменклатура.СтавкаНДС КАК СтавкаНДС,
	0 КАК Цена,
	0 КАК РекомендуемаяРозничнаяЦена,
	Штрихкоды.Штрихкод КАК GTIN,
	NULL КАК КоличествоВОдномМесте,
	СправочникНоменклатура.СтранаПроисхождения КАК Страна,
	NULL КАК КвантПоставки,
	NULL КАК ЕдИзмСрокаГодности,
	NULL КАК СрокГодности,
	ЕСТЬNULL(ЗапасыНаСкладахОстатки.КоличествоОстаток, 0) КАК КоличествоОстаткаНаКонец
ИЗ
	Справочник.Номенклатура КАК СправочникНоменклатура
		ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.ШтрихкодыНоменклатуры КАК Штрихкоды
		ПО СправочникНоменклатура.Ссылка = Штрихкоды.Номенклатура
			И (Штрихкоды.Характеристика = ЗНАЧЕНИЕ(Справочник.ХарактеристикиНоменклатуры.ПустаяСсылка))
			И (Штрихкоды.ЕдиницаИзмерения = СправочникНоменклатура.ЕдиницаИзмерения)
		ЛЕВОЕ СОЕДИНЕНИЕ РегистрНакопления.ЗапасыНаСкладах.Остатки КАК ЗапасыНаСкладахОстатки
		ПО СправочникНоменклатура.Ссылка = ЗапасыНаСкладахОстатки.Номенклатура
ГДЕ
	НЕ СправочникНоменклатура.ЭтоГруппа
	И НЕ СправочникНоменклатура.ПометкаУдаления
	И НЕ СправочникНоменклатура.ТипНоменклатуры = ЗНАЧЕНИЕ(Перечисление.ТипыНоменклатуры.Услуга)
	И &amp;УсловиеОтбораНоменклатуры</query>
					</item>
					<item xsi:type="DataSetQuery">
						<name>Ценовой_лист_СЦенами_Остатки</name>
						<field xsi:type="DataSetFieldField">
							<dataPath>GTIN</dataPath>
							<field>GTIN</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>ЕдИзмСрокаГодности</dataPath>
							<field>ЕдИзмСрокаГодности</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>ЕдиницаИзмерения</dataPath>
							<field>ЕдиницаИзмерения</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>КвантПоставки</dataPath>
							<field>КвантПоставки</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>КодТовараПоставщика</dataPath>
							<field>КодТовараПоставщика</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>КоличествоВОдномМесте</dataPath>
							<field>КоличествоВОдномМесте</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>Наименование</dataPath>
							<field>Наименование</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>Номенклатура</dataPath>
							<field>Номенклатура</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>Родитель</dataPath>
							<field>Родитель</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>СрокГодности</dataPath>
							<field>СрокГодности</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>СтавкаНДС</dataPath>
							<field>СтавкаНДС</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>Страна</dataPath>
							<field>Страна</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>Цена</dataPath>
							<field>Цена</field>
						</field>
						<dataSource>ИсточникДанных1</dataSource>
						<query>ВЫБРАТЬ
	ЦеныНоменклатурыСрезПоследних.Номенклатура.Родитель КАК Родитель,
	ЦеныНоменклатурыСрезПоследних.Номенклатура.Ссылка КАК Номенклатура,
	ЦеныНоменклатурыСрезПоследних.ЕдиницаИзмерения КАК ЕдиницаИзмерения,
	ЦеныНоменклатурыСрезПоследних.Номенклатура.Код КАК КодТовараПоставщика,
	ЦеныНоменклатурыСрезПоследних.Номенклатура.НаименованиеПолное КАК Наименование,
	ЦеныНоменклатурыСрезПоследних.Номенклатура.СтавкаНДС КАК СтавкаНДС,
	ЦеныНоменклатурыСрезПоследних.Цена,
	0 КАК РекомендуемаяРозничнаяЦена,
	Штрихкоды.Штрихкод КАК GTIN,
	NULL КАК КоличествоВОдномМесте,
	ЦеныНоменклатурыСрезПоследних.Номенклатура.СтранаПроисхождения КАК Страна,
	NULL КАК КвантПоставки,
	NULL КАК ЕдИзмСрокаГодности,
	NULL КАК СрокГодности,
	ЕСТЬNULL(ЗапасыНаСкладахОстатки.КоличествоОстаток, 0) КАК КоличествоОстаткаНаКонец
ИЗ
	РегистрСведений.ЦеныНоменклатуры.СрезПоследних(
			,
			ВидЦен = &amp;ТипЦен
				И НЕ Номенклатура.ПометкаУдаления
				И НЕ Номенклатура.ТипНоменклатуры = ЗНАЧЕНИЕ(Перечисление.ТипыНоменклатуры.Услуга)
				И &amp;УсловиеОтбораНоменклатуры) КАК ЦеныНоменклатурыСрезПоследних
		ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.ШтрихкодыНоменклатуры КАК Штрихкоды
		ПО ЦеныНоменклатурыСрезПоследних.Номенклатура = Штрихкоды.Номенклатура
			И (Штрихкоды.ЕдиницаИзмерения = ЦеныНоменклатурыСрезПоследних.ЕдиницаИзмерения)
		ЛЕВОЕ СОЕДИНЕНИЕ РегистрНакопления.ЗапасыНаСкладах.Остатки КАК ЗапасыНаСкладахОстатки
		ПО ЦеныНоменклатурыСрезПоследних.Номенклатура = ЗапасыНаСкладахОстатки.Номенклатура
ГДЕ
	ЦеныНоменклатурыСрезПоследних.Цена &gt; 0</query>
					</item>
				</item>
			</item>
			<item xsi:type="DataSetUnion">
				<name>ЗапросПоCOINVOIC</name>
				<item xsi:type="DataSetQuery">
					<name>Заказ_Реализация_СФ</name>
					<dataSource>ИсточникДанных1</dataSource>
					<query>ВЫБРАТЬ РАЗРЕШЕННЫЕ
	докКорректировка.Ссылка КАК Корректировка,
	ВЫБОР
		КОГДА НЕ докКорректировка.Проведен
			ТОГДА докКорректировка.Ссылка
		ИНАЧЕ ЕСТЬNULL(докСчетФактура.Ссылка, докКорректировка.Ссылка)
	КОНЕЦ КАК Документ,
	ВЫБОР
		КОГДА НЕ докКорректировка.Проведен
			ТОГДА "Провести Корректировка реализации"
		КОГДА докСчетФактура.Ссылка ЕСТЬ NULL
			ТОГДА "Создать Счет-фактура по корректировке"
		КОГДА НЕ докСчетФактура.Ссылка.Проведен И &amp;ТребуетсяПроведениеCOINVOIC
			ТОГДА "Провести Счет-фактура по корректировке"
		КОГДА докСчетФактура.ВидОперации &lt;&gt; ЗНАЧЕНИЕ(Перечисление.ВидыОперацийСчетФактура.Корректировка)
			ТОГДА "Отправить счет-фактуру"
		ИНАЧЕ "Отправить корректировочный счет-фактуру"
	КОНЕЦ КАК ТребуемоеДействие,
	ВЫБОР
		КОГДА докСчетФактура.ВидОперации &lt;&gt; ЗНАЧЕНИЕ(Перечисление.ВидыОперацийСчетФактура.Корректировка)
			ТОГДА "INVOIC"
		ИНАЧЕ "COINVOIC"
	КОНЕЦ КАК ТипСообщения,
	докКорректировка.ДокументОснование КАК ДокументРеализации,
	ТаблицаКэшПартнеровКонтрагентов.Партнер
ПОМЕСТИТЬ табКорректировки
ИЗ
	ТаблицаКэшПартнеровКонтрагентов КАК ТаблицаКэшПартнеровКонтрагентов
		ВНУТРЕННЕЕ СОЕДИНЕНИЕ Документ.КорректировкаРеализации КАК докКорректировка
			ЛЕВОЕ СОЕДИНЕНИЕ Документ.СчетФактура КАК докСчетФактура
				ЛЕВОЕ СОЕДИНЕНИЕ Справочник.КонтурEDI_Сообщения КАК КонтурEDI_Сообщения
				ПО (КонтурEDI_Сообщения.Документ = докСчетФактура.Ссылка)
					И (КонтурEDI_Сообщения.ТипСообщения = "COINVOIC" 
						ИЛИ КонтурEDI_Сообщения.ТипСообщения = "INVOIC")
				ВНУТРЕННЕЕ СОЕДИНЕНИЕ Документ.СчетФактура.ДокументыОснования КАК СчетФактураДокументыОснования
				ПО (СчетФактураДокументыОснования.Ссылка = докСчетФактура.Ссылка)
			ПО (докКорректировка.Ссылка = СчетФактураДокументыОснования.ДокументОснование)
				И (докСчетФактура.ПометкаУдаления = ЛОЖЬ)
		ПО ТаблицаКэшПартнеровКонтрагентов.Контрагент = докКорректировка.Контрагент
			И (ТаблицаКэшПартнеровКонтрагентов.COINVOIC = ИСТИНА)
ГДЕ
	НЕ докКорректировка.ПометкаУдаления
	И докКорректировка.Дата МЕЖДУ &amp;НачалоПериода И &amp;КонецПериода
	И (докКорректировка.ДокументОснование ССЫЛКА Документ.РасходнаяНакладная
			ИЛИ докКорректировка.ДокументОснование ССЫЛКА Документ.КорректировкаРеализации)
	И ВЫБОР
			КОГДА &amp;ТолькоТребуемые
				ТОГДА КонтурEDI_Сообщения.Ссылка ЕСТЬ NULL
			ИНАЧЕ ИСТИНА
		КОНЕЦ
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ РАЗРЕШЕННЫЕ
	табКорректировки.Корректировка,
	ЕСТЬNULL(СчетФактураВыданныйДокументыОснования.Ссылка, табКорректировки.ДокументРеализации) КАК ПредыдущийДокумент
ПОМЕСТИТЬ табПредыдущихДокументов
ИЗ
	табКорректировки КАК табКорректировки
		ВНУТРЕННЕЕ СОЕДИНЕНИЕ Документ.СчетФактура.ДокументыОснования КАК СчетФактураВыданныйДокументыОснования
		ПО табКорректировки.ДокументРеализации = СчетФактураВыданныйДокументыОснования.ДокументОснование
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ РАЗРЕШЕННЫЕ
	КонтурEDI_Сообщения.Ссылка КАК Сообщение,
	табПредыдущихДокументов.Корректировка,
	табПредыдущихДокументов.ПредыдущийДокумент
ПОМЕСТИТЬ табРазрешенийНаОтправку
ИЗ
	табПредыдущихДокументов КАК табПредыдущихДокументов
		ЛЕВОЕ СОЕДИНЕНИЕ Справочник.КонтурEDI_Сообщения КАК КонтурEDI_Сообщения
		ПО табПредыдущихДокументов.ПредыдущийДокумент = КонтурEDI_Сообщения.Документ
			И (НЕ КонтурEDI_Сообщения.Статус В (&amp;БлокирующиеСтатусыПервичногоINVOIC))
			И (КонтурEDI_Сообщения.ТипСообщения = "COINVOIC"
				ИЛИ КонтурEDI_Сообщения.ТипСообщения = "INVOIC")
ГДЕ
	ВЫБОР
			КОГДА &amp;ТолькоТребуемые
				ТОГДА КонтурEDI_Сообщения.Ссылка ЕСТЬ НЕ NULL 
			ИНАЧЕ ИСТИНА
		КОНЕЦ
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ РАЗРЕШЕННЫЕ
	табКорректировки.Корректировка,
	табКорректировки.Документ,
	табКорректировки.ТребуемоеДействие,
	табКорректировки.ТипСообщения,
	табРазрешенийНаОтправку.Сообщение,
	табКорректировки.Партнер,
	табРазрешенийНаОтправку.ПредыдущийДокумент
ПОМЕСТИТЬ ВТ_КоррИспрСФ
ИЗ
	табКорректировки КАК табКорректировки
		ЛЕВОЕ СОЕДИНЕНИЕ табРазрешенийНаОтправку КАК табРазрешенийНаОтправку
		ПО табКорректировки.Корректировка = табРазрешенийНаОтправку.Корректировка
ГДЕ
	ВЫБОР
			КОГДА &amp;ТолькоТребуемые
				ТОГДА табРазрешенийНаОтправку.Корректировка ЕСТЬ НЕ NULL 
			ИНАЧЕ ИСТИНА
		КОНЕЦ
;

////////////////////////////////////////////////////////////////////////////////
УНИЧТОЖИТЬ табКорректировки
;

////////////////////////////////////////////////////////////////////////////////
УНИЧТОЖИТЬ табПредыдущихДокументов
;

////////////////////////////////////////////////////////////////////////////////
УНИЧТОЖИТЬ табРазрешенийНаОтправку</query>
				</item>
				<item xsi:type="DataSetQuery">
					<name>Реализация_СФ</name>
					<dataSource>ИсточникДанных1</dataSource>
					<query>ВЫБРАТЬ РАЗРЕШЕННЫЕ
	докКорректировка.Ссылка КАК Корректировка,
	ВЫБОР
		КОГДА НЕ докКорректировка.Проведен
			ТОГДА докКорректировка.Ссылка
		ИНАЧЕ ЕСТЬNULL(докСчетФактура.Ссылка, докКорректировка.Ссылка)
	КОНЕЦ КАК Документ,
	ВЫБОР
		КОГДА НЕ докКорректировка.Проведен
			ТОГДА "Провести Корректировка реализации"
		КОГДА докСчетФактура.Ссылка ЕСТЬ NULL
			ТОГДА "Создать Счет-фактура по корректировке"
		КОГДА НЕ докСчетФактура.Ссылка.Проведен И &amp;ТребуетсяПроведениеCOINVOIC
			ТОГДА "Провести Счет-фактура по корректировке"
		КОГДА докСчетФактура.ВидОперации &lt;&gt; ЗНАЧЕНИЕ(Перечисление.ВидыОперацийСчетФактура.Корректировка)
			ТОГДА "Отправить счет-фактуру"
		ИНАЧЕ "Отправить корректировочный счет-фактуру"
	КОНЕЦ КАК ТребуемоеДействие,
	ВЫБОР
		КОГДА докСчетФактура.ВидОперации &lt;&gt; ЗНАЧЕНИЕ(Перечисление.ВидыОперацийСчетФактура.Корректировка)
			ТОГДА "INVOIC"
		ИНАЧЕ "COINVOIC"
	КОНЕЦ КАК ТипСообщения,
	докКорректировка.ДокументОснование КАК ДокументРеализации,
	ТаблицаКэшПартнеровКонтрагентов.Партнер
ПОМЕСТИТЬ табКорректировки
ИЗ
	ТаблицаКэшПартнеровКонтрагентов КАК ТаблицаКэшПартнеровКонтрагентов
		ВНУТРЕННЕЕ СОЕДИНЕНИЕ Документ.КорректировкаРеализации КАК докКорректировка
			ЛЕВОЕ СОЕДИНЕНИЕ Документ.СчетФактура КАК докСчетФактура
				ЛЕВОЕ СОЕДИНЕНИЕ Справочник.КонтурEDI_Сообщения КАК КонтурEDI_Сообщения
				ПО (КонтурEDI_Сообщения.Документ = докСчетФактура.Ссылка)
					И (КонтурEDI_Сообщения.ТипСообщения = "COINVOIC" 
						ИЛИ КонтурEDI_Сообщения.ТипСообщения = "INVOIC")
				ВНУТРЕННЕЕ СОЕДИНЕНИЕ Документ.СчетФактура.ДокументыОснования КАК СчетФактураДокументыОснования
				ПО (СчетФактураДокументыОснования.Ссылка = докСчетФактура.Ссылка)
			ПО (докКорректировка.Ссылка = СчетФактураДокументыОснования.ДокументОснование)
				И (докСчетФактура.ПометкаУдаления = ЛОЖЬ)
		ПО ТаблицаКэшПартнеровКонтрагентов.Контрагент = докКорректировка.Контрагент
			И (ТаблицаКэшПартнеровКонтрагентов.COINVOIC = ИСТИНА)
ГДЕ
	НЕ докКорректировка.ПометкаУдаления
	И докКорректировка.Дата МЕЖДУ &amp;НачалоПериода И &amp;КонецПериода
	И (докКорректировка.ДокументОснование ССЫЛКА Документ.РасходнаяНакладная
			ИЛИ докКорректировка.ДокументОснование ССЫЛКА Документ.КорректировкаРеализации)
	И ВЫБОР
			КОГДА &amp;ТолькоТребуемые
				ТОГДА КонтурEDI_Сообщения.Ссылка ЕСТЬ NULL
			ИНАЧЕ ИСТИНА
		КОНЕЦ
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ РАЗРЕШЕННЫЕ
	табКорректировки.Корректировка,
	ЕСТЬNULL(СчетФактураВыданныйДокументыОснования.Ссылка, табКорректировки.ДокументРеализации) КАК ПредыдущийДокумент
ПОМЕСТИТЬ табПредыдущихДокументов
ИЗ
	табКорректировки КАК табКорректировки
		ВНУТРЕННЕЕ СОЕДИНЕНИЕ Документ.СчетФактура.ДокументыОснования КАК СчетФактураВыданныйДокументыОснования
		ПО табКорректировки.ДокументРеализации = СчетФактураВыданныйДокументыОснования.ДокументОснование
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ РАЗРЕШЕННЫЕ
	КонтурEDI_Сообщения.Ссылка КАК Сообщение,
	табПредыдущихДокументов.Корректировка,
	табПредыдущихДокументов.ПредыдущийДокумент
ПОМЕСТИТЬ табРазрешенийНаОтправку
ИЗ
	табПредыдущихДокументов КАК табПредыдущихДокументов
		ЛЕВОЕ СОЕДИНЕНИЕ Справочник.КонтурEDI_Сообщения КАК КонтурEDI_Сообщения
		ПО табПредыдущихДокументов.ПредыдущийДокумент = КонтурEDI_Сообщения.Документ
			И (НЕ КонтурEDI_Сообщения.Статус В (&amp;БлокирующиеСтатусыПервичногоINVOIC))
			И (КонтурEDI_Сообщения.ТипСообщения = "COINVOIC"
				ИЛИ КонтурEDI_Сообщения.ТипСообщения = "INVOIC")
ГДЕ
	ВЫБОР
			КОГДА &amp;ТолькоТребуемые
				ТОГДА КонтурEDI_Сообщения.Ссылка ЕСТЬ НЕ NULL 
			ИНАЧЕ ИСТИНА
		КОНЕЦ
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ РАЗРЕШЕННЫЕ
	табКорректировки.Корректировка,
	табКорректировки.Документ,
	табКорректировки.ТребуемоеДействие,
	табКорректировки.ТипСообщения,
	табРазрешенийНаОтправку.Сообщение,
	табКорректировки.Партнер,
	табРазрешенийНаОтправку.ПредыдущийДокумент
ПОМЕСТИТЬ ВТ_КоррИспрСФ
ИЗ
	табКорректировки КАК табКорректировки
		ЛЕВОЕ СОЕДИНЕНИЕ табРазрешенийНаОтправку КАК табРазрешенийНаОтправку
		ПО табКорректировки.Корректировка = табРазрешенийНаОтправку.Корректировка
ГДЕ
	ВЫБОР
			КОГДА &amp;ТолькоТребуемые
				ТОГДА табРазрешенийНаОтправку.Корректировка ЕСТЬ НЕ NULL 
			ИНАЧЕ ИСТИНА
		КОНЕЦ
;

////////////////////////////////////////////////////////////////////////////////
УНИЧТОЖИТЬ табКорректировки
;

////////////////////////////////////////////////////////////////////////////////
УНИЧТОЖИТЬ табПредыдущихДокументов
;

////////////////////////////////////////////////////////////////////////////////
УНИЧТОЖИТЬ табРазрешенийНаОтправку</query>
				</item>
				<item xsi:type="DataSetQuery">
					<name>Заказ_Реализация</name>
					<dataSource>ИсточникДанных1</dataSource>
					<query>ВЫБРАТЬ РАЗРЕШЕННЫЕ
	докКорректировка.Ссылка КАК Корректировка,
	ВЫБОР
		КОГДА НЕ докКорректировка.Проведен
			ТОГДА докКорректировка.Ссылка
		КОГДА докКорректировка.ВидОперации &lt;&gt; ЗНАЧЕНИЕ(Перечисление.ВидыОперацийИсправленияПоступленияРеализации.СогласованноеИзменение)
			ТОГДА ЕСТЬNULL(докСчетФактура.Ссылка, докКорректировка.Ссылка)
		ИНАЧЕ докКорректировка.Ссылка
	КОНЕЦ КАК Документ,
	ВЫБОР
		КОГДА НЕ докКорректировка.Проведен
			ТОГДА "Провести Корректировка реализации"
		КОГДА докКорректировка.ВидОперации &lt;&gt; ЗНАЧЕНИЕ(Перечисление.ВидыОперацийИсправленияПоступленияРеализации.СогласованноеИзменение)
			ТОГДА ВЫБОР
					КОГДА докСчетФактура.Ссылка ЕСТЬ NULL
						ТОГДА "Создать Счет-фактура по корректировке"
					КОГДА НЕ докСчетФактура.Ссылка.Проведен И &amp;ТребуетсяПроведениеCOINVOIC
						ТОГДА "Провести Счет-фактура по корректировке"
					ИНАЧЕ "Отправить счет-фактуру"
				КОНЕЦ
		ИНАЧЕ "Отправить корректировочный счет-фактуру"
	КОНЕЦ КАК ТребуемоеДействие,
	ВЫБОР
		КОГДА докКорректировка.ВидОперации = ЗНАЧЕНИЕ(Перечисление.ВидыОперацийИсправленияПоступленияРеализации.СогласованноеИзменение)
			ТОГДА "COINVOIC"
		КОГДА докСчетФактура.ВидОперации &lt;&gt; ЗНАЧЕНИЕ(Перечисление.ВидыОперацийСчетФактура.Корректировка)
			ТОГДА "INVOIC"
		ИНАЧЕ "COINVOIC"
	КОНЕЦ КАК ТипСообщения,
	докКорректировка.ДокументОснование КАК ДокументРеализации,
	ТаблицаКэшПартнеровКонтрагентов.Партнер КАК Партнер
ПОМЕСТИТЬ табКорректировки
ИЗ
	ТаблицаКэшПартнеровКонтрагентов КАК ТаблицаКэшПартнеровКонтрагентов
		ВНУТРЕННЕЕ СОЕДИНЕНИЕ Документ.КорректировкаРеализации КАК докКорректировка
			ЛЕВОЕ СОЕДИНЕНИЕ Документ.СчетФактура КАК докСчетФактура
				ВНУТРЕННЕЕ СОЕДИНЕНИЕ Документ.СчетФактура.ДокументыОснования КАК СчетФактураДокументыОснования
				ПО (СчетФактураДокументыОснования.Ссылка = докСчетФактура.Ссылка)
			ПО (докКорректировка.Ссылка = СчетФактураДокументыОснования.ДокументОснование)
				И (докСчетФактура.ПометкаУдаления = ЛОЖЬ)
		ПО ТаблицаКэшПартнеровКонтрагентов.Контрагент = докКорректировка.Контрагент
			И (ТаблицаКэшПартнеровКонтрагентов.COINVOIC = ИСТИНА)

ГДЕ
	НЕ докКорректировка.ПометкаУдаления
	И докКорректировка.Дата МЕЖДУ &amp;НачалоПериода И &amp;КонецПериода
	И (докКорректировка.ДокументОснование ССЫЛКА Документ.РасходнаяНакладная
			ИЛИ докКорректировка.ДокументОснование ССЫЛКА Документ.КорректировкаРеализации)
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ РАЗРЕШЕННЫЕ
	табКорректировки.Корректировка КАК Корректировка,
	табКорректировки.Документ КАК Документ,
	табКорректировки.ТребуемоеДействие КАК ТребуемоеДействие,
	табКорректировки.ТипСообщения КАК ТипСообщения,
	табКорректировки.ДокументРеализации КАК ДокументРеализации,
	табКорректировки.Партнер КАК Партнер
ПОМЕСТИТЬ табКорректировкиИСообщения
ИЗ
	табКорректировки КАК табКорректировки
		ЛЕВОЕ СОЕДИНЕНИЕ Справочник.КонтурEDI_Сообщения КАК КонтурEDI_Сообщения
		ПО табКорректировки.Документ = КонтурEDI_Сообщения.Документ
			И (КонтурEDI_Сообщения.ТипСообщения = "COINVOIC" 
				ИЛИ КонтурEDI_Сообщения.ТипСообщения = "INVOIC")
ГДЕ
	ВЫБОР
			КОГДА &amp;ТолькоТребуемые
				ТОГДА КонтурEDI_Сообщения.Ссылка ЕСТЬ NULL
			ИНАЧЕ ИСТИНА
		КОНЕЦ
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ РАЗРЕШЕННЫЕ
	табКорректировкиИСообщения.Корректировка КАК Корректировка,
	ЕСТЬNULL(СчетФактураВыданныйДокументыОснования.Ссылка, табКорректировкиИСообщения.ДокументРеализации) КАК ПредыдущийДокумент
ПОМЕСТИТЬ табПредыдущихДокументов
ИЗ
	табКорректировкиИСообщения КАК табКорректировкиИСообщения
		ЛЕВОЕ СОЕДИНЕНИЕ Документ.СчетФактура.ДокументыОснования КАК СчетФактураВыданныйДокументыОснования
		ПО табКорректировкиИСообщения.ДокументРеализации = СчетФактураВыданныйДокументыОснования.ДокументОснование
			И (НЕ табКорректировкиИСообщения.ДокументРеализации ССЫЛКА Документ.РасходнаяНакладная)
			И (НЕ табКорректировкиИСообщения.ДокументРеализации.ВидОперации = ЗНАЧЕНИЕ(Перечисление.ВидыОперацийИсправленияПоступленияРеализации.СогласованноеИзменение))
ГДЕ
	(табКорректировкиИСообщения.ДокументРеализации ССЫЛКА Документ.РасходнаяНакладная
			ИЛИ табКорректировкиИСообщения.ДокументРеализации.ВидОперации = ЗНАЧЕНИЕ(Перечисление.ВидыОперацийИсправленияПоступленияРеализации.СогласованноеИзменение)
			ИЛИ СчетФактураВыданныйДокументыОснования.Ссылка ЕСТЬ НЕ NULL )
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ РАЗРЕШЕННЫЕ
	КонтурEDI_Сообщения.Ссылка КАК Сообщение,
	табПредыдущихДокументов.Корректировка КАК Корректировка,
	табПредыдущихДокументов.ПредыдущийДокумент КАК ПредыдущийДокумент
ПОМЕСТИТЬ табРазрешенийНаОтправку
ИЗ
	табПредыдущихДокументов КАК табПредыдущихДокументов
		ЛЕВОЕ СОЕДИНЕНИЕ Справочник.КонтурEDI_Сообщения КАК КонтурEDI_Сообщения
		ПО табПредыдущихДокументов.ПредыдущийДокумент = КонтурEDI_Сообщения.Документ
			И (НЕ КонтурEDI_Сообщения.Статус В (&amp;БлокирующиеСтатусыПервичногоINVOIC))
			И (КонтурEDI_Сообщения.ТипСообщения = "COINVOIC"
				ИЛИ КонтурEDI_Сообщения.ТипСообщения = "INVOIC")
ГДЕ
	ВЫБОР
			КОГДА &amp;ТолькоТребуемые
				ТОГДА КонтурEDI_Сообщения.Ссылка ЕСТЬ НЕ NULL 
			ИНАЧЕ ИСТИНА
		КОНЕЦ
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ РАЗРЕШЕННЫЕ
	табКорректировкиИСообщения.Корректировка КАК Корректировка,
	табКорректировкиИСообщения.Документ КАК Документ,
	табКорректировкиИСообщения.ТребуемоеДействие КАК ТребуемоеДействие,
	табКорректировкиИСообщения.ТипСообщения КАК ТипСообщения,
	табРазрешенийНаОтправку.Сообщение КАК Сообщение,
	табКорректировкиИСообщения.Партнер КАК Партнер,
	табРазрешенийНаОтправку.ПредыдущийДокумент КАК ПредыдущийДокумент
ПОМЕСТИТЬ ВТ_КоррИспрСФ
ИЗ
	табКорректировкиИСообщения КАК табКорректировкиИСообщения
		ЛЕВОЕ СОЕДИНЕНИЕ табРазрешенийНаОтправку КАК табРазрешенийНаОтправку
		ПО табКорректировкиИСообщения.Корректировка = табРазрешенийНаОтправку.Корректировка
ГДЕ
	ВЫБОР
			КОГДА &amp;ТолькоТребуемые
				ТОГДА табРазрешенийНаОтправку.Корректировка ЕСТЬ НЕ NULL 
			ИНАЧЕ ИСТИНА
		КОНЕЦ
;

////////////////////////////////////////////////////////////////////////////////
УНИЧТОЖИТЬ табКорректировки
;

////////////////////////////////////////////////////////////////////////////////
УНИЧТОЖИТЬ табПредыдущихДокументов
;

////////////////////////////////////////////////////////////////////////////////
УНИЧТОЖИТЬ табРазрешенийНаОтправку
;

////////////////////////////////////////////////////////////////////////////////
УНИЧТОЖИТЬ табКорректировкиИСообщения</query>
				</item>
				<item xsi:type="DataSetQuery">
					<name>Реализация</name>
					<dataSource>ИсточникДанных1</dataSource>
					<query>ВЫБРАТЬ РАЗРЕШЕННЫЕ
	докКорректировка.Ссылка КАК Корректировка,
	ВЫБОР
		КОГДА НЕ докКорректировка.Проведен
			ТОГДА докКорректировка.Ссылка
		КОГДА докКорректировка.ВидОперации &lt;&gt; ЗНАЧЕНИЕ(Перечисление.ВидыОперацийИсправленияПоступленияРеализации.СогласованноеИзменение)
			ТОГДА ЕСТЬNULL(докСчетФактура.Ссылка, докКорректировка.Ссылка)
		ИНАЧЕ докКорректировка.Ссылка
	КОНЕЦ КАК Документ,
	ВЫБОР
		КОГДА НЕ докКорректировка.Проведен
			ТОГДА "Провести Корректировка реализации"
		КОГДА докКорректировка.ВидОперации &lt;&gt; ЗНАЧЕНИЕ(Перечисление.ВидыОперацийИсправленияПоступленияРеализации.СогласованноеИзменение)
			ТОГДА ВЫБОР
					КОГДА докСчетФактура.Ссылка ЕСТЬ NULL
						ТОГДА "Создать Счет-фактура по корректировке"
					КОГДА НЕ докСчетФактура.Ссылка.Проведен И &amp;ТребуетсяПроведениеCOINVOIC
						ТОГДА "Провести Счет-фактура по корректировке"
					ИНАЧЕ "Отправить счет-фактуру"
				КОНЕЦ
		ИНАЧЕ "Отправить корректировочный счет-фактуру"
	КОНЕЦ КАК ТребуемоеДействие,
	ВЫБОР
		КОГДА докКорректировка.ВидОперации = ЗНАЧЕНИЕ(Перечисление.ВидыОперацийИсправленияПоступленияРеализации.СогласованноеИзменение)
			ТОГДА "COINVOIC"
		КОГДА докСчетФактура.ВидОперации &lt;&gt; ЗНАЧЕНИЕ(Перечисление.ВидыОперацийСчетФактура.Корректировка)
			ТОГДА "INVOIC"
		ИНАЧЕ "COINVOIC"
	КОНЕЦ КАК ТипСообщения,
	докКорректировка.ДокументОснование КАК ДокументРеализации,
	ТаблицаКэшПартнеровКонтрагентов.Партнер КАК Партнер
ПОМЕСТИТЬ табКорректировки
ИЗ
	ТаблицаКэшПартнеровКонтрагентов КАК ТаблицаКэшПартнеровКонтрагентов
		ВНУТРЕННЕЕ СОЕДИНЕНИЕ Документ.КорректировкаРеализации КАК докКорректировка
			ЛЕВОЕ СОЕДИНЕНИЕ Документ.СчетФактура КАК докСчетФактура
				ВНУТРЕННЕЕ СОЕДИНЕНИЕ Документ.СчетФактура.ДокументыОснования КАК СчетФактураДокументыОснования
				ПО (СчетФактураДокументыОснования.Ссылка = докСчетФактура.Ссылка)
			ПО (докКорректировка.Ссылка = СчетФактураДокументыОснования.ДокументОснование)
				И (докСчетФактура.ПометкаУдаления = ЛОЖЬ)
		ПО ТаблицаКэшПартнеровКонтрагентов.Контрагент = докКорректировка.Контрагент
			И (ТаблицаКэшПартнеровКонтрагентов.COINVOIC = ИСТИНА)

ГДЕ
	НЕ докКорректировка.ПометкаУдаления
	И докКорректировка.Дата МЕЖДУ &amp;НачалоПериода И &amp;КонецПериода
	И (докКорректировка.ДокументОснование ССЫЛКА Документ.РасходнаяНакладная
			ИЛИ докКорректировка.ДокументОснование ССЫЛКА Документ.КорректировкаРеализации)
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ РАЗРЕШЕННЫЕ
	табКорректировки.Корректировка КАК Корректировка,
	табКорректировки.Документ КАК Документ,
	табКорректировки.ТребуемоеДействие КАК ТребуемоеДействие,
	табКорректировки.ТипСообщения КАК ТипСообщения,
	табКорректировки.ДокументРеализации КАК ДокументРеализации,
	табКорректировки.Партнер КАК Партнер
ПОМЕСТИТЬ табКорректировкиИСообщения
ИЗ
	табКорректировки КАК табКорректировки
		ЛЕВОЕ СОЕДИНЕНИЕ Справочник.КонтурEDI_Сообщения КАК КонтурEDI_Сообщения
		ПО табКорректировки.Документ = КонтурEDI_Сообщения.Документ
			И (КонтурEDI_Сообщения.ТипСообщения = "COINVOIC" 
				ИЛИ КонтурEDI_Сообщения.ТипСообщения = "INVOIC")
ГДЕ
	ВЫБОР
			КОГДА &amp;ТолькоТребуемые
				ТОГДА КонтурEDI_Сообщения.Ссылка ЕСТЬ NULL
			ИНАЧЕ ИСТИНА
		КОНЕЦ
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ РАЗРЕШЕННЫЕ
	табКорректировкиИСообщения.Корректировка КАК Корректировка,
	ЕСТЬNULL(СчетФактураВыданныйДокументыОснования.Ссылка, табКорректировкиИСообщения.ДокументРеализации) КАК ПредыдущийДокумент
ПОМЕСТИТЬ табПредыдущихДокументов
ИЗ
	табКорректировкиИСообщения КАК табКорректировкиИСообщения
		ЛЕВОЕ СОЕДИНЕНИЕ Документ.СчетФактура.ДокументыОснования КАК СчетФактураВыданныйДокументыОснования
		ПО табКорректировкиИСообщения.ДокументРеализации = СчетФактураВыданныйДокументыОснования.ДокументОснование
			И (НЕ табКорректировкиИСообщения.ДокументРеализации ССЫЛКА Документ.РасходнаяНакладная)
			И (НЕ табКорректировкиИСообщения.ДокументРеализации.ВидОперации = ЗНАЧЕНИЕ(Перечисление.ВидыОперацийИсправленияПоступленияРеализации.СогласованноеИзменение))
ГДЕ
	(табКорректировкиИСообщения.ДокументРеализации ССЫЛКА Документ.РасходнаяНакладная
			ИЛИ табКорректировкиИСообщения.ДокументРеализации.ВидОперации = ЗНАЧЕНИЕ(Перечисление.ВидыОперацийИсправленияПоступленияРеализации.СогласованноеИзменение)
			ИЛИ СчетФактураВыданныйДокументыОснования.Ссылка ЕСТЬ НЕ NULL )
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ РАЗРЕШЕННЫЕ
	КонтурEDI_Сообщения.Ссылка КАК Сообщение,
	табПредыдущихДокументов.Корректировка КАК Корректировка,
	табПредыдущихДокументов.ПредыдущийДокумент КАК ПредыдущийДокумент
ПОМЕСТИТЬ табРазрешенийНаОтправку
ИЗ
	табПредыдущихДокументов КАК табПредыдущихДокументов
		ЛЕВОЕ СОЕДИНЕНИЕ Справочник.КонтурEDI_Сообщения КАК КонтурEDI_Сообщения
		ПО табПредыдущихДокументов.ПредыдущийДокумент = КонтурEDI_Сообщения.Документ
			И (НЕ КонтурEDI_Сообщения.Статус В (&amp;БлокирующиеСтатусыПервичногоINVOIC))
			И (КонтурEDI_Сообщения.ТипСообщения = "COINVOIC"
				ИЛИ КонтурEDI_Сообщения.ТипСообщения = "INVOIC")
ГДЕ
	ВЫБОР
			КОГДА &amp;ТолькоТребуемые
				ТОГДА КонтурEDI_Сообщения.Ссылка ЕСТЬ НЕ NULL 
			ИНАЧЕ ИСТИНА
		КОНЕЦ
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ РАЗРЕШЕННЫЕ
	табКорректировкиИСообщения.Корректировка КАК Корректировка,
	табКорректировкиИСообщения.Документ КАК Документ,
	табКорректировкиИСообщения.ТребуемоеДействие КАК ТребуемоеДействие,
	табКорректировкиИСообщения.ТипСообщения КАК ТипСообщения,
	табРазрешенийНаОтправку.Сообщение КАК Сообщение,
	табКорректировкиИСообщения.Партнер КАК Партнер,
	табРазрешенийНаОтправку.ПредыдущийДокумент КАК ПредыдущийДокумент
ПОМЕСТИТЬ ВТ_КоррИспрСФ
ИЗ
	табКорректировкиИСообщения КАК табКорректировкиИСообщения
		ЛЕВОЕ СОЕДИНЕНИЕ табРазрешенийНаОтправку КАК табРазрешенийНаОтправку
		ПО табКорректировкиИСообщения.Корректировка = табРазрешенийНаОтправку.Корректировка
ГДЕ
	ВЫБОР
			КОГДА &amp;ТолькоТребуемые
				ТОГДА табРазрешенийНаОтправку.Корректировка ЕСТЬ НЕ NULL 
			ИНАЧЕ ИСТИНА
		КОНЕЦ
;

////////////////////////////////////////////////////////////////////////////////
УНИЧТОЖИТЬ табКорректировки
;

////////////////////////////////////////////////////////////////////////////////
УНИЧТОЖИТЬ табПредыдущихДокументов
;

////////////////////////////////////////////////////////////////////////////////
УНИЧТОЖИТЬ табРазрешенийНаОтправку
;

////////////////////////////////////////////////////////////////////////////////
УНИЧТОЖИТЬ табКорректировкиИСообщения</query>
				</item>
			</item>
		</item>
		<item xsi:type="DataSetUnion">
			<name>Покупатель</name>
			<item xsi:type="DataSetUnion">
				<name>ЗапросОсновнойЦепочки</name>
			</item>
			<item xsi:type="DataSetQuery">
				<name>КонвертироватьТовары1СВEDIВ_GTIN</name>
				<dataSource>ИсточникДанных1</dataSource>
				<query>ВЫБРАТЬ РАЗЛИЧНЫЕ
	ТабТоваров.Номенклатура,
	ТабТоваров.ХарактеристикаНоменклатуры,
	ТабТоваров.ЕдиницаИзмерения,
	ТабТоваров.Номенклатура.Код КАК КодТовараСвой,
	ВЫРАЗИТЬ(Штрихкоды.Штрихкод КАК СТРОКА(14)) КАК GTIN
ПОМЕСТИТЬ ВТШтрихкодыТоваров
ИЗ
	ТабТоваров КАК ТабТоваров
		ВНУТРЕННЕЕ СОЕДИНЕНИЕ РегистрСведений.ШтрихкодыНоменклатуры КАК Штрихкоды
		ПО ТабТоваров.Номенклатура = Штрихкоды.Номенклатура
			И ТабТоваров.ХарактеристикаНоменклатуры = Штрихкоды.Характеристика
ГДЕ
	&amp;ИскатьТоварПоШК

ИНДЕКСИРОВАТЬ ПО
	ТабТоваров.Номенклатура,
	ТабТоваров.ХарактеристикаНоменклатуры,
	ТабТоваров.ЕдиницаИзмерения</query>
				<autoFillFields>false</autoFillFields>
			</item>
			<item xsi:type="DataSetQuery">
				<name>КонвертироватьТоварыEDIВ1С</name>
				<dataSource>ИсточникДанных1</dataSource>
				<query>ВЫБРАТЬ
	ТабТоваров.GTIN КАК GTIN,
	ТабТоваров.КодТовараСторонний КАК КодТовараСторонний,
	ТабТоваров.КодТовараСвой КАК КодТовараСвой,
	ТабСоответствий_КонтурEDI.Номенклатура КАК Номенклатура,
	ТабСоответствий_КонтурEDI.ХарактеристикаНоменклатуры КАК ХарактеристикаНоменклатуры,
	ТабСоответствий_КонтурEDI.ЕдиницаИзмерения КАК ЕдиницаИзмерения,
	ТабСоответствий_КонтурEDI.ТипЕдиницы КАК ТипЕдиницы,
	3 КАК Приоритет
ПОМЕСТИТЬ ВТ_НайденныеСоответствия
ИЗ
	ТабТоваров КАК ТабТоваров
		ВНУТРЕННЕЕ СОЕДИНЕНИЕ ТабСоответствий_КонтурEDI КАК ТабСоответствий_КонтурEDI
		ПО ТабТоваров.GTIN = ТабСоответствий_КонтурEDI.GTIN
			И ТабТоваров.КодТовараСторонний = ТабСоответствий_КонтурEDI.КодТовараСторонний
			И ТабТоваров.КодТовараСвой = ТабСоответствий_КонтурEDI.КодТовараСвой

ОБЪЕДИНИТЬ ВСЕ

ВЫБРАТЬ
	ТабТоваров.GTIN,
	ТабТоваров.КодТовараСторонний,
	ТабТоваров.КодТовараСвой,
	СправочникНоменклатура.Ссылка,
	НЕОПРЕДЕЛЕНО,
	СправочникНоменклатура.ЕдиницаИзмерения,
	ВЫРАЗИТЬ("" КАК СТРОКА(20)),
	2
ИЗ
	ТабТоваров КАК ТабТоваров
		ВНУТРЕННЕЕ СОЕДИНЕНИЕ Справочник.Номенклатура КАК СправочникНоменклатура
		ПО ТабТоваров.КодТовараСвой = СправочникНоменклатура.Код
ГДЕ
	(НЕ ТабТоваров.КодТовараСвой = "")
</query>
				<autoFillFields>false</autoFillFields>
			</item>
		</item>
	</dataSet>
	<dataSet xsi:type="DataSetUnion">
		<name>УФ_УТ</name>
		<field xsi:type="DataSetFieldField">
			<dataPath>СуммаНДС</dataPath>
			<field>СуммаНДС</field>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>НомерСтроки</dataPath>
			<field>НомерСтроки</field>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>Сумма</dataPath>
			<field>Сумма</field>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>Наименование</dataPath>
			<field>Наименование</field>
			<title xsi:type="v8:LocalStringType">
				<v8:item>
					<v8:lang>ru</v8:lang>
					<v8:content>Наименование</v8:content>
				</v8:item>
			</title>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>НаименованиеПолное</dataPath>
			<field>НаименованиеПолное</field>
			<title xsi:type="v8:LocalStringType">
				<v8:item>
					<v8:lang>ru</v8:lang>
					<v8:content>Наименование полное</v8:content>
				</v8:item>
			</title>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>СтавкаНДС</dataPath>
			<field>СтавкаНДС</field>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>ХарактеристикаНоменклатуры</dataPath>
			<field>ХарактеристикаНоменклатуры</field>
			<title xsi:type="v8:LocalStringType">
				<v8:item>
					<v8:lang>ru</v8:lang>
					<v8:content>Характеристика номенклатуры</v8:content>
				</v8:item>
			</title>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>НомерГТД</dataPath>
			<field>НомерГТД</field>
			<title xsi:type="v8:LocalStringType">
				<v8:item>
					<v8:lang>ru</v8:lang>
					<v8:content>Номер ГТД</v8:content>
				</v8:item>
			</title>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>ТипЕдиницы</dataPath>
			<field>ТипЕдиницы</field>
			<title xsi:type="v8:LocalStringType">
				<v8:item>
					<v8:lang>ru</v8:lang>
					<v8:content>Тип единицы</v8:content>
				</v8:item>
			</title>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>Количество</dataPath>
			<field>Количество</field>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>Страна</dataPath>
			<field>Страна</field>
			<title xsi:type="v8:LocalStringType">
				<v8:item>
					<v8:lang>ru</v8:lang>
					<v8:content>Страна</v8:content>
				</v8:item>
			</title>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>ЕдиницаИзмерения</dataPath>
			<field>ЕдиницаИзмерения</field>
			<title xsi:type="v8:LocalStringType">
				<v8:item>
					<v8:lang>ru</v8:lang>
					<v8:content>Единица измерения</v8:content>
				</v8:item>
			</title>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>Номенклатура</dataPath>
			<field>Номенклатура</field>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>Цена</dataPath>
			<field>Цена</field>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>СерияНоменклатуры</dataPath>
			<field>СерияНоменклатуры</field>
			<title xsi:type="v8:LocalStringType">
				<v8:item>
					<v8:lang>ru</v8:lang>
					<v8:content>Серия номенклатуры</v8:content>
				</v8:item>
			</title>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>КоличествоДоКорректировки</dataPath>
			<field>КоличествоДоКорректировки</field>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>СтавкаНДСДоКорректировки</dataPath>
			<field>СтавкаНДСДоКорректировки</field>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>СуммаДоКорректировки</dataPath>
			<field>СуммаДоКорректировки</field>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>СуммаНДСДоКорректировки</dataPath>
			<field>СуммаНДСДоКорректировки</field>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>ЦенаДоКорректировки</dataPath>
			<field>ЦенаДоКорректировки</field>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>GTIN</dataPath>
			<field>GTIN</field>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>ЕдИзмСрокаГодности</dataPath>
			<field>ЕдИзмСрокаГодности</field>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>КвантПоставки</dataPath>
			<field>КвантПоставки</field>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>КодТовараПоставщика</dataPath>
			<field>КодТовараПоставщика</field>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>КоличествоВОдномМесте</dataPath>
			<field>КоличествоВОдномМесте</field>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>Родитель</dataPath>
			<field>Родитель</field>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>СрокГодности</dataPath>
			<field>СрокГодности</field>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>РекомендуемаяРозничнаяЦена</dataPath>
			<field>РекомендуемаяРозничнаяЦена</field>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>КоличествоОстаткаНаКонец</dataPath>
			<field>КоличествоОстаткаНаКонец</field>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>Помещение</dataPath>
			<field>Помещение</field>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>Серия</dataPath>
			<field>Серия</field>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>Склад</dataPath>
			<field>Склад</field>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>Характеристика</dataPath>
			<field>Характеристика</field>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>Назначение</dataPath>
			<field>Назначение</field>
		</field>
		<item xsi:type="DataSetUnion">
			<name>Поставщик</name>
			<field xsi:type="DataSetFieldField">
				<dataPath>СуммаНДС</dataPath>
				<field>СуммаНДС</field>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>НомерСтроки</dataPath>
				<field>НомерСтроки</field>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>Сумма</dataPath>
				<field>Сумма</field>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>Наименование</dataPath>
				<field>Наименование</field>
				<title xsi:type="v8:LocalStringType">
					<v8:item>
						<v8:lang>ru</v8:lang>
						<v8:content>Наименование</v8:content>
					</v8:item>
				</title>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>НаименованиеПолное</dataPath>
				<field>НаименованиеПолное</field>
				<title xsi:type="v8:LocalStringType">
					<v8:item>
						<v8:lang>ru</v8:lang>
						<v8:content>Наименование полное</v8:content>
					</v8:item>
				</title>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>СтавкаНДС</dataPath>
				<field>СтавкаНДС</field>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>ХарактеристикаНоменклатуры</dataPath>
				<field>ХарактеристикаНоменклатуры</field>
				<title xsi:type="v8:LocalStringType">
					<v8:item>
						<v8:lang>ru</v8:lang>
						<v8:content>Характеристика номенклатуры</v8:content>
					</v8:item>
				</title>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>НомерГТД</dataPath>
				<field>НомерГТД</field>
				<title xsi:type="v8:LocalStringType">
					<v8:item>
						<v8:lang>ru</v8:lang>
						<v8:content>Номер ГТД</v8:content>
					</v8:item>
				</title>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>ТипЕдиницы</dataPath>
				<field>ТипЕдиницы</field>
				<title xsi:type="v8:LocalStringType">
					<v8:item>
						<v8:lang>ru</v8:lang>
						<v8:content>Тип единицы</v8:content>
					</v8:item>
				</title>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>Количество</dataPath>
				<field>Количество</field>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>Страна</dataPath>
				<field>Страна</field>
				<title xsi:type="v8:LocalStringType">
					<v8:item>
						<v8:lang>ru</v8:lang>
						<v8:content>Страна</v8:content>
					</v8:item>
				</title>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>ЕдиницаИзмерения</dataPath>
				<field>ЕдиницаИзмерения</field>
				<title xsi:type="v8:LocalStringType">
					<v8:item>
						<v8:lang>ru</v8:lang>
						<v8:content>Единица измерения</v8:content>
					</v8:item>
				</title>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>Номенклатура</dataPath>
				<field>Номенклатура</field>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>Цена</dataPath>
				<field>Цена</field>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>СерияНоменклатуры</dataPath>
				<field>СерияНоменклатуры</field>
				<title xsi:type="v8:LocalStringType">
					<v8:item>
						<v8:lang>ru</v8:lang>
						<v8:content>Серия номенклатуры</v8:content>
					</v8:item>
				</title>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>КоличествоДоКорректировки</dataPath>
				<field>КоличествоДоКорректировки</field>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>СтавкаНДСДоКорректировки</dataPath>
				<field>СтавкаНДСДоКорректировки</field>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>СуммаДоКорректировки</dataPath>
				<field>СуммаДоКорректировки</field>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>СуммаНДСДоКорректировки</dataPath>
				<field>СуммаНДСДоКорректировки</field>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>ЦенаДоКорректировки</dataPath>
				<field>ЦенаДоКорректировки</field>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>GTIN</dataPath>
				<field>GTIN</field>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>ЕдИзмСрокаГодности</dataPath>
				<field>ЕдИзмСрокаГодности</field>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>КвантПоставки</dataPath>
				<field>КвантПоставки</field>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>КодТовараПоставщика</dataPath>
				<field>КодТовараПоставщика</field>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>КоличествоВОдномМесте</dataPath>
				<field>КоличествоВОдномМесте</field>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>Родитель</dataPath>
				<field>Родитель</field>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>СрокГодности</dataPath>
				<field>СрокГодности</field>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>РекомендуемаяРозничнаяЦена</dataPath>
				<field>РекомендуемаяРозничнаяЦена</field>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>КоличествоОстаткаНаКонец</dataPath>
				<field>КоличествоОстаткаНаКонец</field>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>Помещение</dataPath>
				<field>Помещение</field>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>Серия</dataPath>
				<field>Серия</field>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>Склад</dataPath>
				<field>Склад</field>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>Характеристика</dataPath>
				<field>Характеристика</field>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>Назначение</dataPath>
				<field>Назначение</field>
			</field>
			<item xsi:type="DataSetUnion">
				<name>ЗапросОсновнойЦепочки</name>
				<item xsi:type="DataSetQuery">
					<name>Заказ_Реализация_СФ</name>
					<dataSource>ИсточникДанных1</dataSource>
					<query>ВЫБРАТЬ
	докЗаказПокупателя.Ссылка КАК PORDERS,
	докЗаказПокупателя.Ссылка КАК ORDERS,
	докЗаказПокупателя.Ссылка КАК ORDRSP,
	докРеализацияТоваровУслуг.Ссылка КАК DESADV,
	докРеализацияТоваровУслуг.Ссылка КАК RECADV,
	СчетФактураВыданный.Ссылка КАК INVOIC
ИЗ
	(ВЫБРАТЬ
		1 КАК Поле1) КАК Заглушка
		{ПОЛНОЕ СОЕДИНЕНИЕ Документ.СчетФактураВыданный КАК СчетФактураВыданный
			{ПОЛНОЕ СОЕДИНЕНИЕ Документ.РеализацияТоваровУслуг КАК докРеализацияТоваровУслуг
				{ПОЛНОЕ СОЕДИНЕНИЕ Документ.ЗаказКлиента КАК докЗаказПокупателя
				ПО докРеализацияТоваровУслуг.ЗаказКлиента = докЗаказПокупателя.Ссылка}
			ПО СчетФактураВыданный.ДокументОснование = докРеализацияТоваровУслуг.Ссылка}
		ПО (ИСТИНА)}</query>
					<autoFillFields>false</autoFillFields>
				</item>
				<item xsi:type="DataSetQuery">
					<name>Реализация_СФ</name>
					<dataSource>ИсточникДанных1</dataSource>
					<query>ВЫБРАТЬ
	РеализацияТоваровУслуг.Ссылка КАК PORDERS,
	РеализацияТоваровУслуг.Ссылка КАК ORDERS,
	РеализацияТоваровУслуг.Ссылка КАК ORDRSP,
	РеализацияТоваровУслуг.Ссылка КАК DESADV,
	РеализацияТоваровУслуг.Ссылка КАК RECADV,
	СчетФактураВыданный.Ссылка КАК INVOIC
ИЗ
	(ВЫБРАТЬ
		1 КАК Поле1) КАК Заглушка
		{ПОЛНОЕ СОЕДИНЕНИЕ Документ.СчетФактураВыданный КАК СчетФактураВыданный
			{ПОЛНОЕ СОЕДИНЕНИЕ Документ.РеализацияТоваровУслуг КАК РеализацияТоваровУслуг
			ПО (СчетФактураВыданный.ДокументОснование = РеализацияТоваровУслуг.Ссылка)}
		ПО (ИСТИНА)}</query>
					<autoFillFields>false</autoFillFields>
				</item>
				<item xsi:type="DataSetQuery">
					<name>Заказ_Реализация</name>
					<dataSource>ИсточникДанных1</dataSource>
					<query>ВЫБРАТЬ
	докЗаказПокупателя.Ссылка КАК PORDERS,
	докЗаказПокупателя.Ссылка КАК ORDERS,
	докЗаказПокупателя.Ссылка КАК ORDRSP,
	докРеализацияТоваровУслуг.Ссылка КАК DESADV,
	докРеализацияТоваровУслуг.Ссылка КАК RECADV,
	докРеализацияТоваровУслуг.Ссылка КАК INVOIC
ИЗ
	(ВЫБРАТЬ
		1 КАК Поле1) КАК Заглушка
		{ПОЛНОЕ СОЕДИНЕНИЕ Документ.РеализацияТоваровУслуг КАК докРеализацияТоваровУслуг
			{ПОЛНОЕ СОЕДИНЕНИЕ Документ.ЗаказКлиента КАК докЗаказПокупателя
			ПО (докРеализацияТоваровУслуг.ЗаказКлиента = докЗаказПокупателя.Ссылка)}
		ПО (ИСТИНА)}</query>
					<autoFillFields>false</autoFillFields>
				</item>
				<item xsi:type="DataSetQuery">
					<name>Реализация</name>
					<dataSource>ИсточникДанных1</dataSource>
					<query>ВЫБРАТЬ
	РеализацияТоваровУслуг.Ссылка КАК PORDERS,
	РеализацияТоваровУслуг.Ссылка КАК ORDERS,
	РеализацияТоваровУслуг.Ссылка КАК ORDRSP,
	РеализацияТоваровУслуг.Ссылка КАК DESADV,
	РеализацияТоваровУслуг.Ссылка КАК RECADV,
	РеализацияТоваровУслуг.Ссылка КАК INVOIC
ИЗ
	(ВЫБРАТЬ
		1 КАК Поле1) КАК Заглушка
		{ПОЛНОЕ СОЕДИНЕНИЕ Документ.РеализацияТоваровУслуг КАК РеализацияТоваровУслуг
		ПО (ИСТИНА)}</query>
					<autoFillFields>false</autoFillFields>
				</item>
			</item>
			<item xsi:type="DataSetUnion">
				<name>ЗапросПоТоварам</name>
				<field xsi:type="DataSetFieldField">
					<dataPath>СуммаНДС</dataPath>
					<field>СуммаНДС</field>
				</field>
				<field xsi:type="DataSetFieldField">
					<dataPath>НомерСтроки</dataPath>
					<field>НомерСтроки</field>
				</field>
				<field xsi:type="DataSetFieldField">
					<dataPath>Сумма</dataPath>
					<field>Сумма</field>
				</field>
				<field xsi:type="DataSetFieldField">
					<dataPath>Наименование</dataPath>
					<field>Наименование</field>
					<title xsi:type="v8:LocalStringType">
						<v8:item>
							<v8:lang>ru</v8:lang>
							<v8:content>Наименование</v8:content>
						</v8:item>
					</title>
				</field>
				<field xsi:type="DataSetFieldField">
					<dataPath>НаименованиеПолное</dataPath>
					<field>НаименованиеПолное</field>
					<title xsi:type="v8:LocalStringType">
						<v8:item>
							<v8:lang>ru</v8:lang>
							<v8:content>Наименование полное</v8:content>
						</v8:item>
					</title>
				</field>
				<field xsi:type="DataSetFieldField">
					<dataPath>СтавкаНДС</dataPath>
					<field>СтавкаНДС</field>
				</field>
				<field xsi:type="DataSetFieldField">
					<dataPath>ХарактеристикаНоменклатуры</dataPath>
					<field>ХарактеристикаНоменклатуры</field>
					<title xsi:type="v8:LocalStringType">
						<v8:item>
							<v8:lang>ru</v8:lang>
							<v8:content>Характеристика номенклатуры</v8:content>
						</v8:item>
					</title>
				</field>
				<field xsi:type="DataSetFieldField">
					<dataPath>НомерГТД</dataPath>
					<field>НомерГТД</field>
					<title xsi:type="v8:LocalStringType">
						<v8:item>
							<v8:lang>ru</v8:lang>
							<v8:content>Номер ГТД</v8:content>
						</v8:item>
					</title>
				</field>
				<field xsi:type="DataSetFieldField">
					<dataPath>ТипЕдиницы</dataPath>
					<field>ТипЕдиницы</field>
					<title xsi:type="v8:LocalStringType">
						<v8:item>
							<v8:lang>ru</v8:lang>
							<v8:content>Тип единицы</v8:content>
						</v8:item>
					</title>
				</field>
				<field xsi:type="DataSetFieldField">
					<dataPath>Количество</dataPath>
					<field>Количество</field>
				</field>
				<field xsi:type="DataSetFieldField">
					<dataPath>Страна</dataPath>
					<field>Страна</field>
					<title xsi:type="v8:LocalStringType">
						<v8:item>
							<v8:lang>ru</v8:lang>
							<v8:content>Страна</v8:content>
						</v8:item>
					</title>
				</field>
				<field xsi:type="DataSetFieldField">
					<dataPath>ЕдиницаИзмерения</dataPath>
					<field>ЕдиницаИзмерения</field>
					<title xsi:type="v8:LocalStringType">
						<v8:item>
							<v8:lang>ru</v8:lang>
							<v8:content>Единица измерения</v8:content>
						</v8:item>
					</title>
				</field>
				<field xsi:type="DataSetFieldField">
					<dataPath>Номенклатура</dataPath>
					<field>Номенклатура</field>
				</field>
				<field xsi:type="DataSetFieldField">
					<dataPath>Цена</dataPath>
					<field>Цена</field>
				</field>
				<field xsi:type="DataSetFieldField">
					<dataPath>СерияНоменклатуры</dataPath>
					<field>СерияНоменклатуры</field>
					<title xsi:type="v8:LocalStringType">
						<v8:item>
							<v8:lang>ru</v8:lang>
							<v8:content>Серия номенклатуры</v8:content>
						</v8:item>
					</title>
				</field>
				<field xsi:type="DataSetFieldField">
					<dataPath>КоличествоДоКорректировки</dataPath>
					<field>КоличествоДоКорректировки</field>
				</field>
				<field xsi:type="DataSetFieldField">
					<dataPath>СтавкаНДСДоКорректировки</dataPath>
					<field>СтавкаНДСДоКорректировки</field>
				</field>
				<field xsi:type="DataSetFieldField">
					<dataPath>СуммаДоКорректировки</dataPath>
					<field>СуммаДоКорректировки</field>
				</field>
				<field xsi:type="DataSetFieldField">
					<dataPath>СуммаНДСДоКорректировки</dataPath>
					<field>СуммаНДСДоКорректировки</field>
				</field>
				<field xsi:type="DataSetFieldField">
					<dataPath>ЦенаДоКорректировки</dataPath>
					<field>ЦенаДоКорректировки</field>
				</field>
				<field xsi:type="DataSetFieldField">
					<dataPath>GTIN</dataPath>
					<field>GTIN</field>
				</field>
				<field xsi:type="DataSetFieldField">
					<dataPath>ЕдИзмСрокаГодности</dataPath>
					<field>ЕдИзмСрокаГодности</field>
				</field>
				<field xsi:type="DataSetFieldField">
					<dataPath>КвантПоставки</dataPath>
					<field>КвантПоставки</field>
				</field>
				<field xsi:type="DataSetFieldField">
					<dataPath>КодТовараПоставщика</dataPath>
					<field>КодТовараПоставщика</field>
				</field>
				<field xsi:type="DataSetFieldField">
					<dataPath>КоличествоВОдномМесте</dataPath>
					<field>КоличествоВОдномМесте</field>
				</field>
				<field xsi:type="DataSetFieldField">
					<dataPath>Родитель</dataPath>
					<field>Родитель</field>
				</field>
				<field xsi:type="DataSetFieldField">
					<dataPath>СрокГодности</dataPath>
					<field>СрокГодности</field>
				</field>
				<field xsi:type="DataSetFieldField">
					<dataPath>РекомендуемаяРозничнаяЦена</dataPath>
					<field>РекомендуемаяРозничнаяЦена</field>
				</field>
				<field xsi:type="DataSetFieldField">
					<dataPath>КоличествоОстаткаНаКонец</dataPath>
					<field>КоличествоОстаткаНаКонец</field>
				</field>
				<field xsi:type="DataSetFieldField">
					<dataPath>Помещение</dataPath>
					<field>Помещение</field>
				</field>
				<field xsi:type="DataSetFieldField">
					<dataPath>Серия</dataPath>
					<field>Серия</field>
				</field>
				<field xsi:type="DataSetFieldField">
					<dataPath>Склад</dataPath>
					<field>Склад</field>
				</field>
				<field xsi:type="DataSetFieldField">
					<dataPath>Характеристика</dataPath>
					<field>Характеристика</field>
				</field>
				<field xsi:type="DataSetFieldField">
					<dataPath>Назначение</dataPath>
					<field>Назначение</field>
				</field>
				<item xsi:type="DataSetUnion">
					<name>_PORDERS_ORDRSP_</name>
					<item xsi:type="DataSetQuery">
						<name>ЗаказКлиента</name>
						<dataSource>ИсточникДанных1</dataSource>
						<query>ВЫБРАТЬ
	ЗаказПокупателяТовары.Номенклатура,
	ЗаказПокупателяТовары.Характеристика КАК ХарактеристикаНоменклатуры,
	ВЫБОР
		КОГДА ЗаказПокупателяТовары.Упаковка = ЗНАЧЕНИЕ(Справочник.УпаковкиНоменклатуры.ПустаяСсылка)
			ТОГДА ЗаказПокупателяТовары.Номенклатура.ЕдиницаИзмерения
		ИНАЧЕ ЗаказПокупателяТовары.Упаковка
	КОНЕЦ КАК ЕдиницаИзмерения,
	ЗаказПокупателяТовары.Цена,
	ЗаказПокупателяТовары.СтавкаНДС,
	ВЫБОР
		КОГДА ЗаказПокупателяТовары.Отменено
			ТОГДА 0
		ИНАЧЕ ЗаказПокупателяТовары.КоличествоУпаковок
	КОНЕЦ КАК Количество,
	ЗаказПокупателяТовары.Сумма КАК Сумма,
	ЗаказПокупателяТовары.СуммаНДС КАК СуммаНДС,
	ВЫБОР
		КОГДА ЗаказПокупателяТовары.Номенклатура.ТипНоменклатуры = ЗНАЧЕНИЕ(Перечисление.ТипыНоменклатуры.Услуга)
			ТОГДА "Services"
		ИНАЧЕ ""
	КОНЕЦ КАК ТипЕдиницы
ИЗ
	Документ.ЗаказКлиента.Товары КАК ЗаказПокупателяТовары
ГДЕ
	ЗаказПокупателяТовары.Ссылка В(&amp;Ссылка)
	И НЕ ЗаказПокупателяТовары.Отменено
	И (НЕ ЗаказПокупателяТовары.Номенклатура.ТипНоменклатуры = ЗНАЧЕНИЕ(Перечисление.ТипыНоменклатуры.Услуга)
			ИЛИ &amp;РаботаСУслугами)</query>
						<autoFillFields>false</autoFillFields>
					</item>
					<item xsi:type="DataSetQuery">
						<name>РеализацияТоваровУслуг</name>
						<dataSource>ИсточникДанных1</dataSource>
						<query>ВЫБРАТЬ
	РеализацияТоваровУслугТовары.НомерСтроки,
	РеализацияТоваровУслугТовары.Номенклатура,
	РеализацияТоваровУслугТовары.Характеристика КАК ХарактеристикаНоменклатуры,
	ВЫБОР
		КОГДА РеализацияТоваровУслугТовары.Упаковка = ЗНАЧЕНИЕ(Справочник.УпаковкиНоменклатуры.ПустаяСсылка)
			ТОГДА РеализацияТоваровУслугТовары.Номенклатура.ЕдиницаИзмерения
		ИНАЧЕ РеализацияТоваровУслугТовары.Упаковка
	КОНЕЦ КАК ЕдиницаИзмерения,
	ВЫРАЗИТЬ(РеализацияТоваровУслугТовары.Номенклатура.Наименование КАК СТРОКА(178)) КАК Наименование,
	ВЫРАЗИТЬ(РеализацияТоваровУслугТовары.Номенклатура.НаименованиеПолное КАК СТРОКА(500)) КАК НаименованиеПолное,
	РеализацияТоваровУслугТовары.Цена,
	РеализацияТоваровУслугТовары.СтавкаНДС,
	ЗНАЧЕНИЕ(Справочник.СерииНоменклатуры.ПустаяСсылка) КАК СерияНоменклатуры,
	ЗНАЧЕНИЕ(Справочник.СтраныМира.ПустаяСсылка) КАК Страна,
	"" КАК НомерГТД,
	РеализацияТоваровУслугТовары.КоличествоУпаковок КАК Количество,
	РеализацияТоваровУслугТовары.Сумма КАК Сумма,
	РеализацияТоваровУслугТовары.СуммаНДС,
	ВЫБОР
		КОГДА РеализацияТоваровУслугТовары.Номенклатура.ТипНоменклатуры = ЗНАЧЕНИЕ(Перечисление.ТипыНоменклатуры.Услуга)
			ТОГДА "Services"
		ИНАЧЕ ""
	КОНЕЦ КАК ТипЕдиницы
ИЗ
	Документ.РеализацияТоваровУслуг.Товары КАК РеализацияТоваровУслугТовары
ГДЕ
	РеализацияТоваровУслугТовары.Ссылка В(&amp;Ссылка)
	И (НЕ РеализацияТоваровУслугТовары.Номенклатура.ТипНоменклатуры = ЗНАЧЕНИЕ(Перечисление.ТипыНоменклатуры.Услуга)
			ИЛИ &amp;РаботаСУслугами)</query>
						<autoFillFields>false</autoFillFields>
					</item>
				</item>
				<item xsi:type="DataSetUnion">
					<name>_DESADV_INVOIC_</name>
					<item xsi:type="DataSetQuery">
						<name>РеализацияТоваровУслуг_Проведен</name>
						<dataSource>ИсточникДанных1</dataSource>
						<query>ВЫБРАТЬ
	РеализацияТоваровУслугТовары.НомерСтроки,
	РеализацияТоваровУслугТовары.Номенклатура КАК Номенклатура,
	РеализацияТоваровУслугТовары.Характеристика КАК ХарактеристикаНоменклатуры,
	ВЫБОР
		КОГДА РеализацияТоваровУслугТовары.Упаковка = ЗНАЧЕНИЕ(Справочник.УпаковкиНоменклатуры.ПустаяСсылка)
			ТОГДА РеализацияТоваровУслугТовары.Номенклатура.ЕдиницаИзмерения
		ИНАЧЕ РеализацияТоваровУслугТовары.Упаковка
	КОНЕЦ КАК ЕдиницаИзмерения,
	ВЫРАЗИТЬ(РеализацияТоваровУслугТовары.Номенклатура.Наименование КАК СТРОКА(178)) КАК Наименование,
	ВЫРАЗИТЬ(РеализацияТоваровУслугТовары.Номенклатура.НаименованиеПолное КАК СТРОКА(500)) КАК НаименованиеПолное,
	ВЫБОР
		КОГДА РеализацияТоваровУслугТовары.КоличествоУпаковок = 0
			ТОГДА 0
		КОГДА &amp;СуммаВключаетНДС
			ТОГДА РеализацияТоваровУслугТовары.СуммаСНДС / РеализацияТоваровУслугТовары.КоличествоУпаковок
		ИНАЧЕ (РеализацияТоваровУслугТовары.СуммаСНДС - РеализацияТоваровУслугТовары.СуммаНДС) / РеализацияТоваровУслугТовары.КоличествоУпаковок
	КОНЕЦ КАК Цена,
	РеализацияТоваровУслугТовары.СтавкаНДС,
	ЗНАЧЕНИЕ(Справочник.СерииНоменклатуры.ПустаяСсылка) КАК СерияНоменклатуры,
	РеализацияТоваровУслугТовары.НомерГТД.СтранаПроисхождения КАК Страна,
	РеализацияТоваровУслугТовары.НомерГТД.Код КАК НомерГТД,
	РеализацияТоваровУслугТовары.КоличествоУпаковок КАК Количество,
	ВЫБОР
		КОГДА &amp;СуммаВключаетНДС
			ТОГДА РеализацияТоваровУслугТовары.СуммаСНДС
		ИНАЧЕ РеализацияТоваровУслугТовары.СуммаСНДС - РеализацияТоваровУслугТовары.СуммаНДС
	КОНЕЦ КАК Сумма,
	РеализацияТоваровУслугТовары.СуммаНДС,
	"" КАК ТипЕдиницы
ИЗ
	Документ.РеализацияТоваровУслуг.ВидыЗапасов КАК РеализацияТоваровУслугТовары
ГДЕ
	РеализацияТоваровУслугТовары.Ссылка В(&amp;Ссылка)
	И НЕ РеализацияТоваровУслугТовары.Номенклатура.ТипНоменклатуры = ЗНАЧЕНИЕ(Перечисление.ТипыНоменклатуры.Услуга)

ОБЪЕДИНИТЬ ВСЕ

ВЫБРАТЬ
	РеализацияТоваровУслугТовары.НомерСтроки,
	РеализацияТоваровУслугТовары.Номенклатура,
	РеализацияТоваровУслугТовары.Характеристика,
	ВЫБОР
		КОГДА РеализацияТоваровУслугТовары.Упаковка = ЗНАЧЕНИЕ(Справочник.УпаковкиНоменклатуры.ПустаяСсылка)
			ТОГДА РеализацияТоваровУслугТовары.Номенклатура.ЕдиницаИзмерения
		ИНАЧЕ РеализацияТоваровУслугТовары.Упаковка
	КОНЕЦ,
	ВЫРАЗИТЬ(РеализацияТоваровУслугТовары.Номенклатура.Наименование КАК СТРОКА(178)),
	ВЫРАЗИТЬ(РеализацияТоваровУслугТовары.Номенклатура.НаименованиеПолное КАК СТРОКА(500)),
	РеализацияТоваровУслугТовары.Цена,
	РеализацияТоваровУслугТовары.СтавкаНДС,
	ЗНАЧЕНИЕ(Справочник.СерииНоменклатуры.ПустаяСсылка),
	ЗНАЧЕНИЕ(Справочник.СтраныМира.ПустаяСсылка),
	"",
	РеализацияТоваровУслугТовары.КоличествоУпаковок,
	РеализацияТоваровУслугТовары.Сумма,
	РеализацияТоваровУслугТовары.СуммаНДС,
	"Services"
ИЗ
	Документ.РеализацияТоваровУслуг.Товары КАК РеализацияТоваровУслугТовары
ГДЕ
	&amp;РаботаСУслугами
	И РеализацияТоваровУслугТовары.Ссылка В(&amp;Ссылка)
	И РеализацияТоваровУслугТовары.Номенклатура.ТипНоменклатуры = ЗНАЧЕНИЕ(Перечисление.ТипыНоменклатуры.Услуга)</query>
						<autoFillFields>false</autoFillFields>
					</item>
					<item xsi:type="DataSetQuery">
						<name>РеализацияТоваровУслуг_НеПроведен</name>
						<dataSource>ИсточникДанных1</dataSource>
						<query>ВЫБРАТЬ
	РеализацияТоваровУслугТовары.НомерСтроки,
	РеализацияТоваровУслугТовары.Номенклатура КАК Номенклатура,
	РеализацияТоваровУслугТовары.Характеристика КАК ХарактеристикаНоменклатуры,
	ВЫБОР
		КОГДА РеализацияТоваровУслугТовары.Упаковка = ЗНАЧЕНИЕ(Справочник.УпаковкиНоменклатуры.ПустаяСсылка)
			ТОГДА РеализацияТоваровУслугТовары.Номенклатура.ЕдиницаИзмерения
		ИНАЧЕ РеализацияТоваровУслугТовары.Упаковка
	КОНЕЦ КАК ЕдиницаИзмерения,
	ВЫРАЗИТЬ(РеализацияТоваровУслугТовары.Номенклатура.Наименование КАК СТРОКА(178)) КАК Наименование,
	ВЫРАЗИТЬ(РеализацияТоваровУслугТовары.Номенклатура.НаименованиеПолное КАК СТРОКА(500)) КАК НаименованиеПолное,
	РеализацияТоваровУслугТовары.Цена,
	РеализацияТоваровУслугТовары.СтавкаНДС,
	ЗНАЧЕНИЕ(Справочник.СерииНоменклатуры.ПустаяСсылка) КАК СерияНоменклатуры,
	ЗНАЧЕНИЕ(Справочник.СтраныМира.ПустаяСсылка) КАК Страна,
	"" КАК НомерГТД,
	РеализацияТоваровУслугТовары.КоличествоУпаковок КАК Количество,
	РеализацияТоваровУслугТовары.Сумма КАК Сумма,
	РеализацияТоваровУслугТовары.СуммаНДС,
	ВЫБОР
		КОГДА РеализацияТоваровУслугТовары.Номенклатура.ТипНоменклатуры = ЗНАЧЕНИЕ(Перечисление.ТипыНоменклатуры.Услуга)
			ТОГДА "Services"
		ИНАЧЕ ""
	КОНЕЦ КАК ТипЕдиницы
ИЗ
	Документ.РеализацияТоваровУслуг.Товары КАК РеализацияТоваровУслугТовары
ГДЕ
	РеализацияТоваровУслугТовары.Ссылка В(&amp;Ссылка)
	И (НЕ РеализацияТоваровУслугТовары.Номенклатура.ТипНоменклатуры = ЗНАЧЕНИЕ(Перечисление.ТипыНоменклатуры.Услуга)
			ИЛИ &amp;РаботаСУслугами)</query>
						<autoFillFields>false</autoFillFields>
					</item>
				</item>
				<item xsi:type="DataSetUnion">
					<name>_RETINS_RETREC_</name>
					<field xsi:type="DataSetFieldField">
						<dataPath>СуммаНДС</dataPath>
						<field>СуммаНДС</field>
					</field>
					<field xsi:type="DataSetFieldField">
						<dataPath>НомерСтроки</dataPath>
						<field>НомерСтроки</field>
					</field>
					<field xsi:type="DataSetFieldField">
						<dataPath>Сумма</dataPath>
						<field>Сумма</field>
					</field>
					<field xsi:type="DataSetFieldField">
						<dataPath>Наименование</dataPath>
						<field>Наименование</field>
						<title xsi:type="v8:LocalStringType">
							<v8:item>
								<v8:lang>ru</v8:lang>
								<v8:content>Наименование</v8:content>
							</v8:item>
						</title>
					</field>
					<field xsi:type="DataSetFieldField">
						<dataPath>НаименованиеПолное</dataPath>
						<field>НаименованиеПолное</field>
						<title xsi:type="v8:LocalStringType">
							<v8:item>
								<v8:lang>ru</v8:lang>
								<v8:content>Наименование полное</v8:content>
							</v8:item>
						</title>
					</field>
					<field xsi:type="DataSetFieldField">
						<dataPath>СтавкаНДС</dataPath>
						<field>СтавкаНДС</field>
					</field>
					<field xsi:type="DataSetFieldField">
						<dataPath>ХарактеристикаНоменклатуры</dataPath>
						<field>ХарактеристикаНоменклатуры</field>
						<title xsi:type="v8:LocalStringType">
							<v8:item>
								<v8:lang>ru</v8:lang>
								<v8:content>Характеристика номенклатуры</v8:content>
							</v8:item>
						</title>
					</field>
					<field xsi:type="DataSetFieldField">
						<dataPath>НомерГТД</dataPath>
						<field>НомерГТД</field>
						<title xsi:type="v8:LocalStringType">
							<v8:item>
								<v8:lang>ru</v8:lang>
								<v8:content>Номер ГТД</v8:content>
							</v8:item>
						</title>
					</field>
					<field xsi:type="DataSetFieldField">
						<dataPath>ТипЕдиницы</dataPath>
						<field>ТипЕдиницы</field>
						<title xsi:type="v8:LocalStringType">
							<v8:item>
								<v8:lang>ru</v8:lang>
								<v8:content>Тип единицы</v8:content>
							</v8:item>
						</title>
					</field>
					<field xsi:type="DataSetFieldField">
						<dataPath>Количество</dataPath>
						<field>Количество</field>
					</field>
					<field xsi:type="DataSetFieldField">
						<dataPath>Страна</dataPath>
						<field>Страна</field>
						<title xsi:type="v8:LocalStringType">
							<v8:item>
								<v8:lang>ru</v8:lang>
								<v8:content>Страна</v8:content>
							</v8:item>
						</title>
					</field>
					<field xsi:type="DataSetFieldField">
						<dataPath>ЕдиницаИзмерения</dataPath>
						<field>ЕдиницаИзмерения</field>
						<title xsi:type="v8:LocalStringType">
							<v8:item>
								<v8:lang>ru</v8:lang>
								<v8:content>Единица измерения</v8:content>
							</v8:item>
						</title>
					</field>
					<field xsi:type="DataSetFieldField">
						<dataPath>Номенклатура</dataPath>
						<field>Номенклатура</field>
					</field>
					<field xsi:type="DataSetFieldField">
						<dataPath>Цена</dataPath>
						<field>Цена</field>
					</field>
					<field xsi:type="DataSetFieldField">
						<dataPath>СерияНоменклатуры</dataPath>
						<field>СерияНоменклатуры</field>
						<title xsi:type="v8:LocalStringType">
							<v8:item>
								<v8:lang>ru</v8:lang>
								<v8:content>Серия номенклатуры</v8:content>
							</v8:item>
						</title>
					</field>
					<item xsi:type="DataSetQuery">
						<name>ВозвратТоваровОтКлиента</name>
						<field xsi:type="DataSetFieldField">
							<dataPath>СуммаНДС</dataPath>
							<field>СуммаНДС</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>НомерСтроки</dataPath>
							<field>НомерСтроки</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>Сумма</dataPath>
							<field>Сумма</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>Наименование</dataPath>
							<field>Наименование</field>
							<title xsi:type="v8:LocalStringType">
								<v8:item>
									<v8:lang>ru</v8:lang>
									<v8:content>Наименование</v8:content>
								</v8:item>
							</title>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>НаименованиеПолное</dataPath>
							<field>НаименованиеПолное</field>
							<title xsi:type="v8:LocalStringType">
								<v8:item>
									<v8:lang>ru</v8:lang>
									<v8:content>Наименование полное</v8:content>
								</v8:item>
							</title>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>СтавкаНДС</dataPath>
							<field>СтавкаНДС</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>ХарактеристикаНоменклатуры</dataPath>
							<field>ХарактеристикаНоменклатуры</field>
							<title xsi:type="v8:LocalStringType">
								<v8:item>
									<v8:lang>ru</v8:lang>
									<v8:content>Характеристика номенклатуры</v8:content>
								</v8:item>
							</title>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>НомерГТД</dataPath>
							<field>НомерГТД</field>
							<title xsi:type="v8:LocalStringType">
								<v8:item>
									<v8:lang>ru</v8:lang>
									<v8:content>Номер ГТД</v8:content>
								</v8:item>
							</title>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>ТипЕдиницы</dataPath>
							<field>ТипЕдиницы</field>
							<title xsi:type="v8:LocalStringType">
								<v8:item>
									<v8:lang>ru</v8:lang>
									<v8:content>Тип единицы</v8:content>
								</v8:item>
							</title>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>Количество</dataPath>
							<field>Количество</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>Страна</dataPath>
							<field>Страна</field>
							<title xsi:type="v8:LocalStringType">
								<v8:item>
									<v8:lang>ru</v8:lang>
									<v8:content>Страна</v8:content>
								</v8:item>
							</title>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>ЕдиницаИзмерения</dataPath>
							<field>ЕдиницаИзмерения</field>
							<title xsi:type="v8:LocalStringType">
								<v8:item>
									<v8:lang>ru</v8:lang>
									<v8:content>Единица измерения</v8:content>
								</v8:item>
							</title>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>Номенклатура</dataPath>
							<field>Номенклатура</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>Цена</dataPath>
							<field>Цена</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>СерияНоменклатуры</dataPath>
							<field>СерияНоменклатуры</field>
							<title xsi:type="v8:LocalStringType">
								<v8:item>
									<v8:lang>ru</v8:lang>
									<v8:content>Серия номенклатуры</v8:content>
								</v8:item>
							</title>
						</field>
						<dataSource>ИсточникДанных1</dataSource>
						<query>ВЫБРАТЬ
	ВозвратТоваровОтКлиентаТовары.НомерСтроки,
	ВозвратТоваровОтКлиентаТовары.Номенклатура,
	ВозвратТоваровОтКлиентаТовары.Характеристика КАК ХарактеристикаНоменклатуры,
	ВЫБОР
		КОГДА ВозвратТоваровОтКлиентаТовары.Упаковка = ЗНАЧЕНИЕ(Справочник.УпаковкиНоменклатуры.ПустаяСсылка)
			ТОГДА ВозвратТоваровОтКлиентаТовары.Номенклатура.ЕдиницаИзмерения
		ИНАЧЕ ВозвратТоваровОтКлиентаТовары.Упаковка
	КОНЕЦ КАК ЕдиницаИзмерения,
	ВЫРАЗИТЬ(ВозвратТоваровОтКлиентаТовары.Номенклатура.Наименование КАК СТРОКА(178)) КАК Наименование,
	ВЫРАЗИТЬ(ВозвратТоваровОтКлиентаТовары.Номенклатура.НаименованиеПолное КАК СТРОКА(500)) КАК НаименованиеПолное,
	ВозвратТоваровОтКлиентаТовары.Цена,
	ВозвратТоваровОтКлиентаТовары.СтавкаНДС,
	Неопределено КАК СерияНоменклатуры,
	Неопределено КАК Страна,
	Неопределено КАК НомерГТД,
	ВозвратТоваровОтКлиентаТовары.КоличествоУпаковок КАК Количество,
	ВозвратТоваровОтКлиентаТовары.Сумма,
	ВозвратТоваровОтКлиентаТовары.СуммаНДС,
	"" КАК ТипЕдиницы
ИЗ
	Документ.ВозвратТоваровОтКлиента.Товары КАК ВозвратТоваровОтКлиентаТовары
ГДЕ
	ВозвратТоваровОтКлиентаТовары.Ссылка В(&amp;Ссылка)</query>
					</item>
					<item xsi:type="DataSetQuery">
						<name>ПоступлениеТоваровУслуг</name>
						<field xsi:type="DataSetFieldField">
							<dataPath>СуммаНДС</dataPath>
							<field>СуммаНДС</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>НомерСтроки</dataPath>
							<field>НомерСтроки</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>Сумма</dataPath>
							<field>Сумма</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>Наименование</dataPath>
							<field>Наименование</field>
							<title xsi:type="v8:LocalStringType">
								<v8:item>
									<v8:lang>ru</v8:lang>
									<v8:content>Наименование</v8:content>
								</v8:item>
							</title>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>НаименованиеПолное</dataPath>
							<field>НаименованиеПолное</field>
							<title xsi:type="v8:LocalStringType">
								<v8:item>
									<v8:lang>ru</v8:lang>
									<v8:content>Наименование полное</v8:content>
								</v8:item>
							</title>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>СтавкаНДС</dataPath>
							<field>СтавкаНДС</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>ХарактеристикаНоменклатуры</dataPath>
							<field>ХарактеристикаНоменклатуры</field>
							<title xsi:type="v8:LocalStringType">
								<v8:item>
									<v8:lang>ru</v8:lang>
									<v8:content>Характеристика номенклатуры</v8:content>
								</v8:item>
							</title>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>НомерГТД</dataPath>
							<field>НомерГТД</field>
							<title xsi:type="v8:LocalStringType">
								<v8:item>
									<v8:lang>ru</v8:lang>
									<v8:content>Номер ГТД</v8:content>
								</v8:item>
							</title>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>ТипЕдиницы</dataPath>
							<field>ТипЕдиницы</field>
							<title xsi:type="v8:LocalStringType">
								<v8:item>
									<v8:lang>ru</v8:lang>
									<v8:content>Тип единицы</v8:content>
								</v8:item>
							</title>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>Количество</dataPath>
							<field>Количество</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>Страна</dataPath>
							<field>Страна</field>
							<title xsi:type="v8:LocalStringType">
								<v8:item>
									<v8:lang>ru</v8:lang>
									<v8:content>Страна</v8:content>
								</v8:item>
							</title>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>ЕдиницаИзмерения</dataPath>
							<field>ЕдиницаИзмерения</field>
							<title xsi:type="v8:LocalStringType">
								<v8:item>
									<v8:lang>ru</v8:lang>
									<v8:content>Единица измерения</v8:content>
								</v8:item>
							</title>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>Номенклатура</dataPath>
							<field>Номенклатура</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>Цена</dataPath>
							<field>Цена</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>СерияНоменклатуры</dataPath>
							<field>СерияНоменклатуры</field>
							<title xsi:type="v8:LocalStringType">
								<v8:item>
									<v8:lang>ru</v8:lang>
									<v8:content>Серия номенклатуры</v8:content>
								</v8:item>
							</title>
						</field>
						<dataSource>ИсточникДанных1</dataSource>
						<query>ВЫБРАТЬ
	ПоступлениеТоваровУслугТовары.НомерСтроки,
	ПоступлениеТоваровУслугТовары.Номенклатура,
	ПоступлениеТоваровУслугТовары.Характеристика КАК ХарактеристикаНоменклатуры,
	ВЫБОР
		КОГДА ПоступлениеТоваровУслугТовары.Упаковка = ЗНАЧЕНИЕ(Справочник.УпаковкиНоменклатуры.ПустаяСсылка)
			ТОГДА ПоступлениеТоваровУслугТовары.Номенклатура.ЕдиницаИзмерения
		ИНАЧЕ ПоступлениеТоваровУслугТовары.Упаковка
	КОНЕЦ КАК ЕдиницаИзмерения,
	ВЫРАЗИТЬ(ПоступлениеТоваровУслугТовары.Номенклатура.Наименование КАК СТРОКА(178)) КАК Наименование,
	ВЫРАЗИТЬ(ПоступлениеТоваровУслугТовары.Номенклатура.НаименованиеПолное КАК СТРОКА(500)) КАК НаименованиеПолное,
	ПоступлениеТоваровУслугТовары.Цена,
	ПоступлениеТоваровУслугТовары.СтавкаНДС,
	Неопределено КАК СерияНоменклатуры,
	Неопределено КАК Страна,
	Неопределено КАК НомерГТД,
	ПоступлениеТоваровУслугТовары.КоличествоУпаковок КАК Количество,
	ПоступлениеТоваровУслугТовары.Сумма,
	ПоступлениеТоваровУслугТовары.СуммаНДС,
	"" КАК ТипЕдиницы
ИЗ
	Документ.ПоступлениеТоваровУслуг.Товары КАК ПоступлениеТоваровУслугТовары
ГДЕ
	ПоступлениеТоваровУслугТовары.Ссылка В(&amp;Ссылка)</query>
					</item>
					<item xsi:type="DataSetQuery">
						<name>ПриобретениеТоваровУслуг</name>
						<field xsi:type="DataSetFieldField">
							<dataPath>СуммаНДС</dataPath>
							<field>СуммаНДС</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>НомерСтроки</dataPath>
							<field>НомерСтроки</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>Сумма</dataPath>
							<field>Сумма</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>Наименование</dataPath>
							<field>Наименование</field>
							<title xsi:type="v8:LocalStringType">
								<v8:item>
									<v8:lang>ru</v8:lang>
									<v8:content>Наименование</v8:content>
								</v8:item>
							</title>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>НаименованиеПолное</dataPath>
							<field>НаименованиеПолное</field>
							<title xsi:type="v8:LocalStringType">
								<v8:item>
									<v8:lang>ru</v8:lang>
									<v8:content>Наименование полное</v8:content>
								</v8:item>
							</title>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>СтавкаНДС</dataPath>
							<field>СтавкаНДС</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>ХарактеристикаНоменклатуры</dataPath>
							<field>ХарактеристикаНоменклатуры</field>
							<title xsi:type="v8:LocalStringType">
								<v8:item>
									<v8:lang>ru</v8:lang>
									<v8:content>Характеристика номенклатуры</v8:content>
								</v8:item>
							</title>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>НомерГТД</dataPath>
							<field>НомерГТД</field>
							<title xsi:type="v8:LocalStringType">
								<v8:item>
									<v8:lang>ru</v8:lang>
									<v8:content>Номер ГТД</v8:content>
								</v8:item>
							</title>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>ТипЕдиницы</dataPath>
							<field>ТипЕдиницы</field>
							<title xsi:type="v8:LocalStringType">
								<v8:item>
									<v8:lang>ru</v8:lang>
									<v8:content>Тип единицы</v8:content>
								</v8:item>
							</title>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>Количество</dataPath>
							<field>Количество</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>Страна</dataPath>
							<field>Страна</field>
							<title xsi:type="v8:LocalStringType">
								<v8:item>
									<v8:lang>ru</v8:lang>
									<v8:content>Страна</v8:content>
								</v8:item>
							</title>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>ЕдиницаИзмерения</dataPath>
							<field>ЕдиницаИзмерения</field>
							<title xsi:type="v8:LocalStringType">
								<v8:item>
									<v8:lang>ru</v8:lang>
									<v8:content>Единица измерения</v8:content>
								</v8:item>
							</title>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>Номенклатура</dataPath>
							<field>Номенклатура</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>Цена</dataPath>
							<field>Цена</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>СерияНоменклатуры</dataPath>
							<field>СерияНоменклатуры</field>
							<title xsi:type="v8:LocalStringType">
								<v8:item>
									<v8:lang>ru</v8:lang>
									<v8:content>Серия номенклатуры</v8:content>
								</v8:item>
							</title>
						</field>
						<dataSource>ИсточникДанных1</dataSource>
						<query>ВЫБРАТЬ
	ПоступлениеТоваровУслугТовары.НомерСтроки,
	ПоступлениеТоваровУслугТовары.Номенклатура,
	ПоступлениеТоваровУслугТовары.Характеристика КАК ХарактеристикаНоменклатуры,
	ВЫБОР
		КОГДА ПоступлениеТоваровУслугТовары.Упаковка = ЗНАЧЕНИЕ(Справочник.УпаковкиЕдиницыИзмерения.ПустаяСсылка)
			ТОГДА ПоступлениеТоваровУслугТовары.Номенклатура.ЕдиницаИзмерения
		ИНАЧЕ ПоступлениеТоваровУслугТовары.Упаковка
	КОНЕЦ КАК ЕдиницаИзмерения,
	ВЫРАЗИТЬ(ПоступлениеТоваровУслугТовары.Номенклатура.Наименование КАК СТРОКА(178)) КАК Наименование,
	ВЫРАЗИТЬ(ПоступлениеТоваровУслугТовары.Номенклатура.НаименованиеПолное КАК СТРОКА(500)) КАК НаименованиеПолное,
	ПоступлениеТоваровУслугТовары.Цена,
	ПоступлениеТоваровУслугТовары.СтавкаНДС,
	Неопределено КАК СерияНоменклатуры,
	Неопределено КАК Страна,
	Неопределено КАК НомерГТД,
	ПоступлениеТоваровУслугТовары.КоличествоУпаковок КАК Количество,
	ПоступлениеТоваровУслугТовары.Сумма,
	ПоступлениеТоваровУслугТовары.СуммаНДС,
	"" КАК ТипЕдиницы
ИЗ
	Документ.ПриобретениеТоваровУслуг.Товары КАК ПоступлениеТоваровУслугТовары
ГДЕ
	ПоступлениеТоваровУслугТовары.Ссылка В(&amp;Ссылка)</query>
					</item>
				</item>
				<item xsi:type="DataSetUnion">
					<name>_COINVOIC_IINVOIC_</name>
					<field xsi:type="DataSetFieldField">
						<dataPath>ЕдиницаИзмерения</dataPath>
						<field>ЕдиницаИзмерения</field>
					</field>
					<field xsi:type="DataSetFieldField">
						<dataPath>Количество</dataPath>
						<field>Количество</field>
					</field>
					<field xsi:type="DataSetFieldField">
						<dataPath>КоличествоДоКорректировки</dataPath>
						<field>КоличествоДоКорректировки</field>
					</field>
					<field xsi:type="DataSetFieldField">
						<dataPath>Номенклатура</dataPath>
						<field>Номенклатура</field>
					</field>
					<field xsi:type="DataSetFieldField">
						<dataPath>НомерГТД</dataPath>
						<field>НомерГТД</field>
					</field>
					<field xsi:type="DataSetFieldField">
						<dataPath>СерияНоменклатуры</dataPath>
						<field>СерияНоменклатуры</field>
					</field>
					<field xsi:type="DataSetFieldField">
						<dataPath>СтавкаНДС</dataPath>
						<field>СтавкаНДС</field>
					</field>
					<field xsi:type="DataSetFieldField">
						<dataPath>СтавкаНДСДоКорректировки</dataPath>
						<field>СтавкаНДСДоКорректировки</field>
					</field>
					<field xsi:type="DataSetFieldField">
						<dataPath>Страна</dataPath>
						<field>Страна</field>
					</field>
					<field xsi:type="DataSetFieldField">
						<dataPath>Сумма</dataPath>
						<field>Сумма</field>
					</field>
					<field xsi:type="DataSetFieldField">
						<dataPath>СуммаДоКорректировки</dataPath>
						<field>СуммаДоКорректировки</field>
					</field>
					<field xsi:type="DataSetFieldField">
						<dataPath>СуммаНДС</dataPath>
						<field>СуммаНДС</field>
					</field>
					<field xsi:type="DataSetFieldField">
						<dataPath>СуммаНДСДоКорректировки</dataPath>
						<field>СуммаНДСДоКорректировки</field>
					</field>
					<field xsi:type="DataSetFieldField">
						<dataPath>ХарактеристикаНоменклатуры</dataPath>
						<field>ХарактеристикаНоменклатуры</field>
					</field>
					<field xsi:type="DataSetFieldField">
						<dataPath>Цена</dataPath>
						<field>Цена</field>
					</field>
					<field xsi:type="DataSetFieldField">
						<dataPath>ЦенаДоКорректировки</dataPath>
						<field>ЦенаДоКорректировки</field>
					</field>
					<field xsi:type="DataSetFieldField">
						<dataPath>Наименование</dataPath>
						<field>Наименование</field>
					</field>
					<field xsi:type="DataSetFieldField">
						<dataPath>НаименованиеПолное</dataPath>
						<field>НаименованиеПолное</field>
					</field>
					<item xsi:type="DataSetQuery">
						<name>КорректировкаРеализации</name>
						<field xsi:type="DataSetFieldField">
							<dataPath>ЕдиницаИзмерения</dataPath>
							<field>ЕдиницаИзмерения</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>Количество</dataPath>
							<field>Количество</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>КоличествоДоКорректировки</dataPath>
							<field>КоличествоДоКорректировки</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>Номенклатура</dataPath>
							<field>Номенклатура</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>НомерГТД</dataPath>
							<field>НомерГТД</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>СерияНоменклатуры</dataPath>
							<field>СерияНоменклатуры</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>СтавкаНДС</dataPath>
							<field>СтавкаНДС</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>СтавкаНДСДоКорректировки</dataPath>
							<field>СтавкаНДСДоКорректировки</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>Страна</dataPath>
							<field>Страна</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>Сумма</dataPath>
							<field>Сумма</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>СуммаДоКорректировки</dataPath>
							<field>СуммаДоКорректировки</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>СуммаНДС</dataPath>
							<field>СуммаНДС</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>СуммаНДСДоКорректировки</dataPath>
							<field>СуммаНДСДоКорректировки</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>ХарактеристикаНоменклатуры</dataPath>
							<field>ХарактеристикаНоменклатуры</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>Цена</dataPath>
							<field>Цена</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>ЦенаДоКорректировки</dataPath>
							<field>ЦенаДоКорректировки</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>Наименование</dataPath>
							<field>Наименование</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>НаименованиеПолное</dataPath>
							<field>НаименованиеПолное</field>
						</field>
						<dataSource>ИсточникДанных1</dataSource>
						<query>ВЫБРАТЬ
	докКорректировка.Ссылка КАК Корректировка,
	докКорректировка.ДокументОснование КАК ДокументРеализации,
	докКорректировка.Дата КАК ДатаКорректировки
ПОМЕСТИТЬ табКорректировки
ИЗ
	Документ.КорректировкаРеализации КАК докКорректировка
ГДЕ
	докКорректировка.Ссылка = &amp;Ссылка

СГРУППИРОВАТЬ ПО
	докКорректировка.Ссылка,
	докКорректировка.ДокументОснование,
	докКорректировка.Дата
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ
	табКорректировки.Корректировка КАК Корректировка,
	КорректировкаРеализации.Ссылка КАК ПредыдущаяКорректировка,
	КорректировкаРеализации.Дата КАК ДатаПредыдущейКорректировки
ПОМЕСТИТЬ табВсехПредыдущихКорректировок
ИЗ
	табКорректировки КАК табКорректировки
		ВНУТРЕННЕЕ СОЕДИНЕНИЕ Документ.КорректировкаРеализации КАК КорректировкаРеализации
		ПО табКорректировки.ДокументРеализации = КорректировкаРеализации.ДокументОснование
			И табКорректировки.Корректировка &lt;&gt; КорректировкаРеализации.Ссылка
			И табКорректировки.ДатаКорректировки &gt;= КорректировкаРеализации.Дата
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ
	РеализацияТоваровУслугТовары.Номенклатура КАК Номенклатура,
	РеализацияТоваровУслугТовары.Характеристика КАК ХарактеристикаНоменклатуры,
	ВЫБОР
		КОГДА РеализацияТоваровУслугТовары.Упаковка = ЗНАЧЕНИЕ(Справочник.УпаковкиНоменклатуры.ПустаяСсылка)
			ТОГДА РеализацияТоваровУслугТовары.Номенклатура.ЕдиницаИзмерения
		ИНАЧЕ РеализацияТоваровУслугТовары.Упаковка
	КОНЕЦ КАК ЕдиницаИзмерения,
	ВЫРАЗИТЬ(РеализацияТоваровУслугТовары.Номенклатура.Наименование КАК СТРОКА(178)) КАК Наименование,
	ПОДСТРОКА(РеализацияТоваровУслугТовары.Номенклатура.НаименованиеПолное, 0, 500) КАК НаименованиеПолное,
	РеализацияТоваровУслугТовары.СтавкаНДС КАК СтавкаНДС,
	ЗНАЧЕНИЕ(Справочник.СерииНоменклатуры.ПустаяСсылка) КАК СерияНоменклатуры,
	РеализацияТоваровУслугТовары.НомерГТД.СтранаПроисхождения КАК Страна,
	РеализацияТоваровУслугТовары.НомерГТД.Код КАК НомерГТД,
	СУММА(РеализацияТоваровУслугТовары.КоличествоУпаковок) КАК Количество,
	СУММА(РеализацияТоваровУслугТовары.СуммаСНДС) КАК Сумма,
	СУММА(РеализацияТоваровУслугТовары.СуммаНДС) КАК СуммаНДС,
	"" КАК ТипЕдиницы,
	РеализацияТоваровУслугТовары.Ссылка КАК Ссылка
ПОМЕСТИТЬ ПервичныйДокументВидыЗапасов
ИЗ
	табКорректировки КАК табКорректировки
		ВНУТРЕННЕЕ СОЕДИНЕНИЕ Документ.РеализацияТоваровУслуг.ВидыЗапасов КАК РеализацияТоваровУслугТовары
		ПО табКорректировки.ДокументРеализации = РеализацияТоваровУслугТовары.Ссылка
ГДЕ
	РеализацияТоваровУслугТовары.Ссылка В
			(ВЫБРАТЬ
				табКорректировки.ДокументРеализации
			ИЗ
				табКорректировки КАК табКорректировки)

СГРУППИРОВАТЬ ПО
	РеализацияТоваровУслугТовары.Номенклатура,
	РеализацияТоваровУслугТовары.Характеристика,
	ВЫБОР
		КОГДА РеализацияТоваровУслугТовары.Упаковка = ЗНАЧЕНИЕ(Справочник.УпаковкиНоменклатуры.ПустаяСсылка)
			ТОГДА РеализацияТоваровУслугТовары.Номенклатура.ЕдиницаИзмерения
		ИНАЧЕ РеализацияТоваровУслугТовары.Упаковка
	КОНЕЦ,
	ВЫРАЗИТЬ(РеализацияТоваровУслугТовары.Номенклатура.Наименование КАК СТРОКА(178)),
	ПОДСТРОКА(РеализацияТоваровУслугТовары.Номенклатура.НаименованиеПолное, 0, 500),
	РеализацияТоваровУслугТовары.СтавкаНДС,
	РеализацияТоваровУслугТовары.НомерГТД.СтранаПроисхождения,
	РеализацияТоваровУслугТовары.НомерГТД.Код,
	РеализацияТоваровУслугТовары.Ссылка
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ
	КорректировкаРеализацииВидыЗапасовКорректировкаВыручки.Номенклатура КАК Номенклатура,
	КорректировкаРеализацииВидыЗапасовКорректировкаВыручки.Характеристика КАК ХарактеристикаНоменклатуры,
	ЗНАЧЕНИЕ(Справочник.СерииНоменклатуры.ПустаяСсылка) КАК СерияНоменклатуры,
	КорректировкаРеализацииВидыЗапасовКорректировкаВыручки.НомерГТД.Код КАК НомерГТД,
	КорректировкаРеализацииВидыЗапасовКорректировкаВыручки.НомерГТД.СтранаПроисхождения КАК Страна,
	ВЫБОР
		КОГДА КорректировкаРеализацииВидыЗапасовКорректировкаВыручки.Упаковка = ЗНАЧЕНИЕ(Справочник.УпаковкиНоменклатуры.ПустаяСсылка)
			ТОГДА КорректировкаРеализацииВидыЗапасовКорректировкаВыручки.Номенклатура.ЕдиницаИзмерения
		ИНАЧЕ КорректировкаРеализацииВидыЗапасовКорректировкаВыручки.Упаковка
	КОНЕЦ КАК ЕдиницаИзмерения,
	ВЫРАЗИТЬ(КорректировкаРеализацииВидыЗапасовКорректировкаВыручки.Номенклатура.Наименование КАК СТРОКА(178)) КАК Наименование,
	ПОДСТРОКА(КорректировкаРеализацииВидыЗапасовКорректировкаВыручки.Номенклатура.НаименованиеПолное, 0, 500) КАК НаименованиеПолное,
	КорректировкаРеализацииВидыЗапасовКорректировкаВыручки.СтавкаНДС КАК СтавкаНДСДоКорректировки,
	КорректировкаРеализацииВидыЗапасовКорректировкаВыручки.СуммаСНДС КАК СуммаСНДСДоКорректировки,
	КорректировкаРеализацииВидыЗапасовКорректировкаВыручки.СуммаНДС КАК СуммаНДСДоКорректировки,
	0 КАК КоличествоДоКорректировки,
	КорректировкаРеализацииВидыЗапасовКорректировкаВыручки.Ссылка КАК Ссылка
ПОМЕСТИТЬ табСборкаПредудущихДанных
ИЗ
	Документ.КорректировкаРеализации.ВидыЗапасовКорректировкаВыручки КАК КорректировкаРеализацииВидыЗапасовКорректировкаВыручки
		ВНУТРЕННЕЕ СОЕДИНЕНИЕ табВсехПредыдущихКорректировок КАК табВсехПредыдущихКорректировок
		ПО КорректировкаРеализацииВидыЗапасовКорректировкаВыручки.Ссылка = табВсехПредыдущихКорректировок.ПредыдущаяКорректировка

ОБЪЕДИНИТЬ ВСЕ

ВЫБРАТЬ
	КорректировкаРеализацииВидыЗапасовОприходование.Номенклатура,
	КорректировкаРеализацииВидыЗапасовОприходование.Характеристика,
	ЗНАЧЕНИЕ(Справочник.СерииНоменклатуры.ПустаяСсылка),
	КорректировкаРеализацииВидыЗапасовОприходование.НомерГТД.Код,
	КорректировкаРеализацииВидыЗапасовОприходование.НомерГТД.СтранаПроисхождения,
	ВЫБОР
		КОГДА КорректировкаРеализацииВидыЗапасовОприходование.Упаковка = ЗНАЧЕНИЕ(Справочник.УпаковкиНоменклатуры.ПустаяСсылка)
			ТОГДА КорректировкаРеализацииВидыЗапасовОприходование.Номенклатура.ЕдиницаИзмерения
		ИНАЧЕ КорректировкаРеализацииВидыЗапасовОприходование.Упаковка
	КОНЕЦ,
	ВЫРАЗИТЬ(КорректировкаРеализацииВидыЗапасовОприходование.Номенклатура.Наименование КАК СТРОКА(178)),
	ПОДСТРОКА(КорректировкаРеализацииВидыЗапасовОприходование.Номенклатура.НаименованиеПолное, 0, 500),
	КорректировкаРеализацииВидыЗапасовОприходование.СтавкаНДС,
	-КорректировкаРеализацииВидыЗапасовОприходование.СуммаСНДС,
	-КорректировкаРеализацииВидыЗапасовОприходование.СуммаНДС,
	-КорректировкаРеализацииВидыЗапасовОприходование.КоличествоУпаковок,
	КорректировкаРеализацииВидыЗапасовОприходование.Ссылка
ИЗ
	Документ.КорректировкаРеализации.ВидыЗапасовОприходование КАК КорректировкаРеализацииВидыЗапасовОприходование
		ВНУТРЕННЕЕ СОЕДИНЕНИЕ табВсехПредыдущихКорректировок КАК табВсехПредыдущихКорректировок
		ПО КорректировкаРеализацииВидыЗапасовОприходование.Ссылка = табВсехПредыдущихКорректировок.ПредыдущаяКорректировка

ОБЪЕДИНИТЬ ВСЕ

ВЫБРАТЬ
	КорректировкаРеализацииВидыЗапасовСписание.Номенклатура,
	КорректировкаРеализацииВидыЗапасовСписание.Характеристика,
	ЗНАЧЕНИЕ(Справочник.СерииНоменклатуры.ПустаяСсылка),
	КорректировкаРеализацииВидыЗапасовСписание.НомерГТД.Код,
	КорректировкаРеализацииВидыЗапасовСписание.НомерГТД.СтранаПроисхождения,
	ВЫБОР
		КОГДА КорректировкаРеализацииВидыЗапасовСписание.Упаковка = ЗНАЧЕНИЕ(Справочник.УпаковкиНоменклатуры.ПустаяСсылка)
			ТОГДА КорректировкаРеализацииВидыЗапасовСписание.Номенклатура.ЕдиницаИзмерения
		ИНАЧЕ КорректировкаРеализацииВидыЗапасовСписание.Упаковка
	КОНЕЦ,
	ВЫРАЗИТЬ(КорректировкаРеализацииВидыЗапасовСписание.Номенклатура.Наименование КАК СТРОКА(178)),
	ПОДСТРОКА(КорректировкаРеализацииВидыЗапасовСписание.Номенклатура.НаименованиеПолное, 0, 500),
	КорректировкаРеализацииВидыЗапасовСписание.СтавкаНДС,
	КорректировкаРеализацииВидыЗапасовСписание.СуммаСНДС,
	КорректировкаРеализацииВидыЗапасовСписание.СуммаНДС,
	КорректировкаРеализацииВидыЗапасовСписание.КоличествоУпаковок,
	КорректировкаРеализацииВидыЗапасовСписание.Ссылка
ИЗ
	Документ.КорректировкаРеализации.ВидыЗапасовСписание КАК КорректировкаРеализацииВидыЗапасовСписание
		ВНУТРЕННЕЕ СОЕДИНЕНИЕ табВсехПредыдущихКорректировок КАК табВсехПредыдущихКорректировок
		ПО КорректировкаРеализацииВидыЗапасовСписание.Ссылка = табВсехПредыдущихКорректировок.ПредыдущаяКорректировка

ОБЪЕДИНИТЬ ВСЕ

ВЫБРАТЬ
	ПервичныйДокументВидыЗапасов.Номенклатура,
	ПервичныйДокументВидыЗапасов.ХарактеристикаНоменклатуры,
	ПервичныйДокументВидыЗапасов.СерияНоменклатуры,
	ПервичныйДокументВидыЗапасов.НомерГТД,
	ПервичныйДокументВидыЗапасов.Страна,
	ПервичныйДокументВидыЗапасов.ЕдиницаИзмерения,
	ВЫРАЗИТЬ(ПервичныйДокументВидыЗапасов.Наименование КАК СТРОКА(178)),
	ВЫРАЗИТЬ(ПервичныйДокументВидыЗапасов.НаименованиеПолное КАК СТРОКА(500)),
	ПервичныйДокументВидыЗапасов.СтавкаНДС,
	ПервичныйДокументВидыЗапасов.Сумма,
	ПервичныйДокументВидыЗапасов.СуммаНДС,
	ПервичныйДокументВидыЗапасов.Количество,
	ПервичныйДокументВидыЗапасов.Ссылка
ИЗ
	ПервичныйДокументВидыЗапасов КАК ПервичныйДокументВидыЗапасов
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ
	табСборкаПредудущихДанных.Номенклатура КАК Номенклатура,
	табСборкаПредудущихДанных.ХарактеристикаНоменклатуры КАК ХарактеристикаНоменклатуры,
	табСборкаПредудущихДанных.СерияНоменклатуры КАК СерияНоменклатуры,
	табСборкаПредудущихДанных.НомерГТД КАК НомерГТД,
	табСборкаПредудущихДанных.Страна КАК Страна,
	табСборкаПредудущихДанных.ЕдиницаИзмерения КАК ЕдиницаИзмерения,
	табСборкаПредудущихДанных.Наименование КАК Наименование,
	табСборкаПредудущихДанных.НаименованиеПолное КАК НаименованиеПолное,
	табСборкаПредудущихДанных.СтавкаНДСДоКорректировки КАК СтавкаНДС,
	табСборкаПредудущихДанных.СуммаСНДСДоКорректировки КАК СуммаСНДС,
	табСборкаПредудущихДанных.СуммаНДСДоКорректировки КАК СуммаНДС,
	табСборкаПредудущихДанных.КоличествоДоКорректировки КАК Количество,
	табСборкаПредудущихДанных.Ссылка КАК Ссылка
ПОМЕСТИТЬ табСборкаДанныхТекущейКорректировки
ИЗ
	табСборкаПредудущихДанных КАК табСборкаПредудущихДанных

ОБЪЕДИНИТЬ ВСЕ

ВЫБРАТЬ
	КорректировкаРеализацииВидыЗапасовКорректировкаВыручки.Номенклатура,
	КорректировкаРеализацииВидыЗапасовКорректировкаВыручки.Характеристика,
	ЗНАЧЕНИЕ(Справочник.СерииНоменклатуры.ПустаяСсылка),
	КорректировкаРеализацииВидыЗапасовКорректировкаВыручки.НомерГТД.Код,
	КорректировкаРеализацииВидыЗапасовКорректировкаВыручки.НомерГТД.СтранаПроисхождения,
	ВЫБОР
		КОГДА КорректировкаРеализацииВидыЗапасовКорректировкаВыручки.Упаковка = ЗНАЧЕНИЕ(Справочник.УпаковкиНоменклатуры.ПустаяСсылка)
			ТОГДА КорректировкаРеализацииВидыЗапасовКорректировкаВыручки.Номенклатура.ЕдиницаИзмерения
		ИНАЧЕ КорректировкаРеализацииВидыЗапасовКорректировкаВыручки.Упаковка
	КОНЕЦ,
	ВЫРАЗИТЬ(КорректировкаРеализацииВидыЗапасовКорректировкаВыручки.Номенклатура.Наименование КАК СТРОКА(178)),
	ПОДСТРОКА(КорректировкаРеализацииВидыЗапасовКорректировкаВыручки.Номенклатура.НаименованиеПолное, 0, 500),
	КорректировкаРеализацииВидыЗапасовКорректировкаВыручки.СтавкаНДС,
	КорректировкаРеализацииВидыЗапасовКорректировкаВыручки.СуммаСНДС,
	КорректировкаРеализацииВидыЗапасовКорректировкаВыручки.СуммаНДС,
	0,
	КорректировкаРеализацииВидыЗапасовКорректировкаВыручки.Ссылка
ИЗ
	Документ.КорректировкаРеализации.ВидыЗапасовКорректировкаВыручки КАК КорректировкаРеализацииВидыЗапасовКорректировкаВыручки
ГДЕ
	КорректировкаРеализацииВидыЗапасовКорректировкаВыручки.Ссылка = &amp;Ссылка

ОБЪЕДИНИТЬ ВСЕ

ВЫБРАТЬ
	КорректировкаРеализацииВидыЗапасовОприходование.Номенклатура,
	КорректировкаРеализацииВидыЗапасовОприходование.Характеристика,
	ЗНАЧЕНИЕ(Справочник.СерииНоменклатуры.ПустаяСсылка),
	КорректировкаРеализацииВидыЗапасовОприходование.НомерГТД.Код,
	КорректировкаРеализацииВидыЗапасовОприходование.НомерГТД.СтранаПроисхождения,
	ВЫБОР
		КОГДА КорректировкаРеализацииВидыЗапасовОприходование.Упаковка = ЗНАЧЕНИЕ(Справочник.УпаковкиНоменклатуры.ПустаяСсылка)
			ТОГДА КорректировкаРеализацииВидыЗапасовОприходование.Номенклатура.ЕдиницаИзмерения
		ИНАЧЕ КорректировкаРеализацииВидыЗапасовОприходование.Упаковка
	КОНЕЦ,
	ВЫРАЗИТЬ(КорректировкаРеализацииВидыЗапасовОприходование.Номенклатура.Наименование КАК СТРОКА(178)),
	ПОДСТРОКА(КорректировкаРеализацииВидыЗапасовОприходование.Номенклатура.НаименованиеПолное, 0, 500),
	КорректировкаРеализацииВидыЗапасовОприходование.СтавкаНДС,
	-КорректировкаРеализацииВидыЗапасовОприходование.СуммаСНДС,
	-КорректировкаРеализацииВидыЗапасовОприходование.СуммаНДС,
	-КорректировкаРеализацииВидыЗапасовОприходование.КоличествоУпаковок,
	КорректировкаРеализацииВидыЗапасовОприходование.Ссылка
ИЗ
	Документ.КорректировкаРеализации.ВидыЗапасовОприходование КАК КорректировкаРеализацииВидыЗапасовОприходование
ГДЕ
	КорректировкаРеализацииВидыЗапасовОприходование.Ссылка = &amp;Ссылка

ОБЪЕДИНИТЬ ВСЕ

ВЫБРАТЬ
	КорректировкаРеализацииВидыЗапасовСписание.Номенклатура,
	КорректировкаРеализацииВидыЗапасовСписание.Характеристика,
	ЗНАЧЕНИЕ(Справочник.СерииНоменклатуры.ПустаяСсылка),
	КорректировкаРеализацииВидыЗапасовСписание.НомерГТД.Код,
	КорректировкаРеализацииВидыЗапасовСписание.НомерГТД.СтранаПроисхождения,
	ВЫБОР
		КОГДА КорректировкаРеализацииВидыЗапасовСписание.Упаковка = ЗНАЧЕНИЕ(Справочник.УпаковкиНоменклатуры.ПустаяСсылка)
			ТОГДА КорректировкаРеализацииВидыЗапасовСписание.Номенклатура.ЕдиницаИзмерения
		ИНАЧЕ КорректировкаРеализацииВидыЗапасовСписание.Упаковка
	КОНЕЦ,
	ВЫРАЗИТЬ(КорректировкаРеализацииВидыЗапасовСписание.Номенклатура.Наименование КАК СТРОКА(178)),
	ПОДСТРОКА(КорректировкаРеализацииВидыЗапасовСписание.Номенклатура.НаименованиеПолное, 0, 500),
	КорректировкаРеализацииВидыЗапасовСписание.СтавкаНДС,
	КорректировкаРеализацииВидыЗапасовСписание.СуммаСНДС,
	КорректировкаРеализацииВидыЗапасовСписание.СуммаНДС,
	КорректировкаРеализацииВидыЗапасовСписание.КоличествоУпаковок,
	КорректировкаРеализацииВидыЗапасовСписание.Ссылка
ИЗ
	Документ.КорректировкаРеализации.ВидыЗапасовСписание КАК КорректировкаРеализацииВидыЗапасовСписание
ГДЕ
	КорректировкаРеализацииВидыЗапасовСписание.Ссылка = &amp;Ссылка
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ
	табСборкаДанныхТекущейКорректировки.Номенклатура КАК Номенклатура,
	табСборкаДанныхТекущейКорректировки.ХарактеристикаНоменклатуры КАК ХарактеристикаНоменклатуры,
	табСборкаДанныхТекущейКорректировки.СерияНоменклатуры КАК СерияНоменклатуры,
	табСборкаДанныхТекущейКорректировки.НомерГТД КАК НомерГТД,
	табСборкаДанныхТекущейКорректировки.Страна КАК Страна,
	табСборкаДанныхТекущейКорректировки.ЕдиницаИзмерения КАК ЕдиницаИзмерения,
	табСборкаДанныхТекущейКорректировки.Наименование КАК Наименование,
	табСборкаДанныхТекущейКорректировки.НаименованиеПолное КАК НаименованиеПолное,
	табСборкаДанныхТекущейКорректировки.СтавкаНДС КАК СтавкаНДС,
	СУММА(табСборкаДанныхТекущейКорректировки.СуммаСНДС) КАК СуммаСНДС,
	СУММА(табСборкаДанныхТекущейКорректировки.СуммаНДС) КАК СуммаНДС,
	СУММА(табСборкаДанныхТекущейКорректировки.Количество) КАК Количество,
	ВЫРАЗИТЬ(ВЫБОР
			КОГДА СУММА(табСборкаДанныхТекущейКорректировки.Количество) = 0
				ТОГДА 0
			ИНАЧЕ СУММА(табСборкаДанныхТекущейКорректировки.СуммаСНДС) / СУММА(табСборкаДанныхТекущейКорректировки.Количество)
		КОНЕЦ КАК ЧИСЛО(15, 2)) КАК Цена
ПОМЕСТИТЬ СвернутаяТаблицаТекущейКорректировки
ИЗ
	табСборкаДанныхТекущейКорректировки КАК табСборкаДанныхТекущейКорректировки

СГРУППИРОВАТЬ ПО
	табСборкаДанныхТекущейКорректировки.Номенклатура,
	табСборкаДанныхТекущейКорректировки.ХарактеристикаНоменклатуры,
	табСборкаДанныхТекущейКорректировки.СерияНоменклатуры,
	табСборкаДанныхТекущейКорректировки.НомерГТД,
	табСборкаДанныхТекущейКорректировки.Страна,
	табСборкаДанныхТекущейКорректировки.ЕдиницаИзмерения,
	табСборкаДанныхТекущейКорректировки.Наименование,
	табСборкаДанныхТекущейКорректировки.НаименованиеПолное,
	табСборкаДанныхТекущейКорректировки.СтавкаНДС
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ
	табСборкаПредудущихДанных.Номенклатура КАК Номенклатура,
	табСборкаПредудущихДанных.ХарактеристикаНоменклатуры КАК ХарактеристикаНоменклатуры,
	табСборкаПредудущихДанных.СерияНоменклатуры КАК СерияНоменклатуры,
	табСборкаПредудущихДанных.НомерГТД КАК НомерГТД,
	табСборкаПредудущихДанных.Страна КАК Страна,
	табСборкаПредудущихДанных.ЕдиницаИзмерения КАК ЕдиницаИзмерения,
	табСборкаПредудущихДанных.Наименование КАК Наименование,
	табСборкаПредудущихДанных.НаименованиеПолное КАК НаименованиеПолное,
	табСборкаПредудущихДанных.СтавкаНДСДоКорректировки КАК СтавкаНДСДоКорректировки,
	СУММА(табСборкаПредудущихДанных.СуммаСНДСДоКорректировки) КАК СуммаСНДСДоКорректировки,
	СУММА(табСборкаПредудущихДанных.СуммаНДСДоКорректировки) КАК СуммаНДСДоКорректировки,
	СУММА(табСборкаПредудущихДанных.КоличествоДоКорректировки) КАК КоличествоДоКорректировки,
	ВЫРАЗИТЬ(ВЫБОР
			КОГДА СУММА(табСборкаПредудущихДанных.КоличествоДоКорректировки) = 0
				ТОГДА 0
			ИНАЧЕ СУММА(табСборкаПредудущихДанных.СуммаСНДСДоКорректировки) / СУММА(табСборкаПредудущихДанных.КоличествоДоКорректировки)
		КОНЕЦ КАК ЧИСЛО(15, 2)) КАК ЦенаДоКорректировки
ПОМЕСТИТЬ СвернутаяТаблицаПредыдущихДанных
ИЗ
	табСборкаПредудущихДанных КАК табСборкаПредудущихДанных

СГРУППИРОВАТЬ ПО
	табСборкаПредудущихДанных.Номенклатура,
	табСборкаПредудущихДанных.ХарактеристикаНоменклатуры,
	табСборкаПредудущихДанных.СерияНоменклатуры,
	табСборкаПредудущихДанных.НомерГТД,
	табСборкаПредудущихДанных.Страна,
	табСборкаПредудущихДанных.ЕдиницаИзмерения,
	табСборкаПредудущихДанных.Наименование,
	табСборкаПредудущихДанных.НаименованиеПолное,
	табСборкаПредудущихДанных.СтавкаНДСДоКорректировки
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ
	ЕСТЬNULL(СвернутаяТаблицаТекущейКорректировки.Номенклатура, СвернутаяТаблицаПредыдущихДанных.Номенклатура) КАК Номенклатура,
	ЕСТЬNULL(СвернутаяТаблицаТекущейКорректировки.ХарактеристикаНоменклатуры, СвернутаяТаблицаПредыдущихДанных.ХарактеристикаНоменклатуры) КАК ХарактеристикаНоменклатуры,
	ЕСТЬNULL(СвернутаяТаблицаТекущейКорректировки.СерияНоменклатуры, СвернутаяТаблицаПредыдущихДанных.СерияНоменклатуры) КАК СерияНоменклатуры,
	ЕСТЬNULL(СвернутаяТаблицаТекущейКорректировки.НомерГТД, СвернутаяТаблицаПредыдущихДанных.НомерГТД) КАК НомерГТД,
	ЕСТЬNULL(СвернутаяТаблицаТекущейКорректировки.Страна, СвернутаяТаблицаПредыдущихДанных.Страна) КАК Страна,
	ЕСТЬNULL(СвернутаяТаблицаТекущейКорректировки.ЕдиницаИзмерения, СвернутаяТаблицаПредыдущихДанных.ЕдиницаИзмерения) КАК ЕдиницаИзмерения,
	ЕСТЬNULL(СвернутаяТаблицаТекущейКорректировки.Наименование, СвернутаяТаблицаПредыдущихДанных.Наименование) КАК Наименование,
	ЕСТЬNULL(СвернутаяТаблицаТекущейКорректировки.НаименованиеПолное, СвернутаяТаблицаПредыдущихДанных.НаименованиеПолное) КАК НаименованиеПолное,
	СвернутаяТаблицаТекущейКорректировки.СтавкаНДС КАК СтавкаНДС,
	СУММА(ЕСТЬNULL(СвернутаяТаблицаТекущейКорректировки.СуммаСНДС, 0)) КАК СуммаСНДС,
	СУММА(ЕСТЬNULL(СвернутаяТаблицаТекущейКорректировки.СуммаНДС, 0)) КАК СуммаНДС,
	СУММА(ЕСТЬNULL(СвернутаяТаблицаТекущейКорректировки.Количество, 0)) КАК Количество,
	ЕСТЬNULL(СвернутаяТаблицаТекущейКорректировки.Цена, 0) КАК Цена,
	СвернутаяТаблицаПредыдущихДанных.СтавкаНДСДоКорректировки КАК СтавкаНДСДоКорректировки,
	СУММА(ЕСТЬNULL(СвернутаяТаблицаПредыдущихДанных.СуммаСНДСДоКорректировки, 0)) КАК СуммаСНДСДоКорректировки,
	СУММА(ЕСТЬNULL(СвернутаяТаблицаПредыдущихДанных.СуммаНДСДоКорректировки, 0)) КАК СуммаНДСДоКорректировки,
	СУММА(ЕСТЬNULL(СвернутаяТаблицаПредыдущихДанных.КоличествоДоКорректировки, 0)) КАК КоличествоДоКорректировки,
	ЕСТЬNULL(СвернутаяТаблицаПредыдущихДанных.ЦенаДоКорректировки, 0) КАК ЦенаДоКорректировки
ПОМЕСТИТЬ табДанные
ИЗ
	СвернутаяТаблицаТекущейКорректировки КАК СвернутаяТаблицаТекущейКорректировки
		ПОЛНОЕ СОЕДИНЕНИЕ СвернутаяТаблицаПредыдущихДанных КАК СвернутаяТаблицаПредыдущихДанных
		ПО СвернутаяТаблицаТекущейКорректировки.Номенклатура = СвернутаяТаблицаПредыдущихДанных.Номенклатура
			И СвернутаяТаблицаТекущейКорректировки.ХарактеристикаНоменклатуры = СвернутаяТаблицаПредыдущихДанных.ХарактеристикаНоменклатуры
			И СвернутаяТаблицаТекущейКорректировки.СерияНоменклатуры = СвернутаяТаблицаПредыдущихДанных.СерияНоменклатуры
			И СвернутаяТаблицаТекущейКорректировки.НомерГТД = СвернутаяТаблицаПредыдущихДанных.НомерГТД
			И СвернутаяТаблицаТекущейКорректировки.Страна = СвернутаяТаблицаПредыдущихДанных.Страна

СГРУППИРОВАТЬ ПО
	ЕСТЬNULL(СвернутаяТаблицаТекущейКорректировки.Номенклатура, СвернутаяТаблицаПредыдущихДанных.Номенклатура),
	ЕСТЬNULL(СвернутаяТаблицаТекущейКорректировки.ХарактеристикаНоменклатуры, СвернутаяТаблицаПредыдущихДанных.ХарактеристикаНоменклатуры),
	ЕСТЬNULL(СвернутаяТаблицаТекущейКорректировки.СерияНоменклатуры, СвернутаяТаблицаПредыдущихДанных.СерияНоменклатуры),
	ЕСТЬNULL(СвернутаяТаблицаТекущейКорректировки.НомерГТД, СвернутаяТаблицаПредыдущихДанных.НомерГТД),
	ЕСТЬNULL(СвернутаяТаблицаТекущейКорректировки.Страна, СвернутаяТаблицаПредыдущихДанных.Страна),
	ЕСТЬNULL(СвернутаяТаблицаТекущейКорректировки.ЕдиницаИзмерения, СвернутаяТаблицаПредыдущихДанных.ЕдиницаИзмерения),
	ЕСТЬNULL(СвернутаяТаблицаТекущейКорректировки.Наименование, СвернутаяТаблицаПредыдущихДанных.Наименование),
	ЕСТЬNULL(СвернутаяТаблицаТекущейКорректировки.НаименованиеПолное, СвернутаяТаблицаПредыдущихДанных.НаименованиеПолное),
	СвернутаяТаблицаПредыдущихДанных.СтавкаНДСДоКорректировки,
	СвернутаяТаблицаТекущейКорректировки.СтавкаНДС,
	ЕСТЬNULL(СвернутаяТаблицаПредыдущихДанных.ЦенаДоКорректировки, 0),
	ЕСТЬNULL(СвернутаяТаблицаТекущейКорректировки.Цена, 0)
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ
	табДанные.Номенклатура КАК Номенклатура,
	табДанные.ХарактеристикаНоменклатуры КАК ХарактеристикаНоменклатуры,
	ВЫБОР
		КОГДА &amp;СворачиватьСтроки
			ТОГДА НЕОПРЕДЕЛЕНО
		ИНАЧЕ табДанные.СерияНоменклатуры
	КОНЕЦ КАК СерияНоменклатуры,
	ВЫБОР
		КОГДА &amp;ТипСообщения = "INVOIC"
			ТОГДА табДанные.НомерГТД
		ИНАЧЕ ""
	КОНЕЦ КАК НомерГТД,
	ВЫБОР
		КОГДА &amp;ТипСообщения = "INVOIC"
			ТОГДА табДанные.Страна
		ИНАЧЕ ""
	КОНЕЦ КАК Страна,
	табДанные.ЕдиницаИзмерения КАК ЕдиницаИзмерения,
	табДанные.Наименование КАК Наименование,
	табДанные.НаименованиеПолное КАК НаименованиеПолное,
	МАКСИМУМ(табДанные.СтавкаНДС) КАК СтавкаНДС,
	СУММА(табДанные.СуммаСНДС) КАК Сумма,
	СУММА(табДанные.СуммаНДС) КАК СуммаНДС,
	СУММА(табДанные.Количество) КАК Количество,
	МАКСИМУМ(табДанные.Цена) КАК Цена,
	МАКСИМУМ(табДанные.СтавкаНДСДоКорректировки) КАК СтавкаНДСДоКорректировки,
	СУММА(табДанные.СуммаСНДСДоКорректировки) КАК СуммаДоКорректировки,
	СУММА(табДанные.СуммаНДСДоКорректировки) КАК СуммаНДСДоКорректировки,
	СУММА(табДанные.КоличествоДоКорректировки) КАК КоличествоДоКорректировки,
	МАКСИМУМ(табДанные.ЦенаДоКорректировки) КАК ЦенаДоКорректировки
ИЗ
	табДанные КАК табДанные

СГРУППИРОВАТЬ ПО
	табДанные.Номенклатура,
	табДанные.ХарактеристикаНоменклатуры,
	табДанные.ЕдиницаИзмерения,
	табДанные.Наименование,
	табДанные.НаименованиеПолное,
	ВЫБОР
		КОГДА &amp;СворачиватьСтроки
			ТОГДА НЕОПРЕДЕЛЕНО
		ИНАЧЕ табДанные.СерияНоменклатуры
	КОНЕЦ,
	ВЫБОР
		КОГДА &amp;ТипСообщения = "INVOIC"
			ТОГДА табДанные.НомерГТД
		ИНАЧЕ ""
	КОНЕЦ,
	ВЫБОР
		КОГДА &amp;ТипСообщения = "INVOIC"
			ТОГДА табДанные.Страна
		ИНАЧЕ ""
	КОНЕЦ</query>
					</item>
				</item>
				<item xsi:type="DataSetUnion">
					<name>_PRICELIST_</name>
					<field xsi:type="DataSetFieldField">
						<dataPath>GTIN</dataPath>
						<field>GTIN</field>
					</field>
					<field xsi:type="DataSetFieldField">
						<dataPath>ЕдИзмСрокаГодности</dataPath>
						<field>ЕдИзмСрокаГодности</field>
					</field>
					<field xsi:type="DataSetFieldField">
						<dataPath>ЕдиницаИзмерения</dataPath>
						<field>ЕдиницаИзмерения</field>
					</field>
					<field xsi:type="DataSetFieldField">
						<dataPath>КвантПоставки</dataPath>
						<field>КвантПоставки</field>
					</field>
					<field xsi:type="DataSetFieldField">
						<dataPath>КодТовараПоставщика</dataPath>
						<field>КодТовараПоставщика</field>
					</field>
					<field xsi:type="DataSetFieldField">
						<dataPath>КоличествоВОдномМесте</dataPath>
						<field>КоличествоВОдномМесте</field>
					</field>
					<field xsi:type="DataSetFieldField">
						<dataPath>Наименование</dataPath>
						<field>Наименование</field>
					</field>
					<field xsi:type="DataSetFieldField">
						<dataPath>Номенклатура</dataPath>
						<field>Номенклатура</field>
					</field>
					<field xsi:type="DataSetFieldField">
						<dataPath>Родитель</dataPath>
						<field>Родитель</field>
					</field>
					<field xsi:type="DataSetFieldField">
						<dataPath>СрокГодности</dataPath>
						<field>СрокГодности</field>
					</field>
					<field xsi:type="DataSetFieldField">
						<dataPath>СтавкаНДС</dataPath>
						<field>СтавкаНДС</field>
					</field>
					<field xsi:type="DataSetFieldField">
						<dataPath>Страна</dataPath>
						<field>Страна</field>
					</field>
					<field xsi:type="DataSetFieldField">
						<dataPath>Цена</dataPath>
						<field>Цена</field>
					</field>
					<field xsi:type="DataSetFieldField">
						<dataPath>РекомендуемаяРозничнаяЦена</dataPath>
						<field>РекомендуемаяРозничнаяЦена</field>
					</field>
					<field xsi:type="DataSetFieldField">
						<dataPath>КоличествоОстаткаНаКонец</dataPath>
						<field>КоличествоОстаткаНаКонец</field>
					</field>
					<field xsi:type="DataSetFieldField">
						<dataPath>Помещение</dataPath>
						<field>Помещение</field>
					</field>
					<field xsi:type="DataSetFieldField">
						<dataPath>Серия</dataPath>
						<field>Серия</field>
					</field>
					<field xsi:type="DataSetFieldField">
						<dataPath>Склад</dataPath>
						<field>Склад</field>
					</field>
					<field xsi:type="DataSetFieldField">
						<dataPath>Характеристика</dataPath>
						<field>Характеристика</field>
					</field>
					<field xsi:type="DataSetFieldField">
						<dataPath>Назначение</dataPath>
						<field>Назначение</field>
					</field>
					<item xsi:type="DataSetQuery">
						<name>Ценовой_лист_БезЦен</name>
						<field xsi:type="DataSetFieldField">
							<dataPath>GTIN</dataPath>
							<field>GTIN</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>ЕдИзмСрокаГодности</dataPath>
							<field>ЕдИзмСрокаГодности</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>ЕдиницаИзмерения</dataPath>
							<field>ЕдиницаИзмерения</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>КвантПоставки</dataPath>
							<field>КвантПоставки</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>КодТовараПоставщика</dataPath>
							<field>КодТовараПоставщика</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>КоличествоВОдномМесте</dataPath>
							<field>КоличествоВОдномМесте</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>Наименование</dataPath>
							<field>Наименование</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>Номенклатура</dataPath>
							<field>Номенклатура</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>Родитель</dataPath>
							<field>Родитель</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>СрокГодности</dataPath>
							<field>СрокГодности</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>СтавкаНДС</dataPath>
							<field>СтавкаНДС</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>Страна</dataPath>
							<field>Страна</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>Цена</dataPath>
							<field>Цена</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>РекомендуемаяРозничнаяЦена</dataPath>
							<field>РекомендуемаяРозничнаяЦена</field>
						</field>
						<dataSource>ИсточникДанных1</dataSource>
						<query>ВЫБРАТЬ
	СправочникНоменклатура.Родитель КАК Родитель,
	СправочникНоменклатура.Ссылка КАК Номенклатура,
	СправочникНоменклатура.ЕдиницаИзмерения КАК ЕдиницаИзмерения,
	СправочникНоменклатура.Код КАК КодТовараПоставщика,
	СправочникНоменклатура.НаименованиеПолное КАК Наименование,
	СправочникНоменклатура.СтавкаНДС КАК СтавкаНДС,
	0 КАК Цена,
	0 КАК РекомендуемаяРозничнаяЦена,
	Штрихкоды.Штрихкод КАК GTIN,
	NULL КАК КоличествоВОдномМесте,
	ЗНАЧЕНИЕ(Справочник.СтраныМира.ПустаяСсылка) КАК Страна,
	NULL КАК КвантПоставки,
	NULL КАК ЕдИзмСрокаГодности,
	NULL КАК СрокГодности
ИЗ
	Справочник.Номенклатура КАК СправочникНоменклатура
		ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.ШтрихкодыНоменклатуры КАК Штрихкоды
		ПО СправочникНоменклатура.Ссылка = Штрихкоды.Номенклатура
			И (Штрихкоды.Упаковка = СправочникНоменклатура.ЕдиницаИзмерения)
			И (Штрихкоды.Характеристика = ЗНАЧЕНИЕ(Справочник.ХарактеристикиНоменклатуры.ПустаяСсылка))
ГДЕ
	НЕ СправочникНоменклатура.ЭтоГруппа
	И НЕ СправочникНоменклатура.ПометкаУдаления
	И НЕ СправочникНоменклатура.ТипНоменклатуры = ЗНАЧЕНИЕ(Перечисление.ТипыНоменклатуры.Услуга)
	И &amp;УсловиеОтбораНоменклатуры</query>
					</item>
					<item xsi:type="DataSetQuery">
						<name>Ценовой_лист_СЦенами</name>
						<field xsi:type="DataSetFieldField">
							<dataPath>GTIN</dataPath>
							<field>GTIN</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>ЕдИзмСрокаГодности</dataPath>
							<field>ЕдИзмСрокаГодности</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>ЕдиницаИзмерения</dataPath>
							<field>ЕдиницаИзмерения</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>КвантПоставки</dataPath>
							<field>КвантПоставки</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>КодТовараПоставщика</dataPath>
							<field>КодТовараПоставщика</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>КоличествоВОдномМесте</dataPath>
							<field>КоличествоВОдномМесте</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>Наименование</dataPath>
							<field>Наименование</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>Номенклатура</dataPath>
							<field>Номенклатура</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>Родитель</dataPath>
							<field>Родитель</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>СрокГодности</dataPath>
							<field>СрокГодности</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>СтавкаНДС</dataPath>
							<field>СтавкаНДС</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>Страна</dataPath>
							<field>Страна</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>Цена</dataPath>
							<field>Цена</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>РекомендуемаяРозничнаяЦена</dataPath>
							<field>РекомендуемаяРозничнаяЦена</field>
						</field>
						<dataSource>ИсточникДанных1</dataSource>
						<query>ВЫБРАТЬ
	ЦеныНоменклатурыСрезПоследних.Номенклатура.Родитель КАК Родитель,
	ЦеныНоменклатурыСрезПоследних.Номенклатура.Ссылка КАК Номенклатура,
	ВЫБОР
		КОГДА ЦеныНоменклатурыСрезПоследних.Упаковка = ЗНАЧЕНИЕ(Справочник.УпаковкиНоменклатуры.ПустаяСсылка)
			ТОГДА ЦеныНоменклатурыСрезПоследних.Номенклатура.ЕдиницаИзмерения
		ИНАЧЕ ЦеныНоменклатурыСрезПоследних.Упаковка
	КОНЕЦ КАК ЕдиницаИзмерения,
	ЦеныНоменклатурыСрезПоследних.Номенклатура.Код КАК КодТовараПоставщика,
	ЦеныНоменклатурыСрезПоследних.Номенклатура.НаименованиеПолное КАК Наименование,
	ЦеныНоменклатурыСрезПоследних.Номенклатура.СтавкаНДС КАК СтавкаНДС,
	ЦеныНоменклатурыСрезПоследних.Цена,
	0 КАК РекомендуемаяРозничнаяЦена,
	Штрихкоды.Штрихкод КАК GTIN,
	ЦеныНоменклатурыСрезПоследних.Упаковка.Коэффициент КАК КоличествоВОдномМесте,
	ЗНАЧЕНИЕ(Справочник.СтраныМира.ПустаяСсылка) КАК Страна,
	NULL КАК КвантПоставки,
	NULL КАК ЕдИзмСрокаГодности,
	NULL КАК СрокГодности
ИЗ
	РегистрСведений.ЦеныНоменклатуры.СрезПоследних(
			,
			ВидЦены = &amp;ТипЦен
				И НЕ Номенклатура.ПометкаУдаления
				И НЕ Номенклатура.ТипНоменклатуры = ЗНАЧЕНИЕ(Перечисление.ТипыНоменклатуры.Услуга)
				И &amp;УсловиеОтбораНоменклатуры) КАК ЦеныНоменклатурыСрезПоследних
		ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.ШтрихкодыНоменклатуры КАК Штрихкоды
		ПО ЦеныНоменклатурыСрезПоследних.Номенклатура = Штрихкоды.Номенклатура
			И (Штрихкоды.Упаковка = ЦеныНоменклатурыСрезПоследних.Упаковка)
ГДЕ
	ЦеныНоменклатурыСрезПоследних.Цена &gt; 0</query>
					</item>
					<item xsi:type="DataSetQuery">
						<name>Ценовой_лист_БезЦен_Остатки</name>
						<field xsi:type="DataSetFieldField">
							<dataPath>GTIN</dataPath>
							<field>GTIN</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>ЕдИзмСрокаГодности</dataPath>
							<field>ЕдИзмСрокаГодности</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>ЕдиницаИзмерения</dataPath>
							<field>ЕдиницаИзмерения</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>КвантПоставки</dataPath>
							<field>КвантПоставки</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>КодТовараПоставщика</dataPath>
							<field>КодТовараПоставщика</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>КоличествоВОдномМесте</dataPath>
							<field>КоличествоВОдномМесте</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>Наименование</dataPath>
							<field>Наименование</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>Номенклатура</dataPath>
							<field>Номенклатура</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>Родитель</dataPath>
							<field>Родитель</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>СрокГодности</dataPath>
							<field>СрокГодности</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>СтавкаНДС</dataPath>
							<field>СтавкаНДС</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>Страна</dataPath>
							<field>Страна</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>Цена</dataPath>
							<field>Цена</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>КоличествоОстаткаНаКонец</dataPath>
							<field>КоличествоОстаткаНаКонец</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>Помещение</dataPath>
							<field>Помещение</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>РекомендуемаяРозничнаяЦена</dataPath>
							<field>РекомендуемаяРозничнаяЦена</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>Серия</dataPath>
							<field>Серия</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>Склад</dataPath>
							<field>Склад</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>Характеристика</dataPath>
							<field>Характеристика</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>Назначение</dataPath>
							<field>Назначение</field>
						</field>
						<dataSource>ИсточникДанных1</dataSource>
						<query>ВЫБРАТЬ
	СправочникНоменклатура.Родитель КАК Родитель,
	СправочникНоменклатура.Ссылка КАК Номенклатура,
	СправочникНоменклатура.ЕдиницаИзмерения КАК ЕдиницаИзмерения,
	СправочникНоменклатура.Код КАК КодТовараПоставщика,
	СправочникНоменклатура.НаименованиеПолное КАК Наименование,
	СправочникНоменклатура.СтавкаНДС КАК СтавкаНДС,
	0 КАК Цена,
	0 КАК РекомендуемаяРозничнаяЦена,
	Штрихкоды.Штрихкод КАК GTIN,
	NULL КАК КоличествоВОдномМесте,
	ЗНАЧЕНИЕ(Справочник.СтраныМира.ПустаяСсылка) КАК Страна,
	NULL КАК КвантПоставки,
	NULL КАК ЕдИзмСрокаГодности,
	NULL КАК СрокГодности,
	ЕСТЬNULL(ТоварыНаСкладахОстатки.ВНаличииОстаток - ТоварыНаСкладахОстатки.КОтгрузкеОстаток, 0) КАК КоличествоОстаткаНаКонец
ИЗ
	Справочник.Номенклатура КАК СправочникНоменклатура
		ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.ШтрихкодыНоменклатуры КАК Штрихкоды
		ПО СправочникНоменклатура.Ссылка = Штрихкоды.Номенклатура
			И (Штрихкоды.Упаковка = СправочникНоменклатура.ЕдиницаИзмерения)
			И (Штрихкоды.Характеристика = ЗНАЧЕНИЕ(Справочник.ХарактеристикиНоменклатуры.ПустаяСсылка))
		ЛЕВОЕ СОЕДИНЕНИЕ РегистрНакопления.ТоварыНаСкладах.Остатки(
				,
				ВЫБОР
					КОГДА &amp;Склад = НЕОПРЕДЕЛЕНО
						ТОГДА ИСТИНА
					ИНАЧЕ Склад В (&amp;Склад)
				КОНЕЦ) КАК ТоварыНаСкладахОстатки
		ПО СправочникНоменклатура.Ссылка = ТоварыНаСкладахОстатки.Номенклатура
ГДЕ
	НЕ СправочникНоменклатура.ЭтоГруппа
	И НЕ СправочникНоменклатура.ПометкаУдаления
	И НЕ СправочникНоменклатура.ТипНоменклатуры = ЗНАЧЕНИЕ(Перечисление.ТипыНоменклатуры.Услуга)
	И &amp;УсловиеОтбораНоменклатуры</query>
					</item>
					<item xsi:type="DataSetQuery">
						<name>Ценовой_лист_СЦенами_Остатки</name>
						<field xsi:type="DataSetFieldField">
							<dataPath>GTIN</dataPath>
							<field>GTIN</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>ЕдИзмСрокаГодности</dataPath>
							<field>ЕдИзмСрокаГодности</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>ЕдиницаИзмерения</dataPath>
							<field>ЕдиницаИзмерения</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>КвантПоставки</dataPath>
							<field>КвантПоставки</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>КодТовараПоставщика</dataPath>
							<field>КодТовараПоставщика</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>КоличествоВОдномМесте</dataPath>
							<field>КоличествоВОдномМесте</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>Наименование</dataPath>
							<field>Наименование</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>Номенклатура</dataPath>
							<field>Номенклатура</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>Родитель</dataPath>
							<field>Родитель</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>СрокГодности</dataPath>
							<field>СрокГодности</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>СтавкаНДС</dataPath>
							<field>СтавкаНДС</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>Страна</dataPath>
							<field>Страна</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>Цена</dataPath>
							<field>Цена</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>КоличествоОстаткаНаКонец</dataPath>
							<field>КоличествоОстаткаНаКонец</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>Помещение</dataPath>
							<field>Помещение</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>РекомендуемаяРозничнаяЦена</dataPath>
							<field>РекомендуемаяРозничнаяЦена</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>Серия</dataPath>
							<field>Серия</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>Склад</dataPath>
							<field>Склад</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>Характеристика</dataPath>
							<field>Характеристика</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>Назначение</dataPath>
							<field>Назначение</field>
						</field>
						<dataSource>ИсточникДанных1</dataSource>
						<query>ВЫБРАТЬ
	ЦеныНоменклатурыСрезПоследних.Номенклатура.Родитель КАК Родитель,
	ЦеныНоменклатурыСрезПоследних.Номенклатура.Ссылка КАК Номенклатура,
	ВЫБОР
		КОГДА ЦеныНоменклатурыСрезПоследних.Упаковка = ЗНАЧЕНИЕ(Справочник.УпаковкиНоменклатуры.ПустаяСсылка)
			ТОГДА ЦеныНоменклатурыСрезПоследних.Номенклатура.ЕдиницаИзмерения
		ИНАЧЕ ЦеныНоменклатурыСрезПоследних.Упаковка
	КОНЕЦ КАК ЕдиницаИзмерения,
	ЦеныНоменклатурыСрезПоследних.Номенклатура.Код КАК КодТовараПоставщика,
	ЦеныНоменклатурыСрезПоследних.Номенклатура.НаименованиеПолное КАК Наименование,
	ЦеныНоменклатурыСрезПоследних.Номенклатура.СтавкаНДС КАК СтавкаНДС,
	ЦеныНоменклатурыСрезПоследних.Цена,
	0 КАК РекомендуемаяРозничнаяЦена,
	Штрихкоды.Штрихкод КАК GTIN,
	ЦеныНоменклатурыСрезПоследних.Упаковка.Коэффициент КАК КоличествоВОдномМесте,
	ЗНАЧЕНИЕ(Справочник.СтраныМира.ПустаяСсылка) КАК Страна,
	NULL КАК КвантПоставки,
	NULL КАК ЕдИзмСрокаГодности,
	NULL КАК СрокГодности,
	ЕСТЬNULL(ТоварыНаСкладахОстатки.ВНаличииОстаток - ТоварыНаСкладахОстатки.КОтгрузкеОстаток, 0) КАК КоличествоОстаткаНаКонец
ИЗ
	РегистрСведений.ЦеныНоменклатуры.СрезПоследних(
			,
			ВидЦены = &amp;ТипЦен
				И НЕ Номенклатура.ПометкаУдаления
				И НЕ Номенклатура.ТипНоменклатуры = ЗНАЧЕНИЕ(Перечисление.ТипыНоменклатуры.Услуга)
				И &amp;УсловиеОтбораНоменклатуры) КАК ЦеныНоменклатурыСрезПоследних
		ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.ШтрихкодыНоменклатуры КАК Штрихкоды
		ПО ЦеныНоменклатурыСрезПоследних.Номенклатура = Штрихкоды.Номенклатура
			И (Штрихкоды.Упаковка = ЦеныНоменклатурыСрезПоследних.Упаковка)
		ЛЕВОЕ СОЕДИНЕНИЕ РегистрНакопления.ТоварыНаСкладах.Остатки(
				,
				ВЫБОР
					КОГДА &amp;Склад = НЕОПРЕДЕЛЕНО
						ТОГДА ИСТИНА
					ИНАЧЕ Склад В (&amp;Склад)
				КОНЕЦ) КАК ТоварыНаСкладахОстатки
		ПО ЦеныНоменклатурыСрезПоследних.Номенклатура = ТоварыНаСкладахОстатки.Номенклатура
ГДЕ
	ЦеныНоменклатурыСрезПоследних.Цена &gt; 0</query>
					</item>
				</item>
			</item>
			<item xsi:type="DataSetUnion">
				<name>ЗапросПоCOINVOIC</name>
				<item xsi:type="DataSetQuery">
					<name>Заказ_Реализация_СФ</name>
					<dataSource>ИсточникДанных1</dataSource>
					<query>ВЫБРАТЬ РАЗРЕШЕННЫЕ
	докКорректировка.Ссылка КАК Корректировка,
	ВЫБОР
		КОГДА НЕ докКорректировка.Проведен
			ТОГДА докКорректировка.Ссылка
		ИНАЧЕ ЕСТЬNULL(докСчетФактура.Ссылка, докКорректировка.Ссылка)
	КОНЕЦ КАК Документ,
	ВЫБОР
		КОГДА НЕ докКорректировка.Проведен
			ТОГДА "Провести Корректировка реализации"
		КОГДА докСчетФактура.Ссылка ЕСТЬ NULL
			ТОГДА "Создать Счет-фактура по корректировке"
		КОГДА НЕ докСчетФактура.Ссылка.Проведен И &amp;ТребуетсяПроведениеCOINVOIC
			ТОГДА "Провести Счет-фактура по корректировке"
		КОГДА докСчетФактура.Корректировочный &lt;&gt; ИСТИНА
			ТОГДА "Отправить счет-фактуру"
		ИНАЧЕ "Отправить корректировочный счет-фактуру"
	КОНЕЦ КАК ТребуемоеДействие,
	ВЫБОР
		КОГДА докСчетФактура.Корректировочный &lt;&gt; ИСТИНА
			ТОГДА "INVOIC"
		ИНАЧЕ "COINVOIC"
	КОНЕЦ КАК ТипСообщения,
	докКорректировка.ДокументОснование КАК ДокументРеализации,
	ТаблицаКэшПартнеровКонтрагентов.Партнер КАК Партнер,
	докКорректировка.Дата КАК ДатаКорректировки
ПОМЕСТИТЬ табКорректировки
ИЗ
	ТаблицаКэшПартнеровКонтрагентов КАК ТаблицаКэшПартнеровКонтрагентов
		ВНУТРЕННЕЕ СОЕДИНЕНИЕ Документ.КорректировкаРеализации КАК докКорректировка
			ЛЕВОЕ СОЕДИНЕНИЕ Документ.СчетФактураВыданный КАК докСчетФактура
				ЛЕВОЕ СОЕДИНЕНИЕ Справочник.КонтурEDI_Сообщения КАК КонтурEDI_Сообщения
				ПО докСчетФактура.Ссылка = КонтурEDI_Сообщения.Документ
					И (КонтурEDI_Сообщения.ТипСообщения = "COINVOIC" 
						ИЛИ КонтурEDI_Сообщения.ТипСообщения = "INVOIC")
			ПО докКорректировка.Ссылка = докСчетФактура.ДокументОснование
				И (докСчетФактура.ПометкаУдаления = ЛОЖЬ)
		ПО ТаблицаКэшПартнеровКонтрагентов.Контрагент = докКорректировка.Контрагент
			И (ТаблицаКэшПартнеровКонтрагентов.COINVOIC = ИСТИНА)
ГДЕ
	НЕ докКорректировка.ПометкаУдаления
	И докКорректировка.Дата МЕЖДУ &amp;НачалоПериода И &amp;КонецПериода
	И ВЫБОР
			КОГДА &amp;ТолькоТребуемые
				ТОГДА КонтурEDI_Сообщения.Ссылка ЕСТЬ NULL
			ИНАЧЕ ИСТИНА
		КОНЕЦ
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ РАЗРЕШЕННЫЕ
	табКорректировки.Корректировка КАК Корректировка,
	СчетФактураВыданный.Ссылка КАК ОсновнойСчетФактура
ПОМЕСТИТЬ табОсновныхСчетовФактур
ИЗ
	табКорректировки КАК табКорректировки
		ВНУТРЕННЕЕ СОЕДИНЕНИЕ Документ.СчетФактураВыданный КАК СчетФактураВыданный
		ПО табКорректировки.ДокументРеализации = СчетФактураВыданный.ДокументОснование
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ РАЗРЕШЕННЫЕ
	табКорректировки.Корректировка КАК Корректировка,
	КорректировкаРеализации.Ссылка КАК ПредыдущаяКорректировка,
	КорректировкаРеализации.Дата КАК ДатаПредыдущейКорректировки
ПОМЕСТИТЬ табВсехПредыдущихКорректировок
ИЗ
	табКорректировки КАК табКорректировки
		ВНУТРЕННЕЕ СОЕДИНЕНИЕ Документ.КорректировкаРеализации КАК КорректировкаРеализации
		ПО табКорректировки.ДокументРеализации = КорректировкаРеализации.ДокументОснование
			И (НЕ КорректировкаРеализации.ПометкаУдаления)
			И табКорректировки.Корректировка &lt;&gt; КорректировкаРеализации.Ссылка
			И табКорректировки.ДатаКорректировки &gt;= КорректировкаРеализации.Дата
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ РАЗРЕШЕННЫЕ
	табПредыдущихКорректировок.Корректировка КАК Корректировка,
	МАКСИМУМ(табПредыдущихКорректировок.ДатаПредыдущейКорректировки) КАК ДатаПредыдущейКорректировки
ПОМЕСТИТЬ табДляОпределенияПредыдущейКорректировки
ИЗ
	табВсехПредыдущихКорректировок КАК табПредыдущихКорректировок

СГРУППИРОВАТЬ ПО
	табПредыдущихКорректировок.Корректировка
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ РАЗРЕШЕННЫЕ
	табПредыдущихКорректировок.Корректировка КАК Корректировка,
	табПредыдущихКорректировок.ПредыдущаяКорректировка КАК ПредыдущаяКорректировка
ПОМЕСТИТЬ табПредыдущихКорректировок
ИЗ
	табВсехПредыдущихКорректировок КАК табПредыдущихКорректировок
		ВНУТРЕННЕЕ СОЕДИНЕНИЕ табДляОпределенияПредыдущейКорректировки КАК табДляОпределенияПредыдущейКорректировки
		ПО табПредыдущихКорректировок.Корректировка = табДляОпределенияПредыдущейКорректировки.Корректировка
			И табПредыдущихКорректировок.ДатаПредыдущейКорректировки = табДляОпределенияПредыдущейКорректировки.ДатаПредыдущейКорректировки
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ РАЗРЕШЕННЫЕ
	табПредыдущихКорректировок.Корректировка КАК Корректировка,
	СчетФактураВыданный.Ссылка КАК ПредыдущийДокумент
ПОМЕСТИТЬ табПредыдущихДокументов
ИЗ
	табПредыдущихКорректировок КАК табПредыдущихКорректировок
		ВНУТРЕННЕЕ СОЕДИНЕНИЕ Документ.СчетФактураВыданный КАК СчетФактураВыданный
		ПО табПредыдущихКорректировок.ПредыдущаяКорректировка = СчетФактураВыданный.ДокументОснование

ОБЪЕДИНИТЬ ВСЕ

ВЫБРАТЬ
	табОсновныхСчетовФактур.Корректировка,
	табОсновныхСчетовФактур.ОсновнойСчетФактура
ИЗ
	табОсновныхСчетовФактур КАК табОсновныхСчетовФактур
		ЛЕВОЕ СОЕДИНЕНИЕ табПредыдущихКорректировок КАК табПредыдущихКорректировок
		ПО табОсновныхСчетовФактур.Корректировка = табПредыдущихКорректировок.Корректировка
ГДЕ
	табПредыдущихКорректировок.Корректировка ЕСТЬ NULL
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ РАЗРЕШЕННЫЕ
	КонтурEDI_Сообщения.Ссылка КАК Сообщение,
	табПредыдущихДокументов.Корректировка КАК Корректировка,
	табПредыдущихДокументов.ПредыдущийДокумент КАК ПредыдущийДокумент
ПОМЕСТИТЬ табРазрешенийНаОтправку
ИЗ
	табПредыдущихДокументов КАК табПредыдущихДокументов
		ЛЕВОЕ СОЕДИНЕНИЕ Справочник.КонтурEDI_Сообщения КАК КонтурEDI_Сообщения
		ПО табПредыдущихДокументов.ПредыдущийДокумент = КонтурEDI_Сообщения.Документ
			И (НЕ КонтурEDI_Сообщения.Статус В (&amp;БлокирующиеСтатусыПервичногоINVOIC))
			И (КонтурEDI_Сообщения.ТипСообщения = "COINVOIC"
				ИЛИ КонтурEDI_Сообщения.ТипСообщения = "INVOIC")
ГДЕ
	ВЫБОР
			КОГДА &amp;ТолькоТребуемые
				ТОГДА КонтурEDI_Сообщения.Ссылка ЕСТЬ НЕ NULL 
			ИНАЧЕ ИСТИНА
		КОНЕЦ
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ РАЗРЕШЕННЫЕ
	табКорректировки.Корректировка КАК Корректировка,
	табКорректировки.Документ КАК Документ,
	табКорректировки.ТребуемоеДействие КАК ТребуемоеДействие,
	табКорректировки.ТипСообщения КАК ТипСообщения,
	табРазрешенийНаОтправку.Сообщение КАК Сообщение,
	табКорректировки.Партнер КАК Партнер,
	табРазрешенийНаОтправку.ПредыдущийДокумент КАК ПредыдущийДокумент
ПОМЕСТИТЬ ВТ_КоррИспрСФ
ИЗ
	табКорректировки КАК табКорректировки
		ЛЕВОЕ СОЕДИНЕНИЕ табРазрешенийНаОтправку КАК табРазрешенийНаОтправку
		ПО табКорректировки.Корректировка = табРазрешенийНаОтправку.Корректировка
ГДЕ
	ВЫБОР
			КОГДА &amp;ТолькоТребуемые
				ТОГДА табРазрешенийНаОтправку.Корректировка ЕСТЬ НЕ NULL 
			ИНАЧЕ ИСТИНА
		КОНЕЦ
;

////////////////////////////////////////////////////////////////////////////////
УНИЧТОЖИТЬ табКорректировки
;

////////////////////////////////////////////////////////////////////////////////
УНИЧТОЖИТЬ табПредыдущихДокументов
;

////////////////////////////////////////////////////////////////////////////////
УНИЧТОЖИТЬ табОсновныхСчетовФактур
;

////////////////////////////////////////////////////////////////////////////////
УНИЧТОЖИТЬ табДляОпределенияПредыдущейКорректировки
;

////////////////////////////////////////////////////////////////////////////////
УНИЧТОЖИТЬ табВсехПредыдущихКорректировок
;

////////////////////////////////////////////////////////////////////////////////
УНИЧТОЖИТЬ табПредыдущихКорректировок
;

////////////////////////////////////////////////////////////////////////////////
УНИЧТОЖИТЬ табРазрешенийНаОтправку</query>
				</item>
				<item xsi:type="DataSetQuery">
					<name>Реализация_СФ</name>
					<dataSource>ИсточникДанных1</dataSource>
					<query>ВЫБРАТЬ РАЗРЕШЕННЫЕ
	докКорректировка.Ссылка КАК Корректировка,
	ВЫБОР
		КОГДА НЕ докКорректировка.Проведен
			ТОГДА докКорректировка.Ссылка
		ИНАЧЕ ЕСТЬNULL(докСчетФактура.Ссылка, докКорректировка.Ссылка)
	КОНЕЦ КАК Документ,
	ВЫБОР
		КОГДА НЕ докКорректировка.Проведен
			ТОГДА "Провести Корректировка реализации"
		КОГДА докСчетФактура.Ссылка ЕСТЬ NULL
			ТОГДА "Создать Счет-фактура по корректировке"
		КОГДА НЕ докСчетФактура.Ссылка.Проведен И &amp;ТребуетсяПроведениеCOINVOIC
			ТОГДА "Провести Счет-фактура по корректировке"
		КОГДА докСчетФактура.Корректировочный &lt;&gt; ИСТИНА
			ТОГДА "Отправить счет-фактуру"
		ИНАЧЕ "Отправить корректировочный счет-фактуру"
	КОНЕЦ КАК ТребуемоеДействие,
	ВЫБОР
		КОГДА докСчетФактура.Корректировочный &lt;&gt; ИСТИНА
			ТОГДА "INVOIC"
		ИНАЧЕ "COINVOIC"
	КОНЕЦ КАК ТипСообщения,
	докКорректировка.ДокументОснование КАК ДокументРеализации,
	ТаблицаКэшПартнеровКонтрагентов.Партнер КАК Партнер,
	докКорректировка.Дата КАК ДатаКорректировки
ПОМЕСТИТЬ табКорректировки
ИЗ
	ТаблицаКэшПартнеровКонтрагентов КАК ТаблицаКэшПартнеровКонтрагентов
		ВНУТРЕННЕЕ СОЕДИНЕНИЕ Документ.КорректировкаРеализации КАК докКорректировка
			ЛЕВОЕ СОЕДИНЕНИЕ Документ.СчетФактураВыданный КАК докСчетФактура
				ЛЕВОЕ СОЕДИНЕНИЕ Справочник.КонтурEDI_Сообщения КАК КонтурEDI_Сообщения
				ПО докСчетФактура.Ссылка = КонтурEDI_Сообщения.Документ
					И (КонтурEDI_Сообщения.ТипСообщения = "COINVOIC" 
						ИЛИ КонтурEDI_Сообщения.ТипСообщения = "INVOIC")
			ПО докКорректировка.Ссылка = докСчетФактура.ДокументОснование
				И (докСчетФактура.ПометкаУдаления = ЛОЖЬ)
		ПО ТаблицаКэшПартнеровКонтрагентов.Контрагент = докКорректировка.Контрагент
			И (ТаблицаКэшПартнеровКонтрагентов.COINVOIC = ИСТИНА)
ГДЕ
	НЕ докКорректировка.ПометкаУдаления
	И докКорректировка.Дата МЕЖДУ &amp;НачалоПериода И &amp;КонецПериода
	И ВЫБОР
			КОГДА &amp;ТолькоТребуемые
				ТОГДА КонтурEDI_Сообщения.Ссылка ЕСТЬ NULL
			ИНАЧЕ ИСТИНА
		КОНЕЦ
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ РАЗРЕШЕННЫЕ
	табКорректировки.Корректировка КАК Корректировка,
	СчетФактураВыданный.Ссылка КАК ОсновнойСчетФактура
ПОМЕСТИТЬ табОсновныхСчетовФактур
ИЗ
	табКорректировки КАК табКорректировки
		ВНУТРЕННЕЕ СОЕДИНЕНИЕ Документ.СчетФактураВыданный КАК СчетФактураВыданный
		ПО табКорректировки.ДокументРеализации = СчетФактураВыданный.ДокументОснование
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ РАЗРЕШЕННЫЕ
	табКорректировки.Корректировка КАК Корректировка,
	КорректировкаРеализации.Ссылка КАК ПредыдущаяКорректировка,
	КорректировкаРеализации.Дата КАК ДатаПредыдущейКорректировки
ПОМЕСТИТЬ табВсехПредыдущихКорректировок
ИЗ
	табКорректировки КАК табКорректировки
		ВНУТРЕННЕЕ СОЕДИНЕНИЕ Документ.КорректировкаРеализации КАК КорректировкаРеализации
		ПО табКорректировки.ДокументРеализации = КорректировкаРеализации.ДокументОснование
			И (НЕ КорректировкаРеализации.ПометкаУдаления)
			И табКорректировки.Корректировка &lt;&gt; КорректировкаРеализации.Ссылка
			И табКорректировки.ДатаКорректировки &gt;= КорректировкаРеализации.Дата
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ РАЗРЕШЕННЫЕ
	табПредыдущихКорректировок.Корректировка КАК Корректировка,
	МАКСИМУМ(табПредыдущихКорректировок.ДатаПредыдущейКорректировки) КАК ДатаПредыдущейКорректировки
ПОМЕСТИТЬ табДляОпределенияПредыдущейКорректировки
ИЗ
	табВсехПредыдущихКорректировок КАК табПредыдущихКорректировок

СГРУППИРОВАТЬ ПО
	табПредыдущихКорректировок.Корректировка
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ РАЗРЕШЕННЫЕ
	табПредыдущихКорректировок.Корректировка КАК Корректировка,
	табПредыдущихКорректировок.ПредыдущаяКорректировка КАК ПредыдущаяКорректировка
ПОМЕСТИТЬ табПредыдущихКорректировок
ИЗ
	табВсехПредыдущихКорректировок КАК табПредыдущихКорректировок
		ВНУТРЕННЕЕ СОЕДИНЕНИЕ табДляОпределенияПредыдущейКорректировки КАК табДляОпределенияПредыдущейКорректировки
		ПО табПредыдущихКорректировок.Корректировка = табДляОпределенияПредыдущейКорректировки.Корректировка
			И табПредыдущихКорректировок.ДатаПредыдущейКорректировки = табДляОпределенияПредыдущейКорректировки.ДатаПредыдущейКорректировки
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ РАЗРЕШЕННЫЕ
	табПредыдущихКорректировок.Корректировка КАК Корректировка,
	СчетФактураВыданный.Ссылка КАК ПредыдущийДокумент
ПОМЕСТИТЬ табПредыдущихДокументов
ИЗ
	табПредыдущихКорректировок КАК табПредыдущихКорректировок
		ВНУТРЕННЕЕ СОЕДИНЕНИЕ Документ.СчетФактураВыданный КАК СчетФактураВыданный
		ПО табПредыдущихКорректировок.ПредыдущаяКорректировка = СчетФактураВыданный.ДокументОснование

ОБЪЕДИНИТЬ ВСЕ

ВЫБРАТЬ
	табОсновныхСчетовФактур.Корректировка,
	табОсновныхСчетовФактур.ОсновнойСчетФактура
ИЗ
	табОсновныхСчетовФактур КАК табОсновныхСчетовФактур
		ЛЕВОЕ СОЕДИНЕНИЕ табПредыдущихКорректировок КАК табПредыдущихКорректировок
		ПО табОсновныхСчетовФактур.Корректировка = табПредыдущихКорректировок.Корректировка
ГДЕ
	табПредыдущихКорректировок.Корректировка ЕСТЬ NULL
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ РАЗРЕШЕННЫЕ
	КонтурEDI_Сообщения.Ссылка КАК Сообщение,
	табПредыдущихДокументов.Корректировка КАК Корректировка,
	табПредыдущихДокументов.ПредыдущийДокумент КАК ПредыдущийДокумент
ПОМЕСТИТЬ табРазрешенийНаОтправку
ИЗ
	табПредыдущихДокументов КАК табПредыдущихДокументов
		ЛЕВОЕ СОЕДИНЕНИЕ Справочник.КонтурEDI_Сообщения КАК КонтурEDI_Сообщения
		ПО табПредыдущихДокументов.ПредыдущийДокумент = КонтурEDI_Сообщения.Документ
			И (НЕ КонтурEDI_Сообщения.Статус В (&amp;БлокирующиеСтатусыПервичногоINVOIC))
			И (КонтурEDI_Сообщения.ТипСообщения = "COINVOIC"
				ИЛИ КонтурEDI_Сообщения.ТипСообщения = "INVOIC")
ГДЕ
	ВЫБОР
			КОГДА &amp;ТолькоТребуемые
				ТОГДА КонтурEDI_Сообщения.Ссылка ЕСТЬ НЕ NULL 
			ИНАЧЕ ИСТИНА
		КОНЕЦ
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ РАЗРЕШЕННЫЕ
	табКорректировки.Корректировка КАК Корректировка,
	табКорректировки.Документ КАК Документ,
	табКорректировки.ТребуемоеДействие КАК ТребуемоеДействие,
	табКорректировки.ТипСообщения КАК ТипСообщения,
	табРазрешенийНаОтправку.Сообщение КАК Сообщение,
	табКорректировки.Партнер КАК Партнер,
	табРазрешенийНаОтправку.ПредыдущийДокумент КАК ПредыдущийДокумент
ПОМЕСТИТЬ ВТ_КоррИспрСФ
ИЗ
	табКорректировки КАК табКорректировки
		ЛЕВОЕ СОЕДИНЕНИЕ табРазрешенийНаОтправку КАК табРазрешенийНаОтправку
		ПО табКорректировки.Корректировка = табРазрешенийНаОтправку.Корректировка
ГДЕ
	ВЫБОР
			КОГДА &amp;ТолькоТребуемые
				ТОГДА табРазрешенийНаОтправку.Корректировка ЕСТЬ НЕ NULL 
			ИНАЧЕ ИСТИНА
		КОНЕЦ
;

////////////////////////////////////////////////////////////////////////////////
УНИЧТОЖИТЬ табКорректировки
;

////////////////////////////////////////////////////////////////////////////////
УНИЧТОЖИТЬ табПредыдущихДокументов
;

////////////////////////////////////////////////////////////////////////////////
УНИЧТОЖИТЬ табОсновныхСчетовФактур
;

////////////////////////////////////////////////////////////////////////////////
УНИЧТОЖИТЬ табДляОпределенияПредыдущейКорректировки
;

////////////////////////////////////////////////////////////////////////////////
УНИЧТОЖИТЬ табВсехПредыдущихКорректировок
;

////////////////////////////////////////////////////////////////////////////////
УНИЧТОЖИТЬ табПредыдущихКорректировок
;

////////////////////////////////////////////////////////////////////////////////
УНИЧТОЖИТЬ табРазрешенийНаОтправку</query>
				</item>
				<item xsi:type="DataSetQuery">
					<name>Заказ_Реализация</name>
					<dataSource>ИсточникДанных1</dataSource>
					<query>ВЫБРАТЬ РАЗРЕШЕННЫЕ
	докКорректировка.Ссылка КАК Корректировка,
	ВЫБОР
		КОГДА НЕ докКорректировка.Проведен
			ТОГДА докКорректировка.Ссылка
		КОГДА докКорректировка.ХозяйственнаяОперация &lt;&gt; ЗНАЧЕНИЕ(Перечисление.ХозяйственныеОперации.КорректировкаПоСогласованиюСторон)
			ТОГДА ЕСТЬNULL(докСчетФактура.Ссылка, докКорректировка.Ссылка)
		ИНАЧЕ докКорректировка.Ссылка
	КОНЕЦ КАК Документ,
	ВЫБОР
		КОГДА НЕ докКорректировка.Проведен
			ТОГДА "Провести Корректировка реализации"
		КОГДА докКорректировка.ХозяйственнаяОперация &lt;&gt; ЗНАЧЕНИЕ(Перечисление.ХозяйственныеОперации.КорректировкаПоСогласованиюСторон)
			ТОГДА ВЫБОР
					КОГДА докСчетФактура.Ссылка ЕСТЬ NULL 
						ТОГДА "Создать Счет-фактура по корректировке"
					КОГДА НЕ докСчетФактура.Ссылка.Проведен И &amp;ТребуетсяПроведениеCOINVOIC
						ТОГДА "Провести Счет-фактура по корректировке"
					ИНАЧЕ "Отправить счет-фактуру"
				КОНЕЦ
		ИНАЧЕ "Отправить корректировочный счет-фактуру"
	КОНЕЦ КАК ТребуемоеДействие,
	ВЫБОР
		КОГДА докКорректировка.ХозяйственнаяОперация = ЗНАЧЕНИЕ(Перечисление.ХозяйственныеОперации.КорректировкаПоСогласованиюСторон)
			ТОГДА "COINVOIC"
		КОГДА докСчетФактура.Корректировочный &lt;&gt; ИСТИНА
			ТОГДА "INVOIC"
		ИНАЧЕ "COINVOIC"
	КОНЕЦ КАК ТипСообщения,
	докКорректировка.ДокументОснование КАК ДокументРеализации,
	ТаблицаКэшПартнеровКонтрагентов.Партнер КАК Партнер,
	докКорректировка.Дата КАК ДатаКорректировки
ПОМЕСТИТЬ табКорректировки
ИЗ
	ТаблицаКэшПартнеровКонтрагентов КАК ТаблицаКэшПартнеровКонтрагентов
		ВНУТРЕННЕЕ СОЕДИНЕНИЕ Документ.КорректировкаРеализации КАК докКорректировка
			ЛЕВОЕ СОЕДИНЕНИЕ Документ.СчетФактураВыданный КАК докСчетФактура
			ПО докКорректировка.Ссылка = докСчетФактура.ДокументОснование
				И (докСчетФактура.ПометкаУдаления = ЛОЖЬ)
		ПО ТаблицаКэшПартнеровКонтрагентов.Контрагент = докКорректировка.Контрагент
			И (ТаблицаКэшПартнеровКонтрагентов.COINVOIC = ИСТИНА)
ГДЕ
	НЕ докКорректировка.ПометкаУдаления
	И докКорректировка.Дата МЕЖДУ &amp;НачалоПериода И &amp;КонецПериода
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ РАЗРЕШЕННЫЕ
	табКорректировки.Корректировка,
	табКорректировки.Документ,
	табКорректировки.ТребуемоеДействие,
	табКорректировки.ТипСообщения,
	табКорректировки.ДокументРеализации,
	табКорректировки.Партнер,
	табКорректировки.ДатаКорректировки
ПОМЕСТИТЬ табКорректировкиСообщения
ИЗ
	табКорректировки КАК табКорректировки
		ЛЕВОЕ СОЕДИНЕНИЕ Справочник.КонтурEDI_Сообщения КАК КонтурEDI_Сообщения
		ПО табКорректировки.Документ = КонтурEDI_Сообщения.Документ
			И (КонтурEDI_Сообщения.ТипСообщения = "COINVOIC" 
				ИЛИ КонтурEDI_Сообщения.ТипСообщения = "INVOIC")
ГДЕ
	ВЫБОР
			КОГДА &amp;ТолькоТребуемые
				ТОГДА КонтурEDI_Сообщения.Ссылка ЕСТЬ NULL 
			ИНАЧЕ ИСТИНА
		КОНЕЦ
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ РАЗРЕШЕННЫЕ
	табКорректировкиСообщения.Корректировка КАК Корректировка,
	табКорректировкиСообщения.ДокументРеализации КАК ОсновнойСчетФактура
ПОМЕСТИТЬ табОсновныхСчетовФактур
ИЗ
	табКорректировкиСообщения КАК табКорректировкиСообщения
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ РАЗРЕШЕННЫЕ
	табКорректировкиСообщения.Корректировка КАК Корректировка,
	КорректировкаРеализации.Ссылка КАК ПредыдущаяКорректировка,
	КорректировкаРеализации.Дата КАК ДатаПредыдущейКорректировки
ПОМЕСТИТЬ табВсехПредыдущихКорректировок
ИЗ
	табКорректировкиСообщения КАК табКорректировкиСообщения
		ВНУТРЕННЕЕ СОЕДИНЕНИЕ Документ.КорректировкаРеализации КАК КорректировкаРеализации
		ПО табКорректировкиСообщения.ДокументРеализации = КорректировкаРеализации.ДокументОснование
			И (НЕ КорректировкаРеализации.ПометкаУдаления)
			И табКорректировкиСообщения.Корректировка &lt;&gt; КорректировкаРеализации.Ссылка
			И табКорректировкиСообщения.ДатаКорректировки &gt;= КорректировкаРеализации.Дата
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ РАЗРЕШЕННЫЕ
	табПредыдущихКорректировок.Корректировка КАК Корректировка,
	МАКСИМУМ(табПредыдущихКорректировок.ДатаПредыдущейКорректировки) КАК ДатаПредыдущейКорректировки
ПОМЕСТИТЬ табДляОпределенияПредыдущейКорректировки
ИЗ
	табВсехПредыдущихКорректировок КАК табПредыдущихКорректировок

СГРУППИРОВАТЬ ПО
	табПредыдущихКорректировок.Корректировка
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ РАЗРЕШЕННЫЕ
	табПредыдущихКорректировок.Корректировка КАК Корректировка,
	табПредыдущихКорректировок.ПредыдущаяКорректировка КАК ПредыдущаяКорректировка
ПОМЕСТИТЬ табПредыдущихКорректировок
ИЗ
	табВсехПредыдущихКорректировок КАК табПредыдущихКорректировок
		ВНУТРЕННЕЕ СОЕДИНЕНИЕ табДляОпределенияПредыдущейКорректировки КАК табДляОпределенияПредыдущейКорректировки
		ПО табПредыдущихКорректировок.Корректировка = табДляОпределенияПредыдущейКорректировки.Корректировка
			И табПредыдущихКорректировок.ДатаПредыдущейКорректировки = табДляОпределенияПредыдущейКорректировки.ДатаПредыдущейКорректировки
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ РАЗРЕШЕННЫЕ
	табПредыдущихКорректировок.Корректировка КАК Корректировка,
	табПредыдущихКорректировок.Корректировка КАК ПредыдущийДокумент
ПОМЕСТИТЬ табПредыдущихДокументов
ИЗ
	табПредыдущихКорректировок КАК табПредыдущихКорректировок

ОБЪЕДИНИТЬ ВСЕ

ВЫБРАТЬ
	табОсновныхСчетовФактур.Корректировка,
	табОсновныхСчетовФактур.ОсновнойСчетФактура
ИЗ
	табОсновныхСчетовФактур КАК табОсновныхСчетовФактур
;


////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ РАЗРЕШЕННЫЕ
	КонтурEDI_Сообщения.Ссылка КАК Сообщение,
	табПредыдущихДокументов.Корректировка КАК Корректировка,
	табПредыдущихДокументов.ПредыдущийДокумент КАК ПредыдущийДокумент
ПОМЕСТИТЬ табРазрешенийНаОтправку
ИЗ
	табПредыдущихДокументов КАК табПредыдущихДокументов
		ЛЕВОЕ СОЕДИНЕНИЕ Справочник.КонтурEDI_Сообщения КАК КонтурEDI_Сообщения
		ПО табПредыдущихДокументов.ПредыдущийДокумент = КонтурEDI_Сообщения.Документ
			И (НЕ КонтурEDI_Сообщения.Статус В (&amp;БлокирующиеСтатусыПервичногоINVOIC))
			И (КонтурEDI_Сообщения.ТипСообщения = "COINVOIC"
				ИЛИ КонтурEDI_Сообщения.ТипСообщения = "INVOIC")
ГДЕ
	ВЫБОР
			КОГДА &amp;ТолькоТребуемые
				ТОГДА КонтурEDI_Сообщения.Ссылка ЕСТЬ НЕ NULL 
			ИНАЧЕ ИСТИНА
		КОНЕЦ
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ РАЗРЕШЕННЫЕ
	табКорректировки.Корректировка КАК Корректировка,
	табКорректировки.Документ КАК Документ,
	табКорректировки.ТребуемоеДействие КАК ТребуемоеДействие,
	табКорректировки.ТипСообщения КАК ТипСообщения,
	табРазрешенийНаОтправку.Сообщение КАК Сообщение,
	табКорректировки.Партнер КАК Партнер,
	табРазрешенийНаОтправку.ПредыдущийДокумент КАК ПредыдущийДокумент
ПОМЕСТИТЬ ВТ_КоррИспрСФ
ИЗ
	табКорректировки КАК табКорректировки
		ЛЕВОЕ СОЕДИНЕНИЕ табРазрешенийНаОтправку КАК табРазрешенийНаОтправку
		ПО табКорректировки.Корректировка = табРазрешенийНаОтправку.Корректировка
ГДЕ
	ВЫБОР
			КОГДА &amp;ТолькоТребуемые
				ТОГДА табРазрешенийНаОтправку.Корректировка ЕСТЬ НЕ NULL 
			ИНАЧЕ ИСТИНА
		КОНЕЦ
;

////////////////////////////////////////////////////////////////////////////////
УНИЧТОЖИТЬ табКорректировки
;

////////////////////////////////////////////////////////////////////////////////
УНИЧТОЖИТЬ табПредыдущихДокументов
;

////////////////////////////////////////////////////////////////////////////////
УНИЧТОЖИТЬ табОсновныхСчетовФактур
;

////////////////////////////////////////////////////////////////////////////////
УНИЧТОЖИТЬ табДляОпределенияПредыдущейКорректировки
;

////////////////////////////////////////////////////////////////////////////////
УНИЧТОЖИТЬ табВсехПредыдущихКорректировок
;

////////////////////////////////////////////////////////////////////////////////
УНИЧТОЖИТЬ табПредыдущихКорректировок
;

////////////////////////////////////////////////////////////////////////////////
УНИЧТОЖИТЬ табРазрешенийНаОтправку
;

////////////////////////////////////////////////////////////////////////////////
УНИЧТОЖИТЬ табКорректировкиСообщения</query>
				</item>
				<item xsi:type="DataSetQuery">
					<name>Реализация</name>
					<dataSource>ИсточникДанных1</dataSource>
					<query>ВЫБРАТЬ РАЗРЕШЕННЫЕ
	докКорректировка.Ссылка КАК Корректировка,
	ВЫБОР
		КОГДА НЕ докКорректировка.Проведен
			ТОГДА докКорректировка.Ссылка
		КОГДА докКорректировка.ХозяйственнаяОперация &lt;&gt; ЗНАЧЕНИЕ(Перечисление.ХозяйственныеОперации.КорректировкаПоСогласованиюСторон)
			ТОГДА ЕСТЬNULL(докСчетФактура.Ссылка, докКорректировка.Ссылка)
		ИНАЧЕ докКорректировка.Ссылка
	КОНЕЦ КАК Документ,
	ВЫБОР
		КОГДА НЕ докКорректировка.Проведен
			ТОГДА "Провести Корректировка реализации"
		КОГДА докКорректировка.ХозяйственнаяОперация &lt;&gt; ЗНАЧЕНИЕ(Перечисление.ХозяйственныеОперации.КорректировкаПоСогласованиюСторон)
			ТОГДА ВЫБОР
					КОГДА докСчетФактура.Ссылка ЕСТЬ NULL 
						ТОГДА "Создать Счет-фактура по корректировке"
					КОГДА НЕ докСчетФактура.Ссылка.Проведен И &amp;ТребуетсяПроведениеCOINVOIC
						ТОГДА "Провести Счет-фактура по корректировке"
					ИНАЧЕ "Отправить счет-фактуру"
				КОНЕЦ
		ИНАЧЕ "Отправить корректировочный счет-фактуру"
	КОНЕЦ КАК ТребуемоеДействие,
	ВЫБОР
		КОГДА докКорректировка.ХозяйственнаяОперация = ЗНАЧЕНИЕ(Перечисление.ХозяйственныеОперации.КорректировкаПоСогласованиюСторон)
			ТОГДА "COINVOIC"
		КОГДА докСчетФактура.Корректировочный &lt;&gt; ИСТИНА
			ТОГДА "INVOIC"
		ИНАЧЕ "COINVOIC"
	КОНЕЦ КАК ТипСообщения,
	докКорректировка.ДокументОснование КАК ДокументРеализации,
	ТаблицаКэшПартнеровКонтрагентов.Партнер КАК Партнер,
	докКорректировка.Дата КАК ДатаКорректировки
ПОМЕСТИТЬ табКорректировки
ИЗ
	ТаблицаКэшПартнеровКонтрагентов КАК ТаблицаКэшПартнеровКонтрагентов
		ВНУТРЕННЕЕ СОЕДИНЕНИЕ Документ.КорректировкаРеализации КАК докКорректировка
			ЛЕВОЕ СОЕДИНЕНИЕ Документ.СчетФактураВыданный КАК докСчетФактура
			ПО докКорректировка.Ссылка = докСчетФактура.ДокументОснование
				И (докСчетФактура.ПометкаУдаления = ЛОЖЬ)
		ПО ТаблицаКэшПартнеровКонтрагентов.Контрагент = докКорректировка.Контрагент
			И (ТаблицаКэшПартнеровКонтрагентов.COINVOIC = ИСТИНА)
ГДЕ
	НЕ докКорректировка.ПометкаУдаления
	И докКорректировка.Дата МЕЖДУ &amp;НачалоПериода И &amp;КонецПериода
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ РАЗРЕШЕННЫЕ
	табКорректировки.Корректировка,
	табКорректировки.Документ,
	табКорректировки.ТребуемоеДействие,
	табКорректировки.ТипСообщения,
	табКорректировки.ДокументРеализации,
	табКорректировки.Партнер,
	табКорректировки.ДатаКорректировки
ПОМЕСТИТЬ табКорректировкиСообщения
ИЗ
	табКорректировки КАК табКорректировки
		ЛЕВОЕ СОЕДИНЕНИЕ Справочник.КонтурEDI_Сообщения КАК КонтурEDI_Сообщения
		ПО табКорректировки.Документ = КонтурEDI_Сообщения.Документ
			И (КонтурEDI_Сообщения.ТипСообщения = "COINVOIC" 
				ИЛИ КонтурEDI_Сообщения.ТипСообщения = "INVOIC")
ГДЕ
	ВЫБОР
			КОГДА &amp;ТолькоТребуемые
				ТОГДА КонтурEDI_Сообщения.Ссылка ЕСТЬ NULL 
			ИНАЧЕ ИСТИНА
		КОНЕЦ
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ РАЗРЕШЕННЫЕ
	табКорректировкиСообщения.Корректировка КАК Корректировка,
	табКорректировкиСообщения.ДокументРеализации КАК ОсновнойСчетФактура
ПОМЕСТИТЬ табОсновныхСчетовФактур
ИЗ
	табКорректировкиСообщения КАК табКорректировкиСообщения
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ РАЗРЕШЕННЫЕ
	табКорректировкиСообщения.Корректировка КАК Корректировка,
	КорректировкаРеализации.Ссылка КАК ПредыдущаяКорректировка,
	КорректировкаРеализации.Дата КАК ДатаПредыдущейКорректировки
ПОМЕСТИТЬ табВсехПредыдущихКорректировок
ИЗ
	табКорректировкиСообщения КАК табКорректировкиСообщения
		ВНУТРЕННЕЕ СОЕДИНЕНИЕ Документ.КорректировкаРеализации КАК КорректировкаРеализации
		ПО табКорректировкиСообщения.ДокументРеализации = КорректировкаРеализации.ДокументОснование
			И (НЕ КорректировкаРеализации.ПометкаУдаления)
			И табКорректировкиСообщения.Корректировка &lt;&gt; КорректировкаРеализации.Ссылка
			И табКорректировкиСообщения.ДатаКорректировки &gt;= КорректировкаРеализации.Дата
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ РАЗРЕШЕННЫЕ
	табПредыдущихКорректировок.Корректировка КАК Корректировка,
	МАКСИМУМ(табПредыдущихКорректировок.ДатаПредыдущейКорректировки) КАК ДатаПредыдущейКорректировки
ПОМЕСТИТЬ табДляОпределенияПредыдущейКорректировки
ИЗ
	табВсехПредыдущихКорректировок КАК табПредыдущихКорректировок

СГРУППИРОВАТЬ ПО
	табПредыдущихКорректировок.Корректировка
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ РАЗРЕШЕННЫЕ
	табПредыдущихКорректировок.Корректировка КАК Корректировка,
	табПредыдущихКорректировок.ПредыдущаяКорректировка КАК ПредыдущаяКорректировка
ПОМЕСТИТЬ табПредыдущихКорректировок
ИЗ
	табВсехПредыдущихКорректировок КАК табПредыдущихКорректировок
		ВНУТРЕННЕЕ СОЕДИНЕНИЕ табДляОпределенияПредыдущейКорректировки КАК табДляОпределенияПредыдущейКорректировки
		ПО табПредыдущихКорректировок.Корректировка = табДляОпределенияПредыдущейКорректировки.Корректировка
			И табПредыдущихКорректировок.ДатаПредыдущейКорректировки = табДляОпределенияПредыдущейКорректировки.ДатаПредыдущейКорректировки
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ РАЗРЕШЕННЫЕ
	табПредыдущихКорректировок.Корректировка КАК Корректировка,
	табПредыдущихКорректировок.Корректировка КАК ПредыдущийДокумент
ПОМЕСТИТЬ табПредыдущихДокументов
ИЗ
	табПредыдущихКорректировок КАК табПредыдущихКорректировок

ОБЪЕДИНИТЬ ВСЕ

ВЫБРАТЬ
	табОсновныхСчетовФактур.Корректировка,
	табОсновныхСчетовФактур.ОсновнойСчетФактура
ИЗ
	табОсновныхСчетовФактур КАК табОсновныхСчетовФактур
;


////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ РАЗРЕШЕННЫЕ
	КонтурEDI_Сообщения.Ссылка КАК Сообщение,
	табПредыдущихДокументов.Корректировка КАК Корректировка,
	табПредыдущихДокументов.ПредыдущийДокумент КАК ПредыдущийДокумент
ПОМЕСТИТЬ табРазрешенийНаОтправку
ИЗ
	табПредыдущихДокументов КАК табПредыдущихДокументов
		ЛЕВОЕ СОЕДИНЕНИЕ Справочник.КонтурEDI_Сообщения КАК КонтурEDI_Сообщения
		ПО табПредыдущихДокументов.ПредыдущийДокумент = КонтурEDI_Сообщения.Документ
			И (НЕ КонтурEDI_Сообщения.Статус В (&amp;БлокирующиеСтатусыПервичногоINVOIC))
			И (КонтурEDI_Сообщения.ТипСообщения = "COINVOIC"
				ИЛИ КонтурEDI_Сообщения.ТипСообщения = "INVOIC")
ГДЕ
	ВЫБОР
			КОГДА &amp;ТолькоТребуемые
				ТОГДА КонтурEDI_Сообщения.Ссылка ЕСТЬ НЕ NULL 
			ИНАЧЕ ИСТИНА
		КОНЕЦ
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ РАЗРЕШЕННЫЕ
	табКорректировки.Корректировка КАК Корректировка,
	табКорректировки.Документ КАК Документ,
	табКорректировки.ТребуемоеДействие КАК ТребуемоеДействие,
	табКорректировки.ТипСообщения КАК ТипСообщения,
	табРазрешенийНаОтправку.Сообщение КАК Сообщение,
	табКорректировки.Партнер КАК Партнер,
	табРазрешенийНаОтправку.ПредыдущийДокумент КАК ПредыдущийДокумент
ПОМЕСТИТЬ ВТ_КоррИспрСФ
ИЗ
	табКорректировки КАК табКорректировки
		ЛЕВОЕ СОЕДИНЕНИЕ табРазрешенийНаОтправку КАК табРазрешенийНаОтправку
		ПО табКорректировки.Корректировка = табРазрешенийНаОтправку.Корректировка
ГДЕ
	ВЫБОР
			КОГДА &amp;ТолькоТребуемые
				ТОГДА табРазрешенийНаОтправку.Корректировка ЕСТЬ НЕ NULL 
			ИНАЧЕ ИСТИНА
		КОНЕЦ
;

////////////////////////////////////////////////////////////////////////////////
УНИЧТОЖИТЬ табКорректировки
;

////////////////////////////////////////////////////////////////////////////////
УНИЧТОЖИТЬ табПредыдущихДокументов
;

////////////////////////////////////////////////////////////////////////////////
УНИЧТОЖИТЬ табОсновныхСчетовФактур
;

////////////////////////////////////////////////////////////////////////////////
УНИЧТОЖИТЬ табДляОпределенияПредыдущейКорректировки
;

////////////////////////////////////////////////////////////////////////////////
УНИЧТОЖИТЬ табВсехПредыдущихКорректировок
;

////////////////////////////////////////////////////////////////////////////////
УНИЧТОЖИТЬ табПредыдущихКорректировок
;

////////////////////////////////////////////////////////////////////////////////
УНИЧТОЖИТЬ табРазрешенийНаОтправку
;

////////////////////////////////////////////////////////////////////////////////
УНИЧТОЖИТЬ табКорректировкиСообщения</query>
				</item>
			</item>
		</item>
		<item xsi:type="DataSetUnion">
			<name>Покупатель</name>
			<item xsi:type="DataSetUnion">
				<name>ЗапросОсновнойЦепочки</name>
				<item xsi:type="DataSetQuery">
					<name>Заказ_Поступление_СФ</name>
					<dataSource>ИсточникДанных1</dataSource>
					<query>ВЫБРАТЬ
	докЗаказПоставщику.Ссылка КАК PORDERS,
	докЗаказПоставщику.Ссылка КАК ORDERS,
	докЗаказПоставщику.Ссылка КАК ORDRSP,
	докПоступлениеТоваровУслуг.Ссылка КАК DESADV,
	докПоступлениеТоваровУслуг.Ссылка КАК RECADV,
	СчетФактураПолученныйДокументыОснования.Ссылка КАК INVOIC
ИЗ
	(ВЫБРАТЬ
		1 КАК Поле1) КАК Заглушка
		{ПОЛНОЕ СОЕДИНЕНИЕ Документ.СчетФактураПолученный.ДокументыОснования КАК СчетФактураПолученныйДокументыОснования
			{ПОЛНОЕ СОЕДИНЕНИЕ Документ.ПоступлениеТоваровУслуг КАК докПоступлениеТоваровУслуг
				{ПОЛНОЕ СОЕДИНЕНИЕ Документ.ЗаказПоставщику КАК докЗаказПоставщику
				ПО (докПоступлениеТоваровУслуг.ЗаказПоставщику = докЗаказПоставщику.Ссылка)}
			ПО (СчетФактураПолученныйДокументыОснования.ДокументОснование = докПоступлениеТоваровУслуг.Ссылка)}
		ПО (ИСТИНА)}</query>
					<autoFillFields>false</autoFillFields>
				</item>
				<item xsi:type="DataSetQuery">
					<name>Заказ_Приобретение_СФ</name>
					<dataSource>ИсточникДанных1</dataSource>
					<query>ВЫБРАТЬ
	докЗаказПоставщику.Ссылка КАК PORDERS,
	докЗаказПоставщику.Ссылка КАК ORDERS,
	докЗаказПоставщику.Ссылка КАК ORDRSP,
	докПоступлениеТоваровУслуг.Ссылка КАК DESADV,
	докПоступлениеТоваровУслуг.Ссылка КАК RECADV,
	СчетФактураПолученныйДокументыОснования.Ссылка КАК INVOIC
ИЗ
	(ВЫБРАТЬ
		1 КАК Поле1) КАК Заглушка
		{ПОЛНОЕ СОЕДИНЕНИЕ Документ.СчетФактураПолученный.ДокументыОснования КАК СчетФактураПолученныйДокументыОснования
			{ПОЛНОЕ СОЕДИНЕНИЕ Документ.ПриобретениеТоваровУслуг КАК докПоступлениеТоваровУслуг
				{ПОЛНОЕ СОЕДИНЕНИЕ Документ.ЗаказПоставщику КАК докЗаказПоставщику
				ПО (докПоступлениеТоваровУслуг.ЗаказПоставщику = докЗаказПоставщику.Ссылка)}
			ПО (СчетФактураПолученныйДокументыОснования.ДокументОснование = докПоступлениеТоваровУслуг.Ссылка)}
		ПО (ИСТИНА)}</query>
					<autoFillFields>false</autoFillFields>
				</item>
			</item>
			<item xsi:type="DataSetQuery">
				<name>КонвертироватьТовары1СВEDIВ_GTIN</name>
				<dataSource>ИсточникДанных1</dataSource>
				<query>ВЫБРАТЬ РАЗЛИЧНЫЕ
	ТабТоваров.Номенклатура,
	ТабТоваров.ХарактеристикаНоменклатуры,
	ТабТоваров.ЕдиницаИзмерения,
	ТабТоваров.Номенклатура.Код КАК КодТовараСвой,
	ВЫРАЗИТЬ(Штрихкоды.Штрихкод КАК СТРОКА(14)) КАК GTIN,
	Штрихкоды.Упаковка
ПОМЕСТИТЬ ВТ_С_ПустойУпаковкой
ИЗ
	ТабТоваров КАК ТабТоваров
		ВНУТРЕННЕЕ СОЕДИНЕНИЕ РегистрСведений.ШтрихкодыНоменклатуры КАК Штрихкоды
		ПО ТабТоваров.Номенклатура = Штрихкоды.Номенклатура
			И ТабТоваров.ХарактеристикаНоменклатуры = Штрихкоды.Характеристика
			И (Штрихкоды.Упаковка = &amp;ПустаяСсылкаУпаковки)
ГДЕ
	&amp;ИскатьТоварПоШК

ИНДЕКСИРОВАТЬ ПО
	ТабТоваров.Номенклатура,
	ТабТоваров.ХарактеристикаНоменклатуры,
	ТабТоваров.ЕдиницаИзмерения
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ РАЗЛИЧНЫЕ
	ТабТоваров.Номенклатура,
	ТабТоваров.ХарактеристикаНоменклатуры,
	ТабТоваров.ЕдиницаИзмерения,
	ТабТоваров.Номенклатура.Код КАК КодТовараСвой,
	ВЫРАЗИТЬ(Штрихкоды.Штрихкод КАК СТРОКА(14)) КАК GTIN,
	Штрихкоды.Упаковка
ПОМЕСТИТЬ ВТ_С_НЕПустойУпаковкой
ИЗ
	ТабТоваров КАК ТабТоваров
		ВНУТРЕННЕЕ СОЕДИНЕНИЕ РегистрСведений.ШтрихкодыНоменклатуры КАК Штрихкоды
		ПО ТабТоваров.Номенклатура = Штрихкоды.Номенклатура
			И ТабТоваров.ХарактеристикаНоменклатуры = Штрихкоды.Характеристика
			И (НЕ Штрихкоды.Упаковка = &amp;ПустаяСсылкаУпаковки)
			И (Штрихкоды.Упаковка = ТабТоваров.Упаковка)
ГДЕ
	&amp;ИскатьТоварПоШК

ИНДЕКСИРОВАТЬ ПО
	ТабТоваров.Номенклатура,
	ТабТоваров.ХарактеристикаНоменклатуры,
	ТабТоваров.ЕдиницаИзмерения
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ
	ВЫБОР
		КОГДА ВТ_С_НЕПустойУпаковкой.Номенклатура ЕСТЬ NULL
			ТОГДА ВТ_С_ПустойУпаковкой.Номенклатура
		ИНАЧЕ ВТ_С_НЕПустойУпаковкой.Номенклатура
	КОНЕЦ КАК Номенклатура,
	ВЫБОР
		КОГДА ВТ_С_НЕПустойУпаковкой.ХарактеристикаНоменклатуры ЕСТЬ NULL
			ТОГДА ВТ_С_ПустойУпаковкой.ХарактеристикаНоменклатуры
		ИНАЧЕ ВТ_С_НЕПустойУпаковкой.ХарактеристикаНоменклатуры
	КОНЕЦ КАК ХарактеристикаНоменклатуры,
	ВЫБОР
		КОГДА ВТ_С_НЕПустойУпаковкой.Упаковка ЕСТЬ NULL
			ТОГДА ВТ_С_ПустойУпаковкой.Упаковка
		ИНАЧЕ ВТ_С_НЕПустойУпаковкой.Упаковка
	КОНЕЦ КАК Упаковка,
	ВЫБОР
		КОГДА ВТ_С_НЕПустойУпаковкой.Упаковка ЕСТЬ NULL
			ТОГДА ВТ_С_ПустойУпаковкой.GTIN
		ИНАЧЕ ВТ_С_НЕПустойУпаковкой.GTIN
	КОНЕЦ КАК GTIN,
	ВЫБОР
		КОГДА ВТ_С_НЕПустойУпаковкой.ЕдиницаИзмерения ЕСТЬ NULL
			ТОГДА ВТ_С_ПустойУпаковкой.ЕдиницаИзмерения
		ИНАЧЕ ВТ_С_НЕПустойУпаковкой.ЕдиницаИзмерения
	КОНЕЦ КАК ЕдиницаИзмерения
ПОМЕСТИТЬ ВТШтрихкодыТоваров
ИЗ
	ВТ_С_ПустойУпаковкой КАК ВТ_С_ПустойУпаковкой
		ПОЛНОЕ СОЕДИНЕНИЕ ВТ_С_НЕПустойУпаковкой КАК ВТ_С_НЕПустойУпаковкой
		ПО ВТ_С_ПустойУпаковкой.Номенклатура = ВТ_С_НЕПустойУпаковкой.ХарактеристикаНоменклатуры
;

////////////////////////////////////////////////////////////////////////////////
УНИЧТОЖИТЬ ВТ_С_ПустойУпаковкой
;

////////////////////////////////////////////////////////////////////////////////
УНИЧТОЖИТЬ ВТ_С_НЕПустойУпаковкой</query>
				<autoFillFields>false</autoFillFields>
			</item>
			<item xsi:type="DataSetUnion">
				<name>ЗапросПоТоварам</name>
				<item xsi:type="DataSetUnion">
					<name>_ORDERS_</name>
					<item xsi:type="DataSetQuery">
						<name>ЗаказПоставщику</name>
						<dataSource>ИсточникДанных1</dataSource>
						<query>ВЫБРАТЬ
	ЗаказПоставщикуТовары.Номенклатура.Код КАК КодТовараПокупателя,
	ЗаказПоставщикуТовары.Номенклатура,
	ЗаказПоставщикуТовары.Характеристика КАК ХарактеристикаНоменклатуры,
	ВЫБОР
		КОГДА ЗаказПоставщикуТовары.Упаковка = ЗНАЧЕНИЕ(Справочник.УпаковкиНоменклатуры.ПустаяСсылка)
			ТОГДА ЗаказПоставщикуТовары.Номенклатура.ЕдиницаИзмерения
		ИНАЧЕ ЗаказПоставщикуТовары.Упаковка
	КОНЕЦ КАК ЕдиницаИзмерения,
	ВЫРАЗИТЬ(ЗаказПоставщикуТовары.Номенклатура.Наименование КАК СТРОКА(178)) КАК Наименование,
	ЗаказПоставщикуТовары.Цена,
	ЗаказПоставщикуТовары.СтавкаНДС,
	СУММА(ЗаказПоставщикуТовары.КоличествоУпаковок) КАК Количество,
	СУММА(ЗаказПоставщикуТовары.Сумма) КАК Сумма,
	СУММА(ЗаказПоставщикуТовары.СуммаНДС) КАК СуммаНДС
ИЗ
	Документ.ЗаказПоставщику.Товары КАК ЗаказПоставщикуТовары
ГДЕ
	ЗаказПоставщикуТовары.Ссылка = &amp;Ссылка
	И НЕ ЗаказПоставщикуТовары.Отменено

СГРУППИРОВАТЬ ПО
	ЗаказПоставщикуТовары.Номенклатура,
	ЗаказПоставщикуТовары.Характеристика,
	ЗаказПоставщикуТовары.Цена,
	ВЫРАЗИТЬ(ЗаказПоставщикуТовары.Номенклатура.Наименование КАК СТРОКА(178)),
	ЗаказПоставщикуТовары.СтавкаНДС,
	ЗаказПоставщикуТовары.Номенклатура.Код,
	ВЫБОР
		КОГДА ЗаказПоставщикуТовары.Упаковка = ЗНАЧЕНИЕ(Справочник.УпаковкиНоменклатуры.ПустаяСсылка)
			ТОГДА ЗаказПоставщикуТовары.Номенклатура.ЕдиницаИзмерения
		ИНАЧЕ ЗаказПоставщикуТовары.Упаковка
	КОНЕЦ</query>
						<autoFillFields>false</autoFillFields>
					</item>
				</item>
				<item xsi:type="DataSetUnion">
					<name>_RECADV_</name>
					<item xsi:type="DataSetQuery">
						<name>ПоступлениеТоваровУслуг</name>
						<dataSource>ИсточникДанных1</dataSource>
						<query>ВЫБРАТЬ
	ПоступлениеТоваровУслугТовары.Номенклатура,
	ПоступлениеТоваровУслугТовары.Характеристика КАК ХарактеристикаНоменклатуры,
	ВЫБОР
		КОГДА ПоступлениеТоваровУслугТовары.Упаковка = ЗНАЧЕНИЕ(Справочник.УпаковкиНоменклатуры.ПустаяСсылка)
			ТОГДА ПоступлениеТоваровУслугТовары.Номенклатура.ЕдиницаИзмерения
		ИНАЧЕ ПоступлениеТоваровУслугТовары.Упаковка
	КОНЕЦ КАК ЕдиницаИзмерения,
	ВЫРАЗИТЬ(ПоступлениеТоваровУслугТовары.Номенклатура.Наименование КАК СТРОКА(178)) КАК Наименование,
	ПоступлениеТоваровУслугТовары.КоличествоУпаковок КАК Количество,
	ПоступлениеТоваровУслугТовары.Цена,
	ПоступлениеТоваровУслугТовары.СтавкаНДС,
	ПоступлениеТоваровУслугТовары.Сумма,
	ПоступлениеТоваровУслугТовары.СуммаНДС
ИЗ
	Документ.ПоступлениеТоваровУслуг.Товары КАК ПоступлениеТоваровУслугТовары
ГДЕ
	ПоступлениеТоваровУслугТовары.Ссылка = &amp;Ссылка</query>
						<autoFillFields>false</autoFillFields>
					</item>
					<item xsi:type="DataSetQuery">
						<name>ПриобретениеТоваровУслуг</name>
						<dataSource>ИсточникДанных1</dataSource>
						<query>ВЫБРАТЬ
	ПоступлениеТоваровУслугТовары.Номенклатура,
	ПоступлениеТоваровУслугТовары.Характеристика КАК ХарактеристикаНоменклатуры,
	ВЫБОР
		КОГДА ПоступлениеТоваровУслугТовары.Упаковка = ЗНАЧЕНИЕ(Справочник.УпаковкиЕдиницыИзмерения.ПустаяСсылка)
			ТОГДА ПоступлениеТоваровУслугТовары.Номенклатура.ЕдиницаИзмерения
		ИНАЧЕ ПоступлениеТоваровУслугТовары.Упаковка
	КОНЕЦ КАК ЕдиницаИзмерения,
	ВЫРАЗИТЬ(ПоступлениеТоваровУслугТовары.Номенклатура.Наименование КАК СТРОКА(178)) КАК Наименование,
	ПоступлениеТоваровУслугТовары.КоличествоУпаковок КАК Количество,
	ПоступлениеТоваровУслугТовары.Цена,
	ПоступлениеТоваровУслугТовары.СтавкаНДС,
	ПоступлениеТоваровУслугТовары.Сумма,
	ПоступлениеТоваровУслугТовары.СуммаНДС
ИЗ
	Документ.ПриобретениеТоваровУслуг.Товары КАК ПоступлениеТоваровУслугТовары
ГДЕ
	ПоступлениеТоваровУслугТовары.Ссылка = &amp;Ссылка</query>
						<autoFillFields>false</autoFillFields>
					</item>
				</item>
			</item>
			<item xsi:type="DataSetQuery">
				<name>КонвертироватьТоварыEDIВ1С</name>
				<dataSource>ИсточникДанных1</dataSource>
				<query>ВЫБРАТЬ
	ТабТоваров.GTIN КАК GTIN,
	ТабТоваров.КодТовараСторонний КАК КодТовараСторонний,
	ТабТоваров.КодТовараСвой КАК КодТовараСвой,
	ТабСоответствий_КонтурEDI.Номенклатура КАК Номенклатура,
	ТабСоответствий_КонтурEDI.ХарактеристикаНоменклатуры КАК ХарактеристикаНоменклатуры,
	ТабСоответствий_КонтурEDI.ЕдиницаИзмерения КАК ЕдиницаИзмерения,
	ТабСоответствий_КонтурEDI.ТипЕдиницы КАК ТипЕдиницы,
	4 КАК Приоритет
ПОМЕСТИТЬ ВТ_НайденныеСоответствия
ИЗ
	ТабТоваров КАК ТабТоваров
		ВНУТРЕННЕЕ СОЕДИНЕНИЕ ТабСоответствий_КонтурEDI КАК ТабСоответствий_КонтурEDI
		ПО ТабТоваров.GTIN = ТабСоответствий_КонтурEDI.GTIN
			И ТабТоваров.КодТовараСторонний = ТабСоответствий_КонтурEDI.КодТовараСторонний
			И ТабТоваров.КодТовараСвой = ТабСоответствий_КонтурEDI.КодТовараСвой

ОБЪЕДИНИТЬ ВСЕ

ВЫБРАТЬ
	ТабТоваров.GTIN,
	ТабТоваров.КодТовараСторонний,
	ТабТоваров.КодТовараСвой,
	Штрихкоды.Номенклатура,
	Штрихкоды.Характеристика,
	Штрихкоды.Упаковка,
	ВЫРАЗИТЬ("" КАК СТРОКА(20)),
	3
ИЗ
	ТабТоваров КАК ТабТоваров
		ВНУТРЕННЕЕ СОЕДИНЕНИЕ РегистрСведений.ШтрихкодыНоменклатуры КАК Штрихкоды
		ПО (ТабТоваров.GTIN = Штрихкоды.Штрихкод)
			
ГДЕ
	(НЕ ТабТоваров.GTIN = "")

ОБЪЕДИНИТЬ ВСЕ

ВЫБРАТЬ
	ТабТоваров.GTIN,
	ТабТоваров.КодТовараСторонний,
	ТабТоваров.КодТовараСвой,
	Штрихкоды.Номенклатура,
	Штрихкоды.Характеристика,
	Штрихкоды.Упаковка,
	ВЫРАЗИТЬ("" КАК СТРОКА(20)),
	2
ИЗ
	ТабТоваров КАК ТабТоваров
		ВНУТРЕННЕЕ СОЕДИНЕНИЕ РегистрСведений.ШтрихкодыНоменклатуры КАК Штрихкоды
		ПО (ПОДСТРОКА(ТабТоваров.GTIN, 2, 13) = Штрихкоды.Штрихкод)
			
ГДЕ
	(НЕ ТабТоваров.GTIN = "")
	
ОБЪЕДИНИТЬ ВСЕ

ВЫБРАТЬ
	ТабТоваров.GTIN,
	ТабТоваров.КодТовараСторонний,
	ТабТоваров.КодТовараСвой,
	СправочникНоменклатура.Ссылка,
	НЕОПРЕДЕЛЕНО,
	СправочникНоменклатура.ЕдиницаИзмерения,
	ВЫРАЗИТЬ("" КАК СТРОКА(20)),
	1
ИЗ
	ТабТоваров КАК ТабТоваров
		ВНУТРЕННЕЕ СОЕДИНЕНИЕ Справочник.Номенклатура КАК СправочникНоменклатура
		ПО ТабТоваров.КодТовараСвой = СправочникНоменклатура.Код
ГДЕ
	(НЕ ТабТоваров.КодТовараСвой = "")
</query>
				<autoFillFields>false</autoFillFields>
			</item>
		</item>
	</dataSet>
	<dataSet xsi:type="DataSetUnion">
		<name>ДалионУМ</name>
		<item xsi:type="DataSetUnion">
			<name>Покупатель</name>
			<item xsi:type="DataSetUnion">
				<name>ЗапросОсновнойЦепочки</name>
				<item xsi:type="DataSetQuery">
					<name>Заказ_Накладная</name>
					<dataSource>ИсточникДанных1</dataSource>
					<query>ВЫБРАТЬ
	Заказ.Ссылка КАК PORDERS,
	Заказ.Ссылка КАК ORDERS,
	Заказ.Ссылка КАК ORDRSP,
	ПриходнаяНакладная.Ссылка КАК RECADV,
	ПриходнаяНакладная.Ссылка КАК DESADV,
	ПриходнаяНакладная.Ссылка КАК INVOIC 
	
ИЗ
	(ВЫБРАТЬ
		1 КАК Поле1) КАК Заглушка
		{ПОЛНОЕ СОЕДИНЕНИЕ Документ.ПриходнаяНакладная КАК ПриходнаяНакладная
			{ПОЛНОЕ СОЕДИНЕНИЕ Документ.ЗаказПоставщику КАК Заказ
			ПО ПриходнаяНакладная.ДокументОснование = Заказ.Ссылка}
		ПО (ИСТИНА)}
		</query>
					<autoFillFields>false</autoFillFields>
				</item>
			</item>
			<item xsi:type="DataSetUnion">
				<name>ЗапросПоТоварам</name>
				<item xsi:type="DataSetUnion">
					<name>_ORDERS_</name>
					<item xsi:type="DataSetQuery">
						<name>ЗаказПоставщику</name>
						<dataSource>ИсточникДанных1</dataSource>
						<query>ВЫБРАТЬ
	ЗаказПоставщикуТовары.Номенклатура.Код КАК КодТовараПокупателя,
	ЗаказПоставщикуТовары.Номенклатура,
	ЗаказПоставщикуТовары.ХарактеристикаНоменклатуры,
	ЗаказПоставщикуТовары.ЕдиницаИзмерения КАК ЕдиницаИзмерения,
	ЗаказПоставщикуТовары.ЕдиницаИзмерения.ЕдиницаПоКлассификатору.Наименование КАК КодЕдиницыИзмерения,
	ВЫРАЗИТЬ(ЗаказПоставщикуТовары.Номенклатура.Наименование КАК СТРОКА(178)) КАК Наименование,
	ЗаказПоставщикуТовары.Цена,
	ЗаказПоставщикуТовары.СтавкаНДС,
	СУММА(ЗаказПоставщикуТовары.Количество) КАК Количество,
	СУММА(ЗаказПоставщикуТовары.Сумма) КАК Сумма,
	СУММА(ЗаказПоставщикуТовары.СуммаНДС) КАК СуммаНДС
ИЗ
	Документ.ЗаказПоставщику.Товары КАК ЗаказПоставщикуТовары
ГДЕ
	ЗаказПоставщикуТовары.Ссылка = &amp;Ссылка

СГРУППИРОВАТЬ ПО
	ЗаказПоставщикуТовары.Номенклатура,
	ЗаказПоставщикуТовары.ХарактеристикаНоменклатуры,
	ЗаказПоставщикуТовары.ЕдиницаИзмерения,
	ЗаказПоставщикуТовары.Цена,
	ВЫРАЗИТЬ(ЗаказПоставщикуТовары.Номенклатура.Наименование КАК СТРОКА(178)),
	ЗаказПоставщикуТовары.СтавкаНДС,
	ЗаказПоставщикуТовары.Номенклатура.Код</query>
						<autoFillFields>false</autoFillFields>
					</item>
				</item>
				<item xsi:type="DataSetUnion">
					<name>_RECADV_</name>
					<item xsi:type="DataSetQuery">
						<name>ПриходнаяНакладная</name>
						<dataSource>ИсточникДанных1</dataSource>
						<query>ВЫБРАТЬ
	ПриходнаяНакладная.Номенклатура,
	ПриходнаяНакладная.ХарактеристикаНоменклатуры,
	ПриходнаяНакладная.ЕдиницаИзмерения КАК ЕдиницаИзмерения,
	ПриходнаяНакладная.ЕдиницаИзмерения.ЕдиницаПоКлассификатору.Наименование КАК КодЕдиницыИзмерения,
	ВЫРАЗИТЬ(ПриходнаяНакладная.Номенклатура.Наименование КАК СТРОКА(178)) КАК Наименование,
	ПриходнаяНакладная.Количество КАК Количество,
	ПриходнаяНакладная.Цена,
	ПриходнаяНакладная.СтавкаНДС,
	ПриходнаяНакладная.Сумма,
	ПриходнаяНакладная.СуммаНДС
ИЗ
	Документ.ПриходнаяНакладная.Товары КАК ПриходнаяНакладная
ГДЕ
	ПриходнаяНакладная.Ссылка = &amp;Ссылка
</query>
						<autoFillFields>false</autoFillFields>
					</item>
				</item>
			</item>
			<item xsi:type="DataSetQuery">
				<name>КонвертироватьТоварыEDIВ1С</name>
				<dataSource>ИсточникДанных1</dataSource>
				<query>ВЫБРАТЬ
	ТабТоваров.GTIN КАК GTIN,
	ТабТоваров.КодТовараСторонний КАК КодТовараСторонний,
	ТабТоваров.КодТовараСвой КАК КодТовараСвой,
	ТабСоответствий_КонтурEDI.Номенклатура КАК Номенклатура,
	ТабСоответствий_КонтурEDI.ХарактеристикаНоменклатуры КАК ХарактеристикаНоменклатуры,
	ТабСоответствий_КонтурEDI.ЕдиницаИзмерения КАК ЕдиницаИзмерения,
	ТабСоответствий_КонтурEDI.ТипЕдиницы КАК ТипЕдиницы,
	4 КАК Приоритет
ПОМЕСТИТЬ ВТ_НайденныеСоответствия
ИЗ
	ТабТоваров КАК ТабТоваров
		ВНУТРЕННЕЕ СОЕДИНЕНИЕ ТабСоответствий_КонтурEDI КАК ТабСоответствий_КонтурEDI
		ПО ТабТоваров.GTIN = ТабСоответствий_КонтурEDI.GTIN
			И ТабТоваров.КодТовараСторонний = ТабСоответствий_КонтурEDI.КодТовараСторонний
			И ТабТоваров.КодТовараСвой = ТабСоответствий_КонтурEDI.КодТовараСвой

ОБЪЕДИНИТЬ ВСЕ

ВЫБРАТЬ
	ТабТоваров.GTIN,
	ТабТоваров.КодТовараСторонний,
	ТабТоваров.КодТовараСвой,
	Штрихкоды.Номенклатура,
	Штрихкоды.ХарактеристикаНоменклатуры,
	Штрихкоды.ЕдиницаИзмерения,
	ВЫРАЗИТЬ("" КАК СТРОКА(20)),
	3
ИЗ
	ТабТоваров КАК ТабТоваров
		ВНУТРЕННЕЕ СОЕДИНЕНИЕ РегистрСведений.Штрихкоды КАК Штрихкоды
		ПО ТабТоваров.GTIN = Штрихкоды.Штрихкод
ГДЕ
	(НЕ ТабТоваров.GTIN = "")
	
ОБЪЕДИНИТЬ ВСЕ

ВЫБРАТЬ
	ТабТоваров.GTIN,
	ТабТоваров.КодТовараСторонний,
	ТабТоваров.КодТовараСвой,
	Штрихкоды.Номенклатура,
	Штрихкоды.ХарактеристикаНоменклатуры,
	Штрихкоды.ЕдиницаИзмерения,
	ВЫРАЗИТЬ("" КАК СТРОКА(20)),
	2
ИЗ
	ТабТоваров КАК ТабТоваров
		ВНУТРЕННЕЕ СОЕДИНЕНИЕ РегистрСведений.Штрихкоды КАК Штрихкоды
		ПО (ПОДСТРОКА(ТабТоваров.GTIN, 1, 13) = Штрихкоды.Штрихкод)
ГДЕ
	(НЕ ТабТоваров.GTIN = "")
	
ОБЪЕДИНИТЬ ВСЕ

ВЫБРАТЬ
	ТабТоваров.GTIN,
	ТабТоваров.КодТовараСторонний,
	ТабТоваров.КодТовараСвой,
	СправочникНоменклатура.Ссылка,
	НЕОПРЕДЕЛЕНО,
	СправочникНоменклатура.ЕдиницаИзмеренияОтчетов,
	ВЫРАЗИТЬ("" КАК СТРОКА(20)),
	1
ИЗ
	ТабТоваров КАК ТабТоваров
		ВНУТРЕННЕЕ СОЕДИНЕНИЕ Справочник.Номенклатура КАК СправочникНоменклатура
		ПО ТабТоваров.КодТовараСвойЧисло = СправочникНоменклатура.Код
ГДЕ
	(НЕ ТабТоваров.КодТовараСвой = "")
</query>
				<autoFillFields>false</autoFillFields>
			</item>
			<item xsi:type="DataSetQuery">
				<name>КонвертироватьТовары1СВEDIВ_GTIN</name>
				<dataSource>ИсточникДанных1</dataSource>
				<query>ВЫБРАТЬ РАЗЛИЧНЫЕ
	ТабТоваров.Номенклатура,
	ТабТоваров.ХарактеристикаНоменклатуры,
	ТабТоваров.ЕдиницаИзмерения,
	ТабТоваров.Номенклатура.Код КАК КодТовараСвой,
	ВЫРАЗИТЬ(Штрихкоды.Штрихкод КАК СТРОКА(14)) КАК GTIN
ПОМЕСТИТЬ ВТШтрихкодыТоваров
ИЗ
	ТабТоваров КАК ТабТоваров
		ВНУТРЕННЕЕ СОЕДИНЕНИЕ РегистрСведений.Штрихкоды КАК Штрихкоды
		ПО ТабТоваров.Номенклатура = Штрихкоды.Номенклатура
			И (Штрихкоды.НеИспользуется = ЛОЖЬ)
ГДЕ
	&amp;ИскатьТоварПоШК

ИНДЕКСИРОВАТЬ ПО
	ТабТоваров.Номенклатура,
	ТабТоваров.ХарактеристикаНоменклатуры,
	ТабТоваров.ЕдиницаИзмерения</query>
				<autoFillFields>false</autoFillFields>
			</item>
		</item>
		<item xsi:type="DataSetUnion">
			<name>Поставщик</name>
			<item xsi:type="DataSetUnion">
				<name>ЗапросОсновнойЦепочки</name>
				<item xsi:type="DataSetQuery">
					<name>РасходнаяНакладная_СФ</name>
					<dataSource>ИсточникДанных1</dataSource>
					<query>ВЫБРАТЬ
	РасходнаяНакладная.Ссылка КАК PORDERS,
	РасходнаяНакладная.Ссылка КАК ORDERS,
	РасходнаяНакладная.Ссылка КАК ORDRSP,
	РасходнаяНакладная.Ссылка КАК DESADV,
	РасходнаяНакладная.Ссылка КАК RECADV,
	СчетФактура.Ссылка КАК INVOIC
ИЗ
	(ВЫБРАТЬ
		1 КАК Поле1) КАК Заглушка
		{ПОЛНОЕ СОЕДИНЕНИЕ Документ.СчетФактура КАК СчетФактура
			{ПОЛНОЕ СОЕДИНЕНИЕ Документ.РасходнаяНакладная КАК РасходнаяНакладная
			ПО СчетФактура.ДокументОснование = РасходнаяНакладная.Ссылка}
		ПО (ИСТИНА)}</query>
					<autoFillFields>false</autoFillFields>
				</item>
			</item>
			<item xsi:type="DataSetUnion">
				<name>ЗапросПоТоварам</name>
				<item xsi:type="DataSetUnion">
					<name>_PORDERS_ORDRSP_DESADV_INVOIC_</name>
					<item xsi:type="DataSetQuery">
						<name>РасходнаяНакладная</name>
						<dataSource>ИсточникДанных1</dataSource>
						<query>ВЫБРАТЬ
	РасходнаяНакладнаяТовары.НомерСтроки,
	РасходнаяНакладнаяТовары.Номенклатура,
	РасходнаяНакладнаяТовары.ЕдиницаИзмерения КАК ЕдиницаИзмерения,
	РасходнаяНакладнаяТовары.ЕдиницаИзмерения.ЕдиницаПоКлассификатору.Наименование КАК КодЕдиницыИзмерения,
	ВЫРАЗИТЬ(РасходнаяНакладнаяТовары.Номенклатура.Наименование КАК СТРОКА(178)) КАК Наименование,
	ВЫРАЗИТЬ(РасходнаяНакладнаяТовары.Номенклатура.НаименованиеПолное КАК СТРОКА(500)) КАК НаименованиеПолное,
	РасходнаяНакладнаяТовары.ХарактеристикаНоменклатуры КАК ХарактеристикаНоменклатуры,
	Неопределено КАК СерияНоменклатуры,
	РасходнаяНакладнаяТовары.Цена,
	РасходнаяНакладнаяТовары.СтавкаНДС,
	Значение(Справочник.КлассификаторСтранМира.) КАК Страна,
	Значение(Справочник.НомераГТД.) КАК НомерГТД,
	РасходнаяНакладнаяТовары.Количество КАК Количество,
	РасходнаяНакладнаяТовары.Сумма КАК Сумма,
	РасходнаяНакладнаяТовары.СуммаНДС КАК СуммаНДС,
	"" КАК ТипЕдиницы
ИЗ
	Документ.РасходнаяНакладная.Товары КАК РасходнаяНакладнаяТовары
ГДЕ
	РасходнаяНакладнаяТовары.Ссылка В (&amp;Ссылка)

ОБЪЕДИНИТЬ ВСЕ

ВЫБРАТЬ
	0,
	ВозвратТоваровОтПокупателяТовары.Номенклатура,
	ВозвратТоваровОтПокупателяТовары.ЕдиницаИзмерения,
	ВозвратТоваровОтПокупателяТовары.ЕдиницаИзмерения.ЕдиницаПоКлассификатору.Наименование КАК КодЕдиницыИзмерения,
	ВЫРАЗИТЬ(ВозвратТоваровОтПокупателяТовары.Номенклатура.Наименование КАК СТРОКА(178)),
	ВЫРАЗИТЬ(ВозвратТоваровОтПокупателяТовары.Номенклатура.НаименованиеПолное КАК СТРОКА(500)),
	ВозвратТоваровОтПокупателяТовары.ХарактеристикаНоменклатуры,
	Неопределено КАК СерияНоменклатуры,
	ВозвратТоваровОтПокупателяТовары.Цена,
	ВозвратТоваровОтПокупателяТовары.СтавкаНДС,
	ВозвратТоваровОтПокупателяТовары.СтранаПроисхождения,
	ВозвратТоваровОтПокупателяТовары.НомерГТД,
	-ВозвратТоваровОтПокупателяТовары.Количество,
	-ВозвратТоваровОтПокупателяТовары.Сумма,
	-ВозвратТоваровОтПокупателяТовары.СуммаНДС КАК СуммаНДС,
	""
ИЗ
	Документ.ВозвратТоваровОтПокупателя.Товары КАК ВозвратТоваровОтПокупателяТовары
ГДЕ
	ВозвратТоваровОтПокупателяТовары.Ссылка В(&amp;Возвраты)</query>
						<autoFillFields>false</autoFillFields>
					</item>
				</item>
			</item>
		</item>
	</dataSet>
	<dataSet xsi:type="DataSetUnion">
		<name>ХБКП_УСП</name>
		<field xsi:type="DataSetFieldField">
			<dataPath>ЕдиницаИзмерения</dataPath>
			<field>ЕдиницаИзмерения</field>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>КодЕдиницыИзмерения</dataPath>
			<field>КодЕдиницыИзмерения</field>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>Количество</dataPath>
			<field>Количество</field>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>Номенклатура</dataPath>
			<field>Номенклатура</field>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>НоменклатураСтавкаНДС</dataPath>
			<field>НоменклатураСтавкаНДС</field>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>Сумма</dataPath>
			<field>Сумма</field>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>СуммаНДС</dataPath>
			<field>СуммаНДС</field>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>ХарактеристикаНоменклатуры</dataPath>
			<field>ХарактеристикаНоменклатуры</field>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>Цена</dataPath>
			<field>Цена</field>
		</field>
		<item xsi:type="DataSetUnion">
			<name>Поставщик</name>
			<field xsi:type="DataSetFieldField">
				<dataPath>ЕдиницаИзмерения</dataPath>
				<field>ЕдиницаИзмерения</field>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>КодЕдиницыИзмерения</dataPath>
				<field>КодЕдиницыИзмерения</field>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>Количество</dataPath>
				<field>Количество</field>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>Номенклатура</dataPath>
				<field>Номенклатура</field>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>НоменклатураСтавкаНДС</dataPath>
				<field>НоменклатураСтавкаНДС</field>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>Сумма</dataPath>
				<field>Сумма</field>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>СуммаНДС</dataPath>
				<field>СуммаНДС</field>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>ХарактеристикаНоменклатуры</dataPath>
				<field>ХарактеристикаНоменклатуры</field>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>Цена</dataPath>
				<field>Цена</field>
			</field>
			<item xsi:type="DataSetUnion">
				<name>ЗапросОсновнойЦепочки</name>
				<item xsi:type="DataSetQuery">
					<name>ЗаказПокупателя_Реализация_СчетФактураВыданный</name>
					<dataSource>ИсточникДанных1</dataSource>
					<query>ВЫБРАТЬ
	докЗаказПокупателя.Ссылка КАК PORDERS,
	докЗаказПокупателя.Ссылка КАК ORDERS,
	докЗаказПокупателя.Ссылка КАК ORDRSP,
	докРеализация.Ссылка КАК DESADV,
	докРеализация.Ссылка КАК RECADV,
	СчетФактураВыданныйДокументыОснования.Ссылка КАК INVOIC
ИЗ
	(ВЫБРАТЬ
		1 КАК Поле1) КАК Заглушка
		{ПОЛНОЕ СОЕДИНЕНИЕ Документ.СчетФактураВыданный.ДокументыОснования КАК СчетФактураВыданныйДокументыОснования
			{ПОЛНОЕ СОЕДИНЕНИЕ Документ.Реализация КАК докРеализация
				{ПОЛНОЕ СОЕДИНЕНИЕ Документ.ЗаказПокупателя КАК докЗаказПокупателя
				ПО докРеализация.ДокументОснование = докЗаказПокупателя.Ссылка}
			ПО СчетФактураВыданныйДокументыОснования.ДокументОснование = докРеализация.Ссылка}
		ПО (ИСТИНА)}</query>
				</item>
			</item>
			<item xsi:type="DataSetUnion">
				<name>ЗапросПоТоварам</name>
				<field xsi:type="DataSetFieldField">
					<dataPath>ЕдиницаИзмерения</dataPath>
					<field>ЕдиницаИзмерения</field>
				</field>
				<field xsi:type="DataSetFieldField">
					<dataPath>КодЕдиницыИзмерения</dataPath>
					<field>КодЕдиницыИзмерения</field>
				</field>
				<field xsi:type="DataSetFieldField">
					<dataPath>Количество</dataPath>
					<field>Количество</field>
				</field>
				<field xsi:type="DataSetFieldField">
					<dataPath>Номенклатура</dataPath>
					<field>Номенклатура</field>
				</field>
				<field xsi:type="DataSetFieldField">
					<dataPath>НоменклатураСтавкаНДС</dataPath>
					<field>НоменклатураСтавкаНДС</field>
				</field>
				<field xsi:type="DataSetFieldField">
					<dataPath>Сумма</dataPath>
					<field>Сумма</field>
				</field>
				<field xsi:type="DataSetFieldField">
					<dataPath>СуммаНДС</dataPath>
					<field>СуммаНДС</field>
				</field>
				<field xsi:type="DataSetFieldField">
					<dataPath>ХарактеристикаНоменклатуры</dataPath>
					<field>ХарактеристикаНоменклатуры</field>
				</field>
				<field xsi:type="DataSetFieldField">
					<dataPath>Цена</dataPath>
					<field>Цена</field>
				</field>
				<item xsi:type="DataSetUnion">
					<name>_PORDERS_ORDRSP_</name>
					<field xsi:type="DataSetFieldField">
						<dataPath>ЕдиницаИзмерения</dataPath>
						<field>ЕдиницаИзмерения</field>
					</field>
					<field xsi:type="DataSetFieldField">
						<dataPath>КодЕдиницыИзмерения</dataPath>
						<field>КодЕдиницыИзмерения</field>
					</field>
					<field xsi:type="DataSetFieldField">
						<dataPath>Количество</dataPath>
						<field>Количество</field>
					</field>
					<field xsi:type="DataSetFieldField">
						<dataPath>Номенклатура</dataPath>
						<field>Номенклатура</field>
					</field>
					<field xsi:type="DataSetFieldField">
						<dataPath>НоменклатураСтавкаНДС</dataPath>
						<field>НоменклатураСтавкаНДС</field>
					</field>
					<field xsi:type="DataSetFieldField">
						<dataPath>Сумма</dataPath>
						<field>Сумма</field>
					</field>
					<field xsi:type="DataSetFieldField">
						<dataPath>СуммаНДС</dataPath>
						<field>СуммаНДС</field>
					</field>
					<field xsi:type="DataSetFieldField">
						<dataPath>ХарактеристикаНоменклатуры</dataPath>
						<field>ХарактеристикаНоменклатуры</field>
					</field>
					<field xsi:type="DataSetFieldField">
						<dataPath>Цена</dataPath>
						<field>Цена</field>
					</field>
					<item xsi:type="DataSetQuery">
						<name>ЗаказПокупателя</name>
						<field xsi:type="DataSetFieldField">
							<dataPath>ЕдиницаИзмерения</dataPath>
							<field>ЕдиницаИзмерения</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>КодЕдиницыИзмерения</dataPath>
							<field>КодЕдиницыИзмерения</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>Количество</dataPath>
							<field>Количество</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>Номенклатура</dataPath>
							<field>Номенклатура</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>НоменклатураСтавкаНДС</dataPath>
							<field>НоменклатураСтавкаНДС</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>Сумма</dataPath>
							<field>Сумма</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>СуммаНДС</dataPath>
							<field>СуммаНДС</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>ХарактеристикаНоменклатуры</dataPath>
							<field>ХарактеристикаНоменклатуры</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>Цена</dataPath>
							<field>Цена</field>
						</field>
						<dataSource>ИсточникДанных1</dataSource>
						<query> ВЫБРАТЬ
	ЗаказПокупателяТовары.Номенклатура,
	Неопределено как ХарактеристикаНоменклатуры,
	ЗаказПокупателяТовары.ЕдиницаИзмерения КАК ЕдиницаИзмерения,
	ЗаказПокупателяТовары.ЕдиницаИзмерения.ЕдиницаПоКлассификатору.Наименование КАК КодЕдиницыИзмерения,
	0 КАК Цена,
	ЗаказПокупателяТовары.Номенклатура.СтавкаНДС,
	ЗаказПокупателяТовары.Количество КАК Количество,
	0 КАК Сумма,
	0 КАК СуммаНДС
ИЗ
	Документ.ЗаказПокупателя.Товары КАК ЗаказПокупателяТовары
ГДЕ
	ЗаказПокупателяТовары.Ссылка в (&amp;Ссылка)</query>
					</item>
				</item>
				<item xsi:type="DataSetUnion">
					<name>_DESADV_INVOIC_</name>
					<item xsi:type="DataSetQuery">
						<name>Реализация</name>
						<dataSource>ИсточникДанных1</dataSource>
						<query>ВЫБРАТЬ
	РеализацияТовары.НомерСтроки,
	РеализацияТовары.Номенклатура,
	Неопределено КАК ХарактеристикаНоменклатуры,
	РеализацияТовары.ЕдиницаИзмерения КАК ЕдиницаИзмерения,
	РеализацияТовары.ЕдиницаИзмерения.ЕдиницаПоКлассификатору.Наименование КАК КодЕдиницыИзмерения,
	ВЫРАЗИТЬ(РеализацияТовары.Номенклатура.Наименование КАК СТРОКА(178)) КАК Наименование,
	ВЫРАЗИТЬ(РеализацияТовары.Номенклатура.НаименованиеПолное КАК СТРОКА(500)) КАК НаименованиеПолное,
	РеализацияТовары.Цена,
	РеализацияТовары.СтавкаНДС,
	Неопределено КАК СерияНоменклатуры,
	РеализацияТовары.Номенклатура.СтранаПроисхождения КАК Страна,
	РеализацияТовары.Номенклатура.НомерГТД.Код КАК НомерГТД,
	РеализацияТовары.Количество КАК Количество,
	РеализацияТовары.Сумма КАК Сумма,
	РеализацияТовары.СуммаНДС,
	"" КАК ТипЕдиницы
ИЗ
	Документ.Реализация.Товары КАК РеализацияТовары
ГДЕ
	РеализацияТовары.Ссылка в (&amp;Ссылка)</query>
					</item>
				</item>
			</item>
		</item>
		<item xsi:type="DataSetUnion">
			<name>Покупатель</name>
			<item xsi:type="DataSetUnion">
				<name>ЗапросОсновнойЦепочки</name>
			</item>
		</item>
	</dataSet>
	<dataSet xsi:type="DataSetUnion">
		<name>УФ_Розница</name>
		<field xsi:type="DataSetFieldField">
			<dataPath>СуммаНДС</dataPath>
			<field>СуммаНДС</field>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>НомерСтроки</dataPath>
			<field>НомерСтроки</field>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>Сумма</dataPath>
			<field>Сумма</field>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>Наименование</dataPath>
			<field>Наименование</field>
			<title xsi:type="v8:LocalStringType">
				<v8:item>
					<v8:lang>ru</v8:lang>
					<v8:content>Наименование</v8:content>
				</v8:item>
			</title>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>НаименованиеПолное</dataPath>
			<field>НаименованиеПолное</field>
			<title xsi:type="v8:LocalStringType">
				<v8:item>
					<v8:lang>ru</v8:lang>
					<v8:content>Наименование полное</v8:content>
				</v8:item>
			</title>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>СтавкаНДС</dataPath>
			<field>СтавкаНДС</field>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>ХарактеристикаНоменклатуры</dataPath>
			<field>ХарактеристикаНоменклатуры</field>
			<title xsi:type="v8:LocalStringType">
				<v8:item>
					<v8:lang>ru</v8:lang>
					<v8:content>Характеристика номенклатуры</v8:content>
				</v8:item>
			</title>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>НомерГТД</dataPath>
			<field>НомерГТД</field>
			<title xsi:type="v8:LocalStringType">
				<v8:item>
					<v8:lang>ru</v8:lang>
					<v8:content>Номер ГТД</v8:content>
				</v8:item>
			</title>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>ТипЕдиницы</dataPath>
			<field>ТипЕдиницы</field>
			<title xsi:type="v8:LocalStringType">
				<v8:item>
					<v8:lang>ru</v8:lang>
					<v8:content>Тип единицы</v8:content>
				</v8:item>
			</title>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>Количество</dataPath>
			<field>Количество</field>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>Страна</dataPath>
			<field>Страна</field>
			<title xsi:type="v8:LocalStringType">
				<v8:item>
					<v8:lang>ru</v8:lang>
					<v8:content>Страна</v8:content>
				</v8:item>
			</title>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>ЕдиницаИзмерения</dataPath>
			<field>ЕдиницаИзмерения</field>
			<title xsi:type="v8:LocalStringType">
				<v8:item>
					<v8:lang>ru</v8:lang>
					<v8:content>Единица измерения</v8:content>
				</v8:item>
			</title>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>Номенклатура</dataPath>
			<field>Номенклатура</field>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>Цена</dataPath>
			<field>Цена</field>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>СерияНоменклатуры</dataPath>
			<field>СерияНоменклатуры</field>
			<title xsi:type="v8:LocalStringType">
				<v8:item>
					<v8:lang>ru</v8:lang>
					<v8:content>Серия номенклатуры</v8:content>
				</v8:item>
			</title>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>GTIN</dataPath>
			<field>GTIN</field>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>ЕдИзмСрокаГодности</dataPath>
			<field>ЕдИзмСрокаГодности</field>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>КвантПоставки</dataPath>
			<field>КвантПоставки</field>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>КодТовараПоставщика</dataPath>
			<field>КодТовараПоставщика</field>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>КоличествоВОдномМесте</dataPath>
			<field>КоличествоВОдномМесте</field>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>Родитель</dataPath>
			<field>Родитель</field>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>СрокГодности</dataPath>
			<field>СрокГодности</field>
		</field>
		<item xsi:type="DataSetUnion">
			<name>Поставщик</name>
			<field xsi:type="DataSetFieldField">
				<dataPath>СуммаНДС</dataPath>
				<field>СуммаНДС</field>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>НомерСтроки</dataPath>
				<field>НомерСтроки</field>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>Сумма</dataPath>
				<field>Сумма</field>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>Наименование</dataPath>
				<field>Наименование</field>
				<title xsi:type="v8:LocalStringType">
					<v8:item>
						<v8:lang>ru</v8:lang>
						<v8:content>Наименование</v8:content>
					</v8:item>
				</title>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>НаименованиеПолное</dataPath>
				<field>НаименованиеПолное</field>
				<title xsi:type="v8:LocalStringType">
					<v8:item>
						<v8:lang>ru</v8:lang>
						<v8:content>Наименование полное</v8:content>
					</v8:item>
				</title>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>СтавкаНДС</dataPath>
				<field>СтавкаНДС</field>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>ХарактеристикаНоменклатуры</dataPath>
				<field>ХарактеристикаНоменклатуры</field>
				<title xsi:type="v8:LocalStringType">
					<v8:item>
						<v8:lang>ru</v8:lang>
						<v8:content>Характеристика номенклатуры</v8:content>
					</v8:item>
				</title>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>НомерГТД</dataPath>
				<field>НомерГТД</field>
				<title xsi:type="v8:LocalStringType">
					<v8:item>
						<v8:lang>ru</v8:lang>
						<v8:content>Номер ГТД</v8:content>
					</v8:item>
				</title>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>ТипЕдиницы</dataPath>
				<field>ТипЕдиницы</field>
				<title xsi:type="v8:LocalStringType">
					<v8:item>
						<v8:lang>ru</v8:lang>
						<v8:content>Тип единицы</v8:content>
					</v8:item>
				</title>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>Количество</dataPath>
				<field>Количество</field>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>Страна</dataPath>
				<field>Страна</field>
				<title xsi:type="v8:LocalStringType">
					<v8:item>
						<v8:lang>ru</v8:lang>
						<v8:content>Страна</v8:content>
					</v8:item>
				</title>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>ЕдиницаИзмерения</dataPath>
				<field>ЕдиницаИзмерения</field>
				<title xsi:type="v8:LocalStringType">
					<v8:item>
						<v8:lang>ru</v8:lang>
						<v8:content>Единица измерения</v8:content>
					</v8:item>
				</title>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>Номенклатура</dataPath>
				<field>Номенклатура</field>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>Цена</dataPath>
				<field>Цена</field>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>СерияНоменклатуры</dataPath>
				<field>СерияНоменклатуры</field>
				<title xsi:type="v8:LocalStringType">
					<v8:item>
						<v8:lang>ru</v8:lang>
						<v8:content>Серия номенклатуры</v8:content>
					</v8:item>
				</title>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>GTIN</dataPath>
				<field>GTIN</field>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>ЕдИзмСрокаГодности</dataPath>
				<field>ЕдИзмСрокаГодности</field>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>КвантПоставки</dataPath>
				<field>КвантПоставки</field>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>КодТовараПоставщика</dataPath>
				<field>КодТовараПоставщика</field>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>КоличествоВОдномМесте</dataPath>
				<field>КоличествоВОдномМесте</field>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>Родитель</dataPath>
				<field>Родитель</field>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>СрокГодности</dataPath>
				<field>СрокГодности</field>
			</field>
			<item xsi:type="DataSetUnion">
				<name>ЗапросОсновнойЦепочки</name>
				<item xsi:type="DataSetQuery">
					<name>Реализация_СФ</name>
					<dataSource>ИсточникДанных1</dataSource>
					<query>ВЫБРАТЬ
	РеализацияТоваровУслуг.Ссылка КАК PORDERS,
	РеализацияТоваровУслуг.Ссылка КАК ORDERS,
	РеализацияТоваровУслуг.Ссылка КАК ORDRSP,
	РеализацияТоваровУслуг.Ссылка КАК DESADV,
	РеализацияТоваровУслуг.Ссылка КАК RECADV,
	СчетФактураВыданный.Ссылка КАК INVOIC
ИЗ
	(ВЫБРАТЬ
		1 КАК Поле1) КАК Заглушка
		{ПОЛНОЕ СОЕДИНЕНИЕ Документ.СчетФактураВыданный КАК СчетФактураВыданный
			{ПОЛНОЕ СОЕДИНЕНИЕ Документ.РеализацияТоваров КАК РеализацияТоваровУслуг
			ПО (СчетФактураВыданный.ДокументОснование = РеализацияТоваровУслуг.Ссылка)}
		ПО (ИСТИНА)}</query>
					<autoFillFields>false</autoFillFields>
				</item>
				<item xsi:type="DataSetQuery">
					<name>Реализация</name>
					<dataSource>ИсточникДанных1</dataSource>
					<query>ВЫБРАТЬ
	РеализацияТоваровУслуг.Ссылка КАК PORDERS,
	РеализацияТоваровУслуг.Ссылка КАК ORDERS,
	РеализацияТоваровУслуг.Ссылка КАК ORDRSP,
	РеализацияТоваровУслуг.Ссылка КАК DESADV,
	РеализацияТоваровУслуг.Ссылка КАК RECADV,
	РеализацияТоваровУслуг.Ссылка КАК INVOIC
ИЗ
	(ВЫБРАТЬ
		1 КАК Поле1) КАК Заглушка
		{ПОЛНОЕ СОЕДИНЕНИЕ Документ.РеализацияТоваров КАК РеализацияТоваровУслуг
		ПО (ИСТИНА)}</query>
					<autoFillFields>false</autoFillFields>
				</item>
			</item>
			<item xsi:type="DataSetUnion">
				<name>ЗапросПоТоварам</name>
				<field xsi:type="DataSetFieldField">
					<dataPath>СуммаНДС</dataPath>
					<field>СуммаНДС</field>
				</field>
				<field xsi:type="DataSetFieldField">
					<dataPath>НомерСтроки</dataPath>
					<field>НомерСтроки</field>
				</field>
				<field xsi:type="DataSetFieldField">
					<dataPath>Сумма</dataPath>
					<field>Сумма</field>
				</field>
				<field xsi:type="DataSetFieldField">
					<dataPath>Наименование</dataPath>
					<field>Наименование</field>
					<title xsi:type="v8:LocalStringType">
						<v8:item>
							<v8:lang>ru</v8:lang>
							<v8:content>Наименование</v8:content>
						</v8:item>
					</title>
				</field>
				<field xsi:type="DataSetFieldField">
					<dataPath>НаименованиеПолное</dataPath>
					<field>НаименованиеПолное</field>
					<title xsi:type="v8:LocalStringType">
						<v8:item>
							<v8:lang>ru</v8:lang>
							<v8:content>Наименование полное</v8:content>
						</v8:item>
					</title>
				</field>
				<field xsi:type="DataSetFieldField">
					<dataPath>СтавкаНДС</dataPath>
					<field>СтавкаНДС</field>
				</field>
				<field xsi:type="DataSetFieldField">
					<dataPath>ХарактеристикаНоменклатуры</dataPath>
					<field>ХарактеристикаНоменклатуры</field>
					<title xsi:type="v8:LocalStringType">
						<v8:item>
							<v8:lang>ru</v8:lang>
							<v8:content>Характеристика номенклатуры</v8:content>
						</v8:item>
					</title>
				</field>
				<field xsi:type="DataSetFieldField">
					<dataPath>НомерГТД</dataPath>
					<field>НомерГТД</field>
					<title xsi:type="v8:LocalStringType">
						<v8:item>
							<v8:lang>ru</v8:lang>
							<v8:content>Номер ГТД</v8:content>
						</v8:item>
					</title>
				</field>
				<field xsi:type="DataSetFieldField">
					<dataPath>ТипЕдиницы</dataPath>
					<field>ТипЕдиницы</field>
					<title xsi:type="v8:LocalStringType">
						<v8:item>
							<v8:lang>ru</v8:lang>
							<v8:content>Тип единицы</v8:content>
						</v8:item>
					</title>
				</field>
				<field xsi:type="DataSetFieldField">
					<dataPath>Количество</dataPath>
					<field>Количество</field>
				</field>
				<field xsi:type="DataSetFieldField">
					<dataPath>Страна</dataPath>
					<field>Страна</field>
					<title xsi:type="v8:LocalStringType">
						<v8:item>
							<v8:lang>ru</v8:lang>
							<v8:content>Страна</v8:content>
						</v8:item>
					</title>
				</field>
				<field xsi:type="DataSetFieldField">
					<dataPath>ЕдиницаИзмерения</dataPath>
					<field>ЕдиницаИзмерения</field>
					<title xsi:type="v8:LocalStringType">
						<v8:item>
							<v8:lang>ru</v8:lang>
							<v8:content>Единица измерения</v8:content>
						</v8:item>
					</title>
				</field>
				<field xsi:type="DataSetFieldField">
					<dataPath>Номенклатура</dataPath>
					<field>Номенклатура</field>
				</field>
				<field xsi:type="DataSetFieldField">
					<dataPath>Цена</dataPath>
					<field>Цена</field>
				</field>
				<field xsi:type="DataSetFieldField">
					<dataPath>СерияНоменклатуры</dataPath>
					<field>СерияНоменклатуры</field>
					<title xsi:type="v8:LocalStringType">
						<v8:item>
							<v8:lang>ru</v8:lang>
							<v8:content>Серия номенклатуры</v8:content>
						</v8:item>
					</title>
				</field>
				<field xsi:type="DataSetFieldField">
					<dataPath>GTIN</dataPath>
					<field>GTIN</field>
				</field>
				<field xsi:type="DataSetFieldField">
					<dataPath>ЕдИзмСрокаГодности</dataPath>
					<field>ЕдИзмСрокаГодности</field>
				</field>
				<field xsi:type="DataSetFieldField">
					<dataPath>КвантПоставки</dataPath>
					<field>КвантПоставки</field>
				</field>
				<field xsi:type="DataSetFieldField">
					<dataPath>КодТовараПоставщика</dataPath>
					<field>КодТовараПоставщика</field>
				</field>
				<field xsi:type="DataSetFieldField">
					<dataPath>КоличествоВОдномМесте</dataPath>
					<field>КоличествоВОдномМесте</field>
				</field>
				<field xsi:type="DataSetFieldField">
					<dataPath>Родитель</dataPath>
					<field>Родитель</field>
				</field>
				<field xsi:type="DataSetFieldField">
					<dataPath>СрокГодности</dataPath>
					<field>СрокГодности</field>
				</field>
				<item xsi:type="DataSetUnion">
					<name>_PORDERS_ORDRSP_</name>
					<item xsi:type="DataSetQuery">
						<name>РеализацияТоваров</name>
						<dataSource>ИсточникДанных1</dataSource>
						<query>ВЫБРАТЬ
	РеализацияТоваровУслугТовары.НомерСтроки,
	РеализацияТоваровУслугТовары.Номенклатура,
	РеализацияТоваровУслугТовары.Характеристика КАК ХарактеристикаНоменклатуры,
	ВЫБОР
		КОГДА РеализацияТоваровУслугТовары.Упаковка = ЗНАЧЕНИЕ(Справочник.УпаковкиНоменклатуры.ПустаяСсылка)
			ТОГДА РеализацияТоваровУслугТовары.Номенклатура.ЕдиницаИзмерения
		ИНАЧЕ РеализацияТоваровУслугТовары.Упаковка
	КОНЕЦ КАК ЕдиницаИзмерения,
	ВЫРАЗИТЬ(РеализацияТоваровУслугТовары.Номенклатура.Наименование КАК СТРОКА(178)) КАК Наименование,
	ВЫРАЗИТЬ(РеализацияТоваровУслугТовары.Номенклатура.НаименованиеПолное КАК СТРОКА(500)) КАК НаименованиеПолное,
	РеализацияТоваровУслугТовары.Цена,
	РеализацияТоваровУслугТовары.СтавкаНДС,
	ЗНАЧЕНИЕ(Справочник.СерииНоменклатуры.ПустаяСсылка) КАК СерияНоменклатуры,
	ЗНАЧЕНИЕ(Справочник.СтраныМира.ПустаяСсылка) КАК Страна,
	"" КАК НомерГТД,
	РеализацияТоваровУслугТовары.КоличествоУпаковок КАК Количество,
	РеализацияТоваровУслугТовары.Сумма КАК Сумма,
	РеализацияТоваровУслугТовары.СуммаНДС,
	ВЫБОР
		КОГДА РеализацияТоваровУслугТовары.Номенклатура.ТипНоменклатуры = ЗНАЧЕНИЕ(Перечисление.ТипыНоменклатуры.Услуга)
			ТОГДА "Services"
		ИНАЧЕ ""
	КОНЕЦ КАК ТипЕдиницы
ИЗ
	Документ.РеализацияТоваров.Товары КАК РеализацияТоваровУслугТовары
ГДЕ
	РеализацияТоваровУслугТовары.Ссылка В(&amp;Ссылка)
	И (НЕ РеализацияТоваровУслугТовары.Номенклатура.ТипНоменклатуры = ЗНАЧЕНИЕ(Перечисление.ТипыНоменклатуры.Услуга)
			ИЛИ &amp;РаботаСУслугами)</query>
						<autoFillFields>false</autoFillFields>
					</item>
				</item>
				<item xsi:type="DataSetUnion">
					<name>_DESADV_INVOIC_</name>
					<item xsi:type="DataSetQuery">
						<name>РеализацияТоваров_Проведен</name>
						<dataSource>ИсточникДанных1</dataSource>
						<query>
ВЫБРАТЬ
	РеализацияТоваровУслугТовары.НомерСтроки,
	РеализацияТоваровУслугТовары.Номенклатура КАК Номенклатура,
	РеализацияТоваровУслугТовары.Характеристика КАК ХарактеристикаНоменклатуры,
	ВЫБОР
		КОГДА РеализацияТоваровУслугТовары.Упаковка = ЗНАЧЕНИЕ(Справочник.УпаковкиНоменклатуры.ПустаяСсылка)
			ТОГДА РеализацияТоваровУслугТовары.Номенклатура.ЕдиницаИзмерения
		ИНАЧЕ РеализацияТоваровУслугТовары.Упаковка
	КОНЕЦ КАК ЕдиницаИзмерения,
	ВЫРАЗИТЬ(РеализацияТоваровУслугТовары.Номенклатура.Наименование КАК СТРОКА(178)) КАК Наименование,
	ВЫРАЗИТЬ(РеализацияТоваровУслугТовары.Номенклатура.НаименованиеПолное КАК СТРОКА(500)) КАК НаименованиеПолное,
	ВЫБОР
		КОГДА РеализацияТоваровУслугТовары.КоличествоУпаковок = 0
			ТОГДА 0
		ИНАЧЕ РеализацияТоваровУслугТовары.Сумма / РеализацияТоваровУслугТовары.КоличествоУпаковок
	КОНЕЦ КАК Цена,
	РеализацияТоваровУслугТовары.СтавкаНДС,
	ЗНАЧЕНИЕ(Справочник.СерииНоменклатуры.ПустаяСсылка) КАК СерияНоменклатуры,
	ЗНАЧЕНИЕ(Справочник.СтраныМира.ПустаяСсылка) КАК Страна,
	"" КАК НомерГТД,
	РеализацияТоваровУслугТовары.КоличествоУпаковок КАК Количество,
	РеализацияТоваровУслугТовары.Сумма КАК Сумма,
	РеализацияТоваровУслугТовары.СуммаНДС,
	"Services" КАК ТипЕдиницы
ИЗ
	Документ.РеализацияТоваров.Товары КАК РеализацияТоваровУслугТовары
ГДЕ
	РеализацияТоваровУслугТовары.Ссылка В(&amp;Ссылка)
	И (НЕ РеализацияТоваровУслугТовары.Номенклатура.ТипНоменклатуры = ЗНАЧЕНИЕ(Перечисление.ТипыНоменклатуры.Услуга)
			ИЛИ &amp;РаботаСУслугами)

//ранее мы учитывали здесь возвраты чтобы очитстить итоговую СФ, теперь на УФ штатно только через COINVOIC
//проблемаа в том что в видах запасов Возврата нет упаковки!!! 

//ОБЪЕДИНИТЬ ВСЕ

//ВЫБРАТЬ
//	0,
//	ВозвратТоваровОтПокупателяТовары.Номенклатура,
//	ВозвратТоваровОтПокупателяТовары.Характеристика,
//	ВЫБОР
//		КОГДА ВозвратТоваровОтПокупателяТовары.Упаковка = ЗНАЧЕНИЕ(Справочник.УпаковкиНоменклатуры.ПустаяСсылка)
//			ТОГДА ВозвратТоваровОтПокупателяТовары.Номенклатура.ЕдиницаИзмерения
//		ИНАЧЕ ВозвратТоваровОтПокупателяТовары.Упаковка
//	КОНЕЦ,
//	ВозвратТоваровОтПокупателяТовары.Номенклатура.Наименование,
//	ВозвратТоваровОтПокупателяТовары.Номенклатура.НаименованиеПолное,
//	ВЫБОР
//		КОГДА ВозвратТоваровОтПокупателяТовары.КоличествоУпаковок = 0
//			ТОГДА 0
//		ИНАЧЕ ВозвратТоваровОтПокупателяТовары.СуммаСНДС / ВозвратТоваровОтПокупателяТовары.КоличествоУпаковок
//	КОНЕЦ,
//	ВозвратТоваровОтПокупателяТовары.СтавкаНДС,
//	ЗНАЧЕНИЕ(Справочник.СерииНоменклатуры.ПустаяСсылка),
//	ВозвратТоваровОтПокупателяТовары.НомерГТД.СтранаПроисхождения,
//	ВозвратТоваровОтПокупателяТовары.НомерГТД.Код,
//	-ВозвратТоваровОтПокупателяТовары.Количество,
//	-ВозвратТоваровОтПокупателяТовары.Сумма,
//	-ВозвратТоваровОтПокупателяТовары.СуммаНДС,
//	ВЫРАЗИТЬ("" КАК СТРОКА(2))
//ИЗ
//	Документ.ВозвратТоваровОтКлиента.ВидыЗапасов КАК ВозвратТоваровОтПокупателяТовары
//ГДЕ
//	ВозвратТоваровОтПокупателяТовары.Ссылка В(&amp;Возвраты)</query>
						<autoFillFields>false</autoFillFields>
					</item>
					<item xsi:type="DataSetQuery">
						<name>РеализацияТоваров_НеПроведен</name>
						<dataSource>ИсточникДанных1</dataSource>
						<query>ВЫБРАТЬ
	РеализацияТоваровУслугТовары.НомерСтроки,
	РеализацияТоваровУслугТовары.Номенклатура КАК Номенклатура,
	РеализацияТоваровУслугТовары.Характеристика КАК ХарактеристикаНоменклатуры,
	ВЫБОР
		КОГДА РеализацияТоваровУслугТовары.Упаковка = ЗНАЧЕНИЕ(Справочник.УпаковкиНоменклатуры.ПустаяСсылка)
			ТОГДА РеализацияТоваровУслугТовары.Номенклатура.ЕдиницаИзмерения
		ИНАЧЕ РеализацияТоваровУслугТовары.Упаковка
	КОНЕЦ КАК ЕдиницаИзмерения,
	ВЫРАЗИТЬ(РеализацияТоваровУслугТовары.Номенклатура.Наименование КАК СТРОКА(178)) КАК Наименование,
	ВЫРАЗИТЬ(РеализацияТоваровУслугТовары.Номенклатура.НаименованиеПолное КАК СТРОКА(500)) КАК НаименованиеПолное,
	РеализацияТоваровУслугТовары.Цена,
	РеализацияТоваровУслугТовары.СтавкаНДС,
	ЗНАЧЕНИЕ(Справочник.СерииНоменклатуры.ПустаяСсылка) КАК СерияНоменклатуры,
	ЗНАЧЕНИЕ(Справочник.СтраныМира.ПустаяСсылка) КАК Страна,
	"" КАК НомерГТД,
	РеализацияТоваровУслугТовары.КоличествоУпаковок КАК Количество,
	РеализацияТоваровУслугТовары.Сумма КАК Сумма,
	РеализацияТоваровУслугТовары.СуммаНДС,
	ВЫБОР
		КОГДА РеализацияТоваровУслугТовары.Номенклатура.ТипНоменклатуры = ЗНАЧЕНИЕ(Перечисление.ТипыНоменклатуры.Услуга)
			ТОГДА "Services"
		ИНАЧЕ ""
	КОНЕЦ КАК ТипЕдиницы
ИЗ
	Документ.РеализацияТоваров.Товары КАК РеализацияТоваровУслугТовары
ГДЕ
	РеализацияТоваровУслугТовары.Ссылка В(&amp;Ссылка)
	И (НЕ РеализацияТоваровУслугТовары.Номенклатура.ТипНоменклатуры = ЗНАЧЕНИЕ(Перечисление.ТипыНоменклатуры.Услуга)
			ИЛИ &amp;РаботаСУслугами)

//ОБЪЕДИНИТЬ ВСЕ

//ВЫБРАТЬ
//	0,
//	ВозвратТоваровОтПокупателяТовары.Номенклатура,
//	ВозвратТоваровОтПокупателяТовары.Характеристика,
//	ВЫБОР
//		КОГДА ВозвратТоваровОтПокупателяТовары.Упаковка = ЗНАЧЕНИЕ(Справочник.УпаковкиНоменклатуры.ПустаяСсылка)
//			ТОГДА ВозвратТоваровОтПокупателяТовары.Номенклатура.ЕдиницаИзмерения
//		ИНАЧЕ ВозвратТоваровОтПокупателяТовары.Упаковка
//	КОНЕЦ,
//	ВозвратТоваровОтПокупателяТовары.Номенклатура.Наименование,
//	ВозвратТоваровОтПокупателяТовары.Номенклатура.НаименованиеПолное,
//	ВозвратТоваровОтПокупателяТовары.Цена,
//	ВозвратТоваровОтПокупателяТовары.СтавкаНДС,
//	ЗНАЧЕНИЕ(Справочник.СерииНоменклатуры.ПустаяСсылка),
//	ЗНАЧЕНИЕ(Справочник.СтраныМира.ПустаяСсылка),
//	"",
//	-ВозвратТоваровОтПокупателяТовары.Количество,
//	-ВозвратТоваровОтПокупателяТовары.Сумма,
//	-ВозвратТоваровОтПокупателяТовары.СуммаНДС,
//	ВЫРАЗИТЬ("" КАК Строка(2))
//ИЗ
//	Документ.ВозвратТоваровОтКлиента.Товары КАК ВозвратТоваровОтПокупателяТовары
//ГДЕ
//	ВозвратТоваровОтПокупателяТовары.Ссылка В(&amp;Возвраты)
</query>
						<autoFillFields>false</autoFillFields>
					</item>
				</item>
				<item xsi:type="DataSetUnion">
					<name>_RETINS_RETREC_</name>
					<field xsi:type="DataSetFieldField">
						<dataPath>СуммаНДС</dataPath>
						<field>СуммаНДС</field>
					</field>
					<field xsi:type="DataSetFieldField">
						<dataPath>НомерСтроки</dataPath>
						<field>НомерСтроки</field>
					</field>
					<field xsi:type="DataSetFieldField">
						<dataPath>Сумма</dataPath>
						<field>Сумма</field>
					</field>
					<field xsi:type="DataSetFieldField">
						<dataPath>Наименование</dataPath>
						<field>Наименование</field>
						<title xsi:type="v8:LocalStringType">
							<v8:item>
								<v8:lang>ru</v8:lang>
								<v8:content>Наименование</v8:content>
							</v8:item>
						</title>
					</field>
					<field xsi:type="DataSetFieldField">
						<dataPath>НаименованиеПолное</dataPath>
						<field>НаименованиеПолное</field>
						<title xsi:type="v8:LocalStringType">
							<v8:item>
								<v8:lang>ru</v8:lang>
								<v8:content>Наименование полное</v8:content>
							</v8:item>
						</title>
					</field>
					<field xsi:type="DataSetFieldField">
						<dataPath>СтавкаНДС</dataPath>
						<field>СтавкаНДС</field>
					</field>
					<field xsi:type="DataSetFieldField">
						<dataPath>ХарактеристикаНоменклатуры</dataPath>
						<field>ХарактеристикаНоменклатуры</field>
						<title xsi:type="v8:LocalStringType">
							<v8:item>
								<v8:lang>ru</v8:lang>
								<v8:content>Характеристика номенклатуры</v8:content>
							</v8:item>
						</title>
					</field>
					<field xsi:type="DataSetFieldField">
						<dataPath>НомерГТД</dataPath>
						<field>НомерГТД</field>
						<title xsi:type="v8:LocalStringType">
							<v8:item>
								<v8:lang>ru</v8:lang>
								<v8:content>Номер ГТД</v8:content>
							</v8:item>
						</title>
					</field>
					<field xsi:type="DataSetFieldField">
						<dataPath>ТипЕдиницы</dataPath>
						<field>ТипЕдиницы</field>
						<title xsi:type="v8:LocalStringType">
							<v8:item>
								<v8:lang>ru</v8:lang>
								<v8:content>Тип единицы</v8:content>
							</v8:item>
						</title>
					</field>
					<field xsi:type="DataSetFieldField">
						<dataPath>Количество</dataPath>
						<field>Количество</field>
					</field>
					<field xsi:type="DataSetFieldField">
						<dataPath>Страна</dataPath>
						<field>Страна</field>
						<title xsi:type="v8:LocalStringType">
							<v8:item>
								<v8:lang>ru</v8:lang>
								<v8:content>Страна</v8:content>
							</v8:item>
						</title>
					</field>
					<field xsi:type="DataSetFieldField">
						<dataPath>ЕдиницаИзмерения</dataPath>
						<field>ЕдиницаИзмерения</field>
						<title xsi:type="v8:LocalStringType">
							<v8:item>
								<v8:lang>ru</v8:lang>
								<v8:content>Единица измерения</v8:content>
							</v8:item>
						</title>
					</field>
					<field xsi:type="DataSetFieldField">
						<dataPath>Номенклатура</dataPath>
						<field>Номенклатура</field>
					</field>
					<field xsi:type="DataSetFieldField">
						<dataPath>Цена</dataPath>
						<field>Цена</field>
					</field>
					<field xsi:type="DataSetFieldField">
						<dataPath>СерияНоменклатуры</dataPath>
						<field>СерияНоменклатуры</field>
						<title xsi:type="v8:LocalStringType">
							<v8:item>
								<v8:lang>ru</v8:lang>
								<v8:content>Серия номенклатуры</v8:content>
							</v8:item>
						</title>
					</field>
					<item xsi:type="DataSetQuery">
						<name>ВозвратТоваровОтПокупателя</name>
						<field xsi:type="DataSetFieldField">
							<dataPath>СуммаНДС</dataPath>
							<field>СуммаНДС</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>НомерСтроки</dataPath>
							<field>НомерСтроки</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>Сумма</dataPath>
							<field>Сумма</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>Наименование</dataPath>
							<field>Наименование</field>
							<title xsi:type="v8:LocalStringType">
								<v8:item>
									<v8:lang>ru</v8:lang>
									<v8:content>Наименование</v8:content>
								</v8:item>
							</title>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>НаименованиеПолное</dataPath>
							<field>НаименованиеПолное</field>
							<title xsi:type="v8:LocalStringType">
								<v8:item>
									<v8:lang>ru</v8:lang>
									<v8:content>Наименование полное</v8:content>
								</v8:item>
							</title>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>СтавкаНДС</dataPath>
							<field>СтавкаНДС</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>ХарактеристикаНоменклатуры</dataPath>
							<field>ХарактеристикаНоменклатуры</field>
							<title xsi:type="v8:LocalStringType">
								<v8:item>
									<v8:lang>ru</v8:lang>
									<v8:content>Характеристика номенклатуры</v8:content>
								</v8:item>
							</title>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>НомерГТД</dataPath>
							<field>НомерГТД</field>
							<title xsi:type="v8:LocalStringType">
								<v8:item>
									<v8:lang>ru</v8:lang>
									<v8:content>Номер ГТД</v8:content>
								</v8:item>
							</title>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>ТипЕдиницы</dataPath>
							<field>ТипЕдиницы</field>
							<title xsi:type="v8:LocalStringType">
								<v8:item>
									<v8:lang>ru</v8:lang>
									<v8:content>Тип единицы</v8:content>
								</v8:item>
							</title>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>Количество</dataPath>
							<field>Количество</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>Страна</dataPath>
							<field>Страна</field>
							<title xsi:type="v8:LocalStringType">
								<v8:item>
									<v8:lang>ru</v8:lang>
									<v8:content>Страна</v8:content>
								</v8:item>
							</title>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>ЕдиницаИзмерения</dataPath>
							<field>ЕдиницаИзмерения</field>
							<title xsi:type="v8:LocalStringType">
								<v8:item>
									<v8:lang>ru</v8:lang>
									<v8:content>Единица измерения</v8:content>
								</v8:item>
							</title>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>Номенклатура</dataPath>
							<field>Номенклатура</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>Цена</dataPath>
							<field>Цена</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>СерияНоменклатуры</dataPath>
							<field>СерияНоменклатуры</field>
							<title xsi:type="v8:LocalStringType">
								<v8:item>
									<v8:lang>ru</v8:lang>
									<v8:content>Серия номенклатуры</v8:content>
								</v8:item>
							</title>
						</field>
						<dataSource>ИсточникДанных1</dataSource>
						<query>ВЫБРАТЬ
	ВозвратТоваровОтКлиентаТовары.НомерСтроки,
	ВозвратТоваровОтКлиентаТовары.Номенклатура,
	ВозвратТоваровОтКлиентаТовары.Характеристика КАК ХарактеристикаНоменклатуры,
	ВЫБОР
		КОГДА ВозвратТоваровОтКлиентаТовары.Упаковка = ЗНАЧЕНИЕ(Справочник.УпаковкиНоменклатуры.ПустаяСсылка)
			ТОГДА ВозвратТоваровОтКлиентаТовары.Номенклатура.ЕдиницаИзмерения
		ИНАЧЕ ВозвратТоваровОтКлиентаТовары.Упаковка
	КОНЕЦ КАК ЕдиницаИзмерения,
	ВЫРАЗИТЬ(ВозвратТоваровОтКлиентаТовары.Номенклатура.Наименование КАК СТРОКА(178)) КАК Наименование,
	ВЫРАЗИТЬ(ВозвратТоваровОтКлиентаТовары.Номенклатура.НаименованиеПолное КАК СТРОКА(500)) КАК НаименованиеПолное,
	ВозвратТоваровОтКлиентаТовары.Цена,
	ВозвратТоваровОтКлиентаТовары.СтавкаНДС,
	Неопределено КАК СерияНоменклатуры,
	Неопределено КАК Страна,
	Неопределено КАК НомерГТД,
	ВозвратТоваровОтКлиентаТовары.КоличествоУпаковок КАК Количество,
	ВозвратТоваровОтКлиентаТовары.Сумма,
	ВозвратТоваровОтКлиентаТовары.СуммаНДС,
	"" КАК ТипЕдиницы
ИЗ
	Документ.ВозвратТоваровОтПокупателя.Товары КАК ВозвратТоваровОтКлиентаТовары
ГДЕ
	ВозвратТоваровОтКлиентаТовары.Ссылка В(&amp;Ссылка)</query>
					</item>
					<item xsi:type="DataSetQuery">
						<name>ПоступлениеТоваров</name>
						<field xsi:type="DataSetFieldField">
							<dataPath>СуммаНДС</dataPath>
							<field>СуммаНДС</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>НомерСтроки</dataPath>
							<field>НомерСтроки</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>Сумма</dataPath>
							<field>Сумма</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>Наименование</dataPath>
							<field>Наименование</field>
							<title xsi:type="v8:LocalStringType">
								<v8:item>
									<v8:lang>ru</v8:lang>
									<v8:content>Наименование</v8:content>
								</v8:item>
							</title>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>НаименованиеПолное</dataPath>
							<field>НаименованиеПолное</field>
							<title xsi:type="v8:LocalStringType">
								<v8:item>
									<v8:lang>ru</v8:lang>
									<v8:content>Наименование полное</v8:content>
								</v8:item>
							</title>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>СтавкаНДС</dataPath>
							<field>СтавкаНДС</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>ХарактеристикаНоменклатуры</dataPath>
							<field>ХарактеристикаНоменклатуры</field>
							<title xsi:type="v8:LocalStringType">
								<v8:item>
									<v8:lang>ru</v8:lang>
									<v8:content>Характеристика номенклатуры</v8:content>
								</v8:item>
							</title>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>НомерГТД</dataPath>
							<field>НомерГТД</field>
							<title xsi:type="v8:LocalStringType">
								<v8:item>
									<v8:lang>ru</v8:lang>
									<v8:content>Номер ГТД</v8:content>
								</v8:item>
							</title>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>ТипЕдиницы</dataPath>
							<field>ТипЕдиницы</field>
							<title xsi:type="v8:LocalStringType">
								<v8:item>
									<v8:lang>ru</v8:lang>
									<v8:content>Тип единицы</v8:content>
								</v8:item>
							</title>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>Количество</dataPath>
							<field>Количество</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>Страна</dataPath>
							<field>Страна</field>
							<title xsi:type="v8:LocalStringType">
								<v8:item>
									<v8:lang>ru</v8:lang>
									<v8:content>Страна</v8:content>
								</v8:item>
							</title>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>ЕдиницаИзмерения</dataPath>
							<field>ЕдиницаИзмерения</field>
							<title xsi:type="v8:LocalStringType">
								<v8:item>
									<v8:lang>ru</v8:lang>
									<v8:content>Единица измерения</v8:content>
								</v8:item>
							</title>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>Номенклатура</dataPath>
							<field>Номенклатура</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>Цена</dataPath>
							<field>Цена</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>СерияНоменклатуры</dataPath>
							<field>СерияНоменклатуры</field>
							<title xsi:type="v8:LocalStringType">
								<v8:item>
									<v8:lang>ru</v8:lang>
									<v8:content>Серия номенклатуры</v8:content>
								</v8:item>
							</title>
						</field>
						<dataSource>ИсточникДанных1</dataSource>
						<query>ВЫБРАТЬ
	ПоступлениеТоваровУслугТовары.НомерСтроки,
	ПоступлениеТоваровУслугТовары.Номенклатура,
	ПоступлениеТоваровУслугТовары.Характеристика КАК ХарактеристикаНоменклатуры,
	ВЫБОР
		КОГДА ПоступлениеТоваровУслугТовары.Упаковка = ЗНАЧЕНИЕ(Справочник.УпаковкиНоменклатуры.ПустаяСсылка)
			ТОГДА ПоступлениеТоваровУслугТовары.Номенклатура.ЕдиницаИзмерения
		ИНАЧЕ ПоступлениеТоваровУслугТовары.Упаковка
	КОНЕЦ КАК ЕдиницаИзмерения,
	ВЫРАЗИТЬ(ПоступлениеТоваровУслугТовары.Номенклатура.Наименование КАК СТРОКА(178)) КАК Наименование,
	ВЫРАЗИТЬ(ПоступлениеТоваровУслугТовары.Номенклатура.НаименованиеПолное КАК СТРОКА(500)) КАК НаименованиеПолное,
	ПоступлениеТоваровУслугТовары.Цена,
	ПоступлениеТоваровУслугТовары.СтавкаНДС,
	Неопределено КАК СерияНоменклатуры,
	Неопределено КАК Страна,
	Неопределено КАК НомерГТД,
	ПоступлениеТоваровУслугТовары.КоличествоУпаковок КАК Количество,
	ПоступлениеТоваровУслугТовары.Сумма,
	ПоступлениеТоваровУслугТовары.СуммаНДС,
	"" КАК ТипЕдиницы
ИЗ
	Документ.ПоступлениеТоваров.Товары КАК ПоступлениеТоваровУслугТовары
ГДЕ
	ПоступлениеТоваровУслугТовары.Ссылка В(&amp;Ссылка)</query>
					</item>
				</item>
				<item xsi:type="DataSetUnion">
					<name>_PRICELIST_</name>
					<field xsi:type="DataSetFieldField">
						<dataPath>GTIN</dataPath>
						<field>GTIN</field>
					</field>
					<field xsi:type="DataSetFieldField">
						<dataPath>ЕдИзмСрокаГодности</dataPath>
						<field>ЕдИзмСрокаГодности</field>
					</field>
					<field xsi:type="DataSetFieldField">
						<dataPath>ЕдиницаИзмерения</dataPath>
						<field>ЕдиницаИзмерения</field>
					</field>
					<field xsi:type="DataSetFieldField">
						<dataPath>КвантПоставки</dataPath>
						<field>КвантПоставки</field>
					</field>
					<field xsi:type="DataSetFieldField">
						<dataPath>КодТовараПоставщика</dataPath>
						<field>КодТовараПоставщика</field>
					</field>
					<field xsi:type="DataSetFieldField">
						<dataPath>КоличествоВОдномМесте</dataPath>
						<field>КоличествоВОдномМесте</field>
					</field>
					<field xsi:type="DataSetFieldField">
						<dataPath>Наименование</dataPath>
						<field>Наименование</field>
					</field>
					<field xsi:type="DataSetFieldField">
						<dataPath>Номенклатура</dataPath>
						<field>Номенклатура</field>
					</field>
					<field xsi:type="DataSetFieldField">
						<dataPath>Родитель</dataPath>
						<field>Родитель</field>
					</field>
					<field xsi:type="DataSetFieldField">
						<dataPath>СрокГодности</dataPath>
						<field>СрокГодности</field>
					</field>
					<field xsi:type="DataSetFieldField">
						<dataPath>СтавкаНДС</dataPath>
						<field>СтавкаНДС</field>
					</field>
					<field xsi:type="DataSetFieldField">
						<dataPath>Страна</dataPath>
						<field>Страна</field>
					</field>
					<field xsi:type="DataSetFieldField">
						<dataPath>Цена</dataPath>
						<field>Цена</field>
					</field>
					<item xsi:type="DataSetQuery">
						<name>Ценовой_лист_БезЦен</name>
						<field xsi:type="DataSetFieldField">
							<dataPath>GTIN</dataPath>
							<field>GTIN</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>ЕдИзмСрокаГодности</dataPath>
							<field>ЕдИзмСрокаГодности</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>ЕдиницаИзмерения</dataPath>
							<field>ЕдиницаИзмерения</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>КвантПоставки</dataPath>
							<field>КвантПоставки</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>КодТовараПоставщика</dataPath>
							<field>КодТовараПоставщика</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>КоличествоВОдномМесте</dataPath>
							<field>КоличествоВОдномМесте</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>Наименование</dataPath>
							<field>Наименование</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>Номенклатура</dataPath>
							<field>Номенклатура</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>Родитель</dataPath>
							<field>Родитель</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>СрокГодности</dataPath>
							<field>СрокГодности</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>СтавкаНДС</dataPath>
							<field>СтавкаНДС</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>Страна</dataPath>
							<field>Страна</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>Цена</dataPath>
							<field>Цена</field>
						</field>
						<dataSource>ИсточникДанных1</dataSource>
						<query>ВЫБРАТЬ
	СправочникНоменклатура.Родитель КАК Родитель,
	СправочникНоменклатура.Ссылка КАК Номенклатура,
	СправочникНоменклатура.ЕдиницаИзмерения КАК ЕдиницаИзмерения,
	СправочникНоменклатура.Код КАК КодТовараПоставщика,
	СправочникНоменклатура.НаименованиеПолное КАК Наименование,
	СправочникНоменклатура.СтавкаНДС КАК СтавкаНДС,
	0 КАК Цена,
	0 КАК РекомендуемаяРозничнаяЦена,
	Штрихкоды.Штрихкод КАК GTIN,
	NULL КАК КоличествоВОдномМесте,
	ЗНАЧЕНИЕ(Справочник.СтраныМира.ПустаяСсылка) КАК Страна,
	NULL КАК КвантПоставки,
	NULL КАК ЕдИзмСрокаГодности,
	NULL КАК СрокГодности
ИЗ
	Справочник.Номенклатура КАК СправочникНоменклатура
		ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.Штрихкоды КАК Штрихкоды
		ПО СправочникНоменклатура.Ссылка = Штрихкоды.Владелец
			И (Штрихкоды.Упаковка = СправочникНоменклатура.ЕдиницаИзмерения)
			И (Штрихкоды.Характеристика = ЗНАЧЕНИЕ(Справочник.ХарактеристикиНоменклатуры.ПустаяСсылка))
ГДЕ
	НЕ СправочникНоменклатура.ЭтоГруппа
	И НЕ СправочникНоменклатура.ПометкаУдаления
	И НЕ СправочникНоменклатура.ТипНоменклатуры = ЗНАЧЕНИЕ(Перечисление.ТипыНоменклатуры.Услуга)
	И &amp;УсловиеОтбораНоменклатуры</query>
					</item>
					<item xsi:type="DataSetQuery">
						<name>Ценовой_лист_СЦенами</name>
						<field xsi:type="DataSetFieldField">
							<dataPath>GTIN</dataPath>
							<field>GTIN</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>ЕдИзмСрокаГодности</dataPath>
							<field>ЕдИзмСрокаГодности</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>ЕдиницаИзмерения</dataPath>
							<field>ЕдиницаИзмерения</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>КвантПоставки</dataPath>
							<field>КвантПоставки</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>КодТовараПоставщика</dataPath>
							<field>КодТовараПоставщика</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>КоличествоВОдномМесте</dataPath>
							<field>КоличествоВОдномМесте</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>Наименование</dataPath>
							<field>Наименование</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>Номенклатура</dataPath>
							<field>Номенклатура</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>Родитель</dataPath>
							<field>Родитель</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>СрокГодности</dataPath>
							<field>СрокГодности</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>СтавкаНДС</dataPath>
							<field>СтавкаНДС</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>Страна</dataPath>
							<field>Страна</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>Цена</dataPath>
							<field>Цена</field>
						</field>
						<dataSource>ИсточникДанных1</dataSource>
						<query>ВЫБРАТЬ
	ЦеныНоменклатурыСрезПоследних.Номенклатура.Родитель КАК Родитель,
	ЦеныНоменклатурыСрезПоследних.Номенклатура.Ссылка КАК Номенклатура,
	ВЫБОР
		КОГДА ЦеныНоменклатурыСрезПоследних.Упаковка = ЗНАЧЕНИЕ(Справочник.УпаковкиНоменклатуры.ПустаяСсылка)
			ТОГДА ЦеныНоменклатурыСрезПоследних.Номенклатура.ЕдиницаИзмерения
		ИНАЧЕ ЦеныНоменклатурыСрезПоследних.Упаковка
	КОНЕЦ КАК ЕдиницаИзмерения,
	ЦеныНоменклатурыСрезПоследних.Номенклатура.Код КАК КодТовараПоставщика,
	ЦеныНоменклатурыСрезПоследних.Номенклатура.НаименованиеПолное КАК Наименование,
	ЦеныНоменклатурыСрезПоследних.Номенклатура.СтавкаНДС КАК СтавкаНДС,
	ЦеныНоменклатурыСрезПоследних.Цена,
	0 КАК РекомендуемаяРозничнаяЦена,
	Штрихкоды.Штрихкод КАК GTIN,
	ЦеныНоменклатурыСрезПоследних.Упаковка.Коэффициент КАК КоличествоВОдномМесте,
	ЗНАЧЕНИЕ(Справочник.СтраныМира.ПустаяСсылка) КАК Страна,
	NULL КАК КвантПоставки,
	NULL КАК ЕдИзмСрокаГодности,
	NULL КАК СрокГодности
ИЗ
	РегистрСведений.ЦеныНоменклатуры.СрезПоследних(
			,
			ВидЦены = &amp;ТипЦен
				И НЕ Номенклатура.ПометкаУдаления
				И НЕ Номенклатура.ТипНоменклатуры = ЗНАЧЕНИЕ(Перечисление.ТипыНоменклатуры.Услуга)
				И &amp;УсловиеОтбораНоменклатуры) КАК ЦеныНоменклатурыСрезПоследних
		ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.Штрихкоды КАК Штрихкоды
		ПО ЦеныНоменклатурыСрезПоследних.Номенклатура = Штрихкоды.Владелец
			И (Штрихкоды.Упаковка = ЦеныНоменклатурыСрезПоследних.Упаковка)
ГДЕ
	ЦеныНоменклатурыСрезПоследних.Цена &gt; 0</query>
					</item>
					<item xsi:type="DataSetQuery">
						<name>Ценовой_лист_БезЦен_Остатки</name>
						<field xsi:type="DataSetFieldField">
							<dataPath>GTIN</dataPath>
							<field>GTIN</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>ЕдИзмСрокаГодности</dataPath>
							<field>ЕдИзмСрокаГодности</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>ЕдиницаИзмерения</dataPath>
							<field>ЕдиницаИзмерения</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>КвантПоставки</dataPath>
							<field>КвантПоставки</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>КодТовараПоставщика</dataPath>
							<field>КодТовараПоставщика</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>КоличествоВОдномМесте</dataPath>
							<field>КоличествоВОдномМесте</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>Наименование</dataPath>
							<field>Наименование</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>Номенклатура</dataPath>
							<field>Номенклатура</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>Родитель</dataPath>
							<field>Родитель</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>СрокГодности</dataPath>
							<field>СрокГодности</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>СтавкаНДС</dataPath>
							<field>СтавкаНДС</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>Страна</dataPath>
							<field>Страна</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>Цена</dataPath>
							<field>Цена</field>
						</field>
						<dataSource>ИсточникДанных1</dataSource>
						<query>ВЫБРАТЬ
	СправочникНоменклатура.Родитель КАК Родитель,
	СправочникНоменклатура.Ссылка КАК Номенклатура,
	СправочникНоменклатура.ЕдиницаИзмерения КАК ЕдиницаИзмерения,
	СправочникНоменклатура.Код КАК КодТовараПоставщика,
	СправочникНоменклатура.НаименованиеПолное КАК Наименование,
	СправочникНоменклатура.СтавкаНДС КАК СтавкаНДС,
	0 КАК Цена,
	0 КАК РекомендуемаяРозничнаяЦена,
	Штрихкоды.Штрихкод КАК GTIN,
	NULL КАК КоличествоВОдномМесте,
	ЗНАЧЕНИЕ(Справочник.СтраныМира.ПустаяСсылка) КАК Страна,
	NULL КАК КвантПоставки,
	NULL КАК ЕдИзмСрокаГодности,
	NULL КАК СрокГодности,
	ЕСТЬNULL(ТоварыНаСкладахОстатки.КоличествоОстаток, 0) КАК КоличествоОстаткаНаКонец
ИЗ
	Справочник.Номенклатура КАК СправочникНоменклатура
		ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.Штрихкоды КАК Штрихкоды
		ПО СправочникНоменклатура.Ссылка = Штрихкоды.Владелец
			И (Штрихкоды.Упаковка = СправочникНоменклатура.ЕдиницаИзмерения)
			И (Штрихкоды.Характеристика = ЗНАЧЕНИЕ(Справочник.ХарактеристикиНоменклатуры.ПустаяСсылка))
		ЛЕВОЕ СОЕДИНЕНИЕ РегистрНакопления.ТоварыНаСкладах.Остатки(
				,
				ВЫБОР
					КОГДА &amp;Склад = НЕОПРЕДЕЛЕНО
						ТОГДА ИСТИНА
					ИНАЧЕ Склад В (&amp;Склад)
				КОНЕЦ) КАК ТоварыНаСкладахОстатки
		ПО СправочникНоменклатура.Ссылка = ТоварыНаСкладахОстатки.Номенклатура
ГДЕ
	НЕ СправочникНоменклатура.ЭтоГруппа
	И НЕ СправочникНоменклатура.ПометкаУдаления
	И НЕ СправочникНоменклатура.ТипНоменклатуры = ЗНАЧЕНИЕ(Перечисление.ТипыНоменклатуры.Услуга)
	И &amp;УсловиеОтбораНоменклатуры</query>
					</item>
					<item xsi:type="DataSetQuery">
						<name>Ценовой_лист_СЦенами_Остатки</name>
						<field xsi:type="DataSetFieldField">
							<dataPath>GTIN</dataPath>
							<field>GTIN</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>ЕдИзмСрокаГодности</dataPath>
							<field>ЕдИзмСрокаГодности</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>ЕдиницаИзмерения</dataPath>
							<field>ЕдиницаИзмерения</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>КвантПоставки</dataPath>
							<field>КвантПоставки</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>КодТовараПоставщика</dataPath>
							<field>КодТовараПоставщика</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>КоличествоВОдномМесте</dataPath>
							<field>КоличествоВОдномМесте</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>Наименование</dataPath>
							<field>Наименование</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>Номенклатура</dataPath>
							<field>Номенклатура</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>Родитель</dataPath>
							<field>Родитель</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>СрокГодности</dataPath>
							<field>СрокГодности</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>СтавкаНДС</dataPath>
							<field>СтавкаНДС</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>Страна</dataPath>
							<field>Страна</field>
						</field>
						<field xsi:type="DataSetFieldField">
							<dataPath>Цена</dataPath>
							<field>Цена</field>
						</field>
						<dataSource>ИсточникДанных1</dataSource>
						<query>ВЫБРАТЬ
	ЦеныНоменклатурыСрезПоследних.Номенклатура.Родитель КАК Родитель,
	ЦеныНоменклатурыСрезПоследних.Номенклатура.Ссылка КАК Номенклатура,
	ВЫБОР
		КОГДА ЦеныНоменклатурыСрезПоследних.Упаковка = ЗНАЧЕНИЕ(Справочник.УпаковкиНоменклатуры.ПустаяСсылка)
			ТОГДА ЦеныНоменклатурыСрезПоследних.Номенклатура.ЕдиницаИзмерения
		ИНАЧЕ ЦеныНоменклатурыСрезПоследних.Упаковка
	КОНЕЦ КАК ЕдиницаИзмерения,
	ЦеныНоменклатурыСрезПоследних.Номенклатура.Код КАК КодТовараПоставщика,
	ЦеныНоменклатурыСрезПоследних.Номенклатура.НаименованиеПолное КАК Наименование,
	ЦеныНоменклатурыСрезПоследних.Номенклатура.СтавкаНДС КАК СтавкаНДС,
	ЦеныНоменклатурыСрезПоследних.Цена,
	0 КАК РекомендуемаяРозничнаяЦена,
	Штрихкоды.Штрихкод КАК GTIN,
	ЦеныНоменклатурыСрезПоследних.Упаковка.Коэффициент КАК КоличествоВОдномМесте,
	ЗНАЧЕНИЕ(Справочник.СтраныМира.ПустаяСсылка) КАК Страна,
	NULL КАК КвантПоставки,
	NULL КАК ЕдИзмСрокаГодности,
	NULL КАК СрокГодности,
	ЕСТЬNULL(ТоварыНаСкладахОстатки.КоличествоОстаток, 0) КАК КоличествоОстаткаНаКонец
ИЗ
	РегистрСведений.ЦеныНоменклатуры.СрезПоследних(
			,
			ВидЦены = &amp;ТипЦен
				И НЕ Номенклатура.ПометкаУдаления
				И НЕ Номенклатура.ТипНоменклатуры = ЗНАЧЕНИЕ(Перечисление.ТипыНоменклатуры.Услуга)
				И &amp;УсловиеОтбораНоменклатуры) КАК ЦеныНоменклатурыСрезПоследних
		ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.Штрихкоды КАК Штрихкоды
		ПО ЦеныНоменклатурыСрезПоследних.Номенклатура = Штрихкоды.Владелец
			И (Штрихкоды.Упаковка = ЦеныНоменклатурыСрезПоследних.Упаковка)
		ЛЕВОЕ СОЕДИНЕНИЕ РегистрНакопления.ТоварыНаСкладах.Остатки(
				,
				ВЫБОР
					КОГДА &amp;Склад = НЕОПРЕДЕЛЕНО
						ТОГДА ИСТИНА
					ИНАЧЕ Склад В (&amp;Склад)
				КОНЕЦ) КАК ТоварыНаСкладахОстатки
		ПО ЦеныНоменклатурыСрезПоследних.Номенклатура = ТоварыНаСкладахОстатки.Номенклатура
ГДЕ
	ЦеныНоменклатурыСрезПоследних.Цена &gt; 0</query>
					</item>
				</item>
			</item>
		</item>
		<item xsi:type="DataSetUnion">
			<name>Покупатель</name>
			<item xsi:type="DataSetUnion">
				<name>ЗапросОсновнойЦепочки</name>
				<item xsi:type="DataSetQuery">
					<name>Заказ_Поступление_СФ</name>
					<dataSource>ИсточникДанных1</dataSource>
					<query>ВЫБРАТЬ
	докЗаказПоставщику.Ссылка КАК PORDERS,
	докЗаказПоставщику.Ссылка КАК ORDERS,
	докЗаказПоставщику.Ссылка КАК ORDRSP,
	докПоступлениеТоваровУслуг.Ссылка КАК DESADV,
	докПоступлениеТоваровУслуг.Ссылка КАК RECADV,
	СчетФактураПолученныйДокументыОснования.Ссылка КАК INVOIC
ИЗ
	(ВЫБРАТЬ
		1 КАК Поле1) КАК Заглушка
		{ПОЛНОЕ СОЕДИНЕНИЕ Документ.СчетФактураПолученный.ДокументыОснования КАК СчетФактураПолученныйДокументыОснования
			{ПОЛНОЕ СОЕДИНЕНИЕ Документ.ПоступлениеТоваров КАК докПоступлениеТоваровУслуг
				{ПОЛНОЕ СОЕДИНЕНИЕ Документ.ЗаказПоставщику КАК докЗаказПоставщику
				ПО (докПоступлениеТоваровУслуг.ЗаказПоставщику = докЗаказПоставщику.Ссылка)}
			ПО (СчетФактураПолученныйДокументыОснования.ДокументОснование = докПоступлениеТоваровУслуг.Ссылка)}
		ПО (ИСТИНА)}</query>
					<autoFillFields>false</autoFillFields>
				</item>
			</item>
			<item xsi:type="DataSetQuery">
				<name>КонвертироватьТовары1СВEDIВ_GTIN</name>
				<dataSource>ИсточникДанных1</dataSource>
				<query>ВЫБРАТЬ РАЗЛИЧНЫЕ
	ТабТоваров.Номенклатура,
	ТабТоваров.ХарактеристикаНоменклатуры,
	ТабТоваров.ЕдиницаИзмерения,
	ТабТоваров.Номенклатура.Код КАК КодТовараСвой,
	ВЫРАЗИТЬ(Штрихкоды.Штрихкод КАК СТРОКА(14)) КАК GTIN
ПОМЕСТИТЬ ВТШтрихкодыТоваров
ИЗ
	ТабТоваров КАК ТабТоваров
		ВНУТРЕННЕЕ СОЕДИНЕНИЕ РегистрСведений.Штрихкоды КАК Штрихкоды
		ПО ТабТоваров.Номенклатура = Штрихкоды.Владелец
			И ТабТоваров.ХарактеристикаНоменклатуры = Штрихкоды.Характеристика
			И ТабТоваров.ЕдиницаИзмерения = Штрихкоды.Упаковка
ГДЕ
	&amp;ИскатьТоварПоШК

ИНДЕКСИРОВАТЬ ПО
	ТабТоваров.Номенклатура,
	ТабТоваров.ХарактеристикаНоменклатуры,
	ТабТоваров.ЕдиницаИзмерения</query>
				<autoFillFields>false</autoFillFields>
			</item>
			<item xsi:type="DataSetUnion">
				<name>ЗапросПоТоварам</name>
				<item xsi:type="DataSetUnion">
					<name>_ORDERS_</name>
					<item xsi:type="DataSetQuery">
						<name>ЗаказПоставщику</name>
						<dataSource>ИсточникДанных1</dataSource>
						<query>ВЫБРАТЬ
	ЗаказПоставщикуТовары.Номенклатура.Код КАК КодТовараПокупателя,
	ЗаказПоставщикуТовары.Номенклатура,
	ЗаказПоставщикуТовары.Характеристика КАК ХарактеристикаНоменклатуры,
	ВЫБОР
		КОГДА ЗаказПоставщикуТовары.Упаковка = ЗНАЧЕНИЕ(Справочник.УпаковкиНоменклатуры.ПустаяСсылка)
			ТОГДА ЗаказПоставщикуТовары.Номенклатура.ЕдиницаИзмерения
		ИНАЧЕ ЗаказПоставщикуТовары.Упаковка
	КОНЕЦ КАК ЕдиницаИзмерения,
	ВЫРАЗИТЬ(ЗаказПоставщикуТовары.Номенклатура.Наименование КАК СТРОКА(178)) КАК Наименование,
	ЗаказПоставщикуТовары.Цена,
	ЗаказПоставщикуТовары.СтавкаНДС,
	СУММА(ЗаказПоставщикуТовары.КоличествоУпаковок) КАК Количество,
	СУММА(ЗаказПоставщикуТовары.Сумма) КАК Сумма,
	СУММА(ЗаказПоставщикуТовары.СуммаНДС) КАК СуммаНДС
ИЗ
	Документ.ЗаказПоставщику.Товары КАК ЗаказПоставщикуТовары
ГДЕ
	ЗаказПоставщикуТовары.Ссылка = &amp;Ссылка
	
СГРУППИРОВАТЬ ПО
	ЗаказПоставщикуТовары.Номенклатура,
	ЗаказПоставщикуТовары.Характеристика,
	ЗаказПоставщикуТовары.Цена,
	ВЫРАЗИТЬ(ЗаказПоставщикуТовары.Номенклатура.Наименование КАК СТРОКА(178)),
	ЗаказПоставщикуТовары.СтавкаНДС,
	ЗаказПоставщикуТовары.Номенклатура.Код,
	ВЫБОР
		КОГДА ЗаказПоставщикуТовары.Упаковка = ЗНАЧЕНИЕ(Справочник.УпаковкиНоменклатуры.ПустаяСсылка)
			ТОГДА ЗаказПоставщикуТовары.Номенклатура.ЕдиницаИзмерения
		ИНАЧЕ ЗаказПоставщикуТовары.Упаковка
	КОНЕЦ</query>
						<autoFillFields>false</autoFillFields>
					</item>
				</item>
				<item xsi:type="DataSetUnion">
					<name>_RECADV_</name>
					<item xsi:type="DataSetQuery">
						<name>ПоступлениеТоваров</name>
						<dataSource>ИсточникДанных1</dataSource>
						<query>ВЫБРАТЬ
	ПоступлениеТоваровУслугТовары.Номенклатура,
	ПоступлениеТоваровУслугТовары.Характеристика КАК ХарактеристикаНоменклатуры,
	ВЫБОР
		КОГДА ПоступлениеТоваровУслугТовары.Упаковка = ЗНАЧЕНИЕ(Справочник.УпаковкиНоменклатуры.ПустаяСсылка)
			ТОГДА ПоступлениеТоваровУслугТовары.Номенклатура.ЕдиницаИзмерения
		ИНАЧЕ ПоступлениеТоваровУслугТовары.Упаковка
	КОНЕЦ КАК ЕдиницаИзмерения,
	ВЫРАЗИТЬ(ПоступлениеТоваровУслугТовары.Номенклатура.Наименование КАК СТРОКА(178)) КАК Наименование,
	ПоступлениеТоваровУслугТовары.КоличествоУпаковок КАК Количество,
	ПоступлениеТоваровУслугТовары.Цена,
	ПоступлениеТоваровУслугТовары.СтавкаНДС,
	ПоступлениеТоваровУслугТовары.Сумма,
	ПоступлениеТоваровУслугТовары.СуммаНДС
ИЗ
	Документ.ПоступлениеТоваров.Товары КАК ПоступлениеТоваровУслугТовары
ГДЕ
	ПоступлениеТоваровУслугТовары.Ссылка = &amp;Ссылка</query>
						<autoFillFields>false</autoFillFields>
					</item>
				</item>
			</item>
			<item xsi:type="DataSetQuery">
				<name>КонвертироватьТоварыEDIВ1С</name>
				<dataSource>ИсточникДанных1</dataSource>
				<query>ВЫБРАТЬ
	ТабТоваров.GTIN КАК GTIN,
	ТабТоваров.КодТовараСторонний КАК КодТовараСторонний,
	ТабТоваров.КодТовараСвой КАК КодТовараСвой,
	ТабСоответствий_КонтурEDI.Номенклатура КАК Номенклатура,
	ТабСоответствий_КонтурEDI.ХарактеристикаНоменклатуры КАК ХарактеристикаНоменклатуры,
	ТабСоответствий_КонтурEDI.ЕдиницаИзмерения КАК ЕдиницаИзмерения,
	ТабСоответствий_КонтурEDI.ТипЕдиницы КАК ТипЕдиницы,
	4 КАК Приоритет
ПОМЕСТИТЬ ВТ_НайденныеСоответствия
ИЗ
	ТабТоваров КАК ТабТоваров
		ВНУТРЕННЕЕ СОЕДИНЕНИЕ ТабСоответствий_КонтурEDI КАК ТабСоответствий_КонтурEDI
		ПО ТабТоваров.GTIN = ТабСоответствий_КонтурEDI.GTIN
			И ТабТоваров.КодТовараСторонний = ТабСоответствий_КонтурEDI.КодТовараСторонний
			И ТабТоваров.КодТовараСвой = ТабСоответствий_КонтурEDI.КодТовараСвой

ОБЪЕДИНИТЬ ВСЕ

ВЫБРАТЬ
	ТабТоваров.GTIN,
	ТабТоваров.КодТовараСторонний,
	ТабТоваров.КодТовараСвой,
	Штрихкоды.Владелец,
	Штрихкоды.Характеристика,
	Штрихкоды.Упаковка,
	ВЫРАЗИТЬ("" КАК СТРОКА(20)),
	3
ИЗ
	ТабТоваров КАК ТабТоваров
		ВНУТРЕННЕЕ СОЕДИНЕНИЕ РегистрСведений.Штрихкоды КАК Штрихкоды
		ПО (ТабТоваров.GTIN = Штрихкоды.Штрихкод)
			
ГДЕ
	(НЕ ТабТоваров.GTIN = "")

ОБЪЕДИНИТЬ ВСЕ

ВЫБРАТЬ
	ТабТоваров.GTIN,
	ТабТоваров.КодТовараСторонний,
	ТабТоваров.КодТовараСвой,
	Штрихкоды.Владелец,
	Штрихкоды.Характеристика,
	Штрихкоды.Упаковка,
	ВЫРАЗИТЬ("" КАК СТРОКА(20)),
	2
ИЗ
	ТабТоваров КАК ТабТоваров
		ВНУТРЕННЕЕ СОЕДИНЕНИЕ РегистрСведений.Штрихкоды КАК Штрихкоды
		ПО (ПОДСТРОКА(ТабТоваров.GTIN, 2, 13) = Штрихкоды.Штрихкод)
			
ГДЕ
	(НЕ ТабТоваров.GTIN = "")
	
ОБЪЕДИНИТЬ ВСЕ

ВЫБРАТЬ
	ТабТоваров.GTIN,
	ТабТоваров.КодТовараСторонний,
	ТабТоваров.КодТовараСвой,
	СправочникНоменклатура.Ссылка,
	НЕОПРЕДЕЛЕНО,
	СправочникНоменклатура.ЕдиницаИзмерения,
	ВЫРАЗИТЬ("" КАК СТРОКА(20)),
	1
ИЗ
	ТабТоваров КАК ТабТоваров
		ВНУТРЕННЕЕ СОЕДИНЕНИЕ Справочник.Номенклатура КАК СправочникНоменклатура
		ПО ТабТоваров.КодТовараСвой = СправочникНоменклатура.Код
ГДЕ
	(НЕ ТабТоваров.КодТовараСвой = "")
</query>
				<autoFillFields>false</autoFillFields>
			</item>
		</item>
	</dataSet>
	<dataSet xsi:type="DataSetUnion">
		<name>ДалионТРЕНД</name>
		<item xsi:type="DataSetUnion">
			<name>Покупатель</name>
			<item xsi:type="DataSetUnion">
				<name>ЗапросОсновнойЦепочки</name>
				<item xsi:type="DataSetQuery">
					<name>Заказ_Поступление_СФ</name>
					<dataSource>ИсточникДанных1</dataSource>
					<query>ВЫБРАТЬ
	Заказ.Ссылка КАК PORDERS,
	Заказ.Ссылка КАК ORDERS,
	Заказ.Ссылка КАК ORDRSP,
	ПриходнаяНакладная.Ссылка КАК RECADV,
	ПриходнаяНакладная.Ссылка КАК DESADV,
	ПриходнаяНакладная.Ссылка КАК INVOIC
ИЗ
	(ВЫБРАТЬ
		1 КАК Поле1) КАК Заглушка
		{ПОЛНОЕ СОЕДИНЕНИЕ Документ.ПриходнаяНакладная КАК ПриходнаяНакладная
			{ПОЛНОЕ СОЕДИНЕНИЕ Документ.ЗаказТоваров КАК Заказ
			ПО ПриходнаяНакладная.ЗаказТоваров = Заказ.Ссылка}
		ПО (ИСТИНА)}</query>
					<autoFillFields>false</autoFillFields>
				</item>
			</item>
			<item xsi:type="DataSetUnion">
				<name>ЗапросПоТоварам</name>
				<item xsi:type="DataSetUnion">
					<name>_ORDERS_</name>
					<item xsi:type="DataSetQuery">
						<name>ЗаказТоваров</name>
						<dataSource>ИсточникДанных1</dataSource>
						<query>ВЫБРАТЬ
	ЗаказПоставщикуТовары.Номенклатура.Код КАК КодТовараПокупателя,
	ЗаказПоставщикуТовары.Номенклатура,
	ЗаказПоставщикуТовары.ХарактеристикаНоменклатуры,
//	ЗаказПоставщикуТовары.ЕдиницаИзмерения КАК ЕдиницаИзмерения,
//	ЗаказПоставщикуТовары.ЕдиницаИзмерения.ЕдиницаИзмеренияПоКлассификатору.Наименование КАК КодЕдиницыИзмерения,
	ЗаказПоставщикуТовары.Номенклатура.ЕдиницаИзмерения КАК ЕдиницаИзмерения,
	ЗаказПоставщикуТовары.Номенклатура.ЕдиницаИзмерения.Код КАК КодЕдиницыИзмерения,
	ВЫРАЗИТЬ(ЗаказПоставщикуТовары.Номенклатура.Наименование КАК СТРОКА(178)) КАК Наименование,
	ЗаказПоставщикуТовары.Цена,
	ЗаказПоставщикуТовары.СтавкаНДС,
	СУММА(ЗаказПоставщикуТовары.Количество) КАК Количество,
	СУММА(ЗаказПоставщикуТовары.Сумма) КАК Сумма,
	СУММА(ЗаказПоставщикуТовары.СуммаНДС) КАК СуммаНДС
ИЗ
	Документ.ЗаказТоваров.Товары КАК ЗаказПоставщикуТовары
ГДЕ
	ЗаказПоставщикуТовары.Ссылка = &amp;Ссылка

СГРУППИРОВАТЬ ПО
	ЗаказПоставщикуТовары.Номенклатура,
	ЗаказПоставщикуТовары.ХарактеристикаНоменклатуры,
	ЗаказПоставщикуТовары.ЕдиницаИзмерения,
	ЗаказПоставщикуТовары.Цена,
	ВЫРАЗИТЬ(ЗаказПоставщикуТовары.Номенклатура.Наименование КАК СТРОКА(178)),
	ЗаказПоставщикуТовары.СтавкаНДС,
	ЗаказПоставщикуТовары.Номенклатура.Код</query>
						<autoFillFields>false</autoFillFields>
					</item>
				</item>
				<item xsi:type="DataSetUnion">
					<name>_RECADV_</name>
					<item xsi:type="DataSetQuery">
						<name>ПриходнаяНакладная</name>
						<dataSource>ИсточникДанных1</dataSource>
						<query>ВЫБРАТЬ
	ПриходнаяНакладная.Номенклатура,
	ПриходнаяНакладная.ХарактеристикаНоменклатуры,
	ПриходнаяНакладная.Номенклатура.ЕдиницаИзмерения КАК ЕдиницаИзмерения,
	ПриходнаяНакладная.Номенклатура.ЕдиницаИзмерения.Код КАК КодЕдиницыИзмерения,
	ВЫРАЗИТЬ(ПриходнаяНакладная.Номенклатура.Наименование КАК СТРОКА(178)) КАК Наименование,
	ПриходнаяНакладная.КоличествоЕдиницИзмерения КАК Количество,
	//ПриходнаяНакладная.Количество КАК Количество,	
	ПриходнаяНакладная.Цена,
	ПриходнаяНакладная.СтавкаНДС,
	ПриходнаяНакладная.Сумма,
	ПриходнаяНакладная.СуммаНДС
ИЗ
	Документ.ПриходнаяНакладная.Товары КАК ПриходнаяНакладная
ГДЕ
	ПриходнаяНакладная.Ссылка = &amp;Ссылка
</query>
						<autoFillFields>false</autoFillFields>
					</item>
				</item>
			</item>
			<item xsi:type="DataSetQuery">
				<name>КонвертироватьТоварыEDIВ1С</name>
				<dataSource>ИсточникДанных1</dataSource>
				<query>ВЫБРАТЬ
	ТабТоваров.GTIN КАК GTIN,
	ТабТоваров.КодТовараСторонний КАК КодТовараСторонний,
	ТабТоваров.КодТовараСвой КАК КодТовараСвой,
	ТабСоответствий_КонтурEDI.Номенклатура КАК Номенклатура,
	ТабСоответствий_КонтурEDI.ХарактеристикаНоменклатуры КАК ХарактеристикаНоменклатуры,
	ТабСоответствий_КонтурEDI.ЕдиницаИзмерения КАК ЕдиницаИзмерения,
	ТабСоответствий_КонтурEDI.ТипЕдиницы КАК ТипЕдиницы,
	4 КАК Приоритет
ПОМЕСТИТЬ ВТ_НайденныеСоответствия
ИЗ
	ТабТоваров КАК ТабТоваров
		ВНУТРЕННЕЕ СОЕДИНЕНИЕ ТабСоответствий_КонтурEDI КАК ТабСоответствий_КонтурEDI
		ПО ТабТоваров.GTIN = ТабСоответствий_КонтурEDI.GTIN
			И ТабТоваров.КодТовараСторонний = ТабСоответствий_КонтурEDI.КодТовараСторонний
			И ТабТоваров.КодТовараСвой = ТабСоответствий_КонтурEDI.КодТовараСвой

ОБЪЕДИНИТЬ ВСЕ

ВЫБРАТЬ
	ТабТоваров.GTIN,
	ТабТоваров.КодТовараСторонний,
	ТабТоваров.КодТовараСвой,
	Штрихкоды.Номенклатура,
	Штрихкоды.ХарактеристикаНоменклатуры,
	Штрихкоды.ЕдиницаИзмерения,
	ВЫРАЗИТЬ("" КАК СТРОКА(20)),
	3
ИЗ
	ТабТоваров КАК ТабТоваров
		ВНУТРЕННЕЕ СОЕДИНЕНИЕ РегистрСведений.ШтрихкодыНоменклатуры КАК Штрихкоды
		ПО ТабТоваров.GTIN = Штрихкоды.Штрихкод
ГДЕ
	(НЕ ТабТоваров.GTIN = "")

ОБЪЕДИНИТЬ ВСЕ

ВЫБРАТЬ
	ТабТоваров.GTIN,
	ТабТоваров.КодТовараСторонний,
	ТабТоваров.КодТовараСвой,
	Штрихкоды.Номенклатура,
	Штрихкоды.ХарактеристикаНоменклатуры,
	Штрихкоды.ЕдиницаИзмерения,
	ВЫРАЗИТЬ("" КАК СТРОКА(20)),
	2
ИЗ
	ТабТоваров КАК ТабТоваров
		ВНУТРЕННЕЕ СОЕДИНЕНИЕ РегистрСведений.ШтрихкодыНоменклатуры КАК Штрихкоды
		ПО (ПОДСТРОКА(ТабТоваров.GTIN, 1, 13) = Штрихкоды.Штрихкод)
ГДЕ
	(НЕ ТабТоваров.GTIN = "")
	
ОБЪЕДИНИТЬ ВСЕ

ВЫБРАТЬ
	ТабТоваров.GTIN,
	ТабТоваров.КодТовараСторонний,
	ТабТоваров.КодТовараСвой,
	СправочникНоменклатура.Ссылка,
	НЕОПРЕДЕЛЕНО,
	СправочникНоменклатура.ЕдиницаИзмерения,
	ВЫРАЗИТЬ("" КАК СТРОКА(20)),
	1
ИЗ
	ТабТоваров КАК ТабТоваров
		ВНУТРЕННЕЕ СОЕДИНЕНИЕ Справочник.Номенклатура КАК СправочникНоменклатура
		ПО ТабТоваров.КодТовараСвойЧисло = СправочникНоменклатура.Код
ГДЕ
	(НЕ ТабТоваров.КодТовараСвой = "")
</query>
				<autoFillFields>false</autoFillFields>
			</item>
			<item xsi:type="DataSetQuery">
				<name>КонвертироватьТовары1СВEDIВ_GTIN</name>
				<dataSource>ИсточникДанных1</dataSource>
				<query>ВЫБРАТЬ РАЗЛИЧНЫЕ
	ТабТоваров.Номенклатура,
	ТабТоваров.ХарактеристикаНоменклатуры,
	ТабТоваров.ЕдиницаИзмерения,
	ТабТоваров.Номенклатура.Код КАК КодТовараСвой,
	ВЫРАЗИТЬ(Штрихкоды.Штрихкод КАК СТРОКА(14)) КАК GTIN
ПОМЕСТИТЬ ВТШтрихкодыТоваров
ИЗ
	ТабТоваров КАК ТабТоваров
		ВНУТРЕННЕЕ СОЕДИНЕНИЕ РегистрСведений.ШтрихкодыНоменклатуры КАК Штрихкоды
		ПО ТабТоваров.Номенклатура = Штрихкоды.Номенклатура
			И (Штрихкоды.НеИспользуется = ЛОЖЬ)
ГДЕ
	&amp;ИскатьТоварПоШК

ИНДЕКСИРОВАТЬ ПО
	ТабТоваров.Номенклатура,
	ТабТоваров.ХарактеристикаНоменклатуры,
	ТабТоваров.ЕдиницаИзмерения</query>
				<autoFillFields>false</autoFillFields>
			</item>
		</item>
		<item xsi:type="DataSetUnion">
			<name>Поставщик</name>
			<item xsi:type="DataSetUnion">
				<name>ЗапросОсновнойЦепочки</name>
				<item xsi:type="DataSetQuery">
					<name>РасходнаяНакладная_СФ</name>
					<dataSource>ИсточникДанных1</dataSource>
					<query>ВЫБРАТЬ
	РасходнаяНакладная.Ссылка КАК PORDERS,
	РасходнаяНакладная.Ссылка КАК ORDERS,
	РасходнаяНакладная.Ссылка КАК ORDRSP,
	РасходнаяНакладная.Ссылка КАК DESADV,
	РасходнаяНакладная.Ссылка КАК RECADV,
	СчетФактура.Ссылка КАК INVOIC
ИЗ
	(ВЫБРАТЬ
		1 КАК Поле1) КАК Заглушка
		{ПОЛНОЕ СОЕДИНЕНИЕ Документ.СчетФактура КАК СчетФактура
			{ПОЛНОЕ СОЕДИНЕНИЕ Документ.РасходнаяНакладная КАК РасходнаяНакладная
			ПО СчетФактура.ДокументОснование = РасходнаяНакладная.Ссылка}
		ПО (ИСТИНА)}</query>
					<autoFillFields>false</autoFillFields>
				</item>
			</item>
			<item xsi:type="DataSetUnion">
				<name>ЗапросПоТоварам</name>
				<item xsi:type="DataSetUnion">
					<name>_PORDERS_ORDRSP_DESADV_INVOIC_</name>
					<item xsi:type="DataSetQuery">
						<name>РасходнаяНакладная</name>
						<dataSource>ИсточникДанных1</dataSource>
						<query>	ВЫБРАТЬ
	РасходнаяНакладнаяТовары.НомерСтроки,
	РасходнаяНакладнаяТовары.Номенклатура,
	РасходнаяНакладнаяТовары.ЕдиницаИзмерения КАК ЕдиницаИзмерения,
	РасходнаяНакладнаяТовары.ЕдиницаИзмерения.ЕдиницаИзмеренияПоКлассификатору.Наименование КАК КодЕдиницыИзмерения,
	ВЫРАЗИТЬ(РасходнаяНакладнаяТовары.Номенклатура.Наименование КАК СТРОКА(178)) КАК Наименование,
	ВЫРАЗИТЬ(РасходнаяНакладнаяТовары.Номенклатура.НаименованиеПолное КАК СТРОКА(500)) КАК НаименованиеПолное,
	РасходнаяНакладнаяТовары.ХарактеристикаНоменклатуры КАК ХарактеристикаНоменклатуры,
	Неопределено КАК СерияНоменклатуры,
	РасходнаяНакладнаяТовары.Цена,
	РасходнаяНакладнаяТовары.СтавкаНДС,
	Значение(Справочник.СтраныМира.) КАК Страна,
	Значение(Справочник.НомераГТД.) КАК НомерГТД,
	РасходнаяНакладнаяТовары.Количество КАК Количество,
	РасходнаяНакладнаяТовары.Сумма КАК Сумма,
	РасходнаяНакладнаяТовары.СуммаНДС КАК СуммаНДС,
	"" КАК ТипЕдиницы
ИЗ
	Документ.РасходнаяНакладная.Товары КАК РасходнаяНакладнаяТовары
ГДЕ
	РасходнаяНакладнаяТовары.Ссылка В (&amp;Ссылка)

ОБЪЕДИНИТЬ ВСЕ

ВЫБРАТЬ
	0,
	ВозвратТоваровОтПокупателяТовары.Номенклатура,
	ВозвратТоваровОтПокупателяТовары.ЕдиницаИзмерения,
	ВозвратТоваровОтПокупателяТовары.ЕдиницаИзмерения.ЕдиницаИзмеренияПоКлассификатору.Наименование КАК КодЕдиницыИзмерения,
	ВЫРАЗИТЬ(ВозвратТоваровОтПокупателяТовары.Номенклатура.Наименование КАК СТРОКА(178)),
	ВЫРАЗИТЬ(ВозвратТоваровОтПокупателяТовары.Номенклатура.НаименованиеПолное КАК СТРОКА(500)),
	ВозвратТоваровОтПокупателяТовары.ХарактеристикаНоменклатуры,
	Неопределено КАК СерияНоменклатуры,
	ВозвратТоваровОтПокупателяТовары.Цена,
	ВозвратТоваровОтПокупателяТовары.СтавкаНДС,
	Значение(Справочник.СтраныМира.) КАК Страна,
	ВозвратТоваровОтПокупателяТовары.НомерГТД,
	-ВозвратТоваровОтПокупателяТовары.Количество,
	-ВозвратТоваровОтПокупателяТовары.Сумма,
	-ВозвратТоваровОтПокупателяТовары.СуммаНДС КАК СуммаНДС,
	""
ИЗ
	Документ.ВозвратТоваровОтПокупателя.Товары КАК ВозвратТоваровОтПокупателяТовары
ГДЕ
	ВозвратТоваровОтПокупателяТовары.Ссылка В(&amp;Возвраты)</query>
						<autoFillFields>false</autoFillFields>
					</item>
				</item>
			</item>
		</item>
	</dataSet>
	<parameter>
		<name>Ссылка</name>
		<title xsi:type="v8:LocalStringType">
			<v8:item>
				<v8:lang>ru</v8:lang>
				<v8:content>Ссылка</v8:content>
			</v8:item>
		</title>
		<value xsi:nil="true"/>
		<useRestriction>true</useRestriction>
	</parameter>
	<parameter>
		<name>ОтправлятьВозвратнуюТару</name>
		<title xsi:type="v8:LocalStringType">
			<v8:item>
				<v8:lang>ru</v8:lang>
				<v8:content>Отправлять возвратную тару</v8:content>
			</v8:item>
		</title>
		<value xsi:nil="true"/>
		<useRestriction>true</useRestriction>
	</parameter>
	<parameter>
		<name>Возвраты</name>
		<title xsi:type="v8:LocalStringType">
			<v8:item>
				<v8:lang>ru</v8:lang>
				<v8:content>Возвраты</v8:content>
			</v8:item>
		</title>
		<value xsi:nil="true"/>
		<useRestriction>true</useRestriction>
	</parameter>
	<parameter>
		<name>РаботаСУслугами</name>
		<title xsi:type="v8:LocalStringType">
			<v8:item>
				<v8:lang>ru</v8:lang>
				<v8:content>Работа с услугами</v8:content>
			</v8:item>
		</title>
		<valueType>
			<v8:Type>xs:boolean</v8:Type>
		</valueType>
		<value xsi:type="xs:boolean">false</value>
		<useRestriction>true</useRestriction>
	</parameter>
	<parameter>
		<name>СворачиватьСтроки</name>
		<title xsi:type="v8:LocalStringType">
			<v8:item>
				<v8:lang>ru</v8:lang>
				<v8:content>Сворачивать строки</v8:content>
			</v8:item>
		</title>
		<valueType>
			<v8:Type>xs:boolean</v8:Type>
		</valueType>
		<value xsi:type="xs:boolean">false</value>
		<useRestriction>true</useRestriction>
	</parameter>
	<parameter>
		<name>ТипСообщения</name>
		<title xsi:type="v8:LocalStringType">
			<v8:item>
				<v8:lang>ru</v8:lang>
				<v8:content>Тип сообщения</v8:content>
			</v8:item>
		</title>
		<valueType>
			<v8:Type>xs:string</v8:Type>
			<v8:StringQualifiers>
				<v8:Length>6</v8:Length>
				<v8:AllowedLength>Variable</v8:AllowedLength>
			</v8:StringQualifiers>
		</valueType>
		<value xsi:type="xs:string"/>
		<useRestriction>true</useRestriction>
	</parameter>
	<parameter>
		<name>УсловиеОтбораНоменклатуры</name>
		<title xsi:type="v8:LocalStringType">
			<v8:item>
				<v8:lang>ru</v8:lang>
				<v8:content>Условие отбора номенклатуры</v8:content>
			</v8:item>
		</title>
		<value xsi:nil="true"/>
		<useRestriction>true</useRestriction>
	</parameter>
	<parameter>
		<name>Период</name>
		<title xsi:type="v8:LocalStringType">
			<v8:item>
				<v8:lang>ru</v8:lang>
				<v8:content>Период</v8:content>
			</v8:item>
		</title>
		<valueType>
			<v8:Type>xs:dateTime</v8:Type>
			<v8:DateQualifiers>
				<v8:DateFractions>DateTime</v8:DateFractions>
			</v8:DateQualifiers>
		</valueType>
		<value xsi:type="xs:dateTime">0001-01-01T00:00:00</value>
		<useRestriction>false</useRestriction>
	</parameter>
	<parameter>
		<name>ТипЦен</name>
		<title xsi:type="v8:LocalStringType">
			<v8:item>
				<v8:lang>ru</v8:lang>
				<v8:content>Тип цен</v8:content>
			</v8:item>
		</title>
		<value xsi:nil="true"/>
		<useRestriction>true</useRestriction>
	</parameter>
	<parameter>
		<name>Склад</name>
		<title xsi:type="v8:LocalStringType">
			<v8:item>
				<v8:lang>ru</v8:lang>
				<v8:content>Склад</v8:content>
			</v8:item>
		</title>
		<value xsi:nil="true"/>
		<useRestriction>true</useRestriction>
	</parameter>
	<parameter>
		<name>СуммаВключаетНДС</name>
		<title xsi:type="v8:LocalStringType">
			<v8:item>
				<v8:lang>ru</v8:lang>
				<v8:content>Сумма включает НДС</v8:content>
			</v8:item>
		</title>
		<valueType>
			<v8:Type>xs:boolean</v8:Type>
		</valueType>
		<value xsi:type="xs:boolean">false</value>
		<useRestriction>true</useRestriction>
	</parameter>
	<nestedSchema>
		<name>_СOINVOIC_УФ_УТ</name>
		<title xsi:type="v8:LocalStringType">
			<v8:item>
				<v8:lang>ru</v8:lang>
				<v8:content>СOINVOIC (УФ - УТ)</v8:content>
			</v8:item>
		</title>
		<schema>
			<dataSource>
				<name>ИсточникДанных1</name>
				<dataSourceType>Local</dataSourceType>
			</dataSource>
			<dataSet xsi:type="DataSetObject">
				<name>ТаблицаКэшПартнеровКонтрагентов</name>
				<field xsi:type="DataSetFieldField">
					<dataPath>Партнер</dataPath>
					<field>Партнер</field>
					<title xsi:type="v8:LocalStringType">
						<v8:item>
							<v8:lang>ru</v8:lang>
							<v8:content>Партнер</v8:content>
						</v8:item>
					</title>
				</field>
				<field xsi:type="DataSetFieldField">
					<dataPath>Контрагент</dataPath>
					<field>Контрагент</field>
					<title xsi:type="v8:LocalStringType">
						<v8:item>
							<v8:lang>ru</v8:lang>
							<v8:content>Контрагент</v8:content>
						</v8:item>
					</title>
				</field>
				<dataSource>ИсточникДанных1</dataSource>
				<objectName>ТаблицаКэш</objectName>
			</dataSet>
			<dataSet xsi:type="DataSetQuery">
				<name>НачальноеСобытиеЦепочки</name>
				<field xsi:type="DataSetFieldField">
					<dataPath>Ссылка</dataPath>
					<field>Ссылка</field>
				</field>
				<field xsi:type="DataSetFieldField">
					<dataPath>КонтрагентРеализации</dataPath>
					<field>КонтрагентРеализации</field>
					<title xsi:type="v8:LocalStringType">
						<v8:item>
							<v8:lang>ru</v8:lang>
							<v8:content>Контрагент реализации</v8:content>
						</v8:item>
					</title>
				</field>
				<dataSource>ИсточникДанных1</dataSource>
				<query>ВЫБРАТЬ
	РеализацияТоваровУслуг.Ссылка КАК Ссылка,
	&amp;Контрагент КАК КонтрагентРеализации
ИЗ
	Документ.РеализацияТоваровУслуг КАК РеализацияТоваровУслуг
ГДЕ
	РеализацияТоваровУслуг.Контрагент = &amp;Контрагент</query>
			</dataSet>
			<dataSet xsi:type="DataSetQuery">
				<name>СвязанныеСчетаИКорректировки</name>
				<field xsi:type="DataSetFieldField">
					<dataPath>РодительскийДокумент</dataPath>
					<field>РодительскийДокумент</field>
					<title xsi:type="v8:LocalStringType">
						<v8:item>
							<v8:lang>ru</v8:lang>
							<v8:content>Родительский документ</v8:content>
						</v8:item>
					</title>
				</field>
				<field xsi:type="DataSetFieldField">
					<dataPath>ДатаДокумента</dataPath>
					<field>ДатаДокумента</field>
					<title xsi:type="v8:LocalStringType">
						<v8:item>
							<v8:lang>ru</v8:lang>
							<v8:content>Дата документа</v8:content>
						</v8:item>
					</title>
					<presentationExpression>ДатаДокумента</presentationExpression>
					<valueType>
						<v8:Type>xs:dateTime</v8:Type>
						<v8:DateQualifiers>
							<v8:DateFractions>DateTime</v8:DateFractions>
						</v8:DateQualifiers>
					</valueType>
				</field>
				<field xsi:type="DataSetFieldField">
					<dataPath>ЭтоКорректировкаРеализации</dataPath>
					<field>ЭтоКорректировкаРеализации</field>
					<title xsi:type="v8:LocalStringType">
						<v8:item>
							<v8:lang>ru</v8:lang>
							<v8:content>Это корректировка реализации</v8:content>
						</v8:item>
					</title>
					<valueType>
						<v8:Type>xs:boolean</v8:Type>
					</valueType>
				</field>
				<field xsi:type="DataSetFieldField">
					<dataPath>Документ</dataPath>
					<field>Документ</field>
					<title xsi:type="v8:LocalStringType">
						<v8:item>
							<v8:lang>ru</v8:lang>
							<v8:content>Документ</v8:content>
						</v8:item>
					</title>
				</field>
				<field xsi:type="DataSetFieldField">
					<dataPath>ОпределяемТребуемоеДействие</dataPath>
					<field>ОпределяемТребуемоеДействие</field>
					<title xsi:type="v8:LocalStringType">
						<v8:item>
							<v8:lang>ru</v8:lang>
							<v8:content>Определяем требуемое действие</v8:content>
						</v8:item>
					</title>
					<valueType>
						<v8:Type>xs:string</v8:Type>
						<v8:StringQualifiers>
							<v8:Length>100</v8:Length>
							<v8:AllowedLength>Variable</v8:AllowedLength>
						</v8:StringQualifiers>
					</valueType>
				</field>
				<field xsi:type="DataSetFieldField">
					<dataPath>ОпределяемТипСообщения</dataPath>
					<field>ОпределяемТипСообщения</field>
					<title xsi:type="v8:LocalStringType">
						<v8:item>
							<v8:lang>ru</v8:lang>
							<v8:content>Определяем тип сообщения</v8:content>
						</v8:item>
					</title>
					<valueType>
						<v8:Type>xs:string</v8:Type>
						<v8:StringQualifiers>
							<v8:Length>50</v8:Length>
							<v8:AllowedLength>Variable</v8:AllowedLength>
						</v8:StringQualifiers>
					</valueType>
				</field>
				<dataSource>ИсточникДанных1</dataSource>
				<query>ВЫБРАТЬ
	ВЫБОР
		КОГДА СвязанныеДокументы.Ссылка ССЫЛКА Документ.КорректировкаРеализации
			ТОГДА ЕСТЬNULL(СчетФактураВыданный.Ссылка,  СвязанныеДокументы.Ссылка)
		ИНАЧЕ СвязанныеДокументы.Ссылка
	КОНЕЦ КАК Документ,
	&amp;РодительскийДокумент КАК РодительскийДокумент,
	ВЫРАЗИТЬ(СвязанныеДокументы.Ссылка.Дата КАК ДАТА) КАК ДатаДокумента,
	СвязанныеДокументы.Ссылка ССЫЛКА Документ.КорректировкаРеализации КАК ЭтоКорректировкаРеализации,
	ВЫБОР
		КОГДА СвязанныеДокументы.Ссылка ССЫЛКА Документ.КорректировкаРеализации
			ТОГДА ВЫБОР
					КОГДА СчетФактураВыданный.Ссылка ЕСТЬ NULL
						ТОГДА "Создать Счет-фактура выданный"
					КОГДА СвязанныеДокументы.Ссылка.ВидКорректировки = ЗНАЧЕНИЕ(Перечисление.ХозяйственныеОперации.ИсправлениеОшибок)
							И СвязанныеДокументы.Ссылка.ДокументОснование ССЫЛКА Документ.РеализацияТоваровУслуг
						ТОГДА "Отправить счет-фактуру"
					ИНАЧЕ "Отправить корректировочный счет-фактуру"
				КОНЕЦ
		ИНАЧЕ NULL
	КОНЕЦ КАК ОпределяемТребуемоеДействие,
	ВЫБОР
		КОГДА СвязанныеДокументы.Ссылка ССЫЛКА Документ.КорректировкаРеализации
			ТОГДА ВЫБОР
					КОГДА СвязанныеДокументы.Ссылка.ВидКорректировки = ЗНАЧЕНИЕ(Перечисление.ХозяйственныеОперации.ИсправлениеОшибок)
							И СвязанныеДокументы.Ссылка.ДокументОснование ССЫЛКА Документ.РеализацияТоваровУслуг
						ТОГДА "INVOIC"
					ИНАЧЕ "COINVOIC"
				КОНЕЦ
		ИНАЧЕ NULL
	КОНЕЦ КАК ОпределяемТипСообщения
ИЗ
	КритерийОтбора.СвязанныеДокументы(&amp;РодительскийДокумент) КАК СвязанныеДокументы
		ЛЕВОЕ СОЕДИНЕНИЕ Документ.СчетФактураВыданный.ДокументыОснования КАК СчетФактураВыданный
		ПО (СвязанныеДокументы.Ссылка ССЫЛКА Документ.КорректировкаРеализации)
			И СвязанныеДокументы.Ссылка = СчетФактураВыданный.ДокументОснование
ГДЕ
	(СвязанныеДокументы.Ссылка ССЫЛКА Документ.СчетФактураВыданный
			ИЛИ СвязанныеДокументы.Ссылка ССЫЛКА Документ.КорректировкаРеализации)
	И СвязанныеДокументы.Ссылка.Проведен</query>
			</dataSet>
			<dataSet xsi:type="DataSetQuery">
				<name>Сообщения</name>
				<field xsi:type="DataSetFieldField">
					<dataPath>СообщениеДокумент</dataPath>
					<field>СообщениеДокумент</field>
					<title xsi:type="v8:LocalStringType">
						<v8:item>
							<v8:lang>ru</v8:lang>
							<v8:content>Сообщение документ</v8:content>
						</v8:item>
					</title>
				</field>
				<field xsi:type="DataSetFieldField">
					<dataPath>СообщениеТребуемоеДействие</dataPath>
					<field>СообщениеТребуемоеДействие</field>
					<title xsi:type="v8:LocalStringType">
						<v8:item>
							<v8:lang>ru</v8:lang>
							<v8:content>Сообщение требуемое действие</v8:content>
						</v8:item>
					</title>
					<valueType>
						<v8:Type>xs:string</v8:Type>
						<v8:StringQualifiers>
							<v8:Length>100</v8:Length>
							<v8:AllowedLength>Variable</v8:AllowedLength>
						</v8:StringQualifiers>
					</valueType>
				</field>
				<field xsi:type="DataSetFieldField">
					<dataPath>СообщениеСтатус</dataPath>
					<field>СообщениеСтатус</field>
					<title xsi:type="v8:LocalStringType">
						<v8:item>
							<v8:lang>ru</v8:lang>
							<v8:content>Сообщение статус</v8:content>
						</v8:item>
					</title>
					<valueType>
						<v8:Type>xs:string</v8:Type>
						<v8:StringQualifiers>
							<v8:Length>100</v8:Length>
							<v8:AllowedLength>Variable</v8:AllowedLength>
						</v8:StringQualifiers>
					</valueType>
				</field>
				<field xsi:type="DataSetFieldField">
					<dataPath>ЭтоБлокирующийСтатус</dataPath>
					<field>ЭтоБлокирующийСтатус</field>
					<title xsi:type="v8:LocalStringType">
						<v8:item>
							<v8:lang>ru</v8:lang>
							<v8:content>Это блокирующий статус</v8:content>
						</v8:item>
					</title>
					<valueType>
						<v8:Type>xs:boolean</v8:Type>
					</valueType>
				</field>
				<field xsi:type="DataSetFieldField">
					<dataPath>ТипСообщения</dataPath>
					<field>ТипСообщения</field>
					<valueType>
						<v8:Type>xs:string</v8:Type>
						<v8:StringQualifiers>
							<v8:Length>50</v8:Length>
							<v8:AllowedLength>Variable</v8:AllowedLength>
						</v8:StringQualifiers>
					</valueType>
				</field>
				<field xsi:type="DataSetFieldField">
					<dataPath>ПорядокСообщений</dataPath>
					<field>ПорядокСообщений</field>
					<title xsi:type="v8:LocalStringType">
						<v8:item>
							<v8:lang>ru</v8:lang>
							<v8:content>Порядок сообщений</v8:content>
						</v8:item>
					</title>
					<valueType>
						<v8:Type>xs:decimal</v8:Type>
						<v8:NumberQualifiers>
							<v8:Digits>2</v8:Digits>
							<v8:FractionDigits>0</v8:FractionDigits>
							<v8:AllowedSign>Any</v8:AllowedSign>
						</v8:NumberQualifiers>
					</valueType>
				</field>
				<field xsi:type="DataSetFieldField">
					<dataPath>Документ</dataPath>
					<field>Документ</field>
					<title xsi:type="v8:LocalStringType">
						<v8:item>
							<v8:lang>ru</v8:lang>
							<v8:content>Документ</v8:content>
						</v8:item>
					</title>
				</field>
				<field xsi:type="DataSetFieldField">
					<dataPath>СообщениеДокумента</dataPath>
					<field>СообщениеДокумента</field>
					<title xsi:type="v8:LocalStringType">
						<v8:item>
							<v8:lang>ru</v8:lang>
							<v8:content>Сообщение документа</v8:content>
						</v8:item>
					</title>
				</field>
				<dataSource>ИсточникДанных1</dataSource>
				<query>ВЫБРАТЬ
	КонтурEDI_Сообщения.Ссылка КАК СообщениеДокумента,
	КонтурEDI_Сообщения.Статус КАК СообщениеСтатус,
	КонтурEDI_Сообщения.ТребуемоеДействие КАК СообщениеТребуемоеДействие,
	КонтурEDI_Сообщения.Документ КАК СообщениеДокумент,
	КонтурEDI_Сообщения.Статус В (&amp;БлокирующиеСтатусыПервичногоINVOIC) КАК ЭтоБлокирующийСтатус,
	КонтурEDI_Сообщения.ТипСообщения КАК ТипСообщения,
	ВЫБОР
		КОГДА КонтурEDI_Сообщения.ТипСообщения = "ORDERS"
				ИЛИ КонтурEDI_Сообщения.ТипСообщения = "RETANN"
			ТОГДА 1
		КОГДА КонтурEDI_Сообщения.ТипСообщения = "ORDRSP"
				ИЛИ КонтурEDI_Сообщения.ТипСообщения = "RETINS"
			ТОГДА 2
		КОГДА КонтурEDI_Сообщения.ТипСообщения = "DESADV"
				ИЛИ КонтурEDI_Сообщения.ТипСообщения = "RETDES"
			ТОГДА 3
		КОГДА КонтурEDI_Сообщения.ТипСообщения = "RECADV"
				ИЛИ КонтурEDI_Сообщения.ТипСообщения = "RETREC"
			ТОГДА 4
		КОГДА КонтурEDI_Сообщения.ТипСообщения = "INVOIC"
			ТОГДА 5
		КОГДА КонтурEDI_Сообщения.ТипСообщения = "COINVOIC"
			ТОГДА 6
	КОНЕЦ КАК ПорядокСообщений,
	&amp;Документ КАК Документ
ИЗ
	Справочник.КонтурEDI_Сообщения КАК КонтурEDI_Сообщения
ГДЕ
	КонтурEDI_Сообщения.Документ = &amp;Документ</query>
			</dataSet>
			<dataSet xsi:type="DataSetQuery">
				<name>СтатусныеСобытия</name>
				<field xsi:type="DataSetFieldField">
					<dataPath>СсылкаНаСообщение</dataPath>
					<field>СсылкаНаСообщение</field>
					<title xsi:type="v8:LocalStringType">
						<v8:item>
							<v8:lang>ru</v8:lang>
							<v8:content>Ссылка на сообщение</v8:content>
						</v8:item>
					</title>
				</field>
				<field xsi:type="DataSetFieldField">
					<dataPath>СтатусDraftOfDocumentPackageSignedByMe</dataPath>
					<field>СтатусDraftOfDocumentPackageSignedByMe</field>
					<title xsi:type="v8:LocalStringType">
						<v8:item>
							<v8:lang>ru</v8:lang>
							<v8:content>DraftOfDocumentPackageSignedByMe</v8:content>
						</v8:item>
					</title>
					<valueType>
						<v8:Type>xs:boolean</v8:Type>
					</valueType>
				</field>
				<dataSource>ИсточникДанных1</dataSource>
				<query>ВЫБРАТЬ
	КонтурEDI_СообщенияДополнительныеРеквизиты.Значение КАК СтатусDraftOfDocumentPackageSignedByMe,
	&amp;СсылкаНаСообщение КАК СсылкаНаСообщение
ИЗ
	Справочник.КонтурEDI_Сообщения.ДополнительныеРеквизиты КАК КонтурEDI_СообщенияДополнительныеРеквизиты
ГДЕ
	КонтурEDI_СообщенияДополнительныеРеквизиты.Ссылка = &amp;СсылкаНаСообщение
	И КонтурEDI_СообщенияДополнительныеРеквизиты.ИмяРеквизита = "DraftOfDocumentPackageSignedByMe"</query>
			</dataSet>
			<dataSetLink>
				<sourceDataSet>НачальноеСобытиеЦепочки</sourceDataSet>
				<destinationDataSet>СвязанныеСчетаИКорректировки</destinationDataSet>
				<sourceExpression>Ссылка</sourceExpression>
				<destinationExpression>РодительскийДокумент</destinationExpression>
				<parameter>РодительскийДокумент</parameter>
				<parameterListAllowed>false</parameterListAllowed>
				<linkConditionExpression>Ссылка ЕСТЬ НЕ NULL</linkConditionExpression>
			</dataSetLink>
			<dataSetLink>
				<sourceDataSet>СвязанныеСчетаИКорректировки</sourceDataSet>
				<destinationDataSet>Сообщения</destinationDataSet>
				<sourceExpression>Документ</sourceExpression>
				<destinationExpression>СообщениеДокумент</destinationExpression>
				<parameter>Документ</parameter>
				<parameterListAllowed>false</parameterListAllowed>
			</dataSetLink>
			<dataSetLink>
				<sourceDataSet>Сообщения</sourceDataSet>
				<destinationDataSet>СтатусныеСобытия</destinationDataSet>
				<sourceExpression>СообщениеДокумента</sourceExpression>
				<destinationExpression>СсылкаНаСообщение</destinationExpression>
				<parameter>СсылкаНаСообщение</parameter>
				<parameterListAllowed>false</parameterListAllowed>
			</dataSetLink>
			<dataSetLink>
				<sourceDataSet>ТаблицаКэшПартнеровКонтрагентов</sourceDataSet>
				<destinationDataSet>НачальноеСобытиеЦепочки</destinationDataSet>
				<sourceExpression>Контрагент</sourceExpression>
				<destinationExpression>КонтрагентРеализации</destinationExpression>
				<parameter>Контрагент</parameter>
				<parameterListAllowed>false</parameterListAllowed>
			</dataSetLink>
			<dataSetLink>
				<sourceDataSet>Сообщения</sourceDataSet>
				<destinationDataSet>СтатусныеСобытия</destinationDataSet>
				<sourceExpression>СообщениеДокумента</sourceExpression>
				<destinationExpression>СсылкаНаСообщение</destinationExpression>
				<parameter>СсылкаНаСообщение</parameter>
				<parameterListAllowed>false</parameterListAllowed>
			</dataSetLink>
			<calculatedField>
				<dataPath>ПорядокСообщений</dataPath>
				<expression>ЕСТЬNULL(ПорядокСообщений, 99)</expression>
				<title xsi:type="v8:LocalStringType">
					<v8:item>
						<v8:lang>ru</v8:lang>
						<v8:content>Порядок сообщений</v8:content>
					</v8:item>
				</title>
				<valueType>
					<v8:Type>xs:decimal</v8:Type>
					<v8:NumberQualifiers>
						<v8:Digits>2</v8:Digits>
						<v8:FractionDigits>0</v8:FractionDigits>
						<v8:AllowedSign>Any</v8:AllowedSign>
					</v8:NumberQualifiers>
				</valueType>
			</calculatedField>
			<calculatedField>
				<dataPath>СоздатьCOINVOIC</dataPath>
				<expression>ЭтоКорректировкаРеализации И ВычислитьВыражение("СообщениеДокумента ЕСТЬ НЕ NULL И НЕ ЕСТЬNULL(ЭтоБлокирующийСтатус, Ложь) И ЕСТЬNULL(СтатусDraftOfDocumentPackageSignedByMe, Истина)", "ПолученныеДанные","Группировка","Предыдущая" ,"Предыдущая" , , , ) И СообщениеДокумента ЕСТЬ NULL </expression>
				<title xsi:type="v8:LocalStringType">
					<v8:item>
						<v8:lang>ru</v8:lang>
						<v8:content>Создать COINVOIC</v8:content>
					</v8:item>
				</title>
				<valueType>
					<v8:Type>xs:boolean</v8:Type>
				</valueType>
			</calculatedField>
			<calculatedField>
				<dataPath>ТребуемоеДействие</dataPath>
				<expression>Выбор Когда СообщениеТребуемоеДействие ЕСТЬ NULL Тогда ОпределяемТребуемоеДействие Иначе СообщениеТребуемоеДействие Конец</expression>
				<title xsi:type="v8:LocalStringType">
					<v8:item>
						<v8:lang>ru</v8:lang>
						<v8:content>Требуемое действие</v8:content>
					</v8:item>
				</title>
				<valueType>
					<v8:Type>xs:string</v8:Type>
					<v8:StringQualifiers>
						<v8:Length>100</v8:Length>
						<v8:AllowedLength>Variable</v8:AllowedLength>
					</v8:StringQualifiers>
				</valueType>
			</calculatedField>
			<calculatedField>
				<dataPath>ТипСообщения</dataPath>
				<expression>Выбор Когда ТипСообщения ЕСТЬ NULL Тогда ОпределяемТипСообщения Иначе ТипСообщения Конец</expression>
				<title xsi:type="v8:LocalStringType">
					<v8:item>
						<v8:lang>ru</v8:lang>
						<v8:content>Тип сообщения</v8:content>
					</v8:item>
				</title>
				<valueType>
					<v8:Type>xs:string</v8:Type>
					<v8:StringQualifiers>
						<v8:Length>50</v8:Length>
						<v8:AllowedLength>Variable</v8:AllowedLength>
					</v8:StringQualifiers>
				</valueType>
			</calculatedField>
			<calculatedField>
				<dataPath>Сообщение</dataPath>
				<expression>Выбор Когда СообщениеДокумента ЕСТЬ NULL Тогда ВычислитьВыражение("СообщениеДокумента", "ПолученныеДанные","Группировка","Предыдущая" ,"Предыдущая" , , , ) Иначе СообщениеДокумента Конец </expression>
				<title xsi:type="v8:LocalStringType">
					<v8:item>
						<v8:lang>ru</v8:lang>
						<v8:content>Сообщение</v8:content>
					</v8:item>
				</title>
			</calculatedField>
			<totalField>
				<dataPath>СоздатьCOINVOIC</dataPath>
				<expression>Максимум(СоздатьCOINVOIC)</expression>
			</totalField>
			<totalField>
				<dataPath>Сообщение</dataPath>
				<expression>Максимум(Сообщение)</expression>
			</totalField>
			<totalField>
				<dataPath>СтатусDraftOfDocumentPackageSignedByMe</dataPath>
				<expression>Минимум(СтатусDraftOfDocumentPackageSignedByMe)</expression>
			</totalField>
			<parameter>
				<name>Значение</name>
				<title xsi:type="v8:LocalStringType">
					<v8:item>
						<v8:lang>ru</v8:lang>
						<v8:content>Значение</v8:content>
					</v8:item>
				</title>
				<valueType>
					<v8:Type>xs:string</v8:Type>
					<v8:StringQualifiers>
						<v8:Length>10</v8:Length>
						<v8:AllowedLength>Variable</v8:AllowedLength>
					</v8:StringQualifiers>
				</valueType>
				<value xsi:nil="true"/>
				<useRestriction>true</useRestriction>
			</parameter>
			<parameter>
				<name>РодительскийДокумент</name>
				<title xsi:type="v8:LocalStringType">
					<v8:item>
						<v8:lang>ru</v8:lang>
						<v8:content>Родительский документ</v8:content>
					</v8:item>
				</title>
				<valueType>
					<v8:Type>xs:string</v8:Type>
					<v8:StringQualifiers>
						<v8:Length>10</v8:Length>
						<v8:AllowedLength>Variable</v8:AllowedLength>
					</v8:StringQualifiers>
				</valueType>
				<value xsi:nil="true"/>
				<useRestriction>true</useRestriction>
			</parameter>
			<parameter>
				<name>Документ</name>
				<title xsi:type="v8:LocalStringType">
					<v8:item>
						<v8:lang>ru</v8:lang>
						<v8:content>Документ</v8:content>
					</v8:item>
				</title>
				<value xsi:nil="true"/>
				<useRestriction>true</useRestriction>
			</parameter>
			<parameter>
				<name>СсылкаНаСообщение</name>
				<title xsi:type="v8:LocalStringType">
					<v8:item>
						<v8:lang>ru</v8:lang>
						<v8:content>Ссылка на сообщение</v8:content>
					</v8:item>
				</title>
				<value xsi:nil="true"/>
				<useRestriction>true</useRestriction>
			</parameter>
			<parameter>
				<name>БлокирующиеСтатусыПервичногоINVOIC</name>
				<title xsi:type="v8:LocalStringType">
					<v8:item>
						<v8:lang>ru</v8:lang>
						<v8:content>Блокирующие статусы первичного INVOIC</v8:content>
					</v8:item>
				</title>
				<valueType>
					<v8:Type>xs:string</v8:Type>
					<v8:StringQualifiers>
						<v8:Length>40</v8:Length>
						<v8:AllowedLength>Variable</v8:AllowedLength>
					</v8:StringQualifiers>
				</valueType>
				<value xsi:type="xs:string">Ожидает отправки</value>
				<value xsi:type="xs:string">Отправлен</value>
				<value xsi:type="xs:string">Ожидает подписания</value>
				<useRestriction>true</useRestriction>
				<valueListAllowed>true</valueListAllowed>
			</parameter>
			<parameter>
				<name>Контрагент</name>
				<title xsi:type="v8:LocalStringType">
					<v8:item>
						<v8:lang>ru</v8:lang>
						<v8:content>Контрагент</v8:content>
					</v8:item>
				</title>
				<value xsi:nil="true"/>
				<useRestriction>true</useRestriction>
			</parameter>
			<settingsVariant>
				<dcsset:name>Основной</dcsset:name>
				<dcsset:presentation xsi:type="xs:string">Основной</dcsset:presentation>
				<dcsset:settings xmlns:style="http://v8.1c.ru/8.1/data/ui/style" xmlns:sys="http://v8.1c.ru/8.1/data/ui/fonts/system" xmlns:web="http://v8.1c.ru/8.1/data/ui/colors/web" xmlns:win="http://v8.1c.ru/8.1/data/ui/colors/windows">
					<dcsset:order>
						<dcsset:item xsi:type="dcsset:OrderItemField">
							<dcsset:field>ДатаДокумента</dcsset:field>
							<dcsset:orderType>Desc</dcsset:orderType>
						</dcsset:item>
					</dcsset:order>
					<dcsset:item xsi:type="dcsset:StructureItemGroup">
						<dcsset:name>ПолученныеДанные</dcsset:name>
						<dcsset:groupItems>
							<dcsset:item xsi:type="dcsset:GroupItemField">
								<dcsset:field>Ссылка</dcsset:field>
								<dcsset:groupType>Items</dcsset:groupType>
								<dcsset:periodAdditionType>None</dcsset:periodAdditionType>
								<dcsset:periodAdditionBegin xsi:type="xs:dateTime">0001-01-01T00:00:00</dcsset:periodAdditionBegin>
								<dcsset:periodAdditionEnd xsi:type="xs:dateTime">0001-01-01T00:00:00</dcsset:periodAdditionEnd>
							</dcsset:item>
							<dcsset:item xsi:type="dcsset:GroupItemField">
								<dcsset:field>Документ</dcsset:field>
								<dcsset:groupType>Items</dcsset:groupType>
								<dcsset:periodAdditionType>None</dcsset:periodAdditionType>
								<dcsset:periodAdditionBegin xsi:type="xs:dateTime">0001-01-01T00:00:00</dcsset:periodAdditionBegin>
								<dcsset:periodAdditionEnd xsi:type="xs:dateTime">0001-01-01T00:00:00</dcsset:periodAdditionEnd>
							</dcsset:item>
							<dcsset:item xsi:type="dcsset:GroupItemField">
								<dcsset:field>Контрагент</dcsset:field>
								<dcsset:groupType>Items</dcsset:groupType>
								<dcsset:periodAdditionType>None</dcsset:periodAdditionType>
								<dcsset:periodAdditionBegin xsi:type="xs:dateTime">0001-01-01T00:00:00</dcsset:periodAdditionBegin>
								<dcsset:periodAdditionEnd xsi:type="xs:dateTime">0001-01-01T00:00:00</dcsset:periodAdditionEnd>
							</dcsset:item>
							<dcsset:item xsi:type="dcsset:GroupItemField">
								<dcsset:field>Партнер</dcsset:field>
								<dcsset:groupType>Items</dcsset:groupType>
								<dcsset:periodAdditionType>None</dcsset:periodAdditionType>
								<dcsset:periodAdditionBegin xsi:type="xs:dateTime">0001-01-01T00:00:00</dcsset:periodAdditionBegin>
								<dcsset:periodAdditionEnd xsi:type="xs:dateTime">0001-01-01T00:00:00</dcsset:periodAdditionEnd>
							</dcsset:item>
							<dcsset:item xsi:type="dcsset:GroupItemField">
								<dcsset:field>ТребуемоеДействие</dcsset:field>
								<dcsset:groupType>Items</dcsset:groupType>
								<dcsset:periodAdditionType>None</dcsset:periodAdditionType>
								<dcsset:periodAdditionBegin xsi:type="xs:dateTime">0001-01-01T00:00:00</dcsset:periodAdditionBegin>
								<dcsset:periodAdditionEnd xsi:type="xs:dateTime">0001-01-01T00:00:00</dcsset:periodAdditionEnd>
							</dcsset:item>
							<dcsset:item xsi:type="dcsset:GroupItemField">
								<dcsset:field>ТипСообщения</dcsset:field>
								<dcsset:groupType>Items</dcsset:groupType>
								<dcsset:periodAdditionType>None</dcsset:periodAdditionType>
								<dcsset:periodAdditionBegin xsi:type="xs:dateTime">0001-01-01T00:00:00</dcsset:periodAdditionBegin>
								<dcsset:periodAdditionEnd xsi:type="xs:dateTime">0001-01-01T00:00:00</dcsset:periodAdditionEnd>
							</dcsset:item>
							<dcsset:item xsi:type="dcsset:GroupItemField">
								<dcsset:field>ПорядокСообщений</dcsset:field>
								<dcsset:groupType>Items</dcsset:groupType>
								<dcsset:periodAdditionType>None</dcsset:periodAdditionType>
								<dcsset:periodAdditionBegin xsi:type="xs:dateTime">0001-01-01T00:00:00</dcsset:periodAdditionBegin>
								<dcsset:periodAdditionEnd xsi:type="xs:dateTime">0001-01-01T00:00:00</dcsset:periodAdditionEnd>
							</dcsset:item>
							<dcsset:item xsi:type="dcsset:GroupItemField">
								<dcsset:field>ЭтоКорректировкаРеализации</dcsset:field>
								<dcsset:groupType>Items</dcsset:groupType>
								<dcsset:periodAdditionType>None</dcsset:periodAdditionType>
								<dcsset:periodAdditionBegin xsi:type="xs:dateTime">0001-01-01T00:00:00</dcsset:periodAdditionBegin>
								<dcsset:periodAdditionEnd xsi:type="xs:dateTime">0001-01-01T00:00:00</dcsset:periodAdditionEnd>
							</dcsset:item>
							<dcsset:item xsi:type="dcsset:GroupItemField">
								<dcsset:field>ДатаДокумента</dcsset:field>
								<dcsset:groupType>Items</dcsset:groupType>
								<dcsset:periodAdditionType>None</dcsset:periodAdditionType>
								<dcsset:periodAdditionBegin xsi:type="xs:dateTime">0001-01-01T00:00:00</dcsset:periodAdditionBegin>
								<dcsset:periodAdditionEnd xsi:type="xs:dateTime">0001-01-01T00:00:00</dcsset:periodAdditionEnd>
							</dcsset:item>
						</dcsset:groupItems>
						<dcsset:order>
							<dcsset:item xsi:type="dcsset:OrderItemField">
								<dcsset:field>Ссылка</dcsset:field>
								<dcsset:orderType>Asc</dcsset:orderType>
							</dcsset:item>
							<dcsset:item xsi:type="dcsset:OrderItemField">
								<dcsset:field>ЭтоКорректировкаРеализации</dcsset:field>
								<dcsset:orderType>Asc</dcsset:orderType>
							</dcsset:item>
							<dcsset:item xsi:type="dcsset:OrderItemField">
								<dcsset:field>ПорядокСообщений</dcsset:field>
								<dcsset:orderType>Asc</dcsset:orderType>
							</dcsset:item>
							<dcsset:item xsi:type="dcsset:OrderItemField">
								<dcsset:field>ДатаДокумента</dcsset:field>
								<dcsset:orderType>Asc</dcsset:orderType>
							</dcsset:item>
						</dcsset:order>
						<dcsset:selection>
							<dcsset:item xsi:type="dcsset:SelectedItemAuto"/>
							<dcsset:item xsi:type="dcsset:SelectedItemField">
								<dcsset:field>СоздатьCOINVOIC</dcsset:field>
							</dcsset:item>
							<dcsset:item xsi:type="dcsset:SelectedItemField">
								<dcsset:field>Сообщение</dcsset:field>
							</dcsset:item>
							<dcsset:item xsi:type="dcsset:SelectedItemField">
								<dcsset:field>СтатусDraftOfDocumentPackageSignedByMe</dcsset:field>
							</dcsset:item>
						</dcsset:selection>
					</dcsset:item>
				</dcsset:settings>
			</settingsVariant>
		</schema>
		<settings xmlns:style="http://v8.1c.ru/8.1/data/ui/style" xmlns:sys="http://v8.1c.ru/8.1/data/ui/fonts/system" xmlns:web="http://v8.1c.ru/8.1/data/ui/colors/web" xmlns:win="http://v8.1c.ru/8.1/data/ui/colors/windows"/>
	</nestedSchema>
	<nestedSchema>
		<name>_СOINVOIC_УТ_10_3</name>
		<title xsi:type="v8:LocalStringType">
			<v8:item>
				<v8:lang>ru</v8:lang>
				<v8:content>СOINVOIC (УТ 10_3)</v8:content>
			</v8:item>
		</title>
		<schema>
			<dataSource>
				<name>ИсточникДанных1</name>
				<dataSourceType>Local</dataSourceType>
			</dataSource>
			<dataSet xsi:type="DataSetObject">
				<name>ТаблицаКэшПартнеровКонтрагентов</name>
				<field xsi:type="DataSetFieldField">
					<dataPath>Партнер</dataPath>
					<field>Партнер</field>
					<title xsi:type="v8:LocalStringType">
						<v8:item>
							<v8:lang>ru</v8:lang>
							<v8:content>Партнер</v8:content>
						</v8:item>
					</title>
				</field>
				<field xsi:type="DataSetFieldField">
					<dataPath>Контрагент</dataPath>
					<field>Контрагент</field>
					<title xsi:type="v8:LocalStringType">
						<v8:item>
							<v8:lang>ru</v8:lang>
							<v8:content>Контрагент</v8:content>
						</v8:item>
					</title>
				</field>
				<field xsi:type="DataSetFieldField">
					<dataPath>COINVOIC</dataPath>
					<field>COINVOIC</field>
					<title xsi:type="v8:LocalStringType">
						<v8:item>
							<v8:lang>ru</v8:lang>
							<v8:content>COINVOIC</v8:content>
						</v8:item>
					</title>
					<valueType>
						<v8:Type>xs:boolean</v8:Type>
					</valueType>
				</field>
				<dataSource>ИсточникДанных1</dataSource>
				<objectName>ТаблицаКэш</objectName>
			</dataSet>
			<dataSet xsi:type="DataSetQuery">
				<name>СборкаДокументовИСообщений</name>
				<field xsi:type="DataSetFieldField">
					<dataPath>Контрагент</dataPath>
					<field>Контрагент</field>
				</field>
				<field xsi:type="DataSetFieldField">
					<dataPath>Корректировка</dataPath>
					<field>Корректировка</field>
				</field>
				<field xsi:type="DataSetFieldField">
					<dataPath>ДатаДокумента</dataPath>
					<field>ДатаДокумента</field>
				</field>
				<field xsi:type="DataSetFieldField">
					<dataPath>Документ</dataPath>
					<field>Документ</field>
				</field>
				<field xsi:type="DataSetFieldField">
					<dataPath>Порядок</dataPath>
					<field>Порядок</field>
				</field>
				<field xsi:type="DataSetFieldField">
					<dataPath>Статус</dataPath>
					<field>Статус</field>
				</field>
				<field xsi:type="DataSetFieldField">
					<dataPath>ТипСообщения</dataPath>
					<field>ТипСообщения</field>
				</field>
				<field xsi:type="DataSetFieldField">
					<dataPath>ТребуемоеДействие</dataPath>
					<field>ТребуемоеДействие</field>
				</field>
				<field xsi:type="DataSetFieldField">
					<dataPath>МожноСоздаватьСледующее</dataPath>
					<field>МожноСоздаватьСледующее</field>
				</field>
				<field xsi:type="DataSetFieldField">
					<dataPath>СообщениеДокумента</dataPath>
					<field>СообщениеДокумента</field>
				</field>
				<field xsi:type="DataSetFieldField">
					<dataPath>ИдентификаторЦепочки</dataPath>
					<field>ИдентификаторЦепочки</field>
				</field>
				<dataSource>ИсточникДанных1</dataSource>
				<query>ВЫБРАТЬ
	ЕСТЬNULL(СчетФактураВыданныйДокументыОснования.Ссылка, КорректировкаРеализации.Ссылка) КАК Документ,
	КорректировкаРеализации.Контрагент,
	КорректировкаРеализации.Ссылка КАК Корректировка,
	КорректировкаРеализации.Дата КАК ДатаДокумента,
	2 КАК Порядок,
	ВЫБОР
		КОГДА СчетФактураВыданныйДокументыОснования.Ссылка ЕСТЬ NULL 
			ТОГДА "Создать Счет-фактура выданный"
		ИНАЧЕ ВЫБОР
				КОГДА КорректировкаРеализации.ВидОперации = ЗНАЧЕНИЕ(Перечисление.ВидыОперацийИсправленияПоступленияРеализации.ИсправлениеОшибки)
						И КорректировкаРеализации.ДокументРеализации ССЫЛКА Документ.РеализацияТоваровУслуг
					ТОГДА "Отправить счет-фактуру"
				ИНАЧЕ "Отправить корректировочный счет-фактуру"
			КОНЕЦ
	КОНЕЦ КАК ОпределяемТребуемоеДействие,
	ВЫБОР
		КОГДА КорректировкаРеализации.ВидОперации = ЗНАЧЕНИЕ(Перечисление.ВидыОперацийИсправленияПоступленияРеализации.ИсправлениеОшибки)
				И КорректировкаРеализации.ДокументРеализации ССЫЛКА Документ.РеализацияТоваровУслуг
			ТОГДА "INVOIC"
		ИНАЧЕ "COINVOIC"
	КОНЕЦ КАК ОпределяемТипСообщения,
	КорректировкаРеализации.Сделка КАК ИдентификаторЦепочки,
	КорректировкаРеализации.ДокументРеализации
ПОМЕСТИТЬ табКорректировок
ИЗ
	Документ.КорректировкаРеализации КАК КорректировкаРеализации
		ЛЕВОЕ СОЕДИНЕНИЕ Документ.СчетФактураВыданный.ДокументыОснования КАК СчетФактураВыданныйДокументыОснования
		ПО КорректировкаРеализации.Ссылка = СчетФактураВыданныйДокументыОснования.ДокументОснование
ГДЕ
	КорректировкаРеализации.Контрагент = &amp;Контрагент
	И КорректировкаРеализации.Проведен
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ
	СчетФактураВыданный.Ссылка КАК Документ,
	СчетФактураВыданный.Контрагент,
	СчетФактураВыданный.Дата КАК ДатаДокумента,
	1 КАК Порядок,
	табКорректировок.ИдентификаторЦепочки,
	"INVOIC" КАК ТипСообщения
ПОМЕСТИТЬ табПервичныхСчетовФактур
ИЗ
	табКорректировок КАК табКорректировок
		ВНУТРЕННЕЕ СОЕДИНЕНИЕ Документ.СчетФактураВыданный КАК СчетФактураВыданный
		ПО табКорректировок.ДокументРеализации = СчетФактураВыданный.ДокументОснование
			И (табКорректировок.ДокументРеализации ССЫЛКА Документ.РеализацияТоваровУслуг)
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ
	табКорректировок.Документ,
	табКорректировок.Контрагент,
	табКорректировок.Корректировка,
	табКорректировок.ДатаДокумента,
	табКорректировок.Порядок,
	табКорректировок.ОпределяемТребуемоеДействие,
	табКорректировок.ОпределяемТипСообщения,
	табКорректировок.ИдентификаторЦепочки
ПОМЕСТИТЬ табДокументов
ИЗ
	табКорректировок КАК табКорректировок

ОБЪЕДИНИТЬ ВСЕ

ВЫБРАТЬ
	табПервичныхСчетовФактур.Документ,
	табПервичныхСчетовФактур.Контрагент,
	NULL,
	табПервичныхСчетовФактур.ДатаДокумента,
	табПервичныхСчетовФактур.Порядок,
	NULL,
	табПервичныхСчетовФактур.ТипСообщения,
	табПервичныхСчетовФактур.ИдентификаторЦепочки
ИЗ
	табПервичныхСчетовФактур КАК табПервичныхСчетовФактур
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ
	табДокументов.Документ,
	табДокументов.Контрагент,
	табДокументов.Корректировка,
	табДокументов.ДатаДокумента,
	табДокументов.Порядок,
	КонтурEDI_Сообщения.Ссылка КАК СообщениеДокумента,
	КонтурEDI_Сообщения.Статус,
	ЕСТЬNULL(КонтурEDI_Сообщения.ТребуемоеДействие, табДокументов.ОпределяемТребуемоеДействие) КАК ТребуемоеДействие,
	ЕСТЬNULL(КонтурEDI_Сообщения.ТипСообщения, табДокументов.ОпределяемТипСообщения) КАК ТипСообщения,
	ВЫБОР
		КОГДА КонтурEDI_Сообщения.Ссылка ЕСТЬ НЕ NULL 
				И НЕ КонтурEDI_Сообщения.Статус В (&amp;БлокирующиеСтатусыПервичногоINVOIC)
				И ЕСТЬNULL(КонтурEDI_СообщенияДополнительныеРеквизиты.Значение, ИСТИНА) = ИСТИНА
			ТОГДА ИСТИНА
		ИНАЧЕ ЛОЖЬ
	КОНЕЦ КАК МожноСоздаватьСледующее,
	табДокументов.ИдентификаторЦепочки
ИЗ
	табДокументов КАК табДокументов
		ЛЕВОЕ СОЕДИНЕНИЕ Справочник.КонтурEDI_Сообщения КАК КонтурEDI_Сообщения
			ЛЕВОЕ СОЕДИНЕНИЕ Справочник.КонтурEDI_Сообщения.ДополнительныеРеквизиты КАК КонтурEDI_СообщенияДополнительныеРеквизиты
			ПО КонтурEDI_Сообщения.Ссылка = КонтурEDI_СообщенияДополнительныеРеквизиты.Ссылка
				И (КонтурEDI_СообщенияДополнительныеРеквизиты.ИмяРеквизита = "DraftOfDocumentPackageSignedByMe")
		ПО табДокументов.Документ = КонтурEDI_Сообщения.Документ
			И табДокументов.ОпределяемТипСообщения = КонтурEDI_Сообщения.ТипСообщения</query>
			</dataSet>
			<dataSetLink>
				<sourceDataSet>ТаблицаКэшПартнеровКонтрагентов</sourceDataSet>
				<destinationDataSet>СборкаДокументовИСообщений</destinationDataSet>
				<sourceExpression>Контрагент</sourceExpression>
				<destinationExpression>Контрагент</destinationExpression>
				<parameter>Контрагент</parameter>
				<parameterListAllowed>false</parameterListAllowed>
				<linkConditionExpression>COINVOIC = Истина</linkConditionExpression>
			</dataSetLink>
			<calculatedField>
				<dataPath>СоздатьCOINVOIC</dataPath>
				<expression>Корректировка ЕСТЬ НЕ NULL  И СообщениеДокумента ЕСТЬ NULL  И ВычислитьВыражение("МожноСоздаватьСледующее", "ПолученныеДанные","Группировка","Предыдущая" ,"Предыдущая" , , , )</expression>
				<title xsi:type="v8:LocalStringType">
					<v8:item>
						<v8:lang>ru</v8:lang>
						<v8:content>Создать COINVOIC</v8:content>
					</v8:item>
				</title>
			</calculatedField>
			<calculatedField>
				<dataPath>Сообщение</dataPath>
				<expression>Выбор Когда СообщениеДокумента ЕСТЬ NULL Тогда ВычислитьВыражение("СообщениеДокумента", "ПолученныеДанные","Группировка","Предыдущая" ,"Предыдущая" , , , ) Иначе СообщениеДокумента Конец</expression>
				<title xsi:type="v8:LocalStringType">
					<v8:item>
						<v8:lang>ru</v8:lang>
						<v8:content>Сообщение</v8:content>
					</v8:item>
				</title>
			</calculatedField>
			<totalField>
				<dataPath>Сообщение</dataPath>
				<expression>Максимум(Сообщение)</expression>
			</totalField>
			<totalField>
				<dataPath>СоздатьCOINVOIC</dataPath>
				<expression>Минимум(СоздатьCOINVOIC)</expression>
			</totalField>
			<parameter>
				<name>БлокирующиеСтатусыПервичногоINVOIC</name>
				<title xsi:type="v8:LocalStringType">
					<v8:item>
						<v8:lang>ru</v8:lang>
						<v8:content>Блокирующие статусы первичного INVOIC</v8:content>
					</v8:item>
				</title>
				<valueType>
					<v8:Type>xs:string</v8:Type>
					<v8:StringQualifiers>
						<v8:Length>40</v8:Length>
						<v8:AllowedLength>Variable</v8:AllowedLength>
					</v8:StringQualifiers>
				</valueType>
				<useRestriction>false</useRestriction>
				<valueListAllowed>true</valueListAllowed>
			</parameter>
			<parameter>
				<name>Контрагент</name>
				<title xsi:type="v8:LocalStringType">
					<v8:item>
						<v8:lang>ru</v8:lang>
						<v8:content>Контрагент</v8:content>
					</v8:item>
				</title>
				<value xsi:nil="true"/>
				<useRestriction>true</useRestriction>
			</parameter>
			<settingsVariant>
				<dcsset:name>Основной</dcsset:name>
				<dcsset:presentation xsi:type="xs:string">Основной</dcsset:presentation>
				<dcsset:settings xmlns:style="http://v8.1c.ru/8.1/data/ui/style" xmlns:sys="http://v8.1c.ru/8.1/data/ui/fonts/system" xmlns:web="http://v8.1c.ru/8.1/data/ui/colors/web" xmlns:win="http://v8.1c.ru/8.1/data/ui/colors/windows">
					<dcsset:selection>
						<dcsset:item xsi:type="dcsset:SelectedItemField">
							<dcsset:field>Сообщение</dcsset:field>
						</dcsset:item>
						<dcsset:item xsi:type="dcsset:SelectedItemField">
							<dcsset:field>СоздатьCOINVOIC</dcsset:field>
						</dcsset:item>
					</dcsset:selection>
					<dcsset:filter>
						<dcsset:item xsi:type="dcsset:FilterItemComparison">
							<dcsset:left xsi:type="dcscor:Field">Документ</dcsset:left>
							<dcsset:comparisonType>Filled</dcsset:comparisonType>
						</dcsset:item>
					</dcsset:filter>
					<dcsset:order>
						<dcsset:item xsi:type="dcsset:OrderItemField">
							<dcsset:field>ИдентификаторЦепочки</dcsset:field>
							<dcsset:orderType>Asc</dcsset:orderType>
						</dcsset:item>
						<dcsset:item xsi:type="dcsset:OrderItemField">
							<dcsset:field>Порядок</dcsset:field>
							<dcsset:orderType>Asc</dcsset:orderType>
						</dcsset:item>
						<dcsset:item xsi:type="dcsset:OrderItemField">
							<dcsset:field>ДатаДокумента</dcsset:field>
							<dcsset:orderType>Asc</dcsset:orderType>
						</dcsset:item>
					</dcsset:order>
					<dcsset:item xsi:type="dcsset:StructureItemGroup">
						<dcsset:name>ПолученныеДанные</dcsset:name>
						<dcsset:groupItems>
							<dcsset:item xsi:type="dcsset:GroupItemField">
								<dcsset:field>Партнер</dcsset:field>
								<dcsset:groupType>Items</dcsset:groupType>
								<dcsset:periodAdditionType>None</dcsset:periodAdditionType>
								<dcsset:periodAdditionBegin xsi:type="xs:dateTime">0001-01-01T00:00:00</dcsset:periodAdditionBegin>
								<dcsset:periodAdditionEnd xsi:type="xs:dateTime">0001-01-01T00:00:00</dcsset:periodAdditionEnd>
							</dcsset:item>
							<dcsset:item xsi:type="dcsset:GroupItemField">
								<dcsset:field>Контрагент</dcsset:field>
								<dcsset:groupType>Items</dcsset:groupType>
								<dcsset:periodAdditionType>None</dcsset:periodAdditionType>
								<dcsset:periodAdditionBegin xsi:type="xs:dateTime">0001-01-01T00:00:00</dcsset:periodAdditionBegin>
								<dcsset:periodAdditionEnd xsi:type="xs:dateTime">0001-01-01T00:00:00</dcsset:periodAdditionEnd>
							</dcsset:item>
							<dcsset:item xsi:type="dcsset:GroupItemField">
								<dcsset:field>ИдентификаторЦепочки</dcsset:field>
								<dcsset:groupType>Items</dcsset:groupType>
								<dcsset:periodAdditionType>None</dcsset:periodAdditionType>
								<dcsset:periodAdditionBegin xsi:type="xs:dateTime">0001-01-01T00:00:00</dcsset:periodAdditionBegin>
								<dcsset:periodAdditionEnd xsi:type="xs:dateTime">0001-01-01T00:00:00</dcsset:periodAdditionEnd>
							</dcsset:item>
							<dcsset:item xsi:type="dcsset:GroupItemField">
								<dcsset:field>Документ</dcsset:field>
								<dcsset:groupType>Items</dcsset:groupType>
								<dcsset:periodAdditionType>None</dcsset:periodAdditionType>
								<dcsset:periodAdditionBegin xsi:type="xs:dateTime">0001-01-01T00:00:00</dcsset:periodAdditionBegin>
								<dcsset:periodAdditionEnd xsi:type="xs:dateTime">0001-01-01T00:00:00</dcsset:periodAdditionEnd>
							</dcsset:item>
							<dcsset:item xsi:type="dcsset:GroupItemField">
								<dcsset:field>ТребуемоеДействие</dcsset:field>
								<dcsset:groupType>Items</dcsset:groupType>
								<dcsset:periodAdditionType>None</dcsset:periodAdditionType>
								<dcsset:periodAdditionBegin xsi:type="xs:dateTime">0001-01-01T00:00:00</dcsset:periodAdditionBegin>
								<dcsset:periodAdditionEnd xsi:type="xs:dateTime">0001-01-01T00:00:00</dcsset:periodAdditionEnd>
							</dcsset:item>
							<dcsset:item xsi:type="dcsset:GroupItemField">
								<dcsset:field>ТипСообщения</dcsset:field>
								<dcsset:groupType>Items</dcsset:groupType>
								<dcsset:periodAdditionType>None</dcsset:periodAdditionType>
								<dcsset:periodAdditionBegin xsi:type="xs:dateTime">0001-01-01T00:00:00</dcsset:periodAdditionBegin>
								<dcsset:periodAdditionEnd xsi:type="xs:dateTime">0001-01-01T00:00:00</dcsset:periodAdditionEnd>
							</dcsset:item>
							<dcsset:item xsi:type="dcsset:GroupItemField">
								<dcsset:field>Порядок</dcsset:field>
								<dcsset:groupType>Items</dcsset:groupType>
								<dcsset:periodAdditionType>None</dcsset:periodAdditionType>
								<dcsset:periodAdditionBegin xsi:type="xs:dateTime">0001-01-01T00:00:00</dcsset:periodAdditionBegin>
								<dcsset:periodAdditionEnd xsi:type="xs:dateTime">0001-01-01T00:00:00</dcsset:periodAdditionEnd>
							</dcsset:item>
							<dcsset:item xsi:type="dcsset:GroupItemField">
								<dcsset:field>ДатаДокумента</dcsset:field>
								<dcsset:groupType>Items</dcsset:groupType>
								<dcsset:periodAdditionType>None</dcsset:periodAdditionType>
								<dcsset:periodAdditionBegin xsi:type="xs:dateTime">0001-01-01T00:00:00</dcsset:periodAdditionBegin>
								<dcsset:periodAdditionEnd xsi:type="xs:dateTime">0001-01-01T00:00:00</dcsset:periodAdditionEnd>
							</dcsset:item>
						</dcsset:groupItems>
						<dcsset:order>
							<dcsset:item xsi:type="dcsset:OrderItemAuto"/>
						</dcsset:order>
						<dcsset:selection>
							<dcsset:item xsi:type="dcsset:SelectedItemAuto"/>
						</dcsset:selection>
					</dcsset:item>
				</dcsset:settings>
			</settingsVariant>
		</schema>
		<settings xmlns:style="http://v8.1c.ru/8.1/data/ui/style" xmlns:sys="http://v8.1c.ru/8.1/data/ui/fonts/system" xmlns:web="http://v8.1c.ru/8.1/data/ui/colors/web" xmlns:win="http://v8.1c.ru/8.1/data/ui/colors/windows"/>
	</nestedSchema>
	<nestedSchema>
		<name>_СOINVOIC_УФ_УНФ</name>
		<title xsi:type="v8:LocalStringType">
			<v8:item>
				<v8:lang>ru</v8:lang>
				<v8:content>СOINVOIC (УФ - УНФ)</v8:content>
			</v8:item>
		</title>
		<schema>
			<dataSource>
				<name>ИсточникДанных1</name>
				<dataSourceType>Local</dataSourceType>
			</dataSource>
			<dataSet xsi:type="DataSetObject">
				<name>ТаблицаКэшПартнеровКонтрагентов</name>
				<field xsi:type="DataSetFieldField">
					<dataPath>Партнер</dataPath>
					<field>Партнер</field>
					<title xsi:type="v8:LocalStringType">
						<v8:item>
							<v8:lang>ru</v8:lang>
							<v8:content>Партнер</v8:content>
						</v8:item>
					</title>
				</field>
				<field xsi:type="DataSetFieldField">
					<dataPath>Контрагент</dataPath>
					<field>Контрагент</field>
					<title xsi:type="v8:LocalStringType">
						<v8:item>
							<v8:lang>ru</v8:lang>
							<v8:content>Контрагент</v8:content>
						</v8:item>
					</title>
				</field>
				<field xsi:type="DataSetFieldField">
					<dataPath>COINVOIC</dataPath>
					<field>COINVOIC</field>
					<title xsi:type="v8:LocalStringType">
						<v8:item>
							<v8:lang>ru</v8:lang>
							<v8:content>COINVOIC</v8:content>
						</v8:item>
					</title>
				</field>
				<dataSource>ИсточникДанных1</dataSource>
				<objectName>ТаблицаКэш</objectName>
			</dataSet>
			<dataSet xsi:type="DataSetQuery">
				<name>СборкаДокументовИСообщений</name>
				<field xsi:type="DataSetFieldField">
					<dataPath>Контрагент</dataPath>
					<field>Контрагент</field>
				</field>
				<field xsi:type="DataSetFieldField">
					<dataPath>Корректировка</dataPath>
					<field>Корректировка</field>
				</field>
				<field xsi:type="DataSetFieldField">
					<dataPath>ДатаДокумента</dataPath>
					<field>ДатаДокумента</field>
				</field>
				<field xsi:type="DataSetFieldField">
					<dataPath>Документ</dataPath>
					<field>Документ</field>
				</field>
				<field xsi:type="DataSetFieldField">
					<dataPath>Порядок</dataPath>
					<field>Порядок</field>
				</field>
				<field xsi:type="DataSetFieldField">
					<dataPath>Статус</dataPath>
					<field>Статус</field>
				</field>
				<field xsi:type="DataSetFieldField">
					<dataPath>ТипСообщения</dataPath>
					<field>ТипСообщения</field>
				</field>
				<field xsi:type="DataSetFieldField">
					<dataPath>ТребуемоеДействие</dataPath>
					<field>ТребуемоеДействие</field>
				</field>
				<field xsi:type="DataSetFieldField">
					<dataPath>МожноСоздаватьСледующее</dataPath>
					<field>МожноСоздаватьСледующее</field>
				</field>
				<field xsi:type="DataSetFieldField">
					<dataPath>СообщениеДокумента</dataPath>
					<field>СообщениеДокумента</field>
				</field>
				<field xsi:type="DataSetFieldField">
					<dataPath>ИдентификаторЦепочки</dataPath>
					<field>ИдентификаторЦепочки</field>
				</field>
				<dataSource>ИсточникДанных1</dataSource>
				<query>ВЫБРАТЬ
	ЕСТЬNULL(СчетФактура.Ссылка, КорректировкаРеализации.Ссылка) КАК Документ,
	КорректировкаРеализации.Контрагент,
	КорректировкаРеализации.Ссылка КАК Корректировка,
	КорректировкаРеализации.Дата КАК ДатаДокумента,
	2 КАК Порядок,
	ВЫБОР
		КОГДА СчетФактура.Ссылка ЕСТЬ NULL
			ТОГДА "Создать Счет-фактура выданный"
		ИНАЧЕ ВЫБОР
				КОГДА СчетФактура.Исправление = ИСТИНА
						И КорректировкаРеализации.ДокументОснование ССЫЛКА Документ.РасходнаяНакладная
					ТОГДА "Отправить счет-фактуру"
				ИНАЧЕ "Отправить корректировочный счет-фактуру"
			КОНЕЦ
	КОНЕЦ КАК ОпределяемТребуемоеДействие,
	ВЫБОР
		КОГДА СчетФактура.Исправление = ИСТИНА
				И КорректировкаРеализации.ДокументОснование ССЫЛКА Документ.РасходнаяНакладная
			ТОГДА "INVOIC"
		ИНАЧЕ "COINVOIC"
	КОНЕЦ КАК ОпределяемТипСообщения,
	КорректировкаРеализации.Заказ КАК ИдентификаторЦепочки,
	КорректировкаРеализации.ДокументОснование
ПОМЕСТИТЬ табКорректировок
ИЗ
	Документ.КорректировкаРеализации КАК КорректировкаРеализации
		ЛЕВОЕ СОЕДИНЕНИЕ Документ.СчетФактура КАК СчетФактура
		ПО КорректировкаРеализации.Ссылка = СчетФактура.ДокументОснование
ГДЕ
	КорректировкаРеализации.Контрагент = &amp;Контрагент
	И КорректировкаРеализации.Проведен
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ
	СчетФактураВыданный.Ссылка КАК Документ,
	СчетФактураВыданный.Контрагент,
	СчетФактураВыданный.Дата КАК ДатаДокумента,
	1 КАК Порядок,
	табКорректировок.ИдентификаторЦепочки,
	"INVOIC" КАК ТипСообщения
ПОМЕСТИТЬ табПервичныхСчетовФактур
ИЗ
	табКорректировок КАК табКорректировок
		ВНУТРЕННЕЕ СОЕДИНЕНИЕ Документ.СчетФактура КАК СчетФактураВыданный
		ПО (табКорректировок.ДокументОснование = СчетФактураВыданный.ДокументОснование
				И табКорректировок.ДокументОснование ССЫЛКА Документ.РасходнаяНакладная)
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ
	табКорректировок.Документ,
	табКорректировок.Контрагент,
	табКорректировок.Корректировка,
	табКорректировок.ДатаДокумента,
	табКорректировок.Порядок,
	табКорректировок.ОпределяемТребуемоеДействие,
	табКорректировок.ОпределяемТипСообщения,
	табКорректировок.ИдентификаторЦепочки
ПОМЕСТИТЬ табДокументов
ИЗ
	табКорректировок КАК табКорректировок

ОБЪЕДИНИТЬ ВСЕ

ВЫБРАТЬ
	табПервичныхСчетовФактур.Документ,
	табПервичныхСчетовФактур.Контрагент,
	NULL,
	табПервичныхСчетовФактур.ДатаДокумента,
	табПервичныхСчетовФактур.Порядок,
	NULL,
	табПервичныхСчетовФактур.ТипСообщения,
	табПервичныхСчетовФактур.ИдентификаторЦепочки
ИЗ
	табПервичныхСчетовФактур КАК табПервичныхСчетовФактур
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ
	табДокументов.Документ,
	табДокументов.Контрагент,
	табДокументов.Корректировка,
	табДокументов.ДатаДокумента,
	табДокументов.Порядок,
	КонтурEDI_Сообщения.Ссылка КАК СообщениеДокумента,
	КонтурEDI_Сообщения.Статус,
	ЕСТЬNULL(КонтурEDI_Сообщения.ТребуемоеДействие, табДокументов.ОпределяемТребуемоеДействие) КАК ТребуемоеДействие,
	ЕСТЬNULL(КонтурEDI_Сообщения.ТипСообщения, табДокументов.ОпределяемТипСообщения) КАК ТипСообщения,
	ВЫБОР
		КОГДА КонтурEDI_Сообщения.Ссылка ЕСТЬ НЕ NULL 
				И НЕ КонтурEDI_Сообщения.Статус В (&amp;БлокирующиеСтатусыПервичногоINVOIC)
				И ЕСТЬNULL(КонтурEDI_СообщенияДополнительныеРеквизиты.Значение, ИСТИНА) = ИСТИНА
			ТОГДА ИСТИНА
		ИНАЧЕ ЛОЖЬ
	КОНЕЦ КАК МожноСоздаватьСледующее,
	табДокументов.ИдентификаторЦепочки
ИЗ
	табДокументов КАК табДокументов
		ЛЕВОЕ СОЕДИНЕНИЕ Справочник.КонтурEDI_Сообщения КАК КонтурEDI_Сообщения
			ЛЕВОЕ СОЕДИНЕНИЕ Справочник.КонтурEDI_Сообщения.ДополнительныеРеквизиты КАК КонтурEDI_СообщенияДополнительныеРеквизиты
			ПО КонтурEDI_Сообщения.Ссылка = КонтурEDI_СообщенияДополнительныеРеквизиты.Ссылка
				И (КонтурEDI_СообщенияДополнительныеРеквизиты.ИмяРеквизита = "DraftOfDocumentPackageSignedByMe")
		ПО табДокументов.Документ = КонтурEDI_Сообщения.Документ
			И табДокументов.ОпределяемТипСообщения = КонтурEDI_Сообщения.ТипСообщения</query>
			</dataSet>
			<dataSetLink>
				<sourceDataSet>ТаблицаКэшПартнеровКонтрагентов</sourceDataSet>
				<destinationDataSet>СборкаДокументовИСообщений</destinationDataSet>
				<sourceExpression>Контрагент</sourceExpression>
				<destinationExpression>Контрагент</destinationExpression>
				<parameter>Контрагент</parameter>
				<parameterListAllowed>false</parameterListAllowed>
				<linkConditionExpression>COINVOIC = Истина</linkConditionExpression>
			</dataSetLink>
			<calculatedField>
				<dataPath>СоздатьCOINVOIC</dataPath>
				<expression>Корректировка ЕСТЬ НЕ NULL  И СообщениеДокумента ЕСТЬ NULL  И ВычислитьВыражение("МожноСоздаватьСледующее", "ПолученныеДанные","Группировка","Предыдущая" ,"Предыдущая" , , , )</expression>
				<title xsi:type="v8:LocalStringType">
					<v8:item>
						<v8:lang>ru</v8:lang>
						<v8:content>Создать COINVOIC</v8:content>
					</v8:item>
				</title>
			</calculatedField>
			<calculatedField>
				<dataPath>Сообщение</dataPath>
				<expression>Выбор Когда СообщениеДокумента ЕСТЬ NULL Тогда ВычислитьВыражение("СообщениеДокумента", "ПолученныеДанные","Группировка","Предыдущая" ,"Предыдущая" , , , ) Иначе СообщениеДокумента Конец</expression>
				<title xsi:type="v8:LocalStringType">
					<v8:item>
						<v8:lang>ru</v8:lang>
						<v8:content>Сообщение</v8:content>
					</v8:item>
				</title>
			</calculatedField>
			<totalField>
				<dataPath>Сообщение</dataPath>
				<expression>Максимум(Сообщение)</expression>
			</totalField>
			<totalField>
				<dataPath>СоздатьCOINVOIC</dataPath>
				<expression>Минимум(СоздатьCOINVOIC)</expression>
			</totalField>
			<parameter>
				<name>БлокирующиеСтатусыПервичногоINVOIC</name>
				<title xsi:type="v8:LocalStringType">
					<v8:item>
						<v8:lang>ru</v8:lang>
						<v8:content>Блокирующие статусы первичного INVOIC</v8:content>
					</v8:item>
				</title>
				<valueType>
					<v8:Type>xs:string</v8:Type>
					<v8:StringQualifiers>
						<v8:Length>40</v8:Length>
						<v8:AllowedLength>Variable</v8:AllowedLength>
					</v8:StringQualifiers>
				</valueType>
				<value xsi:type="xs:string"/>
				<useRestriction>true</useRestriction>
			</parameter>
			<parameter>
				<name>Контрагент</name>
				<title xsi:type="v8:LocalStringType">
					<v8:item>
						<v8:lang>ru</v8:lang>
						<v8:content>Контрагент</v8:content>
					</v8:item>
				</title>
				<value xsi:nil="true"/>
				<useRestriction>true</useRestriction>
			</parameter>
			<settingsVariant>
				<dcsset:name>Основной</dcsset:name>
				<dcsset:presentation xsi:type="xs:string">Основной</dcsset:presentation>
				<dcsset:settings xmlns:style="http://v8.1c.ru/8.1/data/ui/style" xmlns:sys="http://v8.1c.ru/8.1/data/ui/fonts/system" xmlns:web="http://v8.1c.ru/8.1/data/ui/colors/web" xmlns:win="http://v8.1c.ru/8.1/data/ui/colors/windows">
					<dcsset:selection>
						<dcsset:item xsi:type="dcsset:SelectedItemField">
							<dcsset:field>Сообщение</dcsset:field>
						</dcsset:item>
						<dcsset:item xsi:type="dcsset:SelectedItemField">
							<dcsset:field>СоздатьCOINVOIC</dcsset:field>
						</dcsset:item>
					</dcsset:selection>
					<dcsset:order>
						<dcsset:item xsi:type="dcsset:OrderItemField">
							<dcsset:field>ИдентификаторЦепочки</dcsset:field>
							<dcsset:orderType>Asc</dcsset:orderType>
						</dcsset:item>
						<dcsset:item xsi:type="dcsset:OrderItemField">
							<dcsset:field>Порядок</dcsset:field>
							<dcsset:orderType>Asc</dcsset:orderType>
						</dcsset:item>
						<dcsset:item xsi:type="dcsset:OrderItemField">
							<dcsset:field>ДатаДокумента</dcsset:field>
							<dcsset:orderType>Asc</dcsset:orderType>
						</dcsset:item>
					</dcsset:order>
					<dcsset:item xsi:type="dcsset:StructureItemGroup">
						<dcsset:name>ПолученныеДанные</dcsset:name>
						<dcsset:groupItems>
							<dcsset:item xsi:type="dcsset:GroupItemField">
								<dcsset:field>Партнер</dcsset:field>
								<dcsset:groupType>Items</dcsset:groupType>
								<dcsset:periodAdditionType>None</dcsset:periodAdditionType>
								<dcsset:periodAdditionBegin xsi:type="xs:dateTime">0001-01-01T00:00:00</dcsset:periodAdditionBegin>
								<dcsset:periodAdditionEnd xsi:type="xs:dateTime">0001-01-01T00:00:00</dcsset:periodAdditionEnd>
							</dcsset:item>
							<dcsset:item xsi:type="dcsset:GroupItemField">
								<dcsset:field>Контрагент</dcsset:field>
								<dcsset:groupType>Items</dcsset:groupType>
								<dcsset:periodAdditionType>None</dcsset:periodAdditionType>
								<dcsset:periodAdditionBegin xsi:type="xs:dateTime">0001-01-01T00:00:00</dcsset:periodAdditionBegin>
								<dcsset:periodAdditionEnd xsi:type="xs:dateTime">0001-01-01T00:00:00</dcsset:periodAdditionEnd>
							</dcsset:item>
							<dcsset:item xsi:type="dcsset:GroupItemField">
								<dcsset:field>ИдентификаторЦепочки</dcsset:field>
								<dcsset:groupType>Items</dcsset:groupType>
								<dcsset:periodAdditionType>None</dcsset:periodAdditionType>
								<dcsset:periodAdditionBegin xsi:type="xs:dateTime">0001-01-01T00:00:00</dcsset:periodAdditionBegin>
								<dcsset:periodAdditionEnd xsi:type="xs:dateTime">0001-01-01T00:00:00</dcsset:periodAdditionEnd>
							</dcsset:item>
							<dcsset:item xsi:type="dcsset:GroupItemField">
								<dcsset:field>Документ</dcsset:field>
								<dcsset:groupType>Items</dcsset:groupType>
								<dcsset:periodAdditionType>None</dcsset:periodAdditionType>
								<dcsset:periodAdditionBegin xsi:type="xs:dateTime">0001-01-01T00:00:00</dcsset:periodAdditionBegin>
								<dcsset:periodAdditionEnd xsi:type="xs:dateTime">0001-01-01T00:00:00</dcsset:periodAdditionEnd>
							</dcsset:item>
							<dcsset:item xsi:type="dcsset:GroupItemField">
								<dcsset:field>ТребуемоеДействие</dcsset:field>
								<dcsset:groupType>Items</dcsset:groupType>
								<dcsset:periodAdditionType>None</dcsset:periodAdditionType>
								<dcsset:periodAdditionBegin xsi:type="xs:dateTime">0001-01-01T00:00:00</dcsset:periodAdditionBegin>
								<dcsset:periodAdditionEnd xsi:type="xs:dateTime">0001-01-01T00:00:00</dcsset:periodAdditionEnd>
							</dcsset:item>
							<dcsset:item xsi:type="dcsset:GroupItemField">
								<dcsset:field>ТипСообщения</dcsset:field>
								<dcsset:groupType>Items</dcsset:groupType>
								<dcsset:periodAdditionType>None</dcsset:periodAdditionType>
								<dcsset:periodAdditionBegin xsi:type="xs:dateTime">0001-01-01T00:00:00</dcsset:periodAdditionBegin>
								<dcsset:periodAdditionEnd xsi:type="xs:dateTime">0001-01-01T00:00:00</dcsset:periodAdditionEnd>
							</dcsset:item>
							<dcsset:item xsi:type="dcsset:GroupItemField">
								<dcsset:field>Порядок</dcsset:field>
								<dcsset:groupType>Items</dcsset:groupType>
								<dcsset:periodAdditionType>None</dcsset:periodAdditionType>
								<dcsset:periodAdditionBegin xsi:type="xs:dateTime">0001-01-01T00:00:00</dcsset:periodAdditionBegin>
								<dcsset:periodAdditionEnd xsi:type="xs:dateTime">0001-01-01T00:00:00</dcsset:periodAdditionEnd>
							</dcsset:item>
							<dcsset:item xsi:type="dcsset:GroupItemField">
								<dcsset:field>ДатаДокумента</dcsset:field>
								<dcsset:groupType>Items</dcsset:groupType>
								<dcsset:periodAdditionType>None</dcsset:periodAdditionType>
								<dcsset:periodAdditionBegin xsi:type="xs:dateTime">0001-01-01T00:00:00</dcsset:periodAdditionBegin>
								<dcsset:periodAdditionEnd xsi:type="xs:dateTime">0001-01-01T00:00:00</dcsset:periodAdditionEnd>
							</dcsset:item>
						</dcsset:groupItems>
						<dcsset:order>
							<dcsset:item xsi:type="dcsset:OrderItemAuto"/>
						</dcsset:order>
						<dcsset:selection>
							<dcsset:item xsi:type="dcsset:SelectedItemAuto"/>
						</dcsset:selection>
					</dcsset:item>
				</dcsset:settings>
			</settingsVariant>
		</schema>
		<settings xmlns:style="http://v8.1c.ru/8.1/data/ui/style" xmlns:sys="http://v8.1c.ru/8.1/data/ui/fonts/system" xmlns:web="http://v8.1c.ru/8.1/data/ui/colors/web" xmlns:win="http://v8.1c.ru/8.1/data/ui/colors/windows"/>
	</nestedSchema>
	<settingsVariant>
		<dcsset:name>Основной</dcsset:name>
		<dcsset:presentation xsi:type="xs:string">Основной</dcsset:presentation>
		<dcsset:settings xmlns:style="http://v8.1c.ru/8.1/data/ui/style" xmlns:sys="http://v8.1c.ru/8.1/data/ui/fonts/system" xmlns:web="http://v8.1c.ru/8.1/data/ui/colors/web" xmlns:win="http://v8.1c.ru/8.1/data/ui/colors/windows"/>
	</settingsVariant>
</DataCompositionSchema>